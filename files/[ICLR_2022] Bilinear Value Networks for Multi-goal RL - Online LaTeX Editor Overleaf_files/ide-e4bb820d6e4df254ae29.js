/*! For license information please see ide-e4bb820d6e4df254ae29.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ide=t():(e.Frontend=e.Frontend||{},e.Frontend.ide=t())}(window,(function(){return function(e){function t(t){for(var r,a,h=t[0],p=t[1],f=t[2],y=0,x=[];y<h.length;y++)a=h[y],Object.prototype.hasOwnProperty.call(l,a)&&l[a]&&x.push(l[a][0]),l[a]=0;for(r in p)Object.prototype.hasOwnProperty.call(p,r)&&(e[r]=p[r]);for(w&&w(t);x.length;)x.shift()();return d.push.apply(d,f||[]),n()}function n(){for(var e,t=0;t<d.length;t++){for(var n=d[t],r=!0,a=1;a<n.length;a++){var p=n[a];0!==l[p]&&(r=!1)}r&&(d.splice(t--,1),e=h(h.s=n[0]))}return e}var r={},a={51:0},l={51:0},d=[];function h(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,h),n.l=!0,n.exports}h.e=function(e){var t=[];a[e]?t.push(a[e]):0!==a[e]&&{82:1}[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="stylesheets/"+({3:"cm6-theme0",4:"cm6-theme1",5:"cm6-theme10",6:"cm6-theme11",7:"cm6-theme12",8:"cm6-theme13",9:"cm6-theme14",10:"cm6-theme15",11:"cm6-theme16",12:"cm6-theme17",13:"cm6-theme18",14:"cm6-theme19",15:"cm6-theme2",16:"cm6-theme20",17:"cm6-theme21",18:"cm6-theme22",19:"cm6-theme23",20:"cm6-theme24",21:"cm6-theme25",22:"cm6-theme26",23:"cm6-theme27",24:"cm6-theme28",25:"cm6-theme29",26:"cm6-theme3",27:"cm6-theme30",28:"cm6-theme31",29:"cm6-theme32",30:"cm6-theme33",31:"cm6-theme34",32:"cm6-theme35",33:"cm6-theme36",34:"cm6-theme37",35:"cm6-theme38",36:"cm6-theme39",37:"cm6-theme4",38:"cm6-theme5",39:"cm6-theme6",40:"cm6-theme7",41:"cm6-theme8",42:"cm6-theme9",43:"codemirror-editor",44:"cs-json",45:"da-json",46:"de-json",47:"en-json",48:"es-json",49:"fi-json",50:"fr-json",53:"it-json",54:"ja-json",55:"ko-json",68:"nl-json",69:"no-json",72:"pdf-js-viewer",73:"pl-json",74:"pt-json",75:"rich-text",76:"ru-json",79:"sv-json",80:"tr-json",81:"vendors~codemirror-editor",82:"vendors~pdf-js-viewer",83:"vendors~rich-text",84:"zh-CN-json"}[e]||e)+"-"+{3:"024f7b293315c26546ad",4:"4e264a66d7ad488a5c95",5:"ac1bb92dea294008a3f5",6:"fdeab3d99ec9bcda836e",7:"ccf75971af6dace7e3a6",8:"36320bac54487d819598",9:"e9aecbf53eea90581710",10:"a776e0fef6ea25e65eee",11:"0c2b37dde24afccce054",12:"459634a97d02c179818a",13:"2144f83331cd96e39861",14:"bb8d69570a10a6cf5b3a",15:"5d1267b4333c2a391548",16:"cd604852a450bf285bcc",17:"e8d46c5c1d18d5abbf4a",18:"0b6251f3903da2933d98",19:"573b3392e1cda7ea3a3a",20:"3502e5f4cc13eb118be8",21:"a254f957809dca824bd3",22:"bc53aec3b2065fc32395",23:"d378007f590b804cdfc3",24:"45ca3e325a7c30a6255e",25:"4492b7a30fc491b052b3",26:"ec8bfb52c3af2852e209",27:"92e73a670410278abce4",28:"0dd480d28ef6aeb59853",29:"8a13fd0f6930b78c3a26",30:"cebe1e412104a4345e11",31:"6ab567bd30d1b254cd30",32:"02f0c78d5055f19ef791",33:"08187fe2152bef011cbb",34:"7025caad56f49e9f0855",35:"47b70a7f511303a941a3",36:"64b674d71c81e86f02a1",37:"61b4d2c2ee560cc49617",38:"6734108561f8a2d67c78",39:"a3d969264ca1ac8288d7",40:"514dd35391c9fcdbce35",41:"f6424ce12ac6e8c1aabd",42:"8f6b3b29282598f4128b",43:"243cde96cb553ab4e115",44:"ed4d85ceb2657aa9db2c",45:"cf565e467b68093cbcd5",46:"d1adcbc6bacb2cd21c13",47:"201e8d48432e78a0e682",48:"b1d71cd868efc1fd6701",49:"699b3ca27125c08f112b",50:"ae46c6656e1e4d662980",53:"774323685a840c30d30c",54:"d20edf045bd1c56183be",55:"f4910a44ce7a3143598a",68:"8eca098800d162d599bd",69:"a0d3f24ab3cdd4510615",72:"60f346ebe857048dba70",73:"167f651c4a6197fd1e02",74:"041e8cf24fb3a089acfe",75:"eebc277858ac7b70f33a",76:"9485431286162ea6c286",79:"8eda0ebc4248a28f2aad",80:"9fe4335f980a617bf65a",81:"56a54b9befa1b4861088",82:"64c56e8c99376d48be26",83:"4bca435b0ac58e91d25a",84:"153121a31a4d4ba6243d",85:"70a6ee679dfebbed24cf",86:"f5a90749a53094d1166f",87:"62171b0e66b93f35ac3e",88:"c18aa75a376180acd1dc",89:"4426f029198dcac8ee38"}[e]+".css",l=h.p+r,d=document.getElementsByTagName("link"),p=0;p<d.length;p++){var f=(w=d[p]).getAttribute("data-href")||w.getAttribute("href");if("stylesheet"===w.rel&&(f===r||f===l))return t()}var y=document.getElementsByTagName("style");for(p=0;p<y.length;p++){var w;if((f=(w=y[p]).getAttribute("data-href"))===r||f===l)return t()}var x=document.createElement("link");x.rel="stylesheet",x.type="text/css",x.onload=t,x.onerror=function(t){var r=t&&t.target&&t.target.src||l,d=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");d.code="CSS_CHUNK_LOAD_FAILED",d.request=r,delete a[e],x.parentNode.removeChild(x),n(d)},x.href=l,document.getElementsByTagName("head")[0].appendChild(x)})).then((function(){a[e]=0})));var n=l[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=l[e]=[t,r]}));t.push(n[2]=r);var d,p=document.createElement("script");p.charset="utf-8",p.timeout=120,h.nc&&p.setAttribute("nonce",h.nc),p.src=function(e){return h.p+"js/"+({3:"cm6-theme0",4:"cm6-theme1",5:"cm6-theme10",6:"cm6-theme11",7:"cm6-theme12",8:"cm6-theme13",9:"cm6-theme14",10:"cm6-theme15",11:"cm6-theme16",12:"cm6-theme17",13:"cm6-theme18",14:"cm6-theme19",15:"cm6-theme2",16:"cm6-theme20",17:"cm6-theme21",18:"cm6-theme22",19:"cm6-theme23",20:"cm6-theme24",21:"cm6-theme25",22:"cm6-theme26",23:"cm6-theme27",24:"cm6-theme28",25:"cm6-theme29",26:"cm6-theme3",27:"cm6-theme30",28:"cm6-theme31",29:"cm6-theme32",30:"cm6-theme33",31:"cm6-theme34",32:"cm6-theme35",33:"cm6-theme36",34:"cm6-theme37",35:"cm6-theme38",36:"cm6-theme39",37:"cm6-theme4",38:"cm6-theme5",39:"cm6-theme6",40:"cm6-theme7",41:"cm6-theme8",42:"cm6-theme9",43:"codemirror-editor",44:"cs-json",45:"da-json",46:"de-json",47:"en-json",48:"es-json",49:"fi-json",50:"fr-json",53:"it-json",54:"ja-json",55:"ko-json",68:"nl-json",69:"no-json",72:"pdf-js-viewer",73:"pl-json",74:"pt-json",75:"rich-text",76:"ru-json",79:"sv-json",80:"tr-json",81:"vendors~codemirror-editor",82:"vendors~pdf-js-viewer",83:"vendors~rich-text",84:"zh-CN-json"}[e]||e)+"-"+{3:"024f7b293315c26546ad",4:"4e264a66d7ad488a5c95",5:"ac1bb92dea294008a3f5",6:"fdeab3d99ec9bcda836e",7:"ccf75971af6dace7e3a6",8:"36320bac54487d819598",9:"e9aecbf53eea90581710",10:"a776e0fef6ea25e65eee",11:"0c2b37dde24afccce054",12:"459634a97d02c179818a",13:"2144f83331cd96e39861",14:"bb8d69570a10a6cf5b3a",15:"5d1267b4333c2a391548",16:"cd604852a450bf285bcc",17:"e8d46c5c1d18d5abbf4a",18:"0b6251f3903da2933d98",19:"573b3392e1cda7ea3a3a",20:"3502e5f4cc13eb118be8",21:"a254f957809dca824bd3",22:"bc53aec3b2065fc32395",23:"d378007f590b804cdfc3",24:"45ca3e325a7c30a6255e",25:"4492b7a30fc491b052b3",26:"ec8bfb52c3af2852e209",27:"92e73a670410278abce4",28:"0dd480d28ef6aeb59853",29:"8a13fd0f6930b78c3a26",30:"cebe1e412104a4345e11",31:"6ab567bd30d1b254cd30",32:"02f0c78d5055f19ef791",33:"08187fe2152bef011cbb",34:"7025caad56f49e9f0855",35:"47b70a7f511303a941a3",36:"64b674d71c81e86f02a1",37:"61b4d2c2ee560cc49617",38:"6734108561f8a2d67c78",39:"a3d969264ca1ac8288d7",40:"514dd35391c9fcdbce35",41:"f6424ce12ac6e8c1aabd",42:"8f6b3b29282598f4128b",43:"243cde96cb553ab4e115",44:"ed4d85ceb2657aa9db2c",45:"cf565e467b68093cbcd5",46:"d1adcbc6bacb2cd21c13",47:"201e8d48432e78a0e682",48:"b1d71cd868efc1fd6701",49:"699b3ca27125c08f112b",50:"ae46c6656e1e4d662980",53:"774323685a840c30d30c",54:"d20edf045bd1c56183be",55:"f4910a44ce7a3143598a",68:"8eca098800d162d599bd",69:"a0d3f24ab3cdd4510615",72:"60f346ebe857048dba70",73:"167f651c4a6197fd1e02",74:"041e8cf24fb3a089acfe",75:"eebc277858ac7b70f33a",76:"9485431286162ea6c286",79:"8eda0ebc4248a28f2aad",80:"9fe4335f980a617bf65a",81:"56a54b9befa1b4861088",82:"64c56e8c99376d48be26",83:"4bca435b0ac58e91d25a",84:"153121a31a4d4ba6243d",85:"70a6ee679dfebbed24cf",86:"f5a90749a53094d1166f",87:"62171b0e66b93f35ac3e",88:"c18aa75a376180acd1dc",89:"4426f029198dcac8ee38"}[e]+".js"}(e);var f=new Error;d=function(t){p.onerror=p.onload=null,clearTimeout(y);var n=l[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",f.name="ChunkLoadError",f.type=r,f.request=a,n[1](f)}l[e]=void 0}};var y=setTimeout((function(){d({type:"timeout",target:p})}),12e4);p.onerror=p.onload=d,document.head.appendChild(p)}return Promise.all(t)},h.m=e,h.c=r,h.d=function(e,t,n){h.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},h.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(e,t){if(1&t&&(e=h(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)h.d(n,r,function(t){return e[t]}.bind(null,r));return n},h.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(t,"a",t),t},h.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},h.p="/",h.oe=function(e){throw console.error(e),e};var p=window.webpackJsonp=window.webpackJsonp||[],f=p.push.bind(p);p.push=t,p=p.slice();for(var y=0;y<p.length;y++)t(p[y]);var w=f;return d.push([1009,0,2]),n()}([,,,function(e,t,n){"use strict";n(7),n(65),n(72),n(79),n(104),n(521),n(522),n(5),n(384),n(385),n(386),n(387),n(388),n(274),n(389),n(523),n(524);var r=n(21),a=n(33),l=(n(393),n(45),angular.module("ErrorCatcher",[]));l.config(["$provide",function(e){return e.decorator("$exceptionHandler",["$log","$delegate",function(e,t){return function(e,n){if("Possibly unhandled rejection: canceled"!==e||void 0!==n)return Object(a.a)(e,(function(e){return e.setTag("handler","angular-exception-handler"),e})),t(e,n)}}])}]),l.factory("unAuthHttpResponseInterceptor",["$q","$location",function(e,t){return{responseError:function responseError(t){return[401,403].includes(t.status)&&!(null!=t.config?t.config.disableAutoLoginRedirect:void 0)&&(window.location.pathname.match(/^\/project/)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):window.location="/login"),e.reject(t)}}}]),l.config(["$httpProvider",function(e){return e.interceptors.push("unAuthHttpResponseInterceptor")}]);n(276);function d(){try{var e;return(e=$).sessionStorage.apply(e,arguments)}catch(e){return console.error("sessionStorage exception",e),null}}angular.module("sessionStorage",[]).value("sessionStorage",d);var h=n(153),p=angular.module("SharelatexApp",["ui.bootstrap","autocomplete","RecursionHelper","ng-context-menu","ngSanitize","ipCookie","ErrorCatcher","localStorage","sessionStorage","ui.select"]).config(["$qProvider","$httpProvider","uiSelectConfig",function(e,t,n){e.errorOnUnhandledRejections(!1),n.spinnerClass="fa fa-refresh ui-select-spin",Object(h.a)()}]);p.run(["$rootScope","$templateCache",function(e,t){e.usersEmail=Object(r.a)("ol-usersEmail"),t.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="fa fa-times" aria-hidden="true"></i></a></span></div>')}]);var f=window.location.search.match(/debug=true/);window.sl_debugging=f,window.sl_console=f?console:{log:function(){}};t.a=p},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(1),a=n.n(r),l=n(19),d=n.n(l),h=n(0);function p(e){var t,n,r,a=e.type,l=e.spin,p=e.fw,f=e.modifier,y=e.className,w=void 0===y?"":y,x=e.accessibilityLabel,j=d()("fa","fa-".concat(a),(t={"fa-spin":l,"fa-fw":p},n="fa-".concat(f),r=f,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t),w);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("i",{className:j,"aria-hidden":"true"}),x&&Object(h.jsx)("span",{className:"sr-only",children:x})]})}p.propTypes={type:a.a.string.isRequired,spin:a.a.bool,fw:a.a.bool,modifier:a.a.string,className:a.a.string,accessibilityLabel:a.a.string},t.a=p},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return E})),n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return R}));n(43),n(11),n(30),n(57),n(18),n(58),n(63),n(64),n(12),n(14),n(6),n(8),n(9),n(37),n(49),n(4),n(24),n(10),n(7),n(17);var r=n(74);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=["body","headers","method","credentials","swallowAbortError"];function d(e,t,n,r,a,l,d){try{var h=e[l](d),p=h.value}catch(e){return void n(e)}h.done?t(p):Promise.resolve(p).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function h(e){d(l,r,a,h,p,"next",e)}function p(e){d(l,r,a,h,p,"throw",e)}h(void 0)}))}}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var a=j(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return x(this,n)}}function x(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return I(e,C(C({},t),{},{method:"GET"}))}function k(e,t){return I(e,C(C({},t),{},{method:"POST"}))}function E(e,t){return I(e,C(C({},t),{},{method:"PUT"}))}function A(e,t){return I(e,C(C({},t),{},{method:"DELETE"}))}function T(e){switch(e){case 400:return"Bad Request";case 401:return"Unauthorized";case 403:return"Forbidden";case 404:return"Not Found";case 429:return"Too Many Requests";case 500:return"Internal Server Error";case 502:return"Bad Gateway";case 503:return"Service Unavailable";default:return"Unexpected Error: ".concat(e)}}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(FetchError,e);var t,n,r,a=w(FetchError);function FetchError(e,t,n,r,l){var d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FetchError),e||(e=T(r.status)),(d=a.call(this,e,{statusCode:r?r.status:void 0})).url=t,d.options=n,d.response=r,d.data=l,d}return t=FetchError,(n=[{key:"getUserFacingMessage",value:function(){var e,t,n,r,a=null===(e=this.response)||void 0===e?void 0:e.status,l=T(a),d=(null===(t=this.data)||void 0===t||null===(n=t.message)||void 0===n?void 0:n.text)||(null===(r=this.data)||void 0===r?void 0:r.message);if(d&&d!==l)return d;switch(a){case 400:return"Invalid Request. Please correct the data and try again.";case 403:return"Session error. Please check you have cookies enabled. If the problem persists, try clearing your cache and cookies.";case 429:return"Too many attempts. Please wait for a while and try again.";default:return"Something went wrong talking to the server :(. Please try again."}}}])&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),FetchError}(n.n(r).a);function I(e,t){var n=t.body,r=void 0===n?{}:n,a=t.headers,d=void 0===a?{}:a,h=t.method,f=void 0===h?"GET":h,y=t.credentials,w=void 0===y?"same-origin":y,x=t.swallowAbortError,j=void 0===x||x,O=C(C({},p(t,l)),{},{headers:C(C({},d),{},{"Content-Type":"application/json","X-Csrf-Token":window.csrfToken,Accept:"application/json"}),credentials:w,method:f});return"GET"!==f&&"HEAD"!==f&&(O.body=JSON.stringify(r)),new Promise((function(t,n){fetch(e,O).then((function(r){return function(e){return P.apply(this,arguments)}(r).then((function(a){r.ok?t(a):n(new R(r.statusText,e,O,r,a))}),(function(t){n(new R("There was an error parsing the response body",e,O,r).withCause(t))}))}),(function(t){j&&"AbortError"===t.name||n(new R("There was an error fetching the JSON",e,O).withCause(t))}))}))}function P(){return(P=h(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.headers.get("Content-Type"),!/application\/json/.test(n)){e.next=3;break}return e.abrupt("return",t.json());case 3:if(!/text\/plain/.test(n)){e.next=8;break}return e.next=6,t.text();case 6:return r=e.sent,e.abrupt("return",{message:r});case 8:if(!/text\/html/.test(n)){e.next=14;break}return e.next=11,t.text();case 11:if(a=e.sent,/^\s*</.test(a)){e.next=14;break}return e.abrupt("return",{message:a});case 14:return e.abrupt("return",{});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(6),n(117),n(4),n(8),n(9),n(18),n(77),n(29),n(13),n(10),n(16);var r=n(5),a=n.n(r);function l(e,t){if(window.metaAttributesCache.has(e))return window.metaAttributesCache.get(e);var n=document.head.querySelector('meta[name="'.concat(e,'"]'));if(!n)return t;var r,a=n.content;switch(n.dataset.type){case"boolean":r=n.hasAttribute("content");break;case"json":r=a?JSON.parse(a):void 0;break;default:r=a}return window.metaAttributesCache.set(e,r),r}window.metaAttributesCache=window.metaAttributesCache||new Map,window.data=window.data||{},Array.from(document.querySelectorAll('meta[name^="ol-"]')).map((function(e){return e.name})).sort().forEach((function(e){var t=e.slice("ol-".length);a.a.set(window,t,l(e)),a.a.set(window.data,t,l(e))}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"e",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return C}));n(45),n(49);var r=function(e,t,n){try{return e(t,n)}catch(e){return console.error("sessionStorage exception",e),null}},a=function(e){return JSON.parse(sessionStorage.getItem(e))},l=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},d=function(){sessionStorage.clear()},h=function(e){return sessionStorage.removeItem(e)},p={getItem:function(e){return r(a,e)},setItem:function(e,t){return r(l,e,t)},clear:function(){return r(d)},removeItem:function(e){return r(h,e)}};function f(e){return!!(p.getItem("mbEvents")||{})[e]}function y(e){var t=p.getItem("mbEvents")||{};t[e]=!0,p.setItem("mbEvents",t)}function w(e,t,n,r){"function"==typeof window.ga&&window.ga("send","event",e,t,n,r)}function x(e,t,n,r){f(e)||"function"==typeof window.ga&&(window.ga("send","event",e,t,n,r),y(e))}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(e,t),"function"==typeof window.gtag&&["paywall-click","paywall-prompt","plans-page-click"].includes(e)&&window.gtag("event",e,t)}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(e)||(j(e,t),y(e))}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;Math.random()<n&&j(e,t)}function S(e,t){if(navigator&&navigator.sendBeacon){t._csrf=window.csrfToken;var n=new Blob([JSON.stringify(t)],{type:"application/json; charset=UTF-8"});try{navigator.sendBeacon("/event/".concat(e),n)}catch(e){}}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));n(6),n(4),n(24),n(8),n(9),n(98),n(7),n(99),n(55);var r=window.ExposedSettings.sentryDsn?Promise.resolve().then(n.bind(null,131)).then((function(e){var t=0;return e.init({dsn:window.ExposedSettings.sentryDsn,environment:window.ExposedSettings.sentryEnvironment,release:window.ExposedSettings.sentryRelease,autoSessionTracking:!1,whitelistUrls:[new RegExp(window.ExposedSettings.sentryAllowedOriginRegex)],ignoreErrors:['SecurityError: Permission denied to access property "pathname" on cross-origin object',/^Missing PDF/,/^pdfng error Error: MissingPDFException/,/^AbortError/,"ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications.",/Non-Error promise rejection captured with value: Object Not Found Matching Id/],beforeSend:function(e){return++t>100?null:e}}),e.setUser({id:window.user_id}),e})).catch((function(e){return console.error(e),a()})):a();function a(){return Promise.resolve({captureException:console.error,captureMessage:console.error})}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.then((function(e){return e.captureException.apply(e,t)}))}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.then((function(e){return e.captureMessage.apply(e,t)}))}},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return x})),n.d(t,"a",(function(){return O}));n(10),n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(62),h=n(0);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=Object(r.createContext)(),w={_id:l.a.string.isRequired,name:l.a.string.isRequired,rootDocId:l.a.string,members:l.a.arrayOf(l.a.shape({_id:l.a.string.isRequired})),invites:l.a.arrayOf(l.a.shape({_id:l.a.string.isRequired})),features:l.a.shape({collaborators:l.a.number,compileGroup:l.a.oneOf(["alpha","standard","priority"]),trackChangesVisible:l.a.bool,references:l.a.bool,mendeley:l.a.bool,zotero:l.a.bool}),publicAccessLevel:l.a.string,tokens:l.a.shape({readOnly:l.a.string,readAndWrite:l.a.string}),owner:l.a.shape({_id:l.a.string.isRequired,email:l.a.string.isRequired})};function x(e){var t=Object(r.useContext)(y);if(!t)throw new Error("useProjectContext is only available inside ProjectProvider");return l.a.checkPropTypes(e,t,"data","ProjectContext.Provider"),t}y.Provider.propTypes={value:l.a.shape(w)};var j={_id:window.project_id,name:"",features:{}};function O(e){var t=e.children,n=p(Object(d.a)("project",!0),1)[0]||j,a=n._id,l=n.name,f=n.rootDoc_id,w=n.members,x=n.invites,O=n.features,C=n.publicAccesLevel,S=n.tokens,_=n.owner,k=Object(r.useMemo)((function(){return{_id:a,name:l,rootDocId:f,members:w,invites:x,features:O,publicAccessLevel:C,tokens:S,owner:_}}),[a,l,f,w,x,O,C,S,_]);return Object(h.jsx)(y.Provider,{value:k,children:t})}O.propTypes={children:l.a.any}},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},,,,,function(e,t,n){"use strict";function r(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=0;(l=new Error(t.replace(/%s/g,(function(){return r[d++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}n.d(t,"a",(function(){return r}))},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(5),h=n.n(d),p=n(114);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(p.b)({$scope:l.a.object.isRequired}),a=n.$scope,d=Object(r.useState)((function(){return h.a.get(a,e)})),y=f(d,2),w=y[0],x=y[1];Object(r.useEffect)((function(){return a.$watch(e,(function(e){x((function(){return t?h.a.cloneDeep(e):e}))}),t)}),[e,a,t]);var j=Object(r.useCallback)((function(t){x((function(n){var r=h.a.isFunction(t)?t(n):t;return a.$applyAsync((function(){return h.a.set(a,e,r)})),r}))}),[e,a]);return[w,j]}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return C}));n(10),n(26),n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(62),h=n(362),p=n(114),f=n(38),y=n(0);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var j=Object(r.createContext)();function O(e){var t=e.children,n=e.settings,a=Object(p.b)(),x=Object(f.c)({owner:l.a.shape({_id:l.a.string.isRequired}),features:l.a.shape({compileGroup:l.a.string})}),O=x.owner,C=x.features,S=Object(r.useMemo)((function(){return window.brandVariation?{logoImgUrl:window.brandVariation.logo_url,brandVariationName:window.brandVariation.name,brandVariationId:window.brandVariation.id,brandId:window.brandVariation.brand_id,brandVariationHomeUrl:window.brandVariation.home_url,publishGuideHtml:window.brandVariation.publish_guide_html,partner:window.brandVariation.partner,brandedMenu:window.brandVariation.branded_menu,submitBtnHtml:window.brandVariation.submit_button_html}:void 0}),[]),_=w(Object(d.a)("state.loading"),1)[0],k=w(Object(d.a)("project.name"),2),E=k[0],A=k[1],T=w(Object(d.a)("permissionsLevel"),1)[0],R=w(Object(d.a)("editor.showSymbolPalette"),1)[0],I=w(Object(d.a)("editor.toggleSymbolPalette"),1)[0];Object(r.useEffect)((function(){if(null!=a&&a.socket)return a.socket.on("projectNameUpdated",A),function(){return a.socket.removeListener("projectNameUpdated",A)}}),[null==a?void 0:a.socket,A]);var P=Object(r.useCallback)((function(e){A((function(t){return t!==e&&n.saveProjectSettings({name:e}).catch((function(e){A(t);var n=e.data;return 400===e.status?a.showGenericMessageModal("Error renaming project",n):a.showGenericMessageModal("Error renaming project","Please try again in a moment")})),e}))}),[n,a,A]),D=Object(h.a)().setTitle;Object(r.useEffect)((function(){D("".concat(E?E+" - ":"","Online LaTeX Editor ").concat(window.ExposedSettings.appName))}),[E,D]);var M=Object(r.useCallback)((function(e){window.dispatchEvent(new CustomEvent("editor:insert-symbol",{detail:e}))}),[]),L=Object(r.useMemo)((function(){return{cobranding:S,hasPremiumCompile:"priority"===(null==C?void 0:C.compileGroup),loading:_,renameProject:P,permissionsLevel:T,isProjectOwner:(null==O?void 0:O._id)===window.user.id,isRestrictedTokenMember:window.isRestrictedTokenMember,showSymbolPalette:R,toggleSymbolPalette:I,insertSymbol:M}}),[S,null==C?void 0:C.compileGroup,_,P,T,null==O?void 0:O._id,R,I,M]);return Object(y.jsx)(j.Provider,{value:L,children:t})}function C(e){var t=Object(r.useContext)(j);if(!t)throw new Error("useEditorContext is only available inside EditorProvider");return l.a.checkPropTypes(e,t,"data","EditorContext.Provider"),t}j.Provider.propTypes={value:l.a.shape({cobranding:l.a.shape({logoImgUrl:l.a.string.isRequired,brandVariationName:l.a.string.isRequired,brandVariationId:l.a.number.isRequired,brandId:l.a.number.isRequired,brandVariationHomeUrl:l.a.string.isRequired,publishGuideHtml:l.a.string,partner:l.a.string,brandedMenu:l.a.bool,submitBtnHtml:l.a.string}),hasPremiumCompile:l.a.bool,loading:l.a.bool,renameProject:l.a.func.isRequired,showSymbolPalette:l.a.bool,toggleSymbolPalette:l.a.func,insertSymbol:l.a.func,isProjectOwner:l.a.bool,isRestrictedTokenMember:l.a.bool,permissionsLevel:l.a.oneOf(["readOnly","readAndWrite","owner"])})},O.propTypes={children:l.a.any,settings:l.a.any.isRequired}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Le})),n.d(t,"b",(function(){return Fe}));n(4),n(24),n(83),n(11),n(12),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(62),h=n(114),p=n(5),f=n.n(p);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){var n=Object(h.b)({$scope:l.a.object.isRequired}).$scope,a=y(Object(r.useState)(t),2),d=a[0],p=a[1];return[d,Object(r.useCallback)((function(t){p((function(r){var a=f.a.isFunction(t)?t(r):t;return n.$applyAsync((function(){return f.a.set(n,e,a)})),a}))}),[e,n])]}var j=n(156),O=n(102),C=(n(37),n(93),n(72),n(26),n(46),/^[^%]*\\documentclass/),S=n(21),_=n(20),k=(n(49),n(18),n(314),n(45),n(223)),E=n(22);function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R={version:2,id:Object(k.v4)(),epoch:Date.now(),totalBandwidth:0};function I(e,t){var n,r=e.serviceWorkerMetrics,a=e.stats,l=e.timings,d=performance.now(),h=0;return new Promise((function(e){n=e})).then((function(e){!function(e){var t=e.latencyFetch,n=e.latencyRender,r=e.compileTimeClientE2E,a={version:2,latencyFetch:t,latencyRender:n,compileTimeClientE2E:r};sl_console.log("/event/compile-metrics",JSON.stringify(e)),Object(E.b)("compile-metrics-v5",a,.01)}({latencyFetch:e.latencyFetch,latencyRender:e.latencyRender,compileTimeClientE2E:t,stats:a,timings:l})})),function(e){var t={};Object.entries(e).forEach((function(e){var n=A(e,2),r=n[0],a=n[1];a&&Object.entries(a).forEach((function(e){var n=A(e,2),a=n[0],l=n[1];t[r+"_"+a]=l}))}));var n={};if(Object.entries(t).forEach((function(e){var t=A(e,2),r=t[0],a=t[1];["serviceWorkerMetrics_id","serviceWorkerMetrics_cachedBytes","serviceWorkerMetrics_fetchedBytes","serviceWorkerMetrics_requestedBytes","serviceWorkerMetrics_version","serviceWorkerMetrics_epoch"].includes(r)&&(n[r]=a)})),0===Object.entries(n).length)return;sl_console.log("/event/pdf-bandwidth",JSON.stringify(e)),Object(E.b)("pdf-bandwidth-v5",n,.01)}({pdfJsMetrics:R,serviceWorkerMetrics:r}),{firstRenderDone:function(e){var t,r=e.timePDFFetched,a=e.timePDFRendered;a&&(t=a-r),n({latencyFetch:r-d,latencyRender:t})},updateConsumedBandwidth:function(e){R.totalBandwidth+=e-h,h=e}}}function P(e,t,n,r,a,l,d){try{var h=e[l](d),p=h.value}catch(e){return void n(e)}h.done?t(p):Promise.resolve(p).then(r,a)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=new URLSearchParams(window.location.search),L=function(){function e(t){var n=this,r=t.compilingRef,a=t.projectId,l=t.rootDocId,d=t.setChangedAt,h=t.setCompiling,f=t.setData,y=t.setFirstRenderDone,w=t.setError,x=t.cleanupCompileResult,j=t.signal;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.compilingRef=r,this.projectId=a,this.rootDocId=l,this.setChangedAt=d,this.setCompiling=h,this.setData=f,this.setFirstRenderDone=y,this.setError=w,this.cleanupCompileResult=x,this.signal=j,this.clsiServerId=null,this.currentDoc=null,this.error=void 0,this.timer=0,this.debouncedAutoCompile=Object(p.debounce)((function(){n.compile({isAutoCompileOnChange:!0})}),2500,{maxWait:5e3})}var t,n,r,a,l;return t=e,(n=[{key:"compile",value:(a=regeneratorRuntime.mark((function e(){var t,n,r,a,l,d,h,p,f,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=y.length>0&&void 0!==y[0]?y[0]:{})||(t={}),n=this.compilingRef.current,this.setCompiling(!0),!n){e.next=7;break}return t.isAutoCompileOnChange&&this.debouncedAutoCompile(),e.abrupt("return");case 7:return e.prev=7,this.setChangedAt(0),this.validationIssues=void 0,window.dispatchEvent(new CustomEvent("flush-changes")),r=this.buildCompileParams(t),a=performance.now(),e.next=15,Object(_.d)("/project/".concat(this.projectId,"/compile?").concat(r),{body:{rootDoc_id:this.getRootDocOverrideId(),draft:this.draft,check:"silent",incrementalCompilesEnabled:!this.error},signal:this.signal});case 15:l=e.sent,d=performance.now()-a,h=I(l,d),p=h.firstRenderDone,this.setFirstRenderDone((function(){return p})),this.setError(void 0),l.options=t,l.clsiServerId&&(this.clsiServerId=l.clsiServerId),this.setData(l),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(7),console.error(e.t0),this.cleanupCompileResult(),this.setError(429===(null===(f=e.t0.info)||void 0===f?void 0:f.statusCode)?"rate-limited":"error");case 30:return e.prev=30,this.setCompiling(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[7,25,30,33]])})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var l=a.apply(e,t);function d(e){P(l,n,r,d,h,"next",e)}function h(e){P(l,n,r,d,h,"throw",e)}d(void 0)}))},function(){return l.apply(this,arguments)})},{key:"getRootDocOverrideId",value:function(){if(this.currentDoc.doc_id!==this.rootDocId){var e=this.currentDoc.getSnapshot();if(e&&e.split("\n").some((function(e){return C.test(e)})))return this.currentDoc.doc_id}return null}},{key:"buildPostCompileParams",value:function(){var e=new URLSearchParams;return this.clsiServerId&&e.set("clsiserverid",this.clsiServerId),e}},{key:"buildCompileParams",value:function(e){var t=new URLSearchParams;return(e.isAutoCompileOnLoad||e.isAutoCompileOnChange)&&t.set("auto_compile","true"),Object(S.a)("ol-enablePdfCaching")&&t.set("enable_pdf_caching","true"),"true"===M.get("file_line_errors")&&(t.file_line_errors="true"),t}},{key:"stopCompile",value:function(){var e=this,t=this.buildPostCompileParams();return Object(_.d)("/project/".concat(this.projectId,"/compile/stop?").concat(t),{signal:this.signal}).catch((function(t){console.error(t),e.setError("error")})).finally((function(){e.setCompiling(!1)}))}},{key:"clearCache",value:function(){var e=this,t=this.buildPostCompileParams();return Object(_.b)("/project/".concat(this.projectId,"/output?").concat(t),{signal:this.signal}).catch((function(t){console.error(t),e.setError("clear-cache")}))}}])&&D(t.prototype,n),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();n(117),n(53),n(30),n(55),n(60),n(65),n(98),n(99);function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var B=/^LaTeX Warning: (.*)$/,U=/^(Over|Under)full \\(v|h)box/,H=/^(Package \b.+\b Warning:.*)$/,z=/lines? ([0-9]+)/,V=/^Package (\b.+\b) Warning/,W=/^([./].*):(\d+): (.*)/,K=0,G=1,Y=function(){function e(t,n){F(this,e),this.state=K,n=n||{},this.fileBaseNames=n.fileBaseNames||[/compiles/,/\/usr\/local/],this.ignoreDuplicates=n.ignoreDuplicates,this.data=[],this.fileStack=[],this.currentFileList=this.rootFileList=[],this.openParens=0,this.log=new X(t)}return N(e,[{key:"parse",value:function(){for(;!1!==(this.currentLine=this.log.nextLine());)if(this.state===K&&(this.currentLineIsError()?(this.state=G,this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine.slice(2),content:"",raw:this.currentLine+"\n"}):this.currentLineIsFileLineError()?(this.state=G,this.parseFileLineError()):this.currentLineIsRunawayArgument()?this.parseRunawayArgumentError():this.currentLineIsWarning()?this.parseSingleWarningLine(B):this.currentLineIsHboxWarning()?this.parseHboxLine():this.currentLineIsPackageWarning()?this.parseMultipleWarningLine():this.parseParensForFilenames()),this.state===G){this.currentError.content+=this.log.linesUpToNextMatchingLine(/^l\.[0-9]+/).join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.raw+=this.currentError.content;var e=this.currentError.raw.match(/l\.([0-9]+)/);e&&null===this.currentError.line&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError),this.state=K}return this.postProcess(this.data)}},{key:"currentLineIsError",value:function currentLineIsError(){return"!"===this.currentLine[0]}},{key:"currentLineIsFileLineError",value:function currentLineIsFileLineError(){return W.test(this.currentLine)}},{key:"currentLineIsRunawayArgument",value:function(){return this.currentLine.match(/^Runaway argument/)}},{key:"currentLineIsWarning",value:function(){return!!this.currentLine.match(B)}},{key:"currentLineIsPackageWarning",value:function(){return!!this.currentLine.match(H)}},{key:"currentLineIsHboxWarning",value:function(){return!!this.currentLine.match(U)}},{key:"parseFileLineError",value:function parseFileLineError(){var e=this.currentLine.match(W);this.currentError={line:e[2],file:e[1],level:"error",message:e[3],content:"",raw:this.currentLine+"\n"}}},{key:"parseRunawayArgumentError",value:function parseRunawayArgumentError(){this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine,content:"",raw:this.currentLine+"\n"},this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.raw+=this.currentError.content;var e=this.currentError.raw.match(/l\.([0-9]+)/);return e&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError)}},{key:"parseSingleWarningLine",value:function(e){var t=this.currentLine.match(e);if(t){var n=t[1],r=n.match(z),a=r?parseInt(r[1],10):null;this.data.push({line:a,file:this.currentFilePath,level:"warning",message:n,raw:n})}}},{key:"parseMultipleWarningLine",value:function(){var e=this.currentLine.match(H);if(e){for(var t=[e[1]],n=this.currentLine.match(z),r=n?parseInt(n[1],10):null,a=this.currentLine.match(V)[1],l=new RegExp("(?:\\("+a+"\\))*[\\s]*(.*)","i");this.currentLine=this.log.nextLine();)r=(n=this.currentLine.match(z))?parseInt(n[1],10):r,e=this.currentLine.match(l),t.push(e[1]);var d=t.join(" ");this.data.push({line:r,file:this.currentFilePath,level:"warning",message:d,raw:d})}}},{key:"parseHboxLine",value:function(){var e=this.currentLine.match(z),t=e?parseInt(e[1],10):null;this.data.push({line:t,file:this.currentFilePath,level:"typesetting",message:this.currentLine,raw:this.currentLine})}},{key:"parseParensForFilenames",value:function(){var e=this.currentLine.search(/\(|\)/);if(-1!==e){var t=this.currentLine[e];if(this.currentLine=this.currentLine.slice(e+1),"("===t){var n=this.consumeFilePath();if(n){this.currentFilePath=n;var r={path:n,files:[]};this.fileStack.push(r),this.currentFileList.push(r),this.currentFileList=r.files}else this.openParens++}else if(")"===t)if(this.openParens>0)this.openParens--;else if(this.fileStack.length>1){this.fileStack.pop();var a=this.fileStack[this.fileStack.length-1];this.currentFilePath=a.path,this.currentFileList=a.files}this.parseParensForFilenames()}}},{key:"consumeFilePath",value:function(){if(!this.currentLine.match(/^\/?([^ )]+\/)+/))return!1;for(var e,t=this.currentLine.search(/ |\)/);-1!==t&&" "===this.currentLine[t];){var n=this.currentLine.slice(0,t);if(/\.\w+$/.test(n))break;var r=this.currentLine.slice(t+1);if(/^\s*["()[\]]/.test(r))break;var a=r.search(/[ "()[\]]/);-1===a?t=-1:t+=a+1}return-1===t?(e=this.currentLine,this.currentLine=""):(e=this.currentLine.slice(0,t),this.currentLine=this.currentLine.slice(t)),e}},{key:"postProcess",value:function(e){for(var t=[],n=[],r=[],a=[],l=[],d=function(e){return e.raw},h=0;h<e.length;)this.ignoreDuplicates&&l.indexOf(d(e[h]))>-1||("error"===e[h].level?n.push(e[h]):"typesetting"===e[h].level?a.push(e[h]):"warning"===e[h].level&&r.push(e[h]),t.push(e[h]),l.push(d(e[h]))),h++;return{errors:n,warnings:r,typesetting:a,all:t,files:this.rootFileList}}}]),e}(),X=function(){function e(t){F(this,e),this.text=t.replace(/(\r\n)|\r/g,"\n");var n=this.text.split("\n");this.lines=[n[0]];for(var r=1;r<n.length;)79===n[r-1].length&&"..."!==n[r-1].slice(-3)?this.lines[this.lines.length-1]+=n[r]:this.lines.push(n[r]),r++;this.row=0}return N(e,[{key:"nextLine",value:function(){return this.row++,!(this.row>=this.lines.length)&&this.lines[this.row]}},{key:"rewindLine",value:function(){this.row--}},{key:"linesUpToNextWhitespaceLine",value:function(){return this.linesUpToNextMatchingLine(/^ *$/)}},{key:"linesUpToNextMatchingLine",value:function(e){var t=[],n=this.nextLine();for(!1!==n&&t.push(n);!1!==n&&!n.match(e)&&!1!==n;)!1!==(n=this.nextLine())&&t.push(n);return t}}]),e}(),J=n(0);function Q(e){var t=e.url,n=e.children;return window.wikiEnabled?Object(J.jsx)("a",{href:t,target:"_blank",rel:"noopener",children:n}):Object(J.jsx)(J.Fragment,{children:n})}Q.propTypes={url:l.a.string.isRequired,children:l.a.node.isRequired};var Z=[{regexToMatch:/Misplaced alignment tab character \&/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Misplaced_alignment_tab_character_%26",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have placed an alignment tab character '&' in the wrong place. If you want to align something, you must write it inside an align environment such as \\begin","{align}"," … \\end","{align}",", \\begin","{tabular}"," … \\end","{tabular}",", etc. If you want to write an ampersand '&' in text, you must write \\& instead."]}),humanReadableHint:"You have placed an alignment tab character &#x27;&amp;&#x27; in the wrong place. If you want to align something, you must write it inside an align environment such as \\begin{align} … \\end{align}, \\begin{tabular} … \\end{tabular}, etc. If you want to write an ampersand &#x27;&amp;&#x27; in text, you must write \\&amp; instead."},{regexToMatch:/Extra alignment tab has been changed to \\cr/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Extra_alignment_tab_has_been_changed_to_%5Ccr",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have written too many alignment tabs in a table, causing one of them to be turned into a line break. Make sure you have specified the correct number of columns in your"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Tables",children:"table"}),"."]}),humanReadableHint:'You have written too many alignment tabs in a table, causing one of them to be turned into a line break. Make sure you have specified the correct number of columns in your <a href="https://www.overleaf.com/learn/Tables" target="_blank">table</a>.'},{regexToMatch:/Display math should end with \$\$/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Display_math_should_end_with_$$",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have forgotten a $ sign at the end of 'display math' mode. When writing in display math mode, you must always math write inside $$ … $$. Check that the number of $s match around each math expression."}),humanReadableHint:"You have forgotten a $ sign at the end of &#x27;display math&#x27; mode. When writing in display math mode, you must always math write inside $$ … $$. Check that the number of $s match around each math expression."},{regexToMatch:/Missing [{$] inserted./,extraInfoURL:"https://www.overleaf.com/learn/Errors/Missing_$_inserted",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)("p",{children:"You need to enclose all mathematical expressions and symbols with special markers. These special markers create a ‘math mode’."}),Object(J.jsxs)("p",{children:["Use ",Object(J.jsx)("code",{children:"$...$"})," for inline math mode, and ",Object(J.jsx)("code",{children:"\\[...\\]"}),"or one of the mathematical environments (e.g. equation) for display math mode."]}),Object(J.jsxs)("p",{children:["This applies to symbols such as subscripts ( ",Object(J.jsx)("code",{children:"_"})," ), integrals ( ",Object(J.jsx)("code",{children:"\\int"})," ), Greek letters ( ",Object(J.jsx)("code",{children:"\\alpha"}),","," ",Object(J.jsx)("code",{children:"\\beta"}),", ",Object(J.jsx)("code",{children:"\\delta"})," ) and modifiers"," ",Object(J.jsx)("code",{children:"(\\vec{x}"}),", ",Object(J.jsxs)("code",{children:["\\tilde{x}",")"]}),"."]})]}),humanReadableHint:"You need to enclose all mathematical expressions and symbols with special markers. These special markers create a ‘math mode’. Use $...$ for inline math mode, and \\[...\\] or one of the mathematical environments (e.g. equation) for display math mode.  This applies to symbols such as subscripts ( _ ), integrals ( \\int ), Greek letters ( \\alpha, \\beta, \\delta ) and modifiers (\\vec{x}, \\tilde{x} )."},{regexToMatch:/Reference.+undefined/,extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_undefined_references",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref","{...}"," is the same as what is written inside \\label","{...}","."]}),humanReadableHint:"You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref{...} is the same as what is written inside \\label{...}."},{regexToMatch:/There were undefined references/,extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_undefined_references",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref","{...}"," is the same as what is written inside \\label","{...}","."]}),humanReadableHint:"You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref{...} is the same as what is written inside \\label{...}."},{regexToMatch:/Citation .+ on page .+ undefined on input line .+/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Citation_XXX_on_page_XXX_undefined_on_input_line_XXX",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have cited something which is not included in your bibliography. Make sure that the citation (\\cite","{...}",") has a corresponding key in your bibliography, and that both are spelled the same way."]}),humanReadableHint:"You have cited something which is not included in your bibliography. Make sure that the citation (\\cite{...}) has a corresponding key in your bibliography, and that both are spelled the same way."},{regexToMatch:/(Label .+)? multiply[ -]defined( labels)?/,extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_multiply-defined_labels",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used the same label more than once. Check that each \\label","{...}"," labels only one item."]}),humanReadableHint:"You have used the same label more than once. Check that each \\label{...} labels only one item."},{regexToMatch:/`!?h' float specifier changed to `!?ht'/,extraInfoURL:"https://www.overleaf.com/learn/Errors/%60!h%27_float_specifier_changed_to_%60!ht%27",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["The float specifier 'h' is too strict of a demand for LaTeX to place your float in a nice way here. Try relaxing it by using 'ht', or even 'htbp' if necessary. If you want to try keep the float here anyway, check out the"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"float package"}),"."]}),humanReadableHint:'The float specifier &#x27;h&#x27; is too strict of a demand for LaTeX to place your float in a nice way here. Try relaxing it by using &#x27;ht&#x27;, or even &#x27;htbp&#x27; if necessary. If you want to try keep the float here anyway, check out the <a href="https://www.overleaf.com/learn/Positioning_of_Figures" target="_blank">float package</a>.'},{regexToMatch:/No positions in optional float specifier/,extraInfoURL:"https://www.overleaf.com/learn/Errors/No_positions_in_optional_float_specifier",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have forgotten to include a float specifier, which tells LaTeX where to position your figure. To fix this, either insert a float specifier inside the square brackets (e.g. \\begin","{figure}","[h]), or remove the square brackets (e.g. \\begin","{figure}","). Find out more about float specifiers"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"here"}),"."]}),humanReadableHint:'You have forgotten to include a float specifier, which tells LaTeX where to position your figure. To fix this, either insert a float specifier inside the square brackets (e.g. \\begin{figure}[h]), or remove the square brackets (e.g. \\begin{figure}). Find out more about float specifiers <a href="https://www.overleaf.com/learn/Positioning_of_Figures" target="_blank">here</a>.'},{regexToMatch:/Undefined control sequence/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Undefined_control_sequence",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["The compiler is having trouble understanding a command you have used. Check that the command is spelled correctly. If the command is part of a package, make sure you have included the package in your preamble using \\usepackage","{...}","."]}),humanReadableHint:"The compiler is having trouble understanding a command you have used. Check that the command is spelled correctly. If the command is part of a package, make sure you have included the package in your preamble using \\usepackage{...}."},{regexToMatch:/File .+ not found/,extraInfoURL:"https://www.overleaf.com/learn/Errors/File_XXX_not_found_on_input_line_XXX",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["The compiler cannot find the file you want to include. Make sure that you have"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Including_images_in_ShareLaTeX",children:"uploaded the file"})," ","and"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Errors/File_XXX_not_found_on_input_line_XXX.",children:"specified the file location correctly"}),"."]}),humanReadableHint:'The compiler cannot find the file you want to include. Make sure that you have <a href="https://www.overleaf.com/learn/Including_images_in_ShareLaTeX" target="_blank">uploaded the file</a> and <a href="https://www.overleaf.com/learn/Errors/File_XXX_not_found_on_input_line_XXX." target="_blank">specified the file location correctly</a>.'},{regexToMatch:/LaTeX Error: Unknown graphics extension: \..+/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.XXX",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["The compiler does not recognise the file type of one of your images. Make sure you are using a"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.gif.",children:"supported image format"})," ","for your choice of compiler, and check that there are no periods (.) in the name of your image."]}),humanReadableHint:'The compiler does not recognise the file type of one of your images. Make sure you are using a <a href="https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.gif." target="_blank">supported image format</a> for your choice of compiler, and check that there are no periods (.) in the name of your image.'},{regexToMatch:/LaTeX Error: Unknown float option `H'/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60H%27",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["The compiler isn't recognizing the float option 'H'. Include \\usepackage","{float}"," in your preamble to fix this."]}),humanReadableHint:"The compiler isn&#x27;t recognizing the float option &#x27;H&#x27;. Include \\usepackage{float} in your preamble to fix this."},{regexToMatch:/LaTeX Error: Unknown float option `q'/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60q%27",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used a float specifier which the compiler does not understand. You can learn more about the different float options available for placing figures"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"here"})," ","."]}),humanReadableHint:'You have used a float specifier which the compiler does not understand. You can learn more about the different float options available for placing figures <a href="https://www.overleaf.com/learn/Positioning_of_Figures" target="_blank">here</a> .'},{regexToMatch:/LaTeX Error: \\math.+ allowed only in math mode/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_%5Cmathrm_allowed_only_in_math_mode",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used a font command which is only available in math mode. To use this command, you must be in maths mode (E.g. $ … $ or \\begin","{math}"," … \\end","{math}","). If you want to use it outside of math mode, use the text version instead: \\textrm, \\textit, etc."]}),humanReadableHint:"You have used a font command which is only available in math mode. To use this command, you must be in maths mode (E.g. $ … $ or \\begin{math} … \\end{math}). If you want to use it outside of math mode, use the text version instead: \\textrm, \\textit, etc."},{ruleId:"hint_mismatched_environment",types:["environment"],regexToMatch:/Error: `([^']{2,})' expected, found `([^']{2,})'.*/,newMessage:"Error: environment does not match \\begin{$1} ... \\end{$2}",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used \\begin","{...}"," without a corresponding \\end","{...}","."]}),humanReadableHint:"You have used \\begin{...} without a corresponding \\end{...}."},{ruleId:"hint_mismatched_brackets",types:["environment"],regexToMatch:/Error: `([^a-zA-Z0-9])' expected, found `([^a-zA-Z0-9])'.*/,newMessage:"Error: brackets do not match, found '$2' instead of '$1'",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have used an open bracket without a corresponding close bracket."}),humanReadableHint:"You have used an open bracket without a corresponding close bracket."},{regexToMatch:/LaTeX Error: Can be used only in preamble/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Can_be_used_only_in_preamble",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used a command in the main body of your document which should be used in the preamble. Make sure that \\documentclass[…]","{…}"," and all \\usepackage","{…}"," commands are written before \\begin","{document}","."]}),humanReadableHint:"You have used a command in the main body of your document which should be used in the preamble. Make sure that \\documentclass[…]{…} and all \\usepackage{…} commands are written before \\begin{document}."},{regexToMatch:/Missing \\right inserted/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Missing_%5Cright_insertede",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have started an expression with a \\left command, but have not included a corresponding \\right command. Make sure that your \\left and \\right commands balance everywhere, or else try using \\Biggl and \\Biggr commands instead as shown"," ",Object(J.jsx)(Q,{url:"https://www.overleaf.com/learn/Errors/Missing_%5Cright_inserted",children:"here"}),"."]}),humanReadableHint:'You have started an expression with a \\left command, but have not included a corresponding \\right command. Make sure that your \\left and \\right commands balance everywhere, or else try using \\Biggl and \\Biggr commands instead as shown <a href="https://www.overleaf.com/learn/Errors/Missing_%5Cright_inserted" target="_blank">here</a>.'},{regexToMatch:/Double superscript/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Double_superscript",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have written a double superscript incorrectly as a^b^c, or else you have written a prime with a superscript. Remember to include ","{and}"," ","when using multiple superscripts. Try a^","{b ^ c}"," instead."]}),humanReadableHint:"You have written a double superscript incorrectly as a^b^c, or else you have written a prime with a superscript. Remember to include {and} when using multiple superscripts. Try a^{b ^ c} instead."},{regexToMatch:/Double subscript/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Double_subscript",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have written a double subscript incorrectly as a_b_c. Remember to include ","{and}"," when using multiple subscripts. Try a_","{b_c}"," instead."]}),humanReadableHint:"You have written a double subscript incorrectly as a_b_c. Remember to include {and} when using multiple subscripts. Try a_{b_c} instead."},{regexToMatch:/No \\author given/,extraInfoURL:"https://www.overleaf.com/learn/Errors/No_%5Cauthor_given",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used the \\maketitle command, but have not specified any \\author. To fix this, include an author in your preamble using the \\author","{…}"," command."]}),humanReadableHint:"You have used the \\maketitle command, but have not specified any \\author. To fix this, include an author in your preamble using the \\author{…} command."},{regexToMatch:/LaTeX Error: Environment .+ undefined/,extraInfoURL:"https://www.overleaf.com/learn/Errors%2FLaTeX%20Error%3A%20Environment%20XXX%20undefined",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have created an environment (using \\begin","{…}"," and \\end","{…}"," commands) which is not recognized. Make sure you have included the required package for that environment in your preamble, and that the environment is spelled correctly."]}),humanReadableHint:"You have created an environment (using \\begin{…} and \\end{…} commands) which is not recognized. Make sure you have included the required package for that environment in your preamble, and that the environment is spelled correctly."},{regexToMatch:/LaTeX Error: Something's wrong--perhaps a missing \\item/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Something%27s_wrong--perhaps_a_missing_%5Citem",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"There are no entries found in a list you have created. Make sure you label list entries using the \\item command, and that you have not used a list inside a table."}),humanReadableHint:"There are no entries found in a list you have created. Make sure you label list entries using the \\item command, and that you have not used a list inside a table."},{regexToMatch:/Misplaced \\noalign/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Misplaced_%5Cnoalign",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have used a \\hline command in the wrong place, probably outside a table. If the \\hline command is written inside a table, try including \\\\ before it."}),humanReadableHint:"You have used a \\hline command in the wrong place, probably outside a table. If the \\hline command is written inside a table, try including \\\\ before it."},{regexToMatch:/LaTeX Error: There's no line here to end/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_There%27s_no_line_here_to_end",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have used a \\\\ or \\newline command where LaTeX was not expecting one. Make sure that you only use line breaks after blocks of text, and be careful using linebreaks inside lists and other environments.\\"}),humanReadableHint:"You have used a \\\\ or \\newline command where LaTeX was not expecting one. Make sure that you only use line breaks after blocks of text, and be careful using linebreaks inside lists and other environments.\\"},{regexToMatch:/LaTeX Error: \\verb ended by end of line/,extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_%5Cverb_ended_by_end_of_line",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used a \\verb command incorrectly. Try replacling the \\verb command with \\begin","{verbatim}","…\\end","{verbatim}",".\\"]}),humanReadableHint:"You have used a \\verb command incorrectly. Try replacling the \\verb command with \\begin{verbatim}…\\end{verbatim}.\\"},{regexToMatch:/Illegal unit of measure (pt inserted)/,extraInfoURL:"https://www.overleaf.com/learn/Errors%2FIllegal%20unit%20of%20measure%20(pt%20inserted)",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have written a length, but have not specified the appropriate units (pt, mm, cm etc.). If you have not written a length, check that you have not witten a linebreak \\\\ followed by square brackets […] anywhere."}),humanReadableHint:"You have written a length, but have not specified the appropriate units (pt, mm, cm etc.). If you have not written a length, check that you have not witten a linebreak \\\\ followed by square brackets […] anywhere."},{regexToMatch:/Extra \\right/,extraInfoURL:"https://www.overleaf.com/learn/Errors/Extra_%5Cright",humanReadableHintComponent:Object(J.jsx)(J.Fragment,{children:"You have written a \\right command without a corresponding \\left command. Check that all \\left and \\right commands balance everywhere."}),humanReadableHint:"You have written a \\right command without a corresponding \\left command. Check that all \\left and \\right commands balance everywhere."},{regexToMatch:/Missing \\begin{document}/,extraInfoURL:"https://www.overleaf.com/learn/Errors%2FLaTeX%20Error%3A%20Missing%20%5Cbegin%20document",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["No \\begin","{document}"," command was found. Make sure you have included \\begin","{document}"," in your preamble, and that your main document is set correctly."]}),humanReadableHint:"No \\begin{document} command was found. Make sure you have included \\begin{document} in your preamble, and that your main document is set correctly."},{ruleId:"hint_mismatched_environment2",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: `\\end\{([^\}]+)\}' expected but found `\\end\{([^\}]+)\}'.*/,newMessage:"Error: environments do not match: \\begin{$1} ... \\end{$2}",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]}),humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."},{ruleId:"hint_mismatched_environment3",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Warning: No matching \\end found for `\\begin\{([^\}]+)\}'.*/,newMessage:"Warning: No matching \\end found for \\begin{$1}",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]}),humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."},{ruleId:"hint_mismatched_environment4",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: Found `\\end\{([^\}]+)\}' without corresponding \\begin.*/,newMessage:"Error: found \\end{$1} without a corresponding \\begin{$1}",humanReadableHintComponent:Object(J.jsxs)(J.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]}),humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."}];window.wikiEnabled||Z.forEach((function(e){var t,n;e.extraInfoURL=null,e.humanReadableHint=(t=e.humanReadableHint,(n=document.createElement("DIV")).innerHTML=t,n.textContent||n.innerText||"")}));var ee=Z;function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oe=function(e,t){var n;"string"==typeof e?n=new Y(e,t).parse():n=e;var r,a=function(e){var t,n=ne(ee);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.regexToMatch.test(e))return r}}catch(e){n.e(e)}finally{n.f()}},l={},d=ne(n.all);try{for(d.s();!(r=d.n()).done;){var h=r.value,p=a(h.message);if(null!=p){if(null!=p.ruleId?h.ruleId=p.ruleId:null!=p.regexToMatch&&(h.ruleId="hint_".concat(p.regexToMatch.toString().replace(/\s/g,"_").slice(1,-1))),null!=p.newMessage&&(h.message=h.message.replace(p.regexToMatch,p.newMessage)),null!=p.cascadesFrom){var f,y=ne(p.cascadesFrom);try{for(y.s();!(f=y.n()).done;)l[f.value]&&(h.suppressed=!0)}catch(e){y.e(e)}finally{y.f()}}if(null!=p.types){var w,x=ne(p.types);try{for(x.s();!(w=x.n()).done;)l[w.value]=!0}catch(e){x.e(e)}finally{x.f()}}null!=p.humanReadableHint&&(h.humanReadableHint=p.humanReadableHint),null!=p.humanReadableHintComponent&&(h.humanReadableHintComponent=p.humanReadableHintComponent),null!=p.extraInfoURL&&(h.extraInfoURL=p.extraInfoURL)}}}catch(e){d.e(e)}finally{d.f()}for(var j in n){var O=n[j];"object"===te(O)&&O.length>0&&(n[j]=Array.from(O).filter((function(e){return!e.suppressed})))}return n};function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=/^\[(\d+)].*>\s(INFO|WARN|ERROR)\s-\s(.*)$/,ue=/^Warning--(.+)\n--line (\d+) of file (.+)$/m,de=/^Warning--(.+)$/m,he=/^(.*)---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this entry$/m,pe=/^(A bad cross reference---entry ".+?"\nrefers to entry.+?, which doesn't exist)$/m,fe=/^(.*)\n?---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this command$/m,ge=/^(.*?)\nwhile executing---line (\d+) of file (.*)/m,me={INFO:"info",WARN:"warning",ERROR:"error"},ve=function(e,t){return function(n,r){var a=se(n,2),l=a[0],d=a[1],h=se(r,2),p=se(function(n,r,a){for(var l,d=n,h=[],p=r,f=0;l=p.exec(d);){f+=1;var y=a(l);if(null!=e&&f>=e){if(t){var w=y.level+"s";y.message=["Over",e,w,"returned. Download raw logs to see full list"].join(" "),y.line=void 0,h.unshift(y)}return[h,""]}h.push(y),d=l.input.slice(0,l.index)+l.input.slice(l.index+l[0].length+1,l.input.length)}return[h,d]}(d,h[0],h[1]),2),f=p[0],y=p[1];return[l.concat(f),y]}},be=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("BibLogParser Error: text parameter must be a string");this.text=t.replace(/(\r\n)|\r/g,"\n"),this.options=n||{},this.lines=t.split("\n"),this.warningParsers=[[ue,function(e){var t=se(e,4),n=t[0],r=t[1],a=t[2];return{file:t[3],level:"warning",message:r,line:a,raw:n}}],[de,function(e){var t=se(e,2),n=t[0];return{file:"",level:"warning",message:t[1],line:"",raw:n}}]],this.errorParsers=[[he,function(e){var t=se(e,5),n=t[0],r=t[1],a=t[2];return{file:t[3],level:"error",message:r+"\n"+t[4],line:a,raw:n}}],[pe,function(e){var t=se(e,2),n=t[0];return{file:"",level:"error",message:t[1],line:"",raw:n}}],[fe,function(e){var t=se(e,5),n=t[0],r=t[1],a=t[2];return{file:t[3],level:"error",message:r+"\n"+t[4],line:a,raw:n}}],[ge,function(e){var t=se(e,4),n=t[0],r=t[1],a=t[2];return{file:t[3],level:"error",message:r,line:a,raw:n}}]]}var t,n,r;return t=e,(n=[{key:"parseBibtex",value:function(){var e,t={all:[],errors:[],warnings:[],files:[],typesetting:[]},n=se(this.warningParsers.reduce(ve(this.options.maxErrors,this.options.buildMaxErrorsReachedMessage),[[],this.text]),2),r=n[0],a=n[1],l=se(this.errorParsers.reduce(ve(this.options.maxErrors,this.options.buildMaxErrorsReachedMessage),[[],a]),2);return e=l[0],a=l[1],t.warnings=r,t.errors=e,t.all=r.concat(e),t}},{key:"parseBiber",value:function(){var e={all:[],errors:[],warnings:[],files:[],typesetting:[]};return this.lines.forEach((function(t){var n=t.match(ce);if(n){var r=n[0],a=n[2],l=n[3],d={file:"",level:me[a]||"INFO",message:l,line:"",raw:r},h=d.message.match(/^BibTeX subsystem: \/.+\/(\w+\.\w+)_.+, line (\d+), (.+)$/);if(h&&4===h.length){var p=h[1],f=h[2],y=h[3];d.file=p,d.line=f,d.message=y}switch(e.all.push(d),d.level){case"error":return e.errors.push(d);case"warning":return e.warnings.push(d)}}})),e}},{key:"parse",value:function(){var e=this.lines[0];if(e.match(/^.*INFO - This is Biber.*$/))return this.parseBiber();if(e.match(/^This is BibTeX, Version.+$/))return this.parseBibtex();throw new Error("BibLogParser Error: cannot determine whether text is biber or bibtex output")}}])&&ae(t.prototype,n),r&&ae(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();n(77),n(259);function ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xe=["bbl","gls","ind"],je=["output.fls","output.fdb_latexmk"],Oe=function(e,t){var n={top:[],other:[]};if(e){var r=new URLSearchParams;t&&r.set("clsiserverid",t);var a,l=[],d=ye(e.values());try{for(d.s();!(a=d.n()).done;){var h=a.value;je.includes(h.path)||(h.main=h.path.startsWith("output."),h.url+="?".concat(r),l.push(h))}}catch(e){d.e(e)}finally{d.f()}l.sort((function(e,t){return e.main&&!t.main?e:t.main&&!e.main?t:e.path.localeCompare(t.path)}));for(var p=0,f=l;p<f.length;p++){var y=f[p];xe.includes(y.type)?n.top.push(y):"pdf"===y.type&&!0===y.main||n.other.push(y)}}return n};function Ce(e){return function(e){if(Array.isArray(e))return ke(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_e(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_e(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function _e(e,t){if(e){if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(e,t):void 0}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ee(e,t,n,r,a,l,d){try{var h=e[l](d),p=h.value}catch(e){return void n(e)}h.done?t(p):Promise.resolve(p).then(r,a)}var Ae=new URLSearchParams(window.location.search),$e=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var r,a,l,d,h,p,f,y,w,x,j,O,C,_,E,A,T,R,I,P,D,M;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w=function(e,t){for(var n in r.logEntries)if(e[n]){var a,l,d=Se(e[n]);try{for(d.s();!(l=d.n()).done;){var h=l.value;t&&(h.type=e.type),h.file&&(h.file=Te(h.file)),h.key=Object(k.v4)()}}catch(e){d.e(e)}finally{d.f()}(a=r.logEntries[n]).push.apply(a,Ce(e[n]))}},r={},a=new Map,l=Se(n.outputFiles);try{for(l.s();!(d=l.n()).done;)h=d.value,a.set(h.path,h)}catch(e){l.e(e)}finally{l.f()}if((p=a.get("output.pdf"))&&(f=new URLSearchParams({compileGroup:n.compileGroup}),n.clsiServerId&&f.set("clsiserverid",n.clsiServerId),"true"===Ae.get("verify_chunks")&&f.set("verify_chunks","true"),Object(S.a)("ol-enablePdfCaching")&&f.set("enable_pdf_caching","true"),r.pdfUrl="".concat(n.pdfDownloadDomain).concat(p.url,"?").concat(f),f.set("popupDownload","true"),r.pdfDownloadUrl="/download/project/".concat(t,"/build/").concat(p.build,"/output/output.pdf?").concat(f)),y=new URLSearchParams({compileGroup:n.compileGroup}),n.clsiServerId&&y.set("clsiserverid",n.clsiServerId),r.logEntries={errors:[],warnings:[],typesetting:[]},!(x=a.get("output.log"))){e.next=21;break}return e.next=14,fetch("".concat(n.pdfDownloadDomain).concat(x.url,"?").concat(y));case 14:return j=e.sent,e.next=17,j.text();case 17:O=e.sent,r.log=O,C=oe(O,{ignoreDuplicates:!0}),_=C.errors,E=C.warnings,A=C.typesetting,w({errors:_,warnings:E,typesetting:A});case 21:if(!(T=a.get("output.blg"))){e.next=30;break}return e.next=25,fetch("".concat(n.pdfDownloadDomain).concat(T.url,"?").concat(y));case 25:return R=e.sent,e.next=28,R.text();case 28:I=e.sent;try{P=new be(I,{maxErrors:100}).parse(),D=P.errors,M=P.warnings,w({errors:D,warnings:M},"BibTeX:")}catch(e){}case 30:return r.fileList=Oe(a,n.clsiServerId),r.logEntries.all=[].concat(Ce(r.logEntries.errors),Ce(r.logEntries.warnings),Ce(r.logEntries.typesetting)),e.abrupt("return",r);case 33:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function d(e){Ee(l,r,a,d,h,"next",e)}function h(e){Ee(l,r,a,d,h,"throw",e)}d(void 0)}))});return function(e,n){return t.apply(this,arguments)}}();function Te(e,t){return e=(e=e.replace(/^.*\/compiles\/[0-9a-f]{24}(-[0-9a-f]{24})?\/(\.\/)?/,"")).replace(/^\/compile\//,""),t&&(e=e.replace(/^\.\//,t+"/")),e}var Re=n(38),Ie=n(70);function Pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return De(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return De(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Me=Object(r.createContext)();function Le(e){var t=e.children,n=Object(h.b)(),a=Object(Ie.b)(),l=a.hasPremiumCompile,p=a.isProjectOwner,f=Object(Re.c)(),y=f._id,w=f.rootDocId,C=Pe(Object(r.useState)(!1),2),S=C[0],_=C[1],k=Pe(x("pdf.logEntries"),2),A=k[0],T=k[1],R=Pe(Object(d.a)("pdf.logEntryAnnotations"),2),I=R[0],P=R[1],D=Pe(Object(d.a)("settings.pdfViewer"),1)[0],M=Pe(x("pdf.downloadUrl"),2),F=M[0],q=M[1],N=Pe(x("pdf.url"),2),B=N[0],U=N[1],H=Pe(Object(d.a)("pdf.uncompiled"),2),z=H[0],V=H[1],W=Pe(Object(r.useState)(),2),K=W[0],G=W[1],Y=Pe(Object(r.useState)(),2),X=Y[0],Q=Y[1],Z=Pe(Object(r.useState)(),2),ee=Z[0],te=Z[1],ne=Pe(Object(r.useState)(!1),2),re=ne[0],oe=ne[1],ae=Pe(Object(r.useState)(!1),2),se=ae[0],le=ae[1],ce=Pe(Object(r.useState)(!1),2),ue=ce[0],de=ce[1],he=Pe(Object(r.useState)(),2),pe=he[0],fe=he[1],ge=Pe(Object(r.useState)(),2),me=ge[0],ve=ge[1],be=Pe(Object(r.useState)(),2),ye=be[0],we=be[1],xe=Pe(Object(r.useState)(),2),je=xe[0],Oe=xe[1],Ce=Pe(Object(r.useState)(),2),_e=Ce[0],ke=Ce[1],Ee=Pe(Object(j.a)("pdf.position.".concat(y)),2),Ae=Ee[0],De=Ee[1],Le=Pe(Object(j.a)("autocompile_enabled:".concat(y),!1,!0),2),Fe=Le[0],qe=Le[1],Ne=Pe(Object(j.a)("draft:".concat(y),!1,!0),2),Be=Ne[0],Ue=Ne[1],He=Pe(Object(j.a)("stop_on_validation_error:".concat(y),!0,!0),2),ze=He[0],Ve=He[1],We=Pe(Object(d.a)("editor.sharejs_doc"),1)[0],Ke=Pe(Object(d.a)("hasLintingError"),2),Ge=Ke[0],Ye=Ke[1],Xe=Pe(Object(d.a)("settings.syntaxValidation"),1)[0],Je=Pe(Object(r.useState)(0),2),Qe=Je[0],Ze=Je[1],et=Object(O.a)().signal,tt=Object(r.useCallback)((function(){U(null),q(null),T(null),P({})}),[U,q,T,P]),nt=Object(r.useRef)(!1);Object(r.useEffect)((function(){nt.current=S}),[S]);var rt=Pe(Object(r.useState)((function(){return new L({projectId:y,rootDocId:w,setChangedAt:Ze,setCompiling:_,setData:Q,setFirstRenderDone:te,setError:fe,cleanupCompileResult:tt,compilingRef:nt,signal:et})})),1)[0];Object(r.useEffect)((function(){rt.currentDoc=We}),[rt,We]),Object(r.useEffect)((function(){rt.draft=Be}),[rt,Be]),Object(r.useEffect)((function(){V(Qe>0)}),[V,Qe]),Object(r.useEffect)((function(){!re&&We&&(oe(!0),rt.compile({isAutoCompileOnLoad:!0}))}),[re,We,rt]),Object(r.useEffect)((function(){if(X)switch(X.clsiServerId&&G(X.clsiServerId),X.outputFiles&&$e(y,X).then((function(e){P(function(e,t){var n,r=t.getRootDocDirname(),a={},l=Se(e);try{for(l.s();!(n=l.n()).done;){var d=n.value;if(d.file){d.file=Te(d.file,r);var h=t.findEntityByPath(d.file);h&&(h.id in a||(a[h.id]=[]),a[h.id].push({row:d.line-1,type:"error"===d.level?"error":"warning",text:d.message,source:"compile"}))}}}catch(e){l.e(e)}finally{l.f()}return a}(e.logEntries.all,n.fileTreeManager)),"success"===X.status&&(q(e.pdfDownloadUrl),U(e.pdfUrl)),T(e.logEntries),ve(e.fileList),we(e.log),window.user.alphaProgram||"success"!==X.status||Object(E.d)("compile-result",{errors:e.logEntries.errors.length,warnings:e.logEntries.warnings.length,typesetting:e.logEntries.typesetting.length,newPdfPreview:!0},.01)})),X.status){case"success":fe(void 0),de(!1);break;case"clsi-maintenance":case"compile-in-progress":case"exited":case"failure":case"project-too-large":case"rate-limited":case"terminated":case"too-recently-compiled":fe(X.status);break;case"timedout":fe("timedout"),!l&&p&&Object(E.a)("subscription-funnel","editor-click-feature","compile-timeout");break;case"autocompile-backoff":X.options.isAutoCompileOnLoad||(fe("autocompile-disabled"),qe(!1));break;case"unavailable":fe("clsi-unavailable");break;case"validation-problems":fe("validation-problems"),Oe(X.validationProblems);break;default:fe("error")}}),[X,n,l,p,y,qe,G,T,P,q,U]),Object(r.useEffect)((function(){pe&&de(!0)}),[pe]);var it=Boolean(Fe&&Xe&&Ge),ot=ze&&it,at=Boolean(Fe&&!ot),st=Boolean(at&&z&&re);Object(r.useEffect)((function(){at?Qe>0&&rt.debouncedAutoCompile():rt.debouncedAutoCompile.cancel()}),[rt,at,Qe]),Object(r.useEffect)((function(){return function(){rt.debouncedAutoCompile.cancel()}}),[rt]);var lt=Object(r.useCallback)((function(e){rt.compile(e)}),[rt]),ct=Object(r.useCallback)((function(){rt.stopCompile()}),[rt]),ut=Object(r.useCallback)((function(){return le(!0),rt.clearCache().then((function(){ve(void 0),q(void 0),U(void 0)})).finally((function(){le(!1)}))}),[rt,q,U]),dt=Object(r.useCallback)((function(){ut().then((function(){rt.compile()}))}),[ut,rt]),ht=Object(r.useMemo)((function(){return{autoCompile:Fe,clearCache:ut,clearingCache:se,clsiServerId:K,codeCheckFailed:ot,compiling:S,draft:Be,error:pe,fileList:me,hasChanges:st,highlights:_e,logEntryAnnotations:I,logEntries:A,pdfDownloadUrl:F,pdfUrl:B,pdfViewer:D,position:Ae,rawLog:ye,recompileFromScratch:dt,setAutoCompile:qe,setCompiling:_,setDraft:Ue,setError:fe,setHasLintingError:Ye,setHighlights:ke,setPosition:De,setShowLogs:de,setStopOnValidationError:Ve,showLogs:ue,startCompile:lt,stopCompile:ct,stopOnValidationError:ze,uncompiled:z,validationIssues:je,firstRenderDone:ee,setChangedAt:Ze,cleanupCompileResult:tt}}),[Fe,ut,se,K,ot,S,Be,pe,me,st,_e,A,I,Ae,F,B,D,ye,dt,qe,Ue,fe,Ye,ke,De,Ve,ue,lt,ct,ze,z,je,ee,Ze,tt]);return Object(J.jsx)(Me.Provider,{value:ht,children:t})}function Fe(e){var t=Object(r.useContext)(Me);return l.a.checkPropTypes(e,t,"data","CompileContext.Provider"),t}Me.Provider.propTypes={value:l.a.shape({autoCompile:l.a.bool.isRequired,clearingCache:l.a.bool.isRequired,clsiServerId:l.a.string,codeCheckFailed:l.a.bool.isRequired,compiling:l.a.bool.isRequired,draft:l.a.bool.isRequired,error:l.a.string,fileList:l.a.object,hasChanges:l.a.bool.isRequired,highlights:l.a.arrayOf(l.a.object),logEntries:l.a.object,logEntryAnnotations:l.a.object,pdfDownloadUrl:l.a.string,pdfUrl:l.a.string,pdfViewer:l.a.string,position:l.a.object,rawLog:l.a.string,setAutoCompile:l.a.func.isRequired,setDraft:l.a.func.isRequired,setError:l.a.func.isRequired,setHasLintingError:l.a.func.isRequired,setHighlights:l.a.func.isRequired,setPosition:l.a.func.isRequired,setShowLogs:l.a.func.isRequired,setStopOnValidationError:l.a.func.isRequired,showLogs:l.a.bool.isRequired,stopOnValidationError:l.a.bool.isRequired,uncompiled:l.a.bool,validationIssues:l.a.object,firstRenderDone:l.a.func,cleanupCompileResult:l.a.func})},Le.propTypes={children:l.a.any}},,,,,,,,function(e,t,n){"use strict";var r=n(21);n.p=Object(r.a)("ol-baseAssetPath")},,,,,,,function(e,t,n){"use strict";n(43),n(11),n(30),n(4),n(57),n(18),n(58);var r=n(2),a=n(1),l=n.n(a),d=n(1018),h=n(0),p=["show"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function j(e){var t=e.show,n=x(e,p),a=Object(r.useCallback)((function(e){if(e){var n=e._modal&&e._modal.modalNode;n&&(t?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden","true"))}}),[t]);return Object(h.jsx)(d.a,y(y({show:t},n),{},{ref:a}))}j.propTypes={show:l.a.bool},t.a=j},,,function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"h",(function(){return h})),n.d(t,"createElement",(function(){return h})),n.d(t,"cloneElement",(function(){return y})),n.d(t,"Component",(function(){return W})),n.d(t,"render",(function(){return K})),n.d(t,"rerender",(function(){return O})),n.d(t,"options",(function(){return a}));var a={},l=[],d=[];function h(e,t){var n,h,p,f,y=d;for(f=arguments.length;f-- >2;)l.push(arguments[f]);for(t&&null!=t.children&&(l.length||l.push(t.children),delete t.children);l.length;)if((h=l.pop())&&void 0!==h.pop)for(f=h.length;f--;)l.push(h[f]);else"boolean"==typeof h&&(h=null),(p="function"!=typeof e)&&(null==h?h="":"number"==typeof h?h=String(h):"string"!=typeof h&&(p=!1)),p&&n?y[y.length-1]+=h:y===d?y=[h]:y.push(h),n=p;var w=new r;return w.nodeName=e,w.children=y,w.attributes=null==t?void 0:t,w.key=null==t?void 0:t.key,void 0!==a.vnode&&a.vnode(w),w}function p(e,t){for(var n in t)e[n]=t[n];return e}var f="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function y(e,t){return h(e.nodeName,p(p({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var w=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,x=[];function j(e){!e._dirty&&(e._dirty=!0)&&1==x.push(e)&&(a.debounceRendering||f)(O)}function O(){var e,t=x;for(x=[];e=t.pop();)e._dirty&&z(e)}function C(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&S(e,t.nodeName):n||e._componentConstructor===t.nodeName}function S(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function _(e){var t=p({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function k(e){var t=e.parentNode;t&&t.removeChild(e)}function E(e,t,n,r,a){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||a)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var l in n)l in r||(e.style[l]="");for(var l in r)e.style[l]="number"==typeof r[l]&&!1===w.test(l)?r[l]+"px":r[l]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var d=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,A,d):e.removeEventListener(t,A,d),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!a&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var h=a&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?h?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(h?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function A(e){return this._listeners[e.type](a.event&&a.event(e)||e)}var T=[],R=0,I=!1,P=!1;function D(){for(var e;e=T.pop();)a.afterMount&&a.afterMount(e),e.componentDidMount&&e.componentDidMount()}function M(e,t,n,r,a,l){R++||(I=null!=a&&void 0!==a.ownerSVGElement,P=null!=e&&!("__preactattr_"in e));var d=L(e,t,n,r,l);return a&&d.parentNode!==a&&a.appendChild(d),--R||(P=!1,l||D()),d}function L(e,t,n,r,a){var l=e,d=I;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||a)?e.nodeValue!=t&&(e.nodeValue=t):(l=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(l,e),F(e,!0))),l.__preactattr_=!0,l;var h,p,f=t.nodeName;if("function"==typeof f)return function(e,t,n,r){var a=e&&e._component,l=a,d=e,h=a&&e._componentConstructor===t.nodeName,p=h,f=_(t);for(;a&&!p&&(a=a._parentComponent);)p=a.constructor===t.nodeName;a&&p&&(!r||a._component)?(H(a,f,3,n,r),e=a.base):(l&&!h&&(V(l),e=d=null),a=B(t.nodeName,f,n),e&&!a.nextBase&&(a.nextBase=e,d=null),H(a,f,1,n,r),e=a.base,d&&e!==d&&(d._component=null,F(d,!1)));return e}(e,t,n,r);if(I="svg"===f||"foreignObject"!==f&&I,f=String(f),(!e||!S(e,f))&&(h=f,(p=I?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h)).normalizedNodeName=h,l=p,e)){for(;e.firstChild;)l.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(l,e),F(e,!0)}var y=l.firstChild,w=l.__preactattr_,x=t.children;if(null==w){w=l.__preactattr_={};for(var j=l.attributes,O=j.length;O--;)w[j[O].name]=j[O].value}return!P&&x&&1===x.length&&"string"==typeof x[0]&&null!=y&&void 0!==y.splitText&&null==y.nextSibling?y.nodeValue!=x[0]&&(y.nodeValue=x[0]):(x&&x.length||null!=y)&&function(e,t,n,r,a){var l,d,h,p,f,y=e.childNodes,w=[],x={},j=0,O=0,S=y.length,_=0,E=t?t.length:0;if(0!==S)for(var A=0;A<S;A++){var T=y[A],R=T.__preactattr_;null!=(I=E&&R?T._component?T._component.__key:R.key:null)?(j++,x[I]=T):(R||(void 0!==T.splitText?!a||T.nodeValue.trim():a))&&(w[_++]=T)}if(0!==E)for(A=0;A<E;A++){var I;if(p=t[A],f=null,null!=(I=p.key))j&&void 0!==x[I]&&(f=x[I],x[I]=void 0,j--);else if(!f&&O<_)for(l=O;l<_;l++)if(void 0!==w[l]&&C(d=w[l],p,a)){f=d,w[l]=void 0,l===_-1&&_--,l===O&&O++;break}f=L(f,p,n,r),h=y[A],f&&f!==e&&f!==h&&(null==h?e.appendChild(f):f===h.nextSibling?k(h):e.insertBefore(f,h))}if(j)for(var A in x)void 0!==x[A]&&F(x[A],!1);for(;O<=_;)void 0!==(f=w[_--])&&F(f,!1)}(l,x,n,r,P||null!=w.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||E(e,r,n[r],n[r]=void 0,I);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||E(e,r,n[r],n[r]=t[r],I)}(l,t.attributes,w),I=d,l}function F(e,t){var n=e._component;n?V(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||k(e),q(e))}function q(e){for(e=e.lastChild;e;){var t=e.previousSibling;F(e,!0),e=t}}var N={};function B(e,t,n){var r,a=N[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),W.call(r,t,n)):((r=new W(t,n)).constructor=e,r.render=U),a)for(var l=a.length;l--;)if(a[l].constructor===e){r.nextBase=a[l].nextBase,a.splice(l,1);break}return r}function U(e,t,n){return this.constructor(e,n)}function H(e,t,n,r,l){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||l?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===a.syncComponentUpdates&&e.base?j(e):z(e,1,l)),e.__ref&&e.__ref(e))}function z(e,t,n,r){if(!e._disable){var l,d,h,f=e.props,y=e.state,w=e.context,x=e.prevProps||f,j=e.prevState||y,O=e.prevContext||w,C=e.base,S=e.nextBase,k=C||S,E=e._component,A=!1;if(C&&(e.props=x,e.state=j,e.context=O,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(f,y,w)?A=!0:e.componentWillUpdate&&e.componentWillUpdate(f,y,w),e.props=f,e.state=y,e.context=w),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!A){l=e.render(f,y,w),e.getChildContext&&(w=p(p({},w),e.getChildContext()));var I,P,L=l&&l.nodeName;if("function"==typeof L){var q=_(l);(d=E)&&d.constructor===L&&q.key==d.__key?H(d,q,1,w,!1):(I=d,e._component=d=B(L,q,w),d.nextBase=d.nextBase||S,d._parentComponent=e,H(d,q,0,w,!1),z(d,1,n,!0)),P=d.base}else h=k,(I=E)&&(h=e._component=null),(k||1===t)&&(h&&(h._component=null),P=M(h,l,w,n||!C,k&&k.parentNode,!0));if(k&&P!==k&&d!==E){var N=k.parentNode;N&&P!==N&&(N.replaceChild(P,k),I||(k._component=null,F(k,!1)))}if(I&&V(I),e.base=P,P&&!r){for(var U=e,W=e;W=W._parentComponent;)(U=W).base=P;P._component=U,P._componentConstructor=U.constructor}}if(!C||n?T.unshift(e):A||(e.componentDidUpdate&&e.componentDidUpdate(x,j,O),a.afterUpdate&&a.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);R||r||D()}}function V(e){a.beforeUnmount&&a.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?V(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,k(t),function(e){var t=e.constructor.name;(N[t]||(N[t]=[])).push(e)}(e),q(t)),e.__ref&&e.__ref(null)}function W(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function K(e,t,n){return M(n,e,{},!1,t,!1)}p(W.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=p({},n)),p(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),j(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),z(this,2)},render:function(){}});var G={h:h,createElement:h,cloneElement:y,Component:W,render:K,rerender:O,options:a};t.default=G},,function(e,t,n){"use strict";n(52),n(4),n(13),n(8),n(7),n(65),n(16),n(55),n(11),n(12),n(14),n(6),n(9),n(10),n(17);var r=n(164),a=n.n(r);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a={getColorScheme:function(e,t){return this.isDarkTheme(t)?{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 100%, 28%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 100%, 20%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 100%, 60%);")}:{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 70%, 85%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 70%, 95%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 70%, 40%);")}},isDarkTheme:function(e){var t=e.find(".ace_editor").css("background-color"),n=l(Array.from(t.match(/rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)/)),4),r=(n[0],n[1]),a=n[2],d=n[3];return(r=parseInt(r,10))+(a=parseInt(a,10))+(d=parseInt(d,10))<384},ANONYMOUS_HUE:100,OWN_HUE:200,OWN_HUE_BLOCKED_SIZE:20,TOTAL_HUES:360,getHueForUserId:function(e){if(null==e||"anonymous-user"===e)return this.ANONYMOUS_HUE;if(window.user.id===e)return this.OWN_HUE;var t=this.getHueForId(e);return t>this.OWN_HUE-this.OWN_HUE_BLOCKED_SIZE&&t<this.OWN_HUE+this.OWN_HUE_BLOCKED_SIZE&&(t=(t-=this.OWN_HUE)+this.TOTAL_HUES-this.OWN_HUE_BLOCKED_SIZE),t},getHueForTagId:function(e){return this.getHueForId(e)},getHueForId:function(e){var t=a()(e);return parseInt(t.toString().slice(0,8),16)%(this.TOTAL_HUES-2*this.OWN_HUE_BLOCKED_SIZE)}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17),n(130);var r=n(2);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(){var e=a(Object(r.useState)((function(){return new AbortController})),1)[0];return Object(r.useEffect)((function(){return function(){e.abort()}}),[e]),e}},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,"a",(function(){return r}))},,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return p}));n(6),n(4),n(227),n(8),n(9),n(18),n(26);var r=n(74),a=n.n(r);function l(e,t){var n=p(e,t);if(n)return n;throw new a.a("Entity not found in tree",{entityId:t})}function d(e,t){var n=new Set;return t.forEach((function(t){n.add(l(e,t))})),n}function h(e){var t=new Set;return e.forEach((function(e){(function e(t){var n=new Set([t._id]);for(var r in t.folders){e(t.folders[r]).forEach((function(e){n.add(e)}))}return n})(e).forEach((function(e){t.add(e)}))})),t}function p(e,t,n){for(var r in n||(n=[e._id]),e.docs){var a=e.docs[r];if(a._id===t)return{entity:a,type:"doc",parent:e.docs,parentFolderId:e._id,path:n,index:r}}for(var l in e.fileRefs){var d=e.fileRefs[l];if(d._id===t)return{entity:d,type:"fileRef",parent:e.fileRefs,parentFolderId:e._id,path:n,index:l}}for(var h in e.folders){var f=e.folders[h];if(f._id===t)return{entity:f,type:"folder",parent:e.folders,parentFolderId:e._id,path:n,index:h};var y=p(f,t,n.concat(f._id));if(y)return y}return null}},function(e,t,n){"use strict";n.d(t,"b",(function(){return G})),n.d(t,"a",(function(){return Y}));n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(62),h=(n(43),n(30),n(57),n(18),n(58),n(228),n(26),n(29),n(109)),p=["type"];function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function w(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return E(e,t,(function(e,t,n){return[].concat(w(e.slice(0,n)),w(e.slice(n+1)))}))}function k(e,t,n){var r=n.type,a=y(n,p);if(!r)throw new Error("Entity has no type");var l="".concat(r,"s");return E(e,t,(function(e,t,n){return e[n]=C(C({},t),{},S({},l,[].concat(w(t[l]),[a]))),e}))}function E(e,t,n){if(e._id===t)return f(n([],e,0),1)[0];for(var r=0,a=["docs","fileRefs","folders"];r<a.length;r++)for(var l=a[r],d=0;d<e[l].length;d++){var h=e[l][d];if(h._id===t)return C(C({},e),{},S({},l,n(e[l],h,d)))}var p=e.folders.map((function(e){return E(e,t,n)}));return C(C({},e),{},{folders:p})}function A(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){if(!e)return 0;var t=function e(t){var n,r=t.docs,a=t.folders,l=t.fileRefs,d=[].concat(A(r),A(l)),h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=T(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}(a);try{for(h.s();!(n=h.n()).done;){var p=n.value;d.push.apply(d,A(e(p)))}}catch(e){h.e(e)}finally{h.f()}return d}(e).filter((function(e){return!e.deleted})).length,n=window.ExposedSettings.maxEntitiesPerProject;return{value:t,status:function(e,t,n){if(e>=t)return"error";if(e>=t-n)return"warning";return"success"}(t,n,Math.ceil(n/20)),limit:n}}var P=n(5),D=n.n(P);var M=n(0);function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=Object(r.createContext)(),N=l.a.shape({_id:l.a.string.isRequired,name:l.a.string.isRequired,docs:l.a.array.isRequired,fileRefs:l.a.array.isRequired,folders:l.a.array.isRequired});q.Provider.propTypes={value:l.a.shape({fileTreeData:N,hasFolders:l.a.bool})};var B="RENAME",U="RESET",H="DELETE",z="MOVE",V="CREATE";function W(e,t){var n,r,a,l,d=e.fileTreeData;switch(t.type){case U:var p=t.fileTreeData;return{fileTreeData:p,fileCount:I(p)};case B:var f=function(e,t,n){var r=n.newName;return E(e,t,(function(e,t,n){var a=Object.assign([],e),l=C(C({},t),{},{name:r});return a[n]=l,a}))}(d,t.id,{newName:t.newName});return{fileTreeData:f,fileCount:I(f)};case H:var y=_(d,t.id);return{fileTreeData:y,fileCount:I(y)};case z:var w=(n=d,r=t.entityId,a=t.toFolderId,(l=Object(h.d)(n,r)).parentFolderId===a?n:k(_(n,r),a,C(C({},l.entity),{},{type:l.type})));return{fileTreeData:w,fileCount:I(w)};case V:var x=k(d,t.parentFolderId,t.entity);return{fileTreeData:x,fileCount:I(x)};default:throw new Error("Unknown mutable file tree action type: ".concat(t.type))}}var K=function(e){var t=null==e?void 0:e[0];return{fileTreeData:t,fileCount:I(t)}};function G(e){var t=Object(r.useContext)(q);if(!t)throw new Error("useFileTreeData is only available inside FileTreeDataProvider");return l.a.checkPropTypes(e,t,"data","FileTreeDataContext.Provider"),t}function Y(e){var t,n,a,l=e.children,h=(L(Object(d.a)("project",!0),1)[0]||{}).rootFolder,p=L(Object(r.useReducer)(W,h,K),2),f=p[0],y=f.fileTreeData,w=f.fileCount,x=p[1];t=function(){x({type:U,fileTreeData:null==h?void 0:h[0]})},n=[h],a=Object(r.useRef)(),Object(r.useEffect)((function(){D.a.isEqual(n,a.current)||(a.current=n,t())}),n);var j=Object(r.useCallback)((function(e,t){t.type="folder",x({type:V,parentFolderId:e,entity:t})}),[]),O=Object(r.useCallback)((function(e,t){t.type="doc",x({type:V,parentFolderId:e,entity:t})}),[]),C=Object(r.useCallback)((function(e,t){t.type="fileRef",x({type:V,parentFolderId:e,entity:t})}),[]),S=Object(r.useCallback)((function(e,t){x({type:B,newName:t,id:e})}),[]),_=Object(r.useCallback)((function(e){x({type:H,id:e})}),[]),k=Object(r.useCallback)((function(e,t){x({type:z,entityId:e,toFolderId:t})}),[]),E=Object(r.useMemo)((function(){return{dispatchCreateDoc:O,dispatchCreateFile:C,dispatchCreateFolder:j,dispatchDelete:_,dispatchMove:k,dispatchRename:S,fileCount:w,fileTreeData:y,hasFolders:(null==y?void 0:y.folders.length)>0}}),[O,C,j,_,k,S,w,y]);return Object(M.jsx)(q.Provider,{value:E,children:l})}Y.propTypes={children:l.a.any}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));var r=n(2),a=n(1),l=n.n(a),d=n(0),h=Object(r.createContext)();function p(){var e=Object(r.useContext)(h);if(!e)throw new Error("useIdeContext is only available inside IdeProvider");return e}function f(e){var t=e.ide,n=e.children;return Object(d.jsx)(h.Provider,{value:t,children:n})}h.Provider.propTypes={value:l.a.shape({$scope:l.a.object.isRequired})},f.propTypes={children:l.a.any.isRequired,ide:l.a.shape({$scope:l.a.object.isRequired}).isRequired}},function(e,t,n){"use strict";n(10),n(43),n(11),n(30),n(4),n(57),n(18),n(58);var r=n(33),a=n(609),l=n(0);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){Object(r.a)(e,(function(e){return e.setExtra("componentStack",t),e.setTag("handler","react-error-boundary"),e}))}function y(){return Object(l.jsx)(l.Fragment,{})}t.a=function(e,t){function n(n){return Object(l.jsx)(a.ErrorBoundary,{FallbackComponent:t||y,onError:f,children:Object(l.jsx)(e,h({},n))})}return n.propTypes=e.propTypes,n.displayName="WithErrorBoundaryWrapper".concat(e.displayName||e.name||"Component"),n}},,,,,,,,,,,,function(e,t,n){"use strict";function r(){return!("undefined"==typeof MathJax||!MathJax||!MathJax.Hub)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n(49);var r=function(e,t,n){try{return e(t,n)}catch(e){return console.error("localStorage exception",e),null}},a=function(e){return JSON.parse(localStorage.getItem(e))},l=function(e,t){localStorage.setItem(e,JSON.stringify(t))},d=function(){localStorage.clear()},h=function(e){return localStorage.removeItem(e)},p={getItem:function(e){return r(a,e)},setItem:function(e,t){return r(l,e,t)},clear:function(){return r(d)},removeItem:function(e){return r(h,e)}};t.a=p},,function(e,t,n){"use strict";(function(e){const t=n(471),r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0;r&&(void 0===r.AbortController&&(r.AbortController=t.AbortController),void 0===r.AbortSignal&&(r.AbortSignal=t.AbortSignal))}).call(this,n(84))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n(6),n(4),n(8),n(9),n(93);var r=n(2),a=n(309),l=n(305),d=n(1),h=n.n(d),p=n(22),f=n(0);function y(e){var t=e.buttonStyle,n=void 0===t?"info":t,d=e.children,h=e.classes,y=void 0===h?{}:h,w=e.setStartedFreeTrial,x=e.source,j=Object(a.a)().t;Object(r.useEffect)((function(){p.b("paywall-prompt",{"paywall-type":x})}),[x]);var O=Object(r.useCallback)((function(e){e.preventDefault(),p.a("subscription-funnel","upgraded-free-trial",x),p.b("paywall-click",{"paywall-type":x}),w&&w(!0);var t=new URLSearchParams({planCode:"collaborator_free_trial_7_days",ssp:"true",itm_campaign:x});window.open("/user/subscription/new?".concat(t))}),[w,x]);return Object(f.jsx)(l.a,{bsStyle:n,onClick:O,className:y.button,children:d||j("start_free_trial")})}y.propTypes={buttonStyle:h.a.string,children:h.a.any,classes:h.a.shape({button:h.a.string.isRequired}),setStartedFreeTrial:h.a.func,source:h.a.string.isRequired}},function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return x}));n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2),a=n(1),l=n.n(a),d=n(62),h=n(0);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=Object(r.createContext)();function w(e){var t=e.children,n=p(Object(d.a)("user",!0),1)[0];return Object(h.jsx)(y.Provider,{value:n,children:t})}function x(e){var t=Object(r.useContext)(y);return l.a.checkPropTypes(e,t,"data","UserContext.Provider"),t}y.Provider.propTypes={value:l.a.shape({user:l.a.shape({id:l.a.string,email:l.a.string,allowedFreeTrial:l.a.boolean,first_name:l.a.string,last_name:l.a.string})})},w.propTypes={children:l.a.any}},,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d}));n(26);var r=n(22);function a(e,t,n){var a,l=window.open();"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-free-trial",e),r.b("paywall-click",{"paywall-type":e}),a="/user/subscription/new?planCode=".concat("collaborator_free_trial_7_days","&ssp=true"),a="".concat(a,"&itm_campaign=").concat(e),t&&(a="".concat(a,"&itm_content=").concat(t)),n&&(n.startedFreeTrial=!0),l.location=a}function l(e,t){var n=window.open();!function(){"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-plan",e);t&&(t.startedFreeTrial=!0),n.location="/user/subscription"}()}function d(e){r.b("paywall-prompt",{"paywall-type":e})}},,,,function(e,t,n){(function(e){!function(){var e=function(){return this}();e||"undefined"==typeof window||(e=window);var t=function(e,n,r){"string"==typeof e?(2==arguments.length&&(r=n),t.modules[e]||(t.payloads[e]=r,t.modules[e]=null)):t.original?t.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};t.modules={},t.payloads={};var n,r,a=function(e,t,n){if("string"==typeof t){var r=h(e,t);if(null!=r)return n&&n(),r}else if("[object Array]"===Object.prototype.toString.call(t)){for(var a=[],d=0,p=t.length;d<p;++d){var f=h(e,t[d]);if(null==f&&l.original)return;a.push(f)}return n&&n.apply(null,a)||!0}},l=function(e,t){var n=a("",e,t);return null==n&&l.original?l.original.apply(this,arguments):n},d=function(e,t){if(-1!==t.indexOf("!")){var n=t.split("!");return d(e,n[0])+"!"+d(e,n[1])}if("."==t.charAt(0))for(t=e.split("/").slice(0,-1).join("/")+"/"+t;-1!==t.indexOf(".")&&r!=t;){var r=t;t=t.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return t},h=function(e,n){n=d(e,n);var r=t.modules[n];if(!r){if("function"==typeof(r=t.payloads[n])){var l={},h={id:n,uri:"",exports:l,packaged:!0};l=r((function(e,t){return a(n,e,t)}),l,h)||h.exports,t.modules[n]=l,delete t.payloads[n]}r=t.modules[n]=l||r}return r};r=e,(n="ace")&&(e[n]||(e[n]={}),r=e[n]),r.define&&r.define.packaged||(t.original=r.define,r.define=t,r.define.packaged=!0),r.require&&r.require.packaged||(l.original=r.require,r.require=l,r.require.packaged=!0)}(),ace.define("ace/lib/fixoldbrowsers",[],(function(e,t,n){"use strict";"undefined"==typeof Element||Element.prototype.remove||Object.defineProperty(Element.prototype,"remove",{enumerable:!1,writable:!0,configurable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),ace.define("ace/lib/useragent",[],(function(e,t,n){"use strict";t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS};var r="object"==typeof navigator?navigator:{},a=(/mac|win|linux/i.exec(r.platform)||["other"])[0].toLowerCase(),l=r.userAgent||"",d=r.appName||"";t.isWin="win"==a,t.isMac="mac"==a,t.isLinux="linux"==a,t.isIE="Microsoft Internet Explorer"==d||d.indexOf("MSAppHost")>=0?parseFloat((l.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((l.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=l.match(/ Gecko\/\d+/),t.isOpera="object"==typeof opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(l.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(l.split(" Chrome/")[1])||void 0,t.isEdge=parseFloat(l.split(" Edge/")[1])||void 0,t.isAIR=l.indexOf("AdobeAIR")>=0,t.isAndroid=l.indexOf("Android")>=0,t.isChromeOS=l.indexOf(" CrOS ")>=0,t.isIOS=/iPad|iPhone|iPod/.test(l)&&!window.MSStream,t.isIOS&&(t.isMac=!0),t.isMobile=t.isIOS||t.isAndroid})),ace.define("ace/lib/dom",[],(function(e,t,n){"use strict";var r=e("./useragent");if(t.buildDom=function e(t,n,r){if("string"==typeof t&&t){var a=document.createTextNode(t);return n&&n.appendChild(a),a}if(!Array.isArray(t))return t&&t.appendChild&&n&&n.appendChild(t),t;if("string"!=typeof t[0]||!t[0]){for(var l=[],d=0;d<t.length;d++){var h=e(t[d],n,r);h&&l.push(h)}return l}var p=document.createElement(t[0]),f=t[1],y=1;f&&"object"==typeof f&&!Array.isArray(f)&&(y=2);for(d=y;d<t.length;d++)e(t[d],p,r);return 2==y&&Object.keys(f).forEach((function(e){var t=f[e];"class"===e?p.className=Array.isArray(t)?t.join(" "):t:"function"==typeof t||"value"==e||"$"==e[0]?p[e]=t:"ref"===e?r&&(r[t]=p):null!=t&&p.setAttribute(e,t)})),n&&n.appendChild(p),p},t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||"http://www.w3.org/1999/xhtml",e):document.createElement(e)},t.removeChildren=function(e){e.innerHTML=""},t.createTextNode=function(e,t){return(t?t.ownerDocument:document).createTextNode(e)},t.createFragment=function(e){return(e?e.ownerDocument:document).createDocumentFragment()},t.hasCssClass=function(e,t){return-1!==(e.className+"").split(/\s+/g).indexOf(t)},t.addCssClass=function(e,n){t.hasCssClass(e,n)||(e.className+=" "+n)},t.removeCssClass=function(e,t){for(var n=e.className.split(/\s+/g);;){var r=n.indexOf(t);if(-1==r)break;n.splice(r,1)}e.className=n.join(" ")},t.toggleCssClass=function(e,t){for(var n=e.className.split(/\s+/g),r=!0;;){var a=n.indexOf(t);if(-1==a)break;r=!1,n.splice(a,1)}return r&&n.push(t),e.className=n.join(" "),r},t.setCssClass=function(e,n,r){r?t.addCssClass(e,n):t.removeCssClass(e,n)},t.hasCssString=function(e,t){var n,r=0;if(n=(t=t||document).querySelectorAll("style"))for(;r<n.length;)if(n[r++].id===e)return!0},t.importCssString=function(e,n,r){var a=r;r&&r.getRootNode&&(a=r.getRootNode())&&a!=r||(a=document);var l=a.ownerDocument||a;if(n&&t.hasCssString(n,a))return null;n&&(e+="\n/*# sourceURL=ace/css/"+n+" */");var d=t.createElement("style");d.appendChild(l.createTextNode(e)),n&&(d.id=n),a==l&&(a=t.getDocumentHead(l)),a.insertBefore(d,a.firstChild)},t.importCssStylsheet=function(e,n){t.buildDom(["link",{rel:"stylesheet",href:e}],t.getDocumentHead(n))},t.scrollbarWidth=function(e){var n=t.createElement("ace_inner");n.style.width="100%",n.style.minWidth="0px",n.style.height="200px",n.style.display="block";var r=t.createElement("ace_outer"),a=r.style;a.position="absolute",a.left="-10000px",a.overflow="hidden",a.width="200px",a.minWidth="0px",a.height="150px",a.display="block",r.appendChild(n);var l=e.documentElement;l.appendChild(r);var d=n.offsetWidth;a.overflow="scroll";var h=n.offsetWidth;return d==h&&(h=r.clientWidth),l.removeChild(r),d-h},"undefined"==typeof document&&(t.importCssString=function(){}),t.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},t.setStyle=function(e,t,n){e[t]!==n&&(e[t]=n)},t.HAS_CSS_ANIMATION=!1,t.HAS_CSS_TRANSFORMS=!1,t.HI_DPI=!r.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,"undefined"!=typeof document){var a=document.createElement("div");t.HI_DPI&&void 0!==a.style.transform&&(t.HAS_CSS_TRANSFORMS=!0),r.isEdge||void 0===a.style.animationName||(t.HAS_CSS_ANIMATION=!0),a=null}t.HAS_CSS_TRANSFORMS?t.translate=function(e,t,n){e.style.transform="translate("+Math.round(t)+"px, "+Math.round(n)+"px)"}:t.translate=function(e,t,n){e.style.top=Math.round(n)+"px",e.style.left=Math.round(t)+"px"}})),ace.define("ace/lib/oop",[],(function(e,t,n){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var n in t)e[n]=t[n];return e},t.implement=function(e,n){t.mixin(e,n)}})),ace.define("ace/lib/keys",[],(function(e,t,n){"use strict";var r=e("./oop"),a=function(){var e,t,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta",91:"MetaLeft",92:"MetaRight",93:"ContextMenu"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8,control:1},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(t in n.FUNCTION_KEYS)e=n.FUNCTION_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);for(t in n.PRINTABLE_KEYS)e=n.PRINTABLE_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);return r.mixin(n,n.MODIFIER_KEYS),r.mixin(n,n.PRINTABLE_KEYS),r.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,n[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)n.KEY_MODS[t]=e.filter((function(e){return t&n.KEY_MODS[e]})).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();r.mixin(t,a),t.keyCodeToString=function(e){var t=a[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}})),ace.define("ace/lib/event",[],(function(e,t,n){"use strict";var r,a=e("./keys"),l=e("./useragent"),d=null,h=0;function p(){return null==r&&function(){r=!1;try{document.createComment("").addEventListener("test",(function(){}),{get passive(){r={passive:!1}}})}catch(e){}}(),r}function f(e,t,n){this.elem=e,this.type=t,this.callback=n}f.prototype.destroy=function(){w(this.elem,this.type,this.callback),this.elem=this.type=this.callback=void 0};var y=t.addListener=function(e,t,n,r){e.addEventListener(t,n,p()),r&&r.$toDestroy.push(new f(e,t,n))},w=t.removeListener=function(e,t,n){e.removeEventListener(t,n,p())};t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation()},t.preventDefault=function(e){e.preventDefault&&e.preventDefault()},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||l.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.button},t.capture=function(e,t,n){var r=e&&e.ownerDocument||document;function a(e){t&&t(e),n&&n(e),w(r,"mousemove",t),w(r,"mouseup",a),w(r,"dragstart",a)}return y(r,"mousemove",t),y(r,"mouseup",a),y(r,"dragstart",a),a},t.addMouseWheelListener=function(e,t,n){"onmousewheel"in e?y(e,"mousewheel",(function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),t(e)}),n):"onwheel"in e?y(e,"wheel",(function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}t(e)}),n):y(e,"DOMMouseScroll",(function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),t(e)}),n)},t.addMultiMouseDownListener=function(e,n,r,a,d){var h,p,f,w=0,x={2:"dblclick",3:"tripleclick",4:"quadclick"};function j(e){if(0!==t.getButton(e)?w=0:e.detail>1?++w>4&&(w=1):w=1,l.isIE){var d=Math.abs(e.clientX-h)>5||Math.abs(e.clientY-p)>5;f&&!d||(w=1),f&&clearTimeout(f),f=setTimeout((function(){f=null}),n[w-1]||600),1==w&&(h=e.clientX,p=e.clientY)}if(e._clicks=w,r[a]("mousedown",e),w>4)w=0;else if(w>1)return r[a](x[w],e)}Array.isArray(e)||(e=[e]),e.forEach((function(e){y(e,"mousedown",j,d)}))};var x=function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)};function j(e,t,n){var r=x(t);if(!l.isMac&&d){if(t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(r|=8),d.altGr){if(3==(3&r))return;d.altGr=0}if(18===n||17===n){var p="location"in t?t.location:t.keyLocation;if(17===n&&1===p)1==d[n]&&(h=t.timeStamp);else if(18===n&&3===r&&2===p){t.timeStamp-h<50&&(d.altGr=!0)}}}if((n in a.MODIFIER_KEYS&&(n=-1),!r&&13===n)&&(3===(p="location"in t?t.location:t.keyLocation)&&(e(t,r,-n),t.defaultPrevented)))return;if(l.isChromeOS&&8&r){if(e(t,r,n),t.defaultPrevented)return;r&=-9}return!!(r||n in a.FUNCTION_KEYS||n in a.PRINTABLE_KEYS)&&e(t,r,n)}function O(){d=Object.create(null)}if(t.getModifierString=function(e){return a.KEY_MODS[x(e)]},t.addCommandKeyListener=function(e,n,r){if(l.isOldGecko||l.isOpera&&!("KeyboardEvent"in window)){var a=null;y(e,"keydown",(function(e){a=e.keyCode}),r),y(e,"keypress",(function(e){return j(n,e,a)}),r)}else{var h=null;y(e,"keydown",(function(e){d[e.keyCode]=(d[e.keyCode]||0)+1;var t=j(n,e,e.keyCode);return h=e.defaultPrevented,t}),r),y(e,"keypress",(function(e){h&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),h=null)}),r),y(e,"keyup",(function(e){d[e.keyCode]=null}),r),d||(O(),y(window,"focus",O))}},"object"==typeof window&&window.postMessage&&!l.isOldIE){var C=1;t.nextTick=function(e,n){n=n||window;var r="zero-timeout-message-"+C++,a=function(l){l.data==r&&(t.stopPropagation(l),w(n,"message",a),e())};y(n,"message",a),n.postMessage(r,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout((function n(){t.$idleBlocked?setTimeout(n,100):e()}),n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout((function(){t.$idleBlocked=!1}),e||100)},t.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}})),ace.define("ace/range",[],(function(e,t,n){"use strict";var r=function(e,t,n,r){this.start={row:e,column:t},this.end={row:n,column:r}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,n=e.end,r=e.start;return 1==(t=this.compare(n.row,n.column))?1==(t=this.compare(r.row,r.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(r.row,r.column))?-1:1==t?42:0},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},this.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},this.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var n={row:t+1,column:0};else if(this.end.row<e)n={row:e,column:0};if(this.start.row>t)var a={row:t+1,column:0};else if(this.start.row<e)a={row:e,column:0};return r.fromPoints(a||this.start,n||this.end)},this.extend=function(e,t){var n=this.compare(e,t);if(0==n)return this;if(-1==n)var a={row:e,column:t};else var l={row:e,column:t};return r.fromPoints(a||this.start,l||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return r.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new r(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new r(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),n=e.documentToScreenPosition(this.end);return new r(t.row,t.column,n.row,n.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(r.prototype),r.fromPoints=function(e,t){return new r(e.row,e.column,t.row,t.column)},r.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},r.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=r})),ace.define("ace/lib/lang",[],(function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>=1)&&(e+=e);return n};var r=/^\s\s*/,a=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(r,"")},t.stringTrimRight=function(e){return e.replace(a,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){for(var t=[],n=0,r=e.length;n<r;n++)e[n]&&"object"==typeof e[n]?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=function e(t){if("object"!=typeof t||!t)return t;var n;if(Array.isArray(t)){n=[];for(var r=0;r<t.length;r++)n[r]=e(t[r]);return n}if("[object Object]"!==Object.prototype.toString.call(t))return t;for(var r in n={},t)n[r]=e(t[r]);return n},t.arrayToMap=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return(""+e).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,(function(e){n.push({offset:arguments[arguments.length-2],length:e.length})})),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},a=function(e){null==n&&(n=setTimeout(r,e||t))};return a.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},a.schedule=a,a.call=function(){this.cancel(),e()},a.cancel=function(){n&&clearTimeout(n),n=null},a.isPending=function(){return n},a}})),ace.define("ace/clipboard",[],(function(e,t,n){"use strict";var r;n.exports={lineMode:!1,pasteCancelled:function(){return!!(r&&r>Date.now()-50)||(r=!1)},cancel:function(){r=Date.now()}}})),ace.define("ace/keyboard/textinput",[],(function(e,t,n){"use strict";var r=e("../lib/event"),a=e("../lib/useragent"),l=e("../lib/dom"),d=e("../lib/lang"),h=e("../clipboard"),p=a.isChrome<18,f=a.isIE,y=a.isChrome>63,w=e("../lib/keys"),x=w.KEY_MODS,j=a.isIOS,O=j?/\s/:/\n/,C=a.isMobile;t.TextInput=function(e,t){var n=l.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck",!1),n.style.opacity="0",e.insertBefore(n,e.firstChild);var S=!1,_=!1,k=!1,E=!1,A="";C||(n.style.fontSize="1px");var T=!1,R=!1,I="",P=0,D=0,M=0;try{var L=document.activeElement===n}catch(e){}r.addListener(n,"blur",(function(e){R||(t.onBlur(e),L=!1)}),t),r.addListener(n,"focus",(function(e){if(!R){if(L=!0,a.isEdge)try{if(!document.hasFocus())return}catch(e){}t.onFocus(e),a.isEdge?setTimeout(F):F()}}),t),this.$focusScroll=!1,this.focus=function(){if(A||y||"browser"==this.$focusScroll)return n.focus({preventScroll:!0});var e=n.style.top;n.style.position="fixed",n.style.top="0px";try{var t=0!=n.getBoundingClientRect().top}catch(e){return}var r=[];if(t)for(var a=n.parentElement;a&&1==a.nodeType;)r.push(a),a.setAttribute("ace_nocontext",!0),a=!a.parentElement&&a.getRootNode?a.getRootNode().host:a.parentElement;n.focus({preventScroll:!0}),t&&r.forEach((function(e){e.removeAttribute("ace_nocontext")})),setTimeout((function(){n.style.position="","0px"==n.style.top&&(n.style.top=e)}),0)},this.blur=function(){n.blur()},this.isFocused=function(){return L},t.on("beforeEndOperation",(function(){var e=t.curOp,r=e&&e.command&&e.command.name;if("insertstring"!=r){var a=r&&(e.docChanged||e.selectionChanged);k&&a&&(I=n.value="",Y()),F()}}));var F=j?function(e){if(L&&(!S||e)&&!E){e||(e="");var r="\n ab"+e+"cde fg\n";r!=n.value&&(n.value=I=r);var a=4+(e.length||(t.selection.isEmpty()?0:1));4==P&&D==a||n.setSelectionRange(4,a),P=4,D=a}}:function(){if(!k&&!E&&(L||N)){k=!0;var e=0,r=0,a="";if(t.session){var l=t.selection,d=l.getRange(),h=l.cursor.row;if(e=d.start.column,r=d.end.column,a=t.session.getLine(h),d.start.row!=h){var p=t.session.getLine(h-1);e=d.start.row<h-1?0:e,r+=p.length+1,a=p+"\n"+a}else if(d.end.row!=h){var f=t.session.getLine(h+1);r=d.end.row>h+1?f.length:r,r+=a.length+1,a=a+"\n"+f}else C&&h>0&&(a="\n"+a,r+=1,e+=1);a.length>400&&(e<400&&r<400?a=a.slice(0,400):(a="\n",e==r?e=r=0:(e=0,r=1)))}var y=a+"\n\n";if(y!=I&&(n.value=I=y,P=D=y.length),N&&(P=n.selectionStart,D=n.selectionEnd),D!=r||P!=e||n.selectionEnd!=D)try{n.setSelectionRange(e,r),P=e,D=r}catch(e){}k=!1}};this.resetSelection=F,L&&t.onFocus();var q=null;this.setInputHandler=function(e){q=e},this.getInputHandler=function(){return q};var N=!1,B=function(e,r){if(N&&(N=!1),_)return F(),e&&t.onPaste(e),_=!1,"";for(var l=n.selectionStart,d=n.selectionEnd,h=P,p=I.length-D,f=e,y=e.length-l,w=e.length-d,x=0;h>0&&I[x]==e[x];)x++,h--;for(f=f.slice(x),x=1;p>0&&I.length-x>P-1&&I[I.length-x]==e[e.length-x];)x++,p--;y-=x-1,w-=x-1;var j=f.length-x+1;if(j<0&&(h=-j,j=0),f=f.slice(0,j),!(r||f||y||h||p||w))return"";E=!0;var O=!1;return a.isAndroid&&". "==f&&(f="  ",O=!0),f&&!h&&!p&&!y&&!w||T?t.onTextInput(f):t.onTextInput(f,{extendLeft:h,extendRight:p,restoreStart:y,restoreEnd:w}),E=!1,I=e,P=l,D=d,M=w,O?"\n":f},U=function(e){if(k)return G();if(e&&e.inputType){if("historyUndo"==e.inputType)return t.execCommand("undo");if("historyRedo"==e.inputType)return t.execCommand("redo")}var r=n.value,a=B(r,!0);(r.length>500||O.test(a)||C&&P<1&&P==D)&&F()},H=function(e,t,n){var r=e.clipboardData||window.clipboardData;if(r&&!p){var a=f||n?"Text":"text/plain";try{return t?!1!==r.setData(a,t):r.getData(a)}catch(e){if(!n)return H(e,t,!0)}}},z=function(e,a){var l=t.getCopyText();if(!l)return r.preventDefault(e);H(e,l)?(j&&(F(l),S=l,setTimeout((function(){S=!1}),10)),a?t.onCut():t.onCopy(),r.preventDefault(e)):(S=!0,n.value=l,n.select(),setTimeout((function(){S=!1,F(),a?t.onCut():t.onCopy()})))},V=function(e){z(e,!0)},W=function(e){z(e,!1)},K=function(e){var l=H(e);h.pasteCancelled()||("string"==typeof l?(l&&t.onPaste(l,e),a.isIE&&setTimeout(F),r.preventDefault(e)):(n.value="",_=!0))};r.addCommandKeyListener(n,t.onCommandKey.bind(t),t),r.addListener(n,"select",(function(e){k||(S?S=!1:!function(e){return 0===e.selectionStart&&e.selectionEnd>=I.length&&e.value===I&&I&&e.selectionEnd!==D}(n)?C&&n.selectionStart!=P&&F():(t.selectAll(),F()))}),t),r.addListener(n,"input",U,t),r.addListener(n,"cut",V,t),r.addListener(n,"copy",W,t),r.addListener(n,"paste",K,t),"oncut"in n&&"oncopy"in n&&"onpaste"in n||r.addListener(e,"keydown",(function(e){if((!a.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:W(e);break;case 86:K(e);break;case 88:V(e)}}),t);var G=function(){if(k&&t.onCompositionUpdate&&!t.$readOnly){if(T)return X();if(k.useTextareaForIME)t.onCompositionUpdate(n.value);else{var e=n.value;B(e),k.markerRange&&(k.context&&(k.markerRange.start.column=k.selectionStart=k.context.compositionStartOffset),k.markerRange.end.column=k.markerRange.start.column+D-k.selectionStart+M)}}},Y=function(e){t.onCompositionEnd&&!t.$readOnly&&(k=!1,t.onCompositionEnd(),t.off("mousedown",X),e&&U())};function X(){R=!0,n.blur(),n.focus(),R=!1}var J,Q=d.delayedCall(G,50).schedule.bind(null,null);function Z(){clearTimeout(J),J=setTimeout((function(){A&&(n.style.cssText=A,A=""),t.renderer.$isMousePressed=!1,t.renderer.$keepTextAreaAtCursor&&t.renderer.$moveTextAreaToCursor()}),0)}r.addListener(n,"compositionstart",(function(e){if(!k&&t.onCompositionStart&&!t.$readOnly&&(k={},!T)){e.data&&(k.useTextareaForIME=!1),setTimeout(G,0),t._signal("compositionStart"),t.on("mousedown",X);var r=t.getSelectionRange();r.end.row=r.start.row,r.end.column=r.start.column,k.markerRange=r,k.selectionStart=P,t.onCompositionStart(k),k.useTextareaForIME?(I=n.value="",P=0,D=0):(n.msGetInputContext&&(k.context=n.msGetInputContext()),n.getInputContext&&(k.context=n.getInputContext()))}}),t),r.addListener(n,"compositionupdate",G,t),r.addListener(n,"keyup",(function(e){27==e.keyCode&&n.value.length<n.selectionStart&&(k||(I=n.value),P=D=-1,F()),Q()}),t),r.addListener(n,"keydown",Q,t),r.addListener(n,"compositionend",Y,t),this.getElement=function(){return n},this.setCommandMode=function(e){T=e,n.readOnly=!1},this.setReadOnly=function(e){T||(n.readOnly=e)},this.setCopyWithEmptySelection=function(e){},this.onContextMenu=function(e){N=!0,F(),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,d){A||(A=n.style.cssText),n.style.cssText=(d?"z-index:100000;":"")+(a.isIE?"opacity:0.1;":"")+"text-indent: -"+(P+D)*t.renderer.characterWidth*.5+"px;";var h=t.container.getBoundingClientRect(),p=l.computedStyle(t.container),f=h.top+(parseInt(p.borderTopWidth)||0),y=h.left+(parseInt(h.borderLeftWidth)||0),w=h.bottom-f-n.clientHeight-2,x=function(e){l.translate(n,e.clientX-y-2,Math.min(e.clientY-f-2,w))};x(e),"mousedown"==e.type&&(t.renderer.$isMousePressed=!0,clearTimeout(J),a.isWin&&r.capture(t.container,x,Z))},this.onContextMenuClose=Z;var ee=function(e){t.textInput.onContextMenu(e),Z()};r.addListener(n,"mouseup",ee,t),r.addListener(n,"mousedown",(function(e){e.preventDefault(),Z()}),t),r.addListener(t.renderer.scroller,"contextmenu",ee,t),r.addListener(n,"contextmenu",ee,t),j&&function(e,t,n){var r=null,a=!1;n.addEventListener("keydown",(function(e){r&&clearTimeout(r),a=!0}),!0),n.addEventListener("keyup",(function(e){r=setTimeout((function(){a=!1}),100)}),!0);var l=function(e){if(document.activeElement===n&&!(a||k||t.$mouseHandler.isMousePressed||S)){var r=n.selectionStart,l=n.selectionEnd,d=null,h=0;if(0==r?d=w.up:1==r?d=w.home:l>D&&"\n"==I[l]?d=w.end:r<P&&" "==I[r-1]?(d=w.left,h=x.option):r<P||r==P&&D!=P&&r==l?d=w.left:l>D&&I.slice(0,l).split("\n").length>2?d=w.down:l>D&&" "==I[l-1]?(d=w.right,h=x.option):(l>D||l==D&&D!=P&&r==l)&&(d=w.right),r!==l&&(h|=x.shift),d){if(!t.onCommandKey({},h,d)&&t.commands){d=w.keyCodeToString(d);var p=t.commands.findKeyCommand(h,d);p&&t.execCommand(p)}P=r,D=l,F("")}}};document.addEventListener("selectionchange",l),t.on("destroy",(function(){document.removeEventListener("selectionchange",l)}))}(0,t,n)},t.$setUserAgentForTests=function(e,t){C=e,j=t}})),ace.define("ace/mouse/default_handlers",[],(function(e,t,n){"use strict";var r=e("../lib/useragent");function a(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(t){e[t]=this[t]}),this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function l(e,t){if(e.start.row==e.end.row)var n=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)n=2*t.row-e.start.row-e.end.row;else var n=t.column-4;return n<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}(function(){this.onMouseDown=function(e){var t=e.inSelection(),n=e.getDocumentPosition();this.mousedownEvent=e;var a=this.editor,l=e.getButton();return 0!==l?((a.getSelectionRange().isEmpty()||1==l)&&a.selection.moveToPosition(n),void(2==l&&(a.textInput.onContextMenu(e.domEvent),r.isMozilla||e.preventDefault()))):(this.mousedownEvent.time=Date.now(),!t||a.isFocused()||(a.focus(),!this.$focusTimeout||this.$clickSelection||a.inMultiSelectMode)?(this.captureMouse(e),this.startSelect(n,e.domEvent._clicks>1),e.preventDefault()):(this.setState("focusWait"),void this.captureMouse(e)))},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var n=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?n.selection.selectToPosition(e):t||n.selection.moveToPosition(e),t||this.select(),n.renderer.scroller.setCapture&&n.renderer.scroller.setCapture(),n.setStyle("ace_selecting"),this.setState("select"))},this.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(n);if(-1==r)e=this.$clickSelection.end;else if(1==r)e=this.$clickSelection.start;else{var a=l(this.$clickSelection,n);n=a.cursor,e=a.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,n=this.editor,r=n.renderer.screenToTextCoordinates(this.x,this.y),a=n.selection[e](r.row,r.column);if(this.$clickSelection){var d=this.$clickSelection.comparePoint(a.start),h=this.$clickSelection.comparePoint(a.end);if(-1==d&&h<=0)t=this.$clickSelection.end,a.end.row==r.row&&a.end.column==r.column||(r=a.start);else if(1==h&&d>=0)t=this.$clickSelection.start,a.start.row==r.row&&a.start.column==r.column||(r=a.end);else if(-1==d&&1==h)r=a.end,t=a.start;else{var p=l(this.$clickSelection,r);r=p.cursor,t=p.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(r),n.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e,t,n,r,a=(e=this.mousedownEvent.x,t=this.mousedownEvent.y,n=this.x,r=this.y,Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))),l=Date.now();(a>0||l-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),n=this.editor,r=n.session.getBracketRange(t);r?(r.isEmpty()&&(r.start.column--,r.end.column++),this.setState("select")):(r=n.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=r,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),n=this.editor;this.setState("selectByLines");var r=n.getSelectionRange();r.isMultiLine()&&r.contains(t.row,t.column)?(this.$clickSelection=n.selection.getLineRange(r.start.row),this.$clickSelection.end=n.selection.getLineRange(r.end.row).end):this.$clickSelection=n.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var n=this.$lastScroll,r=e.domEvent.timeStamp,a=r-n.t,l=a?e.wheelX/a:n.vx,d=a?e.wheelY/a:n.vy;a<550&&(l=(l+n.vx)/2,d=(d+n.vy)/2);var h=Math.abs(l/d),p=!1;if(h>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(p=!0),h<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(p=!0),p)n.allowed=r;else if(r-n.allowed<550){Math.abs(l)<=1.5*Math.abs(n.vx)&&Math.abs(d)<=1.5*Math.abs(n.vy)?(p=!0,n.allowed=r):n.allowed=0}return n.t=r,n.vx=l,n.vy=d,p?(t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(a.prototype),t.DefaultHandlers=a})),ace.define("ace/tooltip",[],(function(e,t,n){"use strict";e("./lib/oop");var r=e("./lib/dom");function a(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}(function(){this.$init=function(){return this.$element=r.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){this.getElement().textContent=e},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){r.addCssClass(this.getElement(),e)},this.show=function(e,t,n){null!=e&&this.setText(e),null!=t&&null!=n&&this.setPosition(t,n),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(a.prototype),t.Tooltip=a})),ace.define("ace/mouse/default_gutter_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=e("../lib/oop"),l=e("../lib/event"),d=e("../tooltip").Tooltip;function h(e){d.call(this,e)}a.inherits(h,d),function(){this.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,a=this.getWidth(),l=this.getHeight();(e+=15)+a>n&&(e-=e+a-n),(t+=15)+l>r&&(t-=20+l),d.prototype.setPosition.call(this,e,t)}}.call(h.prototype),t.GutterHandler=function(e){var t,n,a,d=e.editor,p=d.renderer.$gutterLayer,f=new h(d.container);function y(){t&&(t=clearTimeout(t)),a&&(f.hide(),a=null,d._signal("hideGutterTooltip",f),d.off("mousewheel",y))}function w(e){f.setPosition(e.x,e.y)}e.editor.setDefaultHandler("guttermousedown",(function(t){if(d.isFocused()&&0==t.getButton()&&"foldWidgets"!=p.getRegion(t)){var n=t.getDocumentPosition().row,r=d.session.selection;if(t.getShiftKey())r.selectTo(n,0);else{if(2==t.domEvent.detail)return d.selectAll(),t.preventDefault();e.$clickSelection=d.selection.getLineRange(n)}return e.setState("selectByLines"),e.captureMouse(t),t.preventDefault()}})),e.editor.setDefaultHandler("guttermousemove",(function(l){var h=l.domEvent.target||l.domEvent.srcElement;if(r.hasCssClass(h,"ace_fold-widget"))return y();a&&e.$tooltipFollowsMouse&&w(l),n=l,t||(t=setTimeout((function(){t=null,n&&!e.isMousePressed?function(){var t=n.getDocumentPosition().row,r=p.$annotations[t];if(!r)return y();if(t==d.session.getLength()){var l=d.renderer.pixelToScreenCoordinates(0,n.y).row,h=n.$pos;if(l>d.session.documentToScreenRow(h.row,h.column))return y()}if(a!=r)if(a=r.text.join("<br/>"),f.setHtml(a),f.show(),d._signal("showGutterTooltip",f),d.on("mousewheel",y),e.$tooltipFollowsMouse)w(n);else{var x=n.domEvent.target.getBoundingClientRect(),j=f.getElement().style;j.left=x.right+"px",j.top=x.bottom+"px"}}():y()}),50))})),l.addListener(d.renderer.$gutter,"mouseout",(function(e){n=null,a&&!t&&(t=setTimeout((function(){t=null,y()}),50))}),d),d.on("changeSession",y)}})),ace.define("ace/mouse/mouse_event",[],(function(e,t,n){"use strict";var r=e("../lib/event"),a=e("../lib/useragent"),l=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){r.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){r.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor.getSelectionRange();if(e.isEmpty())this.$inSelection=!1;else{var t=this.getDocumentPosition();this.$inSelection=e.contains(t.row,t.column)}return this.$inSelection},this.getButton=function(){return r.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=a.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(l.prototype)})),ace.define("ace/mouse/dragdrop_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=e("../lib/event"),l=e("../lib/useragent");function d(e){var t=e.editor,n=r.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",l.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(t){e[t]=this[t]}),this),t.on("mousedown",this.onMouseDown.bind(e));var d,p,f,y,w,x,j,O,C,S,_,k=t.container,E=0;function A(){var e=x;(function(e,n){var r=Date.now(),a=!n||e.row!=n.row,l=!n||e.column!=n.column;!S||a||l?(t.moveCursorToPosition(e),S=r,_={x:p,y:f}):h(_.x,_.y,p,f)>5?S=null:r-S>=200&&(t.renderer.scrollCursorIntoView(),S=null)})(x=t.renderer.screenToTextCoordinates(p,f),e),function(e,n){var r=Date.now(),a=t.renderer.layerConfig.lineHeight,l=t.renderer.layerConfig.characterWidth,d=t.renderer.scroller.getBoundingClientRect(),h={x:{left:p-d.left,right:d.right-p},y:{top:f-d.top,bottom:d.bottom-f}},y=Math.min(h.x.left,h.x.right),w=Math.min(h.y.top,h.y.bottom),x={row:e.row,column:e.column};y/l<=2&&(x.column+=h.x.left<h.x.right?-3:2),w/a<=1&&(x.row+=h.y.top<h.y.bottom?-1:1);var j=e.row!=x.row,O=e.column!=x.column,S=!n||e.row!=n.row;j||O&&!S?C?r-C>=200&&t.renderer.scrollCursorIntoView(x):C=r:C=null}(x,e)}function T(){w=t.selection.toOrientedRange(),d=t.session.addMarker(w,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(y),A(),y=setInterval(A,20),E=0,a.addListener(document,"mousemove",P)}function R(){clearInterval(y),t.session.removeMarker(d),d=null,t.selection.fromOrientedRange(w),t.isFocused()&&!O&&t.$resetCursorStyle(),w=null,x=null,E=0,C=null,S=null,a.removeListener(document,"mousemove",P)}this.onDragStart=function(e){if(this.cancelDrag||!k.draggable){var r=this;return setTimeout((function(){r.startSelect(),r.captureMouse(e)}),0),e.preventDefault()}w=t.getSelectionRange();var a=e.dataTransfer;a.effectAllowed=t.getReadOnly()?"copy":"copyMove",l.isOpera&&(t.container.appendChild(n),n.scrollTop=0),a.setDragImage&&a.setDragImage(n,0,0),l.isOpera&&t.container.removeChild(n),a.clearData(),a.setData("Text",t.session.getTextRange()),O=!0,this.setState("drag")},this.onDragEnd=function(e){if(k.draggable=!1,O=!1,this.setState(null),!t.getReadOnly()){var n=e.dataTransfer.dropEffect;j||"move"!=n||t.session.remove(t.getSelectionRange()),t.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!t.getReadOnly()&&D(e.dataTransfer))return p=e.clientX,f=e.clientY,d||T(),E++,e.dataTransfer.dropEffect=j=M(e),a.preventDefault(e)},this.onDragOver=function(e){if(!t.getReadOnly()&&D(e.dataTransfer))return p=e.clientX,f=e.clientY,d||(T(),E++),null!==I&&(I=null),e.dataTransfer.dropEffect=j=M(e),a.preventDefault(e)},this.onDragLeave=function(e){if(--E<=0&&d)return R(),j=null,a.preventDefault(e)},this.onDrop=function(e){if(x){var n=e.dataTransfer;if(O)switch(j){case"move":w=w.contains(x.row,x.column)?{start:x,end:x}:t.moveText(w,x);break;case"copy":w=t.moveText(w,x,!0)}else{var r=n.getData("Text");w={start:x,end:t.session.insert(x,r)},t.focus(),j=null}return R(),a.preventDefault(e)}},a.addListener(k,"dragstart",this.onDragStart.bind(e),t),a.addListener(k,"dragend",this.onDragEnd.bind(e),t),a.addListener(k,"dragenter",this.onDragEnter.bind(e),t),a.addListener(k,"dragover",this.onDragOver.bind(e),t),a.addListener(k,"dragleave",this.onDragLeave.bind(e),t),a.addListener(k,"drop",this.onDrop.bind(e),t);var I=null;function P(){null==I&&(I=setTimeout((function(){null!=I&&d&&R()}),20))}function D(e){var t=e.types;return!t||Array.prototype.some.call(t,(function(e){return"text/plain"==e||"Text"==e}))}function M(e){var t=["copy","copymove","all","uninitialized"],n=l.isMac?e.altKey:e.ctrlKey,r="uninitialized";try{r=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var a="none";return n&&t.indexOf(r)>=0?a="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(r)>=0?a="move":t.indexOf(r)>=0&&(a="copy"),a}}function h(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor;e.container.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var t=l.isWin?"default":"move";e.renderer.setCursorStyle(t),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;l.isIE&&"dragReady"==this.state&&(h(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&t.dragDrop());"dragWait"===this.state&&(h(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition())))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),r=e.getButton();if(1===(e.domEvent.detail||1)&&0===r&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var a=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in a&&(a.unselectable="on"),t.getDragDelay()){if(l.isWebKit)this.cancelDrag=!0,t.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(d.prototype),t.DragdropHandler=d})),ace.define("ace/mouse/touch_handler",[],(function(e,t,n){"use strict";var r=e("./mouse_event").MouseEvent,a=e("../lib/event"),l=e("../lib/dom");t.addTouchListeners=function(e,t){var n,d,h,p,f,y,w,x,j,O="scroll",C=0,S=0,_=0,k=0;function E(){var e=window.navigator&&window.navigator.clipboard,n=!1,r=function(r){var a,d,h=r.target.getAttribute("action");if("more"==h||!n)return n=!n,a=t.getCopyText(),d=t.session.getUndoManager().hasUndo(),void j.replaceChild(l.buildDom(n?["span",!a&&["span",{class:"ace_mobile-button",action:"selectall"},"Select All"],a&&["span",{class:"ace_mobile-button",action:"copy"},"Copy"],a&&["span",{class:"ace_mobile-button",action:"cut"},"Cut"],e&&["span",{class:"ace_mobile-button",action:"paste"},"Paste"],d&&["span",{class:"ace_mobile-button",action:"undo"},"Undo"],["span",{class:"ace_mobile-button",action:"find"},"Find"],["span",{class:"ace_mobile-button",action:"openCommandPallete"},"Pallete"]]:["span"]),j.firstChild);"paste"==h?e.readText().then((function(e){t.execCommand(h,e)})):h&&("cut"!=h&&"copy"!=h||(e?e.writeText(t.getCopyText()):document.execCommand("copy")),t.execCommand(h)),j.firstChild.style.display="none",n=!1,"openCommandPallete"!=h&&t.focus()};j=l.buildDom(["div",{class:"ace_mobile-menu",ontouchstart:function(e){O="menu",e.stopPropagation(),e.preventDefault(),t.textInput.focus()},ontouchend:function(e){e.stopPropagation(),e.preventDefault(),r(e)},onclick:r},["span"],["span",{class:"ace_mobile-button",action:"more"},"..."]],t.container)}function A(){j||E();var e=t.selection.cursor,n=t.renderer.textToScreenCoordinates(e.row,e.column),r=t.renderer.textToScreenCoordinates(0,0).pageX,a=t.renderer.scrollLeft,l=t.container.getBoundingClientRect();j.style.top=n.pageY-l.top-3+"px",n.pageX-l.left<l.width-70?(j.style.left="",j.style.right="10px"):(j.style.right="",j.style.left=r+a-l.left+"px"),j.style.display="",j.firstChild.style.display="none",t.on("input",T)}function T(e){j&&(j.style.display="none"),t.off("input",T)}function R(){f=null,clearTimeout(f);var e=t.selection.getRange(),n=e.contains(w.row,w.column);!e.isEmpty()&&n||(t.selection.moveToPosition(w),t.selection.selectWord()),O="wait",A()}a.addListener(e,"contextmenu",(function(e){x&&t.textInput.getElement().focus()}),t),a.addListener(e,"touchstart",(function(e){var a=e.touches;if(f||a.length>1)return clearTimeout(f),f=null,h=-1,void(O="zoom");x=t.$mouseHandler.isMousePressed=!0;var l=t.renderer.layerConfig.lineHeight,y=t.renderer.layerConfig.lineHeight,j=e.timeStamp;p=j;var E=a[0],A=E.clientX,T=E.clientY;Math.abs(n-A)+Math.abs(d-T)>l&&(h=-1),n=e.clientX=A,d=e.clientY=T,_=k=0;var I=new r(e,t);if(w=I.getDocumentPosition(),j-h<500&&1==a.length&&!C)S++,e.preventDefault(),e.button=0,function(){f=null,clearTimeout(f),t.selection.moveToPosition(w);var e=S>=2?t.selection.getLineRange(w.row):t.session.getBracketRange(w);e&&!e.isEmpty()?t.selection.setRange(e):t.selection.selectWord(),O="wait"}();else{S=0;var P=t.selection.cursor,D=t.selection.isEmpty()?P:t.selection.anchor,M=t.renderer.$cursorLayer.getPixelPosition(P,!0),L=t.renderer.$cursorLayer.getPixelPosition(D,!0),F=t.renderer.scroller.getBoundingClientRect(),q=t.renderer.layerConfig.offset,N=t.renderer.scrollLeft,B=function(e,t){return(e/=y)*e+(t=t/l-.75)*t};if(e.clientX<F.left)return void(O="zoom");var U=B(e.clientX-F.left-M.left+N,e.clientY-F.top-M.top+q),H=B(e.clientX-F.left-L.left+N,e.clientY-F.top-L.top+q);U<3.5&&H<3.5&&(O=U>H?"cursor":"anchor"),O=H<3.5?"anchor":U<3.5?"cursor":"scroll",f=setTimeout(R,450)}h=j}),t),a.addListener(e,"touchend",(function(e){x=t.$mouseHandler.isMousePressed=!1,y&&clearInterval(y),"zoom"==O?(O="",C=0):f?(t.selection.moveToPosition(w),C=0,A()):"scroll"==O?(C+=60,y=setInterval((function(){C--<=0&&(clearInterval(y),y=null),Math.abs(_)<.01&&(_=0),Math.abs(k)<.01&&(k=0),C<20&&(_*=.9),C<20&&(k*=.9);var e=t.session.getScrollTop();t.renderer.scrollBy(10*_,10*k),e==t.session.getScrollTop()&&(C=0)}),10),T()):A(),clearTimeout(f),f=null}),t),a.addListener(e,"touchmove",(function(e){f&&(clearTimeout(f),f=null);var a=e.touches;if(!(a.length>1||"zoom"==O)){var l=a[0],h=n-l.clientX,y=d-l.clientY;if("wait"==O){if(!(h*h+y*y>4))return e.preventDefault();O="cursor"}n=l.clientX,d=l.clientY,e.clientX=l.clientX,e.clientY=l.clientY;var w=e.timeStamp,x=w-p;if(p=w,"scroll"==O){var j=new r(e,t);j.speed=1,j.wheelX=h,j.wheelY=y,10*Math.abs(h)<Math.abs(y)&&(h=0),10*Math.abs(y)<Math.abs(h)&&(y=0),0!=x&&(_=h/x,k=y/x),t._emit("mousewheel",j),j.propagationStopped||(_=k=0)}else{var C=new r(e,t).getDocumentPosition();"cursor"==O?t.selection.moveCursorToPosition(C):"anchor"==O&&t.selection.setSelectionAnchor(C.row,C.column),t.renderer.scrollCursorIntoView(C),e.preventDefault()}}}),t)}})),ace.define("ace/lib/net",[],(function(e,t,n){"use strict";var r=e("./dom");t.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&t(n.responseText)},n.send(null)},t.loadScript=function(e,t){var n=r.getDocumentHead(),a=document.createElement("script");a.src=e,n.appendChild(a),a.onload=a.onreadystatechange=function(e,n){!n&&a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(a=a.onload=a.onreadystatechange=null,n||t())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}})),ace.define("ace/lib/event_emitter",[],(function(e,t,n){"use strict";var r={},a=function(){this.propagationStopped=!0},l=function(){this.defaultPrevented=!0};r._emit=r._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var n=this._eventRegistry[e]||[],r=this._defaultHandlers[e];if(n.length||r){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=a),t.preventDefault||(t.preventDefault=l),n=n.slice();for(var d=0;d<n.length&&(n[d](t,this),!t.propagationStopped);d++);return r&&!t.defaultPrevented?r(t,this):void 0}},r._signal=function(e,t){var n=(this._eventRegistry||{})[e];if(n){n=n.slice();for(var r=0;r<n.length;r++)n[r](t,this)}},r.once=function(e,t){var n=this;if(this.on(e,(function r(){n.off(e,r),t.apply(null,arguments)})),!t)return new Promise((function(e){t=e}))},r.setDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n||(n=this._defaultHandlers={_disabled_:{}}),n[e]){var r=n[e],a=n._disabled_[e];a||(n._disabled_[e]=a=[]),a.push(r);var l=a.indexOf(t);-1!=l&&a.splice(l,1)}n[e]=t},r.removeDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n){var r=n._disabled_[e];if(n[e]==t)r&&this.setDefaultHandler(e,r.pop());else if(r){var a=r.indexOf(t);-1!=a&&r.splice(a,1)}}},r.on=r.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var r=this._eventRegistry[e];return r||(r=this._eventRegistry[e]=[]),-1==r.indexOf(t)&&r[n?"unshift":"push"](t),t},r.off=r.removeListener=r.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},r.removeAllListeners=function(e){e||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[e]=void 0),this._defaultHandlers&&(this._defaultHandlers[e]=void 0)},t.EventEmitter=r})),ace.define("ace/lib/app_config",[],(function(e,t,n){var r=e("./oop"),a=e("./event_emitter").EventEmitter,l={setOptions:function(e){Object.keys(e).forEach((function(t){this.setOption(t,e[t])}),this)},getOptions:function(e){var t={};if(e)Array.isArray(e)||(t=e,e=Object.keys(t));else{var n=this.$options;e=Object.keys(n).filter((function(e){return!n[e].hidden}))}return e.forEach((function(e){t[e]=this.getOption(e)}),this),t},setOption:function(e,t){if(this["$"+e]!==t){var n=this.$options[e];if(!n)return d('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:d('misspelled option "'+e+'"')}};function d(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function reportError(e,t){var n=new Error(e);n.data=t,"object"==typeof console&&console.error&&console.error(n),setTimeout((function(){throw n}))}var h=function(){this.$defaultOptions={}};(function(){r.implement(this,a),this.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach((function(t){var r=n[t];"string"==typeof r&&(r={forwardTo:r}),r.name||(r.name=t),e.$options[r.name]=r,"initialValue"in r&&(e["$"+r.name]=r.initialValue)})),r.implement(e,l),this},this.resetOptions=function(e){Object.keys(e.$options).forEach((function(t){var n=e.$options[t];"value"in n&&e.setOption(t,n.value)}))},this.setDefaultValue=function(e,t,n){if(!e){for(e in this.$defaultOptions)if(this.$defaultOptions[e][t])break;if(!this.$defaultOptions[e][t])return!1}var r=this.$defaultOptions[e]||(this.$defaultOptions[e]={});r[t]&&(r.forwardTo?this.setDefaultValue(r.forwardTo,t,n):r[t].value=n)},this.setDefaultValues=function(e,t){Object.keys(t).forEach((function(n){this.setDefaultValue(e,n,t[n])}),this)},this.warn=d,this.reportError=reportError}).call(h.prototype),t.AppConfig=h})),ace.define("ace/config",[],(function(e,t,r){var a=e("./lib/lang"),l=(e("./lib/oop"),e("./lib/net")),d=e("./lib/app_config").AppConfig;r.exports=t=new d;var h=function(){return this||"undefined"!=typeof window&&window}(),p={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1};t.get=function(e){if(!p.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return p[e]},t.set=function(e,t){if(p.hasOwnProperty(e))p[e]=t;else if(0==this.setDefaultValue("",e,t))throw new Error("Unknown config key: "+e)},t.all=function(){return a.copyObject(p)},t.$modes={},t.moduleUrl=function(e,t){if(p.$moduleUrls[e])return p.$moduleUrls[e];var n=e.split("/"),r="snippets"==(t=t||n[n.length-2]||"")?"/":"-",a=n[n.length-1];if("worker"==t&&"-"==r){var l=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");a=a.replace(l,"")}(!a||a==t)&&n.length>1&&(a=n[n.length-2]);var d=p[t+"Path"];return null==d?d=p.basePath:"/"==r&&(t=r=""),d&&"/"!=d.slice(-1)&&(d+="/"),d+t+r+a+this.get("suffix")},t.setModuleUrl=function(e,t){return p.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(n,r){var a,d;Array.isArray(n)&&(d=n[0],n=n[1]);try{a=e(n)}catch(e){}if(a&&!t.$loading[n])return r&&r(a);if(t.$loading[n]||(t.$loading[n]=[]),t.$loading[n].push(r),!(t.$loading[n].length>1)){var h=function(){e([n],(function(e){t._emit("load.module",{name:n,module:e});var r=t.$loading[n];t.$loading[n]=null,r.forEach((function(t){t&&t(e)}))}))};if(!t.get("packaged"))return h();l.loadScript(t.moduleUrl(n,d),h),f()}};var f=function(){p.basePath||p.workerPath||p.modePath||p.themePath||Object.keys(p.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),f=function(){})};function y(a){if(h&&h.document){p.packaged=a||e.packaged||r.packaged||h.define&&n(590).packaged;for(var l,d={},f="",y=document.currentScript||document._currentScript,w=(y&&y.ownerDocument||document).getElementsByTagName("script"),x=0;x<w.length;x++){var j=w[x],O=j.src||j.getAttribute("src");if(O){for(var C=j.attributes,S=0,_=C.length;S<_;S++){var k=C[S];0===k.name.indexOf("data-ace-")&&(d[(l=k.name.replace(/^data-ace-/,""),l.replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=k.value)}var E=O.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);E&&(f=E[1])}}for(var A in f&&(d.base=d.base||f,d.packaged=!0),d.basePath=d.base,d.workerPath=d.workerPath||d.base,d.modePath=d.modePath||d.base,d.themePath=d.themePath||d.base,delete d.base,d)void 0!==d[A]&&t.set(A,d[A])}}y(!0),t.init=y,t.version="1.4.12"})),ace.define("ace/mouse/mouse_handler",[],(function(e,t,n){"use strict";var r=e("../lib/event"),a=e("../lib/useragent"),l=e("./default_handlers").DefaultHandlers,d=e("./default_gutter_handler").GutterHandler,h=e("./mouse_event").MouseEvent,p=e("./dragdrop_handler").DragdropHandler,f=e("./touch_handler").addTouchListeners,y=e("../config"),w=function(e){var t=this;this.editor=e,new l(this),new d(this),new p(this);var n=function(t){(!document.hasFocus||!document.hasFocus()||!e.isFocused()&&document.activeElement==(e.textInput&&e.textInput.getElement()))&&window.focus(),e.focus()},h=e.renderer.getMouseEventTarget();r.addListener(h,"click",this.onMouseEvent.bind(this,"click"),e),r.addListener(h,"mousemove",this.onMouseMove.bind(this,"mousemove"),e),r.addMultiMouseDownListener([h,e.renderer.scrollBarV&&e.renderer.scrollBarV.inner,e.renderer.scrollBarH&&e.renderer.scrollBarH.inner,e.textInput&&e.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent",e),r.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel"),e),f(e.container,e);var y=e.renderer.$gutter;r.addListener(y,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"),e),r.addListener(y,"click",this.onMouseEvent.bind(this,"gutterclick"),e),r.addListener(y,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"),e),r.addListener(y,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"),e),r.addListener(h,"mousedown",n,e),r.addListener(y,"mousedown",n,e),a.isIE&&e.renderer.scrollBarV&&(r.addListener(e.renderer.scrollBarV.element,"mousedown",n,e),r.addListener(e.renderer.scrollBarH.element,"mousedown",n,e)),e.on("mousemove",(function(n){if(!t.state&&!t.$dragDelay&&t.$dragEnabled){var r=e.renderer.screenToTextCoordinates(n.x,n.y),a=e.session.selection.getRange(),l=e.renderer;!a.isEmpty()&&a.insideStart(r.row,r.column)?l.setCursorStyle("default"):l.setCursorStyle("")}}),e)};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new h(t,this.editor))},this.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;n&&n.length&&this.editor._emit(e,new h(t,this.editor))},this.onMouseWheel=function(e,t){var n=new h(t,this.editor);n.speed=2*this.$scrollSpeed,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor,l=this.editor.renderer;l.$isMousePressed=!0;var d=this,p=function(e){if(e){if(a.isWebKit&&!e.which&&d.releaseMouse)return d.releaseMouse();d.x=e.clientX,d.y=e.clientY,t&&t(e),d.mouseEvent=new h(e,d.editor),d.$mouseMoved=!0}},f=function(e){n.off("beforeEndOperation",w),clearInterval(x),y(),d[d.state+"End"]&&d[d.state+"End"](e),d.state="",d.isMousePressed=l.$isMousePressed=!1,l.$keepTextAreaAtCursor&&l.$moveTextAreaToCursor(),d.$onCaptureMouseMove=d.releaseMouse=null,e&&d.onMouseEvent("mouseup",e),n.endOperation()},y=function(){d[d.state]&&d[d.state](),d.$mouseMoved=!1};if(a.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout((function(){f(e)}));var w=function(e){d.releaseMouse&&n.curOp.command.name&&n.curOp.selectionChanged&&(d[d.state+"End"]&&d[d.state+"End"](),d.state="",d.releaseMouse())};n.on("beforeEndOperation",w),n.startOperation({command:{name:"mouse"}}),d.$onCaptureMouseMove=p,d.releaseMouse=r.capture(this.editor.container,p,f);var x=setInterval(y,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){t&&t.domEvent&&"contextmenu"!=t.domEvent.type||(this.editor.off("nativecontextmenu",e),t&&t.domEvent&&r.stopEvent(t.domEvent))}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)},this.destroy=function(){this.releaseMouse&&this.releaseMouse()}}).call(w.prototype),y.defineOptions(w.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:a.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=w})),ace.define("ace/mouse/fold_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom");t.FoldHandler=function(e){e.on("click",(function(t){var n=t.getDocumentPosition(),a=e.session,l=a.getFoldAt(n.row,n.column,1);l&&(t.getAccelKey()?a.removeFold(l):a.expandFold(l),t.stop());var d=t.domEvent&&t.domEvent.target;d&&r.hasCssClass(d,"ace_inline_button")&&r.hasCssClass(d,"ace_toggle_wrap")&&(a.setOption("wrap",!a.getUseWrapMode()),e.renderer.scrollCursorIntoView())})),e.on("gutterclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,r=e.session;r.foldWidgets&&r.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}})),e.on("gutterdblclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,r=e.session,a=r.getParentFoldRangeData(n,!0),l=a.range||a.firstRange;if(l){n=l.start.row;var d=r.getFoldAt(n,r.getLine(n).length,1);d?r.removeFold(d):(r.addFold("...",l),e.renderer.scrollCursorIntoView({row:l.start.row,column:0}))}t.stop()}}))}})),ace.define("ace/keyboard/keybinding",[],(function(e,t,n){"use strict";var r=e("../lib/keys"),a=e("../lib/event"),l=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var n=this.$handlers.indexOf(e);-1!=n&&this.$handlers.splice(n,1),null==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==n&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map((function(n){return n.getStatusText&&n.getStatusText(t,e)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,t,n,r){for(var l,d=!1,h=this.$editor.commands,p=this.$handlers.length;p--&&!((l=this.$handlers[p].handleKeyboard(this.$data,e,t,n,r))&&l.command&&((d="null"==l.command||h.exec(l.command,this.$editor,l.args,r))&&r&&-1!=e&&1!=l.passEvent&&1!=l.command.passEvent&&a.stopEvent(r),d)););return d||-1!=e||(l={command:"insertstring"},d=h.exec("insertstring",this.$editor,t)),d&&this.$editor._signal&&this.$editor._signal("keyboardActivity",l),d},this.onCommandKey=function(e,t,n){var a=r.keyCodeToString(n);return this.$callKeyboardHandlers(t,a,n,e)},this.onTextInput=function(e){return this.$callKeyboardHandlers(-1,e)}}).call(l.prototype),t.KeyBinding=l})),ace.define("ace/lib/bidiutil",[],(function(e,t,n){"use strict";var r=0,a=0,l=!1,d=!1,h=!1,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y=[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4],w=[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function x(e,t,n){if(!(a<e))if(1!=e||1!=r||d)for(var l,h,p,f,y=n.length,w=0;w<y;){if(t[w]>=e){for(l=w+1;l<y&&t[l]>=e;)l++;for(h=w,p=l-1;h<p;h++,p--)f=n[h],n[h]=n[p],n[p]=f;w=l}w++}else n.reverse()}function j(e,t,n,a){var p,f,y,w,x=t[a];switch(x){case 0:case 1:l=!1;case 4:case 3:return x;case 2:return l?3:2;case 7:return l=!0,!0,1;case 8:return 4;case 9:return a<1||a+1>=t.length||2!=(p=n[a-1])&&3!=p||2!=(f=t[a+1])&&3!=f?4:(l&&(f=3),f==p?f:4);case 10:return 2==(p=a>0?n[a-1]:5)&&a+1<t.length&&2==t[a+1]?2:4;case 11:if(a>0&&2==n[a-1])return 2;if(l)return 4;for(w=a+1,y=t.length;w<y&&11==t[w];)w++;return w<y&&2==t[w]?2:4;case 12:for(y=t.length,w=a+1;w<y&&12==t[w];)w++;if(w<y){var j=e[a],O=j>=1425&&j<=2303||64286==j;if(p=t[w],O&&(1==p||7==p))return 1}return a<1||5==(p=t[a-1])?4:n[a-1];case 5:return l=!1,d=!0,r;case 6:return h=!0,4;case 13:case 14:case 16:case 17:case 15:l=!1;case 18:return 4}}function O(e){var t=e.charCodeAt(0),n=t>>8;return 0==n?t>191?0:y[t]:5==n?/[\u0591-\u05f4]/.test(e)?1:0:6==n?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?12:/[\u0660-\u0669\u066b-\u066c]/.test(e)?3:1642==t?11:/[\u06f0-\u06f9]/.test(e)?2:7:32==n&&t<=8287?w[255&t]:254==n&&t>=65136?7:4}t.L=0,t.R=1,t.EN=2,t.ON_R=3,t.AN=4,t.R_H=5,t.B=6,t.RLE=7,t.DOT="·",t.doBidiReorder=function(e,n,y){if(e.length<2)return{};var w=e.split(""),C=new Array(w.length),S=new Array(w.length),_=[];r=y?1:0,function(e,t,n,y){var w=r?f:p,x=null,C=null,S=null,_=0,k=null,E=-1,A=null,T=null,R=[];if(!y)for(A=0,y=[];A<n;A++)y[A]=O(e[A]);for(a=r,l=!1,!1,d=!1,h=!1,T=0;T<n;T++){if(x=_,R[T]=C=j(e,y,R,T),k=240&(_=w[x][C]),_&=15,t[T]=S=w[_][5],k>0)if(16==k){for(A=E;A<T;A++)t[A]=1;E=-1}else E=-1;if(w[_][6])-1==E&&(E=T);else if(E>-1){for(A=E;A<T;A++)t[A]=S;E=-1}5==y[T]&&(t[T]=0),a|=S}if(h)for(A=0;A<n;A++)if(6==y[A]){t[A]=r;for(var I=A-1;I>=0&&8==y[I];I--)t[I]=r}}(w,_,w.length,n);for(var k=0;k<C.length;C[k]=k,k++);x(2,_,C),x(1,_,C);for(k=0;k<C.length-1;k++)3===n[k]?_[k]=t.AN:1===_[k]&&(n[k]>7&&n[k]<13||4===n[k]||18===n[k])?_[k]=t.ON_R:k>0&&"ل"===w[k-1]&&/\u0622|\u0623|\u0625|\u0627/.test(w[k])&&(_[k-1]=_[k]=t.R_H,k++);w[w.length-1]===t.DOT&&(_[w.length-1]=t.B),"‫"===w[0]&&(_[0]=t.RLE);for(k=0;k<C.length;k++)S[k]=_[C[k]];return{logicalFromVisual:C,bidiLevels:S}},t.hasBidiCharacters=function(e,t){for(var n=!1,r=0;r<e.length;r++)t[r]=O(e.charAt(r)),n||1!=t[r]&&7!=t[r]&&3!=t[r]||(n=!0);return n},t.getVisualFromLogicalIdx=function(e,t){for(var n=0;n<t.logicalFromVisual.length;n++)if(t.logicalFromVisual[n]==e)return n;return 0}})),ace.define("ace/bidihandler",[],(function(e,t,n){"use strict";var r=e("./lib/bidiutil"),a=e("./lib/lang"),l=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,d=function(e){this.session=e,this.bidiMap={},this.currentRow=null,this.bidiUtil=r,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=l.test(e.getValue())};(function(){this.isBidiRow=function(e,t,n){return!!this.seenBidi&&(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,n),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(e){this.seenBidi?this.currentRow=null:"insert"==e.action&&l.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n=this.session.$getRowCacheIndex(t,this.currentRow);n>=0&&(e=this.session.$docRowCache[n])}return e},this.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length)for(var n,r=this.session.$getRowCacheIndex(t,this.currentRow);this.currentRow-e>0&&(n=this.session.$getRowCacheIndex(t,this.currentRow-e-1))===r;)r=n,e++;else e=this.currentRow;return e},this.updateRowLine=function(e,t){void 0===e&&(e=this.getDocumentRow());var n=e===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(e),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var l=this.session.$wrapData[e];l&&(void 0===t&&(t=this.getSplitIndex()),t>0&&l.length?(this.wrapIndent=l.indent,this.wrapOffset=this.wrapIndent*this.charWidths[r.L],this.line=t<l.length?this.line.substring(l[t-1],l[t]):this.line.substring(l[l.length-1])):this.line=this.line.substring(0,l[t])),t==l.length&&(this.line+=this.showInvisibles?n:r.DOT)}else this.line+=this.showInvisibles?n:r.DOT;var d,h=this.session,p=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(e,t){return"\t"===e||h.isFullWidth(e.charCodeAt(0))?(d="\t"===e?h.getScreenTabSize(t+p):2,p+=d-1,a.stringRepeat(r.DOT,d)):e})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==r.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},this.updateBidiMap=function(){var e=[];r.hasBidiCharacters(this.line,e)||this.isRtlDir?this.bidiMap=r.doBidiReorder(this.line,e,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(e){if(this.characterWidth!==e.$characterSize.width){this.fontMetrics=e;var t=this.characterWidth=e.$characterSize.width,n=e.$measureCharWidth("ה");this.charWidths[r.L]=this.charWidths[r.EN]=this.charWidths[r.ON_R]=t,this.charWidths[r.R]=this.charWidths[r.AN]=n,this.charWidths[r.R_H]=.45*n,this.charWidths[r.B]=this.charWidths[r.RLE]=0,this.currentRow=null}},this.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},this.setEolChar=function(e){this.EOL=e},this.setContentWidth=function(e){this.contentWidth=e},this.isRtlLine=function(e){return!!this.$isRtl||(null!=e?this.session.getLine(e).charAt(0)==this.RLE:this.isRtlDir)},this.setRtlDirection=function(e,t){for(var n=e.getCursorPosition(),r=e.selection.getSelectionAnchor().row;r<=n.row;r++)t||e.session.getLine(r).charAt(0)!==e.session.$bidiHandler.RLE?t&&e.session.getLine(r).charAt(0)!==e.session.$bidiHandler.RLE&&e.session.doc.insert({column:0,row:r},e.session.$bidiHandler.RLE):e.session.doc.removeInLine(r,0,1)},this.getPosLeft=function(e){e-=this.wrapIndent;var t=this.line.charAt(0)===this.RLE?1:0,n=e>t?this.session.getOverwrite()?e:e-1:t,a=r.getVisualFromLogicalIdx(n,this.bidiMap),l=this.bidiMap.bidiLevels,d=0;!this.session.getOverwrite()&&e<=t&&l[a]%2!=0&&a++;for(var h=0;h<a;h++)d+=this.charWidths[l[h]];return!this.session.getOverwrite()&&e>t&&l[a]%2==0&&(d+=this.charWidths[l[a]]),this.wrapIndent&&(d+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(d+=this.rtlLineOffset),d},this.getSelections=function(e,t){var n,r=this.bidiMap,a=r.bidiLevels,l=[],d=0,h=Math.min(e,t)-this.wrapIndent,p=Math.max(e,t)-this.wrapIndent,f=!1,y=!1,w=0;this.wrapIndent&&(d+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var x,j=0;j<a.length;j++)x=r.logicalFromVisual[j],n=a[j],(f=x>=h&&x<p)&&!y?w=d:!f&&y&&l.push({left:w,width:d-w}),d+=this.charWidths[n],y=f;if(f&&j===a.length&&l.push({left:w,width:d-w}),this.isRtlDir)for(var O=0;O<l.length;O++)l[O].left+=this.rtlLineOffset;return l},this.offsetToCol=function(e){this.isRtlDir&&(e-=this.rtlLineOffset);var t=0,n=(e=Math.max(e,0),0),r=0,a=this.bidiMap.bidiLevels,l=this.charWidths[a[r]];for(this.wrapIndent&&(e-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);e>n+l/2;){if(n+=l,r===a.length-1){l=0;break}l=this.charWidths[a[++r]]}return r>0&&a[r-1]%2!=0&&a[r]%2==0?(e<n&&r--,t=this.bidiMap.logicalFromVisual[r]):r>0&&a[r-1]%2==0&&a[r]%2!=0?t=1+(e>n?this.bidiMap.logicalFromVisual[r]:this.bidiMap.logicalFromVisual[r-1]):this.isRtlDir&&r===a.length-1&&0===l&&a[r-1]%2==0||!this.isRtlDir&&0===r&&a[r]%2!=0?t=1+this.bidiMap.logicalFromVisual[r]:(r>0&&a[r-1]%2!=0&&0!==l&&r--,t=this.bidiMap.logicalFromVisual[r]),0===t&&this.isRtlDir&&t++,t+this.wrapIndent}}).call(d.prototype),t.BidiHandler=d})),ace.define("ace/selection",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/lang"),l=e("./lib/event_emitter").EventEmitter,d=e("./range").Range,h=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",(function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),t.$isEmpty||t.$silent||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)})),this.anchor.on("change",(function(){t.$anchorChanged=!0,t.$isEmpty||t.$silent||t._emit("changeSelection")}))};(function(){r.implement(this,l),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?d.fromPoints(t,t):this.isBackwards()?d.fromPoints(t,e):d.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(e,t){var n=t?e.end:e.start,r=t?e.start:e.end;this.$setSelection(n.row,n.column,r.row,r.column)},this.$setSelection=function(e,t,n,r){if(!this.$silent){var a=this.$isEmpty,l=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(n,r),this.$isEmpty=!d.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||a!=this.$isEmpty||l)&&this._emit("changeSelection")}},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection((function(){this.moveCursorTo(e,t)}))},this.selectToPosition=function(e){this.$moveSelection((function(){this.moveCursorToPosition(e)}))},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(void 0===t){var n=e||this.lead;e=n.row,t=n.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var n,r="number"==typeof e?e:this.lead.row,a=this.session.getFoldLine(r);return a?(r=a.start.row,n=a.end.row):n=r,!0===t?new d(r,0,n,this.session.getLine(n).length):new d(r,0,n+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(e,t,n){var r=e.column,a=e.column+t;return n<0&&(r=e.column-t,a=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(r,a).split(" ").length-1==t},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var n=this.session.getTabSize();this.wouldMoveIntoSoftTab(t,n,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-n):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var n=this.session.getTabSize();t=this.lead;this.wouldMoveIntoSoftTab(t,n,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,n):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,n=this.session.documentToScreenRow(e,t),r=this.session.screenToDocumentPosition(n,0),a=this.session.getDisplayLine(e,null,r.row,r.column).match(/^\s*/);a[0].length==t||this.session.$useEmacsStyleLineStart||(r.column+=a[0].length),this.moveCursorToPosition(r)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var n=this.session.getLine(t.row);if(t.column==n.length){var r=n.search(/\s+$/);r>0&&(t.column=r)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var a=this.session.getFoldAt(e,t,1);if(a)this.moveCursorTo(a.end.row,a.end.column);else{if(this.session.nonTokenRe.exec(r)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,r=n.substring(t)),t>=n.length)return this.moveCursorTo(e,n.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(r)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))this.moveCursorTo(e.start.row,e.start.column);else{var r=this.session.getFoldStringAt(t,n,-1);null==r&&(r=this.doc.getLine(t).substring(0,n));var l=a.stringReverse(r);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(l)&&(n-=this.session.nonTokenRe.lastIndex,l=l.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),n<=0)return this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(l)&&(n-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,n)}},this.$shortWordEndIndex=function(e){var t,n=0,r=/\s/,a=this.session.tokenRe;if(a.lastIndex=0,this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(t=e[n])&&r.test(t);)n++;if(n<1)for(a.lastIndex=0;(t=e[n])&&!a.test(t);)if(a.lastIndex=0,n++,r.test(t)){if(n>2){n--;break}for(;(t=e[n])&&r.test(t);)n++;if(n>2)break}}return a.lastIndex=0,n},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t),a=this.session.getFoldAt(e,t,1);if(a)return this.moveCursorTo(a.end.row,a.end.column);if(t==n.length){var l=this.doc.getLength();do{e++,r=this.doc.getLine(e)}while(e<l&&/^\s*$/.test(r));/^\s+/.test(r)||(r=""),t=0}var d=this.$shortWordEndIndex(r);this.moveCursorTo(e,t+d)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))return this.moveCursorTo(e.start.row,e.start.column);var r=this.session.getLine(t).substring(0,n);if(0===n){do{t--,r=this.doc.getLine(t)}while(t>0&&/^\s*$/.test(r));n=r.length,/\s+$/.test(r)||(r="")}var l=a.stringReverse(r),d=this.$shortWordEndIndex(l);return this.moveCursorTo(t,n-d)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var n,r=this.session.documentToScreenPosition(this.lead.row,this.lead.column);if(0===t&&(0!==e&&(this.session.$bidiHandler.isBidiRow(r.row,this.lead.row)?(n=this.session.$bidiHandler.getPosLeft(r.column),r.column=Math.round(n/this.session.$bidiHandler.charWidths[0])):n=r.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?r.column=this.$desiredColumn:this.$desiredColumn=r.column),0!=e&&this.session.lineWidgets&&this.session.lineWidgets[this.lead.row]){var a=this.session.lineWidgets[this.lead.row];e<0?e-=a.rowsAbove||0:e>0&&(e+=a.rowCount-(a.rowsAbove||0))}var l=this.session.screenToDocumentPosition(r.row+e,r.column,n);0!==e&&0===t&&l.row===this.lead.row&&(l.column,this.lead.column),this.moveCursorTo(l.row,l.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,n){var r=this.session.getFoldAt(e,t,1);r&&(e=r.start.row,t=r.start.column),this.$keepDesiredColumnOnChange=!0;var a=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(a.charAt(t))&&a.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,n||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,n){var r=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(r.row,r.column,n)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var n=this.getCursor();return d.fromPoints(t,n)}catch(e){return d.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map((function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t}));else(e=this.getRange()).isBackwards=this.isBackwards();return e},this.fromJSON=function(e){if(null==e.start){if(this.rangeList&&e.length>1){this.toSingleRange(e[0]);for(var t=e.length;t--;){var n=d.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(n.cursor=n.start),this.addRange(n,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(h.prototype),t.Selection=h})),ace.define("ace/tokenizer",[],(function(e,t,n){"use strict";var r=e("./config"),a=2e3,l=function(e){for(var t in this.states=e,this.regExps={},this.matchMappings={},this.states){for(var n=this.states[t],r=[],a=0,l=this.matchMappings[t]={defaultToken:"text"},d="g",h=[],p=0;p<n.length;p++){var f=n[p];if(f.defaultToken&&(l.defaultToken=f.defaultToken),f.caseInsensitive&&(d="gi"),null!=f.regex){f.regex instanceof RegExp&&(f.regex=f.regex.toString().slice(1,-1));var y=f.regex,w=new RegExp("(?:("+y+")|(.))").exec("a").length-2;Array.isArray(f.token)?1==f.token.length||1==w?f.token=f.token[0]:w-1!=f.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:f,groupCount:w-1}),f.token=f.token[0]):(f.tokenArray=f.token,f.token=null,f.onMatch=this.$arrayTokens):"function"!=typeof f.token||f.onMatch||(f.onMatch=w>1?this.$applyToken:f.token),w>1&&(/\\\d/.test(f.regex)?y=f.regex.replace(/\\([0-9]+)/g,(function(e,t){return"\\"+(parseInt(t,10)+a+1)})):(w=1,y=this.removeCapturingGroups(f.regex)),f.splitRegex||"string"==typeof f.token||h.push(f)),l[a]=p,a+=w,r.push(y),f.onMatch||(f.onMatch=null)}}r.length||(l[0]=0,r.push("$")),h.forEach((function(e){e.splitRegex=this.createSplitterRegexp(e.regex,d)}),this),this.regExps[t]=new RegExp("("+r.join(")|(")+")|($)",d)}};(function(){this.$setMaxTokenCount=function(e){a=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),n=this.token.apply(this,t);if("string"==typeof n)return[{type:n,value:e}];for(var r=[],a=0,l=n.length;a<l;a++)t[a]&&(r[r.length]={type:n[a],value:t[a]});return r},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var n=[],r=this.tokenArray,a=0,l=r.length;a<l;a++)t[a+1]&&(n[n.length]={type:r[a],value:t[a+1]});return n},this.removeCapturingGroups=function(e){return e.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,(function(e,t){return t?"(?:":e}))},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var n=0,r=!1,a={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(e,t,l,d,h,p){return r?r="]"!=h:h?r=!0:d?(n==a.stack&&(a.end=p+1,a.stack=-1),n--):l&&(n++,1!=l.length&&(a.stack=n,a.start=p)),e})),null!=a.end&&/^\)*$/.test(e.substr(a.end))&&(e=e.substring(0,a.start)+e.substr(a.end))}return"^"!=e.charAt(0)&&(e="^"+e),"$"!=e.charAt(e.length-1)&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var n=t.slice(0);"#tmp"===(t=n[0])&&(n.shift(),t=n.shift())}else n=[];var r=t||"start",l=this.states[r];l||(r="start",l=this.states[r]);var d=this.matchMappings[r],h=this.regExps[r];h.lastIndex=0;for(var p,f=[],y=0,w=0,x={type:null,value:""};p=h.exec(e);){var j=d.defaultToken,O=null,C=p[0],S=h.lastIndex;if(S-C.length>y){var _=e.substring(y,S-C.length);x.type==j?x.value+=_:(x.type&&f.push(x),x={type:j,value:_})}for(var k=0;k<p.length-2;k++)if(void 0!==p[k+1]){j=(O=l[d[k]]).onMatch?O.onMatch(C,r,n,e):O.token,O.next&&(r="string"==typeof O.next?O.next:O.next(r,n),(l=this.states[r])||(this.reportError("state doesn't exist",r),r="start",l=this.states[r]),d=this.matchMappings[r],y=S,(h=this.regExps[r]).lastIndex=S),O.consumeLineEnd&&(y=S);break}if(C)if("string"==typeof j)O&&!1===O.merge||x.type!==j?(x.type&&f.push(x),x={type:j,value:C}):x.value+=C;else if(j){x.type&&f.push(x),x={type:null,value:""};for(k=0;k<j.length;k++)f.push(j[k])}if(y==e.length)break;if(y=S,w++>a){for(w>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});y<e.length;)x.type&&f.push(x),x={value:e.substring(y,y+=500),type:"overflow"};r="start",n=[];break}}return x.type&&f.push(x),n.length>1&&n[0]!==r&&n.unshift("#tmp",r),{tokens:f,state:n.length?n:r}},this.reportError=r.reportError}).call(l.prototype),t.Tokenizer=l})),ace.define("ace/mode/text_highlight_rules",[],(function(e,t,n){"use strict";var r=e("../lib/lang"),a=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var n in e){for(var r=e[n],a=0;a<r.length;a++){var l=r[a];(l.next||l.onMatch)&&("string"==typeof l.next&&0!==l.next.indexOf(t)&&(l.next=t+l.next),l.nextState&&0!==l.nextState.indexOf(t)&&(l.nextState=t+l.nextState))}this.$rules[t+n]=r}else for(var n in e)this.$rules[n]=e[n]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,n,a,l){var d="function"==typeof e?(new e).getRules():e;if(a)for(var h=0;h<a.length;h++)a[h]=t+a[h];else for(var p in a=[],d)a.push(t+p);if(this.addRules(d,t),n){var f=Array.prototype[l?"push":"unshift"];for(h=0;h<a.length;h++)f.apply(this.$rules[a[h]],r.deepCopy(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var n=0,r=this.$rules;Object.keys(r).forEach((function a(l){var d=r[l];d.processed=!0;for(var h=0;h<d.length;h++){var p=d[h],f=null;Array.isArray(p)&&(f=p,p={}),!p.regex&&p.start&&(p.regex=p.start,p.next||(p.next=[]),p.next.push({defaultToken:p.token},{token:p.token+".end",regex:p.end||p.start,next:"pop"}),p.token=p.token+".start",p.push=!0);var y=p.next||p.push;if(y&&Array.isArray(y)){var w=p.stateName;w||("string"!=typeof(w=p.token)&&(w=w[0]||""),r[w]&&(w+=n++)),r[w]=y,p.next=w,a(w)}else"pop"==y&&(p.next=t);if(p.push&&(p.nextState=p.next||p.push,p.next=e,delete p.push),p.rules)for(var x in p.rules)r[x]?r[x].push&&r[x].push.apply(r[x],p.rules[x]):r[x]=p.rules[x];var j="string"==typeof p?p:p.include;if(j&&(f=Array.isArray(j)?j.map((function(e){return r[e]})):r[j]),f){var O=[h,1].concat(f);p.noEscape&&(O=O.filter((function(e){return!e.next}))),d.splice.apply(d,O),h--}p.keywordMap&&(p.token=this.createKeywordMapper(p.keywordMap,p.defaultToken||"text",p.caseInsensitive),delete p.defaultToken)}}),this)},this.createKeywordMapper=function(e,t,n,r){var a=Object.create(null);return this.$keywordList=[],Object.keys(e).forEach((function(t){for(var l=e[t].split(r||"|"),d=l.length;d--;){var h=l[d];this.$keywordList.push(h),n&&(h=h.toLowerCase()),a[h]=t}}),this),e=null,n?function(e){return a[e.toLowerCase()]||t}:function(e){return a[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(a.prototype),t.TextHighlightRules=a})),ace.define("ace/mode/behaviour",[],(function(e,t,n){"use strict";var r=function(){this.$behaviours={}};(function(){this.add=function(e,t,n){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=n},this.addBehaviours=function(e){for(var t in e)for(var n in e[t])this.add(t,n,e[t][n])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var n=(new e).getBehaviours(t);else n=e.getBehaviours(t);this.addBehaviours(n)},this.getBehaviours=function(e){if(e){for(var t={},n=0;n<e.length;n++)this.$behaviours[e[n]]&&(t[e[n]]=this.$behaviours[e[n]]);return t}return this.$behaviours}}).call(r.prototype),t.Behaviour=r})),ace.define("ace/token_iterator",[],(function(e,t,n){"use strict";var r=e("./range").Range,a=function(e,t,n){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var r=e.getTokenAt(t,n);this.$tokenIndex=r?r.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,n=e[t].start;if(void 0!==n)return n;for(n=0;t>0;)n+=e[t-=1].value.length;return n},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var e=this.$rowTokens[this.$tokenIndex],t=this.getCurrentTokenColumn();return new r(this.$row,t,this.$row,t+e.value.length)}}).call(a.prototype),t.TokenIterator=a})),ace.define("ace/mode/behaviour/cstyle",[],(function(e,t,n){"use strict";var r,a=e("../../lib/oop"),l=e("../behaviour").Behaviour,d=e("../../token_iterator").TokenIterator,h=e("../../lib/lang"),p=["text","paren.rparen","rparen","paren","punctuation.operator"],f=["text","paren.rparen","rparen","paren","punctuation.operator","comment"],y={},w={'"':'"',"'":"'"},x=function(e){var t=-1;if(e.multiSelect&&(t=e.selection.index,y.rangeCount!=e.multiSelect.rangeCount&&(y={rangeCount:e.multiSelect.rangeCount})),y[t])return r=y[t];r=y[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},j=function(e,t,n,r){var a=e.end.row-e.start.row;return{text:n+t+r,selection:[0,e.start.column+1,a,e.end.column+(a?0:1)]}},O=function(e){this.add("braces","insertion",(function(t,n,a,l,d){var p=a.getCursorPosition(),f=l.doc.getLine(p.row);if("{"==d){x(a);var y=a.getSelectionRange(),w=l.doc.getTextRange(y);if(""!==w&&"{"!==w&&a.getWrapBehavioursEnabled())return j(y,w,"{","}");if(O.isSaneInsertion(a,l))return/[\]\}\)]/.test(f[p.column])||a.inMultiSelectMode||e&&e.braces?(O.recordAutoInsert(a,l,"}"),{text:"{}",selection:[1,1]}):(O.recordMaybeInsert(a,l,"{"),{text:"{",selection:[1,1]})}else if("}"==d){if(x(a),"}"==f.substring(p.column,p.column+1))if(null!==l.$findOpeningBracket("}",{column:p.column+1,row:p.row})&&O.isAutoInsertedClosing(p,f,d))return O.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==d||"\r\n"==d){x(a);var C="";if(O.isMaybeInsertedClosing(p,f)&&(C=h.stringRepeat("}",r.maybeInsertedBrackets),O.clearMaybeInsertedClosing()),"}"===f.substring(p.column,p.column+1)){var S=l.findMatchingBracket({row:p.row,column:p.column+1},"}");if(!S)return null;var _=this.$getIndent(l.getLine(S.row))}else{if(!C)return void O.clearMaybeInsertedClosing();_=this.$getIndent(f)}var k=_+l.getTabString();return{text:"\n"+k+"\n"+_+C,selection:[1,k.length,1,k.length]}}O.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(e,t,n,a,l){var d=a.doc.getTextRange(l);if(!l.isMultiLine()&&"{"==d){if(x(n),"}"==a.doc.getLine(l.start.row).substring(l.end.column,l.end.column+1))return l.end.column++,l;r.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(e,t,n,r,a){if("("==a){x(n);var l=n.getSelectionRange(),d=r.doc.getTextRange(l);if(""!==d&&n.getWrapBehavioursEnabled())return j(l,d,"(",")");if(O.isSaneInsertion(n,r))return O.recordAutoInsert(n,r,")"),{text:"()",selection:[1,1]}}else if(")"==a){x(n);var h=n.getCursorPosition(),p=r.doc.getLine(h.row);if(")"==p.substring(h.column,h.column+1))if(null!==r.$findOpeningBracket(")",{column:h.column+1,row:h.row})&&O.isAutoInsertedClosing(h,p,a))return O.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(e,t,n,r,a){var l=r.doc.getTextRange(a);if(!a.isMultiLine()&&"("==l&&(x(n),")"==r.doc.getLine(a.start.row).substring(a.start.column+1,a.start.column+2)))return a.end.column++,a})),this.add("brackets","insertion",(function(e,t,n,r,a){if("["==a){x(n);var l=n.getSelectionRange(),d=r.doc.getTextRange(l);if(""!==d&&n.getWrapBehavioursEnabled())return j(l,d,"[","]");if(O.isSaneInsertion(n,r))return O.recordAutoInsert(n,r,"]"),{text:"[]",selection:[1,1]}}else if("]"==a){x(n);var h=n.getCursorPosition(),p=r.doc.getLine(h.row);if("]"==p.substring(h.column,h.column+1))if(null!==r.$findOpeningBracket("]",{column:h.column+1,row:h.row})&&O.isAutoInsertedClosing(h,p,a))return O.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(e,t,n,r,a){var l=r.doc.getTextRange(a);if(!a.isMultiLine()&&"["==l&&(x(n),"]"==r.doc.getLine(a.start.row).substring(a.start.column+1,a.start.column+2)))return a.end.column++,a})),this.add("string_dquotes","insertion",(function(e,t,n,r,a){var l=r.$mode.$quotes||w;if(1==a.length&&l[a]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(a))return;x(n);var d=a,h=n.getSelectionRange(),p=r.doc.getTextRange(h);if(!(""===p||1==p.length&&l[p])&&n.getWrapBehavioursEnabled())return j(h,p,d,d);if(!p){var f=n.getCursorPosition(),y=r.doc.getLine(f.row),O=y.substring(f.column-1,f.column),C=y.substring(f.column,f.column+1),S=r.getTokenAt(f.row,f.column),_=r.getTokenAt(f.row,f.column+1);if("\\"==O&&S&&/escape/.test(S.type))return null;var k,E=S&&/string|escape/.test(S.type),A=!_||/string|escape/.test(_.type);if(C==d)(k=E!==A)&&/string\.end/.test(_.type)&&(k=!1);else{if(E&&!A)return null;if(E&&A)return null;var T=r.$mode.tokenRe;T.lastIndex=0;var R=T.test(O);T.lastIndex=0;var I=T.test(O);if(R||I)return null;if(C&&!/[\s;,.})\]\\]/.test(C))return null;var P=y[f.column-2];if(O==d&&(P==d||T.test(P)))return null;k=!0}return{text:k?d+d:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(e,t,n,r,a){var l=r.$mode.$quotes||w,d=r.doc.getTextRange(a);if(!a.isMultiLine()&&l.hasOwnProperty(d)&&(x(n),r.doc.getLine(a.start.row).substring(a.start.column+1,a.start.column+2)==d))return a.end.column++,a}))};O.isSaneInsertion=function(e,t){var n=e.getCursorPosition(),r=new d(t,n.row,n.column);if(!this.$matchTokenType(r.getCurrentToken()||"text",p)){if(/[)}\]]/.test(e.session.getLine(n.row)[n.column]))return!0;var a=new d(t,n.row,n.column+1);if(!this.$matchTokenType(a.getCurrentToken()||"text",p))return!1}return r.stepForward(),r.getCurrentTokenRow()!==n.row||this.$matchTokenType(r.getCurrentToken()||"text",f)},O.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},O.recordAutoInsert=function(e,t,n){var a=e.getCursorPosition(),l=t.doc.getLine(a.row);this.isAutoInsertedClosing(a,l,r.autoInsertedLineEnd[0])||(r.autoInsertedBrackets=0),r.autoInsertedRow=a.row,r.autoInsertedLineEnd=n+l.substr(a.column),r.autoInsertedBrackets++},O.recordMaybeInsert=function(e,t,n){var a=e.getCursorPosition(),l=t.doc.getLine(a.row);this.isMaybeInsertedClosing(a,l)||(r.maybeInsertedBrackets=0),r.maybeInsertedRow=a.row,r.maybeInsertedLineStart=l.substr(0,a.column)+n,r.maybeInsertedLineEnd=l.substr(a.column),r.maybeInsertedBrackets++},O.isAutoInsertedClosing=function(e,t,n){return r.autoInsertedBrackets>0&&e.row===r.autoInsertedRow&&n===r.autoInsertedLineEnd[0]&&t.substr(e.column)===r.autoInsertedLineEnd},O.isMaybeInsertedClosing=function(e,t){return r.maybeInsertedBrackets>0&&e.row===r.maybeInsertedRow&&t.substr(e.column)===r.maybeInsertedLineEnd&&t.substr(0,e.column)==r.maybeInsertedLineStart},O.popAutoInsertedClosing=function(){r.autoInsertedLineEnd=r.autoInsertedLineEnd.substr(1),r.autoInsertedBrackets--},O.clearMaybeInsertedClosing=function(){r&&(r.maybeInsertedBrackets=0,r.maybeInsertedRow=-1)},a.inherits(O,l),t.CstyleBehaviour=O})),ace.define("ace/unicode",[],(function(e,t,n){"use strict";for(var r=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],a=0,l=[],d=0;d<r.length;d+=2)l.push(a+=r[d]),r[d+1]&&l.push(45,a+=r[d+1]);t.wordChars=String.fromCharCode.apply(null,l)})),ace.define("ace/mode/text",[],(function(e,t,n){"use strict";var r=e("../config"),a=e("../tokenizer").Tokenizer,l=e("./text_highlight_rules").TextHighlightRules,d=e("./behaviour/cstyle").CstyleBehaviour,h=e("../unicode"),p=e("../lib/lang"),f=e("../token_iterator").TokenIterator,y=e("../range").Range,w=function(){this.HighlightRules=l};(function(){this.$defaultBehaviour=new d,this.tokenRe=new RegExp("^["+h.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+h.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new a(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,n,r){var a=t.doc,l=!0,d=!0,h=1/0,f=t.getTabSize(),y=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))C=this.lineCommentStart.map(p.escapeRegExp).join("|"),j=this.lineCommentStart[0];else C=p.escapeRegExp(this.lineCommentStart),j=this.lineCommentStart;C=new RegExp("^(\\s*)(?:"+C+") ?"),y=t.getUseSoftTabs();k=function(e,t){var n=e.match(C);if(n){var r=n[1].length,l=n[0].length;x(e,r,l)||" "!=n[0][l-1]||l--,a.removeInLine(t,r,l)}};var w=j+" ",x=(_=function(e,t){l&&!/\S/.test(e)||(x(e,h,h)?a.insertInLine({row:t,column:h},w):a.insertInLine({row:t,column:h},j))},E=function(e,t){return C.test(e)},function(e,t,n){for(var r=0;t--&&" "==e.charAt(t);)r++;if(r%f!=0)return!1;for(r=0;" "==e.charAt(n++);)r++;return f>2?r%f!=f-1:r%f==0})}else{if(!this.blockComment)return!1;var j=this.blockComment.start,O=this.blockComment.end,C=new RegExp("^(\\s*)(?:"+p.escapeRegExp(j)+")"),S=new RegExp("(?:"+p.escapeRegExp(O)+")\\s*$"),_=function(e,t){E(e,t)||l&&!/\S/.test(e)||(a.insertInLine({row:t,column:e.length},O),a.insertInLine({row:t,column:h},j))},k=function(e,t){var n;(n=e.match(S))&&a.removeInLine(t,e.length-n[0].length,e.length),(n=e.match(C))&&a.removeInLine(t,n[1].length,n[0].length)},E=function(e,n){if(C.test(e))return!0;for(var r=t.getTokens(n),a=0;a<r.length;a++)if("comment"===r[a].type)return!0}}function A(e){for(var t=n;t<=r;t++)e(a.getLine(t),t)}var T=1/0;A((function(e,t){var n=e.search(/\S/);-1!==n?(n<h&&(h=n),d&&!E(e,t)&&(d=!1)):T>e.length&&(T=e.length)})),h==1/0&&(h=T,l=!1,d=!1),y&&h%f!=0&&(h=Math.floor(h/f)*f),A(d?k:_)},this.toggleBlockComment=function(e,t,n,r){var a=this.blockComment;if(a){!a.start&&a[0]&&(a=a[0]);var l,d,h=(C=new f(t,r.row,r.column)).getCurrentToken(),p=(t.selection,t.selection.toOrientedRange());if(h&&/comment/.test(h.type)){for(var w,x;h&&/comment/.test(h.type);){if(-1!=(S=h.value.indexOf(a.start))){var j=C.getCurrentTokenRow(),O=C.getCurrentTokenColumn()+S;w=new y(j,O,j,O+a.start.length);break}h=C.stepBackward()}var C;for(h=(C=new f(t,r.row,r.column)).getCurrentToken();h&&/comment/.test(h.type);){var S;if(-1!=(S=h.value.indexOf(a.end))){j=C.getCurrentTokenRow(),O=C.getCurrentTokenColumn()+S;x=new y(j,O,j,O+a.end.length);break}h=C.stepForward()}x&&t.remove(x),w&&(t.remove(w),l=w.start.row,d=-a.start.length)}else d=a.start.length,l=n.start.row,t.insert(n.end,a.end),t.insert(n.start,a.start);p.start.row==l&&(p.start.column+=d),p.end.row==l&&(p.end.column+=d),t.selection.fromOrientedRange(p)}},this.getNextLineIndent=function(e,t,n){return this.$getIndent(t)},this.checkOutdent=function(e,t,n){return!1},this.autoOutdent=function(e,t,n){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){for(var t in this.$embeds=[],this.$modes={},e)if(e[t]){var n=e[t],a=n.prototype.$id,l=r.$modes[a];l||(r.$modes[a]=l=new n),r.$modes[t]||(r.$modes[t]=l),this.$embeds.push(t),this.$modes[t]=l}var d=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(t=0;t<d.length;t++)!function(e){var n=d[t],r=e[n];e[d[t]]=function(){return this.$delegator(n,arguments,r)}}(this)},this.$delegator=function(e,t,n){var r=t[0]||"start";if("string"!=typeof r){if(Array.isArray(r[2])){var a=r[2][r[2].length-1];if(d=this.$modes[a])return d[e].apply(d,[r[1]].concat([].slice.call(t,1)))}r=r[0]||"start"}for(var l=0;l<this.$embeds.length;l++)if(this.$modes[this.$embeds[l]]){var d,h=r.split(this.$embeds[l]);if(!h[0]&&h[1])return t[0]=h[1],(d=this.$modes[this.$embeds[l]])[e].apply(d,t)}var p=n.apply(this,t);return n?p:void 0},this.transformAction=function(e,t,n,r,a){if(this.$behaviour){var l=this.$behaviour.getBehaviours();for(var d in l)if(l[d][t]){var h=l[d][t].apply(this,arguments);if(h)return h}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,n=[];for(var r in t)for(var a=t[r],l=0,d=a.length;l<d;l++)if("string"==typeof a[l].token)/keyword|support|storage/.test(a[l].token)&&n.push(a[l].regex);else if("object"==typeof a[l].token)for(var h=0,p=a[l].token.length;h<p;h++)if(/keyword|support|storage/.test(a[l].token[h])){r=a[l].regex.match(/\(.+?\)/g)[h];n.push(r.substr(1,r.length-2))}this.completionKeywords=n}return e?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,n,r){return(this.$keywordList||this.$createKeywordList()).map((function(e){return{name:e,value:e,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(w.prototype),t.Mode=w})),ace.define("ace/apply_delta",[],(function(e,t,n){"use strict";t.applyDelta=function(e,t,n){var r=t.start.row,a=t.start.column,l=e[r]||"";switch(t.action){case"insert":if(1===t.lines.length)e[r]=l.substring(0,a)+t.lines[0]+l.substring(a);else{var d=[r,1].concat(t.lines);e.splice.apply(e,d),e[r]=l.substring(0,a)+e[r],e[r+t.lines.length-1]+=l.substring(a)}break;case"remove":var h=t.end.column,p=t.end.row;r===p?e[r]=l.substring(0,a)+l.substring(h):e.splice(r,p-r+1,l.substring(0,a)+e[p].substring(h))}}})),ace.define("ace/anchor",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/event_emitter").EventEmitter,l=t.Anchor=function(e,t,n){this.$onChange=this.onChange.bind(this),this.attach(e),void 0===n?this.setPosition(t.row,t.column):this.setPosition(t,n)};(function(){function e(e,t,n){var r=n?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&r}r.implement(this,a),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(t){if(!(t.start.row==t.end.row&&t.start.row!=this.row||t.start.row>this.row)){var n=function(t,n,r){var a="insert"==t.action,l=(a?1:-1)*(t.end.row-t.start.row),d=(a?1:-1)*(t.end.column-t.start.column),h=t.start,p=a?h:t.end;if(e(n,h,r))return{row:n.row,column:n.column};if(e(p,n,!r))return{row:n.row+l,column:n.column+(n.row==p.row?d:0)};return{row:h.row,column:h.column}}(t,{row:this.row,column:this.column},this.$insertRight);this.setPosition(n.row,n.column,!0)}},this.setPosition=function(e,t,n){var r;if(r=n?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=r.row||this.column!=r.column){var a={row:this.row,column:this.column};this.row=r.row,this.column=r.column,this._signal("change",{old:a,value:r})}},this.detach=function(){this.document.off("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var n={};return e>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):e<0?(n.row=0,n.column=0):(n.row=e,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,t))),t<0&&(n.column=0),n}}).call(l.prototype)})),ace.define("ace/document",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./apply_delta").applyDelta,l=e("./lib/event_emitter").EventEmitter,d=e("./range").Range,h=e("./anchor").Anchor,p=function(e){this.$lines=[""],0===e.length?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)};(function(){r.implement(this,l),this.setValue=function(e){var t=this.getLength()-1;this.remove(new d(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new h(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},this.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{(t=this.getLines(e.start.row,e.end.row))[0]=(t[0]||"").substring(e.start.column);var n=t.length-1;e.end.row-e.start.row==n&&(t[n]=t[n].substring(0,e.end.column))}return t},this.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},this.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},this.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},this.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},this.insertInLine=function(e,t){var n=this.clippedPos(e.row,e.column),r=this.pos(e.row,e.column+t.length);return this.applyDelta({start:n,end:r,action:"insert",lines:[t]},!0),this.clonePos(r)},this.clippedPos=function(e,t){var n=this.getLength();void 0===e?e=n:e<0?e=0:e>=n&&(e=n-1,t=void 0);var r=this.getLine(e);return null==t&&(t=r.length),{row:e,column:t=Math.min(Math.max(t,0),r.length)}},this.clonePos=function(e){return{row:e.row,column:e.column}},this.pos=function(e,t){return{row:e,column:t}},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},this.insertFullLines=function(e,t){var n=0;(e=Math.min(Math.max(e,0),this.getLength()))<this.getLength()?(t=t.concat([""]),n=0):(t=[""].concat(t),e--,n=this.$lines[e].length),this.insertMergedLines({row:e,column:n},t)},this.insertMergedLines=function(e,t){var n=this.clippedPos(e.row,e.column),r={row:n.row+t.length-1,column:(1==t.length?n.column:0)+t[t.length-1].length};return this.applyDelta({start:n,end:r,action:"insert",lines:t}),this.clonePos(r)},this.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),n=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:n,action:"remove",lines:this.getLinesForRange({start:t,end:n})}),this.clonePos(t)},this.removeInLine=function(e,t,n){var r=this.clippedPos(e,t),a=this.clippedPos(e,n);return this.applyDelta({start:r,end:a,action:"remove",lines:this.getLinesForRange({start:r,end:a})},!0),this.clonePos(r)},this.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1);var n=(t=Math.min(Math.max(0,t),this.getLength()-1))==this.getLength()-1&&e>0,r=t<this.getLength()-1,a=n?e-1:e,l=n?this.getLine(a).length:0,h=r?t+1:t,p=r?0:this.getLine(h).length,f=new d(a,l,h,p),y=this.$lines.slice(e,t+1);return this.applyDelta({start:f.start,end:f.end,action:"remove",lines:this.getLinesForRange(f)}),y},this.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},this.replace=function(e,t){return e instanceof d||(e=d.fromPoints(e.start,e.end)),0===t.length&&e.isEmpty()?e.start:t==this.getTextRange(e)?e.end:(this.remove(e),t?this.insert(e.start,t):e.start)},this.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,t){var n="insert"==e.action;(n?e.lines.length<=1&&!e.lines[0]:!d.comparePoints(e.start,e.end))||(n&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(a(this.$lines,e,t),this._signal("change",e)))},this.$safeApplyDelta=function(e){var t=this.$lines.length;("remove"==e.action&&e.start.row<t&&e.end.row<t||"insert"==e.action&&e.start.row<=t)&&this.applyDelta(e)},this.$splitAndapplyLargeDelta=function(e,t){for(var n=e.lines,r=n.length-t+1,a=e.start.row,l=e.start.column,d=0,h=0;d<r;d=h){h+=t-1;var p=n.slice(d,h);p.push(""),this.applyDelta({start:this.pos(a+d,l),end:this.pos(a+h,l=0),action:e.action,lines:p},!0)}e.lines=n.slice(d),e.start.row=a+d,e.start.column=l,this.applyDelta(e,!0)},this.revertDelta=function(e){this.$safeApplyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:"insert"==e.action?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){for(var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,a=t||0,l=n.length;a<l;a++)if((e-=n[a].length+r)<0)return{row:a,column:e+n[a].length+r};return{row:l-1,column:e+n[l-1].length+r}},this.positionToIndex=function(e,t){for(var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,a=0,l=Math.min(e.row,n.length),d=t||0;d<l;++d)a+=n[d].length+r;return a+e.column}}).call(p.prototype),t.Document=p})),ace.define("ace/background_tokenizer",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/event_emitter").EventEmitter,l=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(n.running){for(var e=new Date,t=n.currentLine,r=-1,a=n.doc,l=t;n.lines[t];)t++;var d=a.getLength(),h=0;for(n.running=!1;t<d;){n.$tokenizeRow(t),r=t;do{t++}while(n.lines[t]);if(++h%5==0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,-1==r&&(r=t),l<=r&&n.fireUpdateEvent(l,r)}}};(function(){r.implement(this,a),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.lines[t]=null;else if("remove"==e.action)this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.lines.splice.apply(this.lines,r),this.states.splice.apply(this.states,r)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.states[e-1],r=this.tokenizer.getLineTokens(t,n,e);return this.states[e]+""!=r.state+""?(this.states[e]=r.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=r.tokens}}).call(l.prototype),t.BackgroundTokenizer=l})),ace.define("ace/search_highlight",[],(function(e,t,n){"use strict";var r=e("./lib/lang"),a=(e("./lib/oop"),e("./range").Range),l=function(e,t,n){this.setRegexp(e),this.clazz=t,this.type=n||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,n,l){if(this.regExp)for(var d=l.firstRow,h=l.lastRow,p=d;p<=h;p++){var f=this.cache[p];null==f&&((f=r.getMatchOffsets(n.getLine(p),this.regExp)).length>this.MAX_RANGES&&(f=f.slice(0,this.MAX_RANGES)),f=f.map((function(e){return new a(p,e.offset,p,e.offset+e.length)})),this.cache[p]=f.length?f:"");for(var y=f.length;y--;)t.drawSingleLineMarker(e,f[y].toScreenRange(n),this.clazz,l)}}}).call(l.prototype),t.SearchHighlight=l})),ace.define("ace/edit_session/fold_line",[],(function(e,t,n){"use strict";var r=e("../range").Range;function a(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var n=t[t.length-1];this.range=new r(t[0].start.row,t[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(e){e.setFoldLine(this)}),this)}(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach((function(t){t.start.row+=e,t.end.row+=e}))},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort((function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)})),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,n){var r,a,l=0,d=this.folds,h=!0;null==t&&(t=this.end.row,n=this.end.column);for(var p=0;p<d.length;p++){if(-1==(a=(r=d[p]).range.compareStart(t,n)))return void e(null,t,n,l,h);if(!e(null,r.start.row,r.start.column,l,h)&&e(r.placeholder,r.start.row,r.start.column,l)||0===a)return;h=!r.sameRow,l=r.end.column}e(null,t,n,l,h)},this.getNextFoldTo=function(e,t){for(var n,r,a=0;a<this.folds.length;a++){if(-1==(r=(n=this.folds[a]).range.compareEnd(e,t)))return{fold:n,kind:"after"};if(0===r)return{fold:n,kind:"inside"}}return null},this.addRemoveChars=function(e,t,n){var r,a,l=this.getNextFoldTo(e,t);if(l)if(r=l.fold,"inside"==l.kind&&r.start.column!=t&&r.start.row!=e)window.console&&window.console.log(e,t,r);else if(r.start.row==e){var d=(a=this.folds).indexOf(r);for(0===d&&(this.start.column+=n);d<a.length;d++){if((r=a[d]).start.column+=n,!r.sameRow)return;r.end.column+=n}this.end.column+=n}},this.split=function(e,t){var n=this.getNextFoldTo(e,t);if(!n||"inside"==n.kind)return null;var r=n.fold,l=this.folds,d=this.foldData,h=l.indexOf(r),p=l[h-1];this.end.row=p.end.row,this.end.column=p.end.column;var f=new a(d,l=l.splice(h,l.length-h));return d.splice(d.indexOf(this)+1,0,f),f},this.merge=function(e){for(var t=e.folds,n=0;n<t.length;n++)this.addFold(t[n]);var r=this.foldData;r.splice(r.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach((function(t){e.push("  "+t.toString())})),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t=0,n=0;n<this.folds.length;n++){var r=this.folds[n];if((e-=r.start.column-t)<0)return{row:r.start.row,column:r.start.column+e};if((e-=r.placeholder.length)<0)return r.start;t=r.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(a.prototype),t.FoldLine=a})),ace.define("ace/range_list",[],(function(e,t,n){"use strict";var r=e("./range").Range.comparePoints,a=function(){this.ranges=[],this.$bias=1};(function(){this.comparePoints=r,this.pointIndex=function(e,t,n){for(var a=this.ranges,l=n||0;l<a.length;l++){var d=a[l],h=r(e,d.end);if(!(h>0)){var p=r(e,d.start);return 0===h?t&&0!==p?-l-2:l:p>0||0===p&&!t?l:-l-1}}return-l-1},this.add=function(e){var t=!e.isEmpty(),n=this.pointIndex(e.start,t);n<0&&(n=-n-1);var r=this.pointIndex(e.end,t,n);return r<0?r=-r-1:r++,this.ranges.splice(n,r-n,e)},this.addList=function(e){for(var t=[],n=e.length;n--;)t.push.apply(t,this.add(e[n]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){for(var e,t=[],n=this.ranges,a=(n=n.sort((function(e,t){return r(e.start,t.start)})))[0],l=1;l<n.length;l++){e=a,a=n[l];var d=r(e.end,a.start);d<0||(0!=d||e.isEmpty()||a.isEmpty())&&(r(e.end,a.end)<0&&(e.end.row=a.end.row,e.end.column=a.end.column),n.splice(l,1),t.push(a),a=e,l--)}return this.ranges=n,t},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},this.clipRows=function(e,t){var n=this.ranges;if(n[0].start.row>t||n[n.length-1].start.row<e)return[];var r=this.pointIndex({row:e,column:0});r<0&&(r=-r-1);var a=this.pointIndex({row:t,column:0},r);a<0&&(a=-a-1);for(var l=[],d=r;d<a;d++)l.push(n[d]);return l},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){for(var t=e.start,n=e.end,r=t.row,a=n.row,l=this.ranges,d=0,h=l.length;d<h;d++){if((y=l[d]).end.row>=r)break}if("insert"==e.action)for(var p=a-r,f=-t.column+n.column;d<h;d++){if((y=l[d]).start.row>r)break;if(y.start.row==r&&y.start.column>=t.column&&(y.start.column==t.column&&this.$bias<=0||(y.start.column+=f,y.start.row+=p)),y.end.row==r&&y.end.column>=t.column){if(y.end.column==t.column&&this.$bias<0)continue;y.end.column==t.column&&f>0&&d<h-1&&y.end.column>y.start.column&&y.end.column==l[d+1].start.column&&(y.end.column-=f),y.end.column+=f,y.end.row+=p}}else for(p=r-a,f=t.column-n.column;d<h;d++){if((y=l[d]).start.row>a)break;y.end.row<a&&(r<y.end.row||r==y.end.row&&t.column<y.end.column)?(y.end.row=r,y.end.column=t.column):y.end.row==a?y.end.column<=n.column?(p||y.end.column>t.column)&&(y.end.column=t.column,y.end.row=t.row):(y.end.column+=f,y.end.row+=p):y.end.row>a&&(y.end.row+=p),y.start.row<a&&(r<y.start.row||r==y.start.row&&t.column<y.start.column)?(y.start.row=r,y.start.column=t.column):y.start.row==a?y.start.column<=n.column?(p||y.start.column>t.column)&&(y.start.column=t.column,y.start.row=t.row):(y.start.column+=f,y.start.row+=p):y.start.row>a&&(y.start.row+=p)}if(0!=p&&d<h)for(;d<h;d++){var y;(y=l[d]).start.row+=p,y.end.row+=p}}}).call(a.prototype),t.RangeList=a})),ace.define("ace/edit_session/fold",[],(function(e,t,n){"use strict";var r=e("../range_list").RangeList,a=e("../lib/oop"),l=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};function d(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function h(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}a.inherits(l,r),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach((function(t){t.setFoldLine(e)}))},this.clone=function(){var e=this.range.clone(),t=new l(e,this.placeholder);return this.subFolds.forEach((function(e){t.subFolds.push(e.clone())})),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){var t,n;t=e,n=this.start,d(t.start,n),d(t.end,n);for(var r=e.start.row,a=e.start.column,l=0,h=-1;l<this.subFolds.length&&1==(h=this.subFolds[l].range.compare(r,a));l++);var p=this.subFolds[l],f=0;if(0==h){if(p.range.containsRange(e))return p.addSubFold(e);f=1}r=e.range.end.row,a=e.range.end.column;var y=l;for(h=-1;y<this.subFolds.length&&1==(h=this.subFolds[y].range.compare(r,a));y++);0==h&&y++;for(var w=this.subFolds.splice(l,y-l,e),x=0==h?w.length-1:w.length,j=f;j<x;j++)e.addSubFold(w[j]);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return function(e,t){h(e.start,t),h(e.end,t)}(e,this.start)}}.call(l.prototype)})),ace.define("ace/edit_session/folding",[],(function(e,t,n){"use strict";var r=e("../range").Range,a=e("./fold_line").FoldLine,l=e("./fold").Fold,d=e("../token_iterator").TokenIterator;t.Folding=function(){this.getFoldAt=function(e,t,n){var r=this.getFoldLine(e);if(!r)return null;for(var a=r.folds,l=0;l<a.length;l++){var d=a[l].range;if(d.contains(e,t)){if(1==n&&d.isEnd(e,t)&&!d.isEmpty())continue;if(-1==n&&d.isStart(e,t)&&!d.isEmpty())continue;return a[l]}}},this.getFoldsInRange=function(e){var t=e.start,n=e.end,r=this.$foldData,a=[];t.column+=1,n.column-=1;for(var l=0;l<r.length;l++){var d=r[l].range.compareRange(e);if(2!=d){if(-2==d)break;for(var h=r[l].folds,p=0;p<h.length;p++){var f=h[p];if(-2==(d=f.range.compareRange(e)))break;if(2!=d){if(42==d)break;a.push(f)}}}}return t.column-=1,n.column+=1,a},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach((function(e){t=t.concat(this.getFoldsInRange(e))}),this)}else t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,n=0;n<t.length;n++)for(var r=0;r<t[n].folds.length;r++)e.push(t[n].folds[r]);return e},this.getFoldStringAt=function(e,t,n,r){if(!(r=r||this.getFoldLine(e)))return null;for(var a,l,d={end:{column:0}},h=0;h<r.folds.length;h++){var p=(l=r.folds[h]).range.compareEnd(e,t);if(-1==p){a=this.getLine(l.start.row).substring(d.end.column,l.start.column);break}if(0===p)return null;d=l}return a||(a=this.getLine(l.start.row).substring(d.end.column)),-1==n?a.substring(0,t-d.end.column):1==n?a.substring(t-d.end.column):a},this.getFoldLine=function(e,t){var n=this.$foldData,r=0;for(t&&(r=n.indexOf(t)),-1==r&&(r=0);r<n.length;r++){var a=n[r];if(a.start.row<=e&&a.end.row>=e)return a;if(a.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var n=this.$foldData,r=0;for(t&&(r=n.indexOf(t)),-1==r&&(r=0);r<n.length;r++){var a=n[r];if(a.end.row>=e)return a}return null},this.getFoldedRowCount=function(e,t){for(var n=this.$foldData,r=t-e+1,a=0;a<n.length;a++){var l=n[a],d=l.end.row,h=l.start.row;if(d>=t){h<t&&(h>=e?r-=t-h:r=0);break}d>=e&&(r-=h>=e?d-h:d-e+1)}return r},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort((function(e,t){return e.start.row-t.start.row})),e},this.addFold=function(e,t){var n,r=this.$foldData,d=!1;e instanceof l?n=e:(n=new l(t,e)).collapseChildren=t.collapseChildren,this.$clipRangeToDocument(n.range);var h=n.start.row,p=n.start.column,f=n.end.row,y=n.end.column,w=this.getFoldAt(h,p,1),x=this.getFoldAt(f,y,-1);if(w&&x==w)return w.addSubFold(n);w&&!w.range.isStart(h,p)&&this.removeFold(w),x&&!x.range.isEnd(f,y)&&this.removeFold(x);var j=this.getFoldsInRange(n.range);j.length>0&&(this.removeFolds(j),n.collapseChildren||j.forEach((function(e){n.addSubFold(e)})));for(var O=0;O<r.length;O++){var C=r[O];if(f==C.start.row){C.addFold(n),d=!0;break}if(h==C.end.row){if(C.addFold(n),d=!0,!n.sameRow){var S=r[O+1];if(S&&S.start.row==f){C.merge(S);break}}break}if(f<=C.start.row)break}return d||(C=this.$addFoldLine(new a(this.$foldData,n))),this.$useWrapMode?this.$updateWrapData(C.start.row,C.start.row):this.$updateRowLengthCache(C.start.row,C.start.row),this.$modified=!0,this._signal("changeFold",{data:n,action:"add"}),n},this.addFolds=function(e){e.forEach((function(e){this.addFold(e)}),this)},this.removeFold=function(e){var t=e.foldLine,n=t.start.row,r=t.end.row,a=this.$foldData,l=t.folds;if(1==l.length)a.splice(a.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))l.pop(),t.end.row=l[l.length-1].end.row,t.end.column=l[l.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))l.shift(),t.start.row=l[0].start.row,t.start.column=l[0].start.column;else if(e.sameRow)l.splice(l.indexOf(e),1);else{var d=t.split(e.start.row,e.start.column);(l=d.folds).shift(),d.start.row=l[0].start.row,d.start.column=l[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(n,r):this.$updateRowLengthCache(n,r)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);t.forEach((function(e){this.removeFold(e)}),this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach((function(t){e.restoreRange(t),this.addFold(t)}),this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach((function(e){this.expandFold(e)}),this)},this.unfold=function(e,t){var n,a;if(null==e?(n=new r(0,0,this.getLength(),0),null==t&&(t=!0)):n="number"==typeof e?new r(e,0,e,this.getLine(e).length):"row"in e?r.fromPoints(e,e):e,a=this.getFoldsInRangeList(n),0!=t?this.removeFolds(a):this.expandFolds(a),a.length)return a},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var n=this.getFoldLine(e,t);return n?n.end.row:e},this.getRowFoldStart=function(e,t){var n=this.getFoldLine(e,t);return n?n.start.row:e},this.getFoldDisplayLine=function(e,t,n,r,a){null==r&&(r=e.start.row),null==a&&(a=0),null==t&&(t=e.end.row),null==n&&(n=this.getLine(t).length);var l=this.doc,d="";return e.walk((function(e,t,n,h){if(!(t<r)){if(t==r){if(n<a)return;h=Math.max(a,h)}d+=null!=e?e:l.getLine(t).substring(h,n)}}),t,n),d},this.getDisplayLine=function(e,t,n,r){var a,l=this.getFoldLine(e);return l?this.getFoldDisplayLine(l,e,t,n,r):(a=this.doc.getLine(e)).substring(r||0,t||a.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map((function(t){var n=t.folds.map((function(e){return e.clone()}));return new a(e,n)}))},this.toggleFold=function(e){var t,n,r=this.selection.getRange();if(r.isEmpty()){var a=r.start;if(t=this.getFoldAt(a.row,a.column))return void this.expandFold(t);(n=this.findMatchingBracket(a))?1==r.comparePoint(n)?r.end=n:(r.start=n,r.start.column++,r.end.column--):(n=this.findMatchingBracket({row:a.row,column:a.column+1}))?(1==r.comparePoint(n)?r.end=n:r.start=n,r.start.column++):r=this.getCommentFoldRange(a.row,a.column)||r}else{var l=this.getFoldsInRange(r);if(e&&l.length)return void this.expandFolds(l);1==l.length&&(t=l[0])}if(t||(t=this.getFoldAt(r.start.row,r.start.column)),t&&t.range.toString()==r.toString())this.expandFold(t);else{var d="...";if(!r.isMultiLine()){if((d=this.getTextRange(r)).length<4)return;d=d.trim().substring(0,2)+".."}this.addFold(d,r)}},this.getCommentFoldRange=function(e,t,n){var a=new d(this,e,t),l=a.getCurrentToken(),h=l&&l.type;if(l&&/^comment|string/.test(h)){"comment"==(h=h.match(/comment|string/)[0])&&(h+="|doc-start");var p=new RegExp(h),f=new r;if(1!=n){do{l=a.stepBackward()}while(l&&p.test(l.type));a.stepForward()}if(f.start.row=a.getCurrentTokenRow(),f.start.column=a.getCurrentTokenColumn()+2,a=new d(this,e,t),-1!=n){var y=-1;do{if(l=a.stepForward(),-1==y){var w=this.getState(a.$row);p.test(w)||(y=a.$row)}else if(a.$row>y)break}while(l&&p.test(l.type));l=a.stepBackward()}else l=a.getCurrentToken();return f.end.row=a.getCurrentTokenRow(),f.end.column=a.getCurrentTokenColumn()+l.value.length-2,f}},this.foldAll=function(e,t,n,r){null==n&&(n=1e5);var a=this.foldWidgets;if(a){t=t||this.getLength();for(var l=e=e||0;l<t;l++)if(null==a[l]&&(a[l]=this.getFoldWidget(l)),"start"==a[l]&&(!r||r(l))){var d=this.getFoldWidgetRange(l);d&&d.isMultiLine()&&d.end.row<=t&&d.start.row>=e&&(l=d.end.row,d.collapseChildren=n,this.addFold("...",d))}}},this.foldToLevel=function(e){for(this.foldAll();e-- >0;)this.unfold(null,!1)},this.foldAllComments=function(){var e=this;this.foldAll(null,null,null,(function(t){for(var n=e.getTokens(t),r=0;r<n.length;r++){var a=n[r];if("text"!=a.type||!/^\s+$/.test(a.value))return!!/comment/.test(a.type)}}))},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var n=this.foldWidgets;if(!n||t&&n[e])return{};for(var r,a=e-1;a>=0;){var l=n[a];if(null==l&&(l=n[a]=this.getFoldWidget(a)),"start"==l){var d=this.getFoldWidgetRange(a);if(r||(r=d),d&&d.end.row>=e)break}a--}return{range:-1!==a&&d,firstRange:r}},this.onFoldWidgetClick=function(e,t){var n={children:(t=t.domEvent).shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey};if(!this.$toggleFoldWidget(e,n)){var r=t.target||t.srcElement;r&&/ace_fold-widget/.test(r.className)&&(r.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var n=this.getFoldWidget(e),r=this.getLine(e),a="end"===n?-1:1,l=this.getFoldAt(e,-1===a?0:r.length,a);if(l)return t.children||t.all?this.removeFold(l):this.expandFold(l),l;var d=this.getFoldWidgetRange(e,!0);if(d&&!d.isMultiLine()&&(l=this.getFoldAt(d.start.row,d.start.column,1))&&d.isEqual(l.range))return this.removeFold(l),l;if(t.siblings){var h=this.getParentFoldRangeData(e);if(h.range)var p=h.range.start.row+1,f=h.range.end.row;this.foldAll(p,f,t.all?1e4:0)}else t.children?(f=d?d.end.row:this.getLength(),this.foldAll(e+1,f,t.all?1e4:0)):d&&(t.all&&(d.collapseChildren=1e4),this.addFold("...",d));return d}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var n=this.$toggleFoldWidget(t,{});if(!n){var r=this.getParentFoldRangeData(t,!0);if(n=r.range||r.firstRange){t=n.start.row;var a=this.getFoldAt(t,this.getLine(t).length,1);a?this.removeFold(a):this.addFold("...",n)}}},this.updateFoldWidgets=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.foldWidgets[t]=null;else if("remove"==e.action)this.foldWidgets.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,r)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",[],(function(e,t,n){"use strict";var r=e("../token_iterator").TokenIterator,a=e("../range").Range;t.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var n=t||this.getLine(e.row).charAt(e.column-1);if(""==n)return null;var r=n.match(/([\(\[\{])|([\)\]\}])/);return r?r[1]?this.$findClosingBracket(r[1],e):this.$findOpeningBracket(r[2],e):null},this.getBracketRange=function(e){var t,n=this.getLine(e.row),r=!0,l=n.charAt(e.column-1),d=l&&l.match(/([\(\[\{])|([\)\]\}])/);if(d||(l=n.charAt(e.column),e={row:e.row,column:e.column+1},d=l&&l.match(/([\(\[\{])|([\)\]\}])/),r=!1),!d)return null;if(d[1]){if(!(h=this.$findClosingBracket(d[1],e)))return null;t=a.fromPoints(e,h),r||(t.end.column++,t.start.column--),t.cursor=t.end}else{var h;if(!(h=this.$findOpeningBracket(d[2],e)))return null;t=a.fromPoints(h,e),r||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.getMatchingBracketRanges=function(e){var t=this.getLine(e.row),n=t.charAt(e.column-1),r=n&&n.match(/([\(\[\{])|([\)\]\}])/);if(r||(n=t.charAt(e.column),e={row:e.row,column:e.column+1},r=n&&n.match(/([\(\[\{])|([\)\]\}])/)),!r)return null;var l=new a(e.row,e.column-1,e.row,e.column),d=r[1]?this.$findClosingBracket(r[1],e):this.$findOpeningBracket(r[2],e);return d?[l,new a(d.row,d.column,d.row,d.column+1)]:[l]},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(e,t,n){var a=this.$brackets[e],l=1,d=new r(this,t.row,t.column),h=d.getCurrentToken();if(h||(h=d.stepForward()),h){n||(n=new RegExp("(\\.?"+h.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var p=t.column-d.getCurrentTokenColumn()-2,f=h.value;;){for(;p>=0;){var y=f.charAt(p);if(y==a){if(0==(l-=1))return{row:d.getCurrentTokenRow(),column:p+d.getCurrentTokenColumn()}}else y==e&&(l+=1);p-=1}do{h=d.stepBackward()}while(h&&!n.test(h.type));if(null==h)break;p=(f=h.value).length-1}return null}},this.$findClosingBracket=function(e,t,n){var a=this.$brackets[e],l=1,d=new r(this,t.row,t.column),h=d.getCurrentToken();if(h||(h=d.stepForward()),h){n||(n=new RegExp("(\\.?"+h.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var p=t.column-d.getCurrentTokenColumn();;){for(var f=h.value,y=f.length;p<y;){var w=f.charAt(p);if(w==a){if(0==(l-=1))return{row:d.getCurrentTokenRow(),column:p+d.getCurrentTokenColumn()}}else w==e&&(l+=1);p+=1}do{h=d.stepForward()}while(h&&!n.test(h.type));if(null==h)break;p=0}return null}}}})),ace.define("ace/edit_session",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/lang"),l=e("./bidihandler").BidiHandler,d=e("./config"),h=e("./lib/event_emitter").EventEmitter,p=e("./selection").Selection,f=e("./mode/text").Mode,y=e("./range").Range,w=e("./document").Document,x=e("./background_tokenizer").BackgroundTokenizer,j=e("./search_highlight").SearchHighlight,O=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++O.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new w(e)),this.setDocument(e),this.selection=new p(this),this.$bidiHandler=new l(this),d.resetOptions(this),this.setMode(t),d._signal("session",this)};O.$uid=0,function(){r.implement(this,h),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,n=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>n&&(this.$docRowCache.splice(n,t),this.$screenRowCache.splice(n,t))},this.$getRowCacheIndex=function(e,t){for(var n=0,r=e.length-1;n<=r;){var a=n+r>>1,l=e[a];if(t>l)n=a+1;else{if(!(t<l))return a;r=a-1}}return n-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var n,r=this.bgTokenizer.getTokens(e),a=0;if(null==t){var l=r.length-1;a=this.getLine(e).length}else for(l=0;l<r.length&&!((a+=r[l].value.length)>=t);l++);return(n=r[l])?(n.index=l,n.start=a-n.value.length,n):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;e.addSession(this),this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.mergeUndoDeltas=!1},this.$informUndoManager=a.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},hasUndo:function(){},hasRedo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?a.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,n,r){var a=this.$markerId++,l={range:e,type:n||"line",renderer:"function"==typeof n?n:null,clazz:t,inFront:!!r,id:a};return r?(this.$frontMarkers[a]=l,this._signal("changeFrontMarker")):(this.$backMarkers[a]=l,this._signal("changeBackMarker")),a},this.addDynamicMarker=function(e,t){if(e.update){var n=this.$markerId++;return e.id=n,e.inFront=!!t,t?(this.$frontMarkers[n]=e,this._signal("changeFrontMarker")):(this.$backMarkers[n]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];t&&(delete(t.inFront?this.$frontMarkers:this.$backMarkers)[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new j(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,n,r){"number"!=typeof t&&(n=t,t=e),n||(n="ace_step");var a=new y(e,0,t,1/0);return a.id=this.addMarker(a,n,"fullLine",r),a},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getWordRange=function(e,t){var n=this.getLine(e),r=!1;if(t>0&&(r=!!n.charAt(t-1).match(this.tokenRe)),r||(r=!!n.charAt(t).match(this.tokenRe)),r)var a=this.tokenRe;else if(/^\s+$/.test(n.slice(t-1,t+1)))a=/\s/;else a=this.nonTokenRe;var l=t;if(l>0){do{l--}while(l>=0&&n.charAt(l).match(a));l++}for(var d=t;d<n.length&&n.charAt(d).match(a);)d++;return new y(e,l,e,d)},this.getAWordRange=function(e,t){for(var n=this.getWordRange(e,t),r=this.getLine(n.end.row);r.charAt(n.end.column).match(/[ \t]/);)n.end.column+=1;return n},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes=d.$modes,this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var n=e,r=n.path}else r=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new f),this.$modes[r]&&!n)return this.$onChangeMode(this.$modes[r]),void(t&&t());this.$modeId=r,d.loadModule(["mode",r],function(e){if(this.$modeId!==r)return t&&t();this.$modes[r]&&!n?this.$onChangeMode(this.$modes[r]):e&&e.Mode&&(e=new e.Mode(n),n||(this.$modes[r]=e,e.$id=r),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){var n=this.$mode;this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var r=e.getTokenizer();if(void 0!==r.on){var a=this.onReloadTokenizer.bind(this);r.on("update",a)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(r);else{this.bgTokenizer=new x(r);var l=this;this.bgTokenizer.on("update",(function(e){l._signal("tokenizerUpdate",e)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode",{oldMode:n,mode:e}))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){d.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach((function(t){t&&t.screenWidth>e&&(e=t.screenWidth)})),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),n=this.$rowLengthCache,r=0,a=0,l=this.$foldData[a],d=l?l.start.row:1/0,h=t.length,p=0;p<h;p++){if(p>d){if((p=l.end.row+1)>=h)break;d=(l=this.$foldData[a++])?l.start.row:1/0}null==n[p]&&(n[p]=this.$getStringScreenWidth(t[p])[0]),n[p]>r&&(r=n[p])}this.screenWidth=r}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=e.length-1;-1!=n;n--){var r=e[n];"insert"==r.action||"remove"==r.action?this.doc.revertDelta(r):r.folds&&this.addFolds(r.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=0;n<e.length;n++){var r=e[n];"insert"!=r.action&&"remove"!=r.action||this.doc.$safeApplyDelta(r)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t){function n(e){return t?"insert"!==e.action:"insert"===e.action}for(var r,a,l=0;l<e.length;l++){var d=e[l];d.start&&(r?n(d)?(a=d.start,-1==r.compare(a.row,a.column)&&r.setStart(a),a=d.end,1==r.compare(a.row,a.column)&&r.setEnd(a)):(a=d.start,-1==r.compare(a.row,a.column)&&(r=y.fromPoints(d.start,d.start))):r=n(d)?y.fromPoints(d.start,d.end):y.fromPoints(d.start,d.start))}return r},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,n){var r=this.getTextRange(e),a=this.getFoldsInRange(e),l=y.fromPoints(t,t);if(!n){this.remove(e);var d=e.start.row-e.end.row;(f=d?-e.end.column:e.start.column-e.end.column)&&(l.start.row==e.end.row&&l.start.column>e.end.column&&(l.start.column+=f),l.end.row==e.end.row&&l.end.column>e.end.column&&(l.end.column+=f)),d&&l.start.row>=e.end.row&&(l.start.row+=d,l.end.row+=d)}if(l.end=this.insert(l.start,r),a.length){var h=e.start,p=l.start,f=(d=p.row-h.row,p.column-h.column);this.addFolds(a.map((function(e){return(e=e.clone()).start.row==h.row&&(e.start.column+=f),e.end.row==h.row&&(e.end.column+=f),e.start.row+=d,e.end.row+=d,e})))}return l},this.indentRows=function(e,t,n){n=n.replace(/\t/g,this.getTabString());for(var r=e;r<=t;r++)this.doc.insertInLine({row:r,column:0},n)},this.outdentRows=function(e){for(var t=e.collapseRows(),n=new y(0,0,0,0),r=this.getTabSize(),a=t.start.row;a<=t.end.row;++a){var l=this.getLine(a);n.start.row=a,n.end.row=a;for(var d=0;d<r&&" "==l.charAt(d);++d);d<r&&"\t"==l.charAt(d)?(n.start.column=d,n.end.column=d+1):(n.start.column=0,n.end.column=d),this.remove(n)}},this.$moveLines=function(e,t,n){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),n<0){if((a=this.getRowFoldStart(e+n))<0)return 0;var r=a-e}else if(n>0){var a;if((a=this.getRowFoldEnd(t+n))>this.doc.getLength()-1)return 0;r=a-t}else{e=this.$clipRowToDocument(e);r=(t=this.$clipRowToDocument(t))-e+1}var l=new y(e,0,t,Number.MAX_VALUE),d=this.getFoldsInRange(l).map((function(e){return(e=e.clone()).start.row+=r,e.end.row+=r,e})),h=0==n?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+r,h),d.length&&this.addFolds(d),r},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)e=0,t=0;else{var n=this.doc.getLength();e>=n?(e=n-1,t=this.doc.getLine(n-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var n=this.$wrapLimitRange;n.max<0&&(n={min:t,max:t});var r=this.$constrainWrapLimit(e,n.min,n.max);return r!=this.$wrapLimit&&r>1&&(this.$wrapLimit=r,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(e,t,n){return t&&(e=Math.max(t,e)),n&&(e=Math.min(n,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,n=e.action,r=e.start,a=e.end,l=r.row,d=a.row,h=d-l,p=null;if(this.$updating=!0,0!=h)if("remove"===n){this[t?"$wrapData":"$rowLengthCache"].splice(l,h);var f=this.$foldData;p=this.getFoldsInRange(e),this.removeFolds(p);var y=0;if(C=this.getFoldLine(a.row)){C.addRemoveChars(a.row,a.column,r.column-a.column),C.shiftRow(-h);var w=this.getFoldLine(l);w&&w!==C&&(w.merge(C),C=w),y=f.indexOf(C)+1}for(;y<f.length;y++){(C=f[y]).start.row>=a.row&&C.shiftRow(-h)}d=l}else{var x=Array(h);x.unshift(l,0);var j=t?this.$wrapData:this.$rowLengthCache;j.splice.apply(j,x);f=this.$foldData,y=0;if(C=this.getFoldLine(l)){var O=C.range.compareInside(r.row,r.column);0==O?(C=C.split(r.row,r.column))&&(C.shiftRow(h),C.addRemoveChars(d,0,a.column-r.column)):-1==O&&(C.addRemoveChars(l,0,a.column-r.column),C.shiftRow(h)),y=f.indexOf(C)+1}for(;y<f.length;y++){var C;(C=f[y]).start.row>=l&&C.shiftRow(h)}}else h=Math.abs(e.start.column-e.end.column),"remove"===n&&(p=this.getFoldsInRange(e),this.removeFolds(p),h=-h),(C=this.getFoldLine(l))&&C.addRemoveChars(l,r.column,h);return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(l,d):this.$updateRowLengthCache(l,d),p},this.$updateRowLengthCache=function(e,t,n){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(n,r){var a,l,d=this.doc.getAllLines(),h=this.getTabSize(),p=this.$wrapData,f=this.$wrapLimit,y=n;for(r=Math.min(r,d.length-1);y<=r;)(l=this.getFoldLine(y,l))?(a=[],l.walk(function(n,r,l,h){var p;if(null!=n){(p=this.$getDisplayTokens(n,a.length))[0]=e;for(var f=1;f<p.length;f++)p[f]=t}else p=this.$getDisplayTokens(d[r].substring(h,l),a.length);a=a.concat(p)}.bind(this),l.end.row,d[l.end.row].length+1),p[l.start.row]=this.$computeWrapSplits(a,f,h),y=l.end.row+1):(a=this.$getDisplayTokens(d[y]),p[y]=this.$computeWrapSplits(a,f,h),y++)};var e=3,t=4;function n(e){return!(e<4352)&&(e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510)}this.$computeWrapSplits=function(n,r,a){if(0==n.length)return[];var l=[],d=n.length,h=0,p=0,f=this.$wrapAsCode,y=this.$indentedSoftWrap,w=r<=Math.max(2*a,8)||!1===y?0:Math.floor(r/2);function x(e){for(var t=e-h,r=h;r<e;r++){var d=n[r];12!==d&&2!==d||(t-=1)}l.length||(j=function(){var e=0;if(0===w)return e;if(y)for(var t=0;t<n.length;t++){var r=n[t];if(10==r)e+=1;else{if(11!=r){if(12==r)continue;break}e+=a}}return f&&!1!==y&&(e+=a),Math.min(e,w)}(),l.indent=j),p+=t,l.push(p),h=e}for(var j=0;d-h>r-j;){var O=h+r-j;if(n[O-1]>=10&&n[O]>=10)x(O);else if(n[O]!=e&&n[O]!=t){for(var C=Math.max(O-(r-(r>>2)),h-1);O>C&&n[O]<e;)O--;if(f){for(;O>C&&n[O]<e;)O--;for(;O>C&&9==n[O];)O--}else for(;O>C&&n[O]<10;)O--;O>C?x(++O):(2==n[O=h+r]&&O--,x(O-j))}else{for(;O!=h-1&&n[O]!=e;O--);if(O>h){x(O);continue}for(O=h+r;O<n.length&&n[O]==t;O++);if(O==n.length)break;x(O)}}return l},this.$getDisplayTokens=function(e,t){var r,a=[];t=t||0;for(var l=0;l<e.length;l++){var d=e.charCodeAt(l);if(9==d){r=this.getScreenTabSize(a.length+t),a.push(11);for(var h=1;h<r;h++)a.push(12)}else 32==d?a.push(10):d>39&&d<48||d>57&&d<64?a.push(9):d>=4352&&n(d)?a.push(1,2):a.push(1)}return a},this.$getStringScreenWidth=function(e,t,r){if(0==t)return[0,0];var a,l;for(null==t&&(t=1/0),r=r||0,l=0;l<e.length&&(9==(a=e.charCodeAt(l))?r+=this.getScreenTabSize(r):a>=4352&&n(a)?r+=2:r+=1,!(r>t));l++);return[r,l]},this.lineWidgets=null,this.getRowLength=function(e){var t=1;return this.lineWidgets&&(t+=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0),this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+t:t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),n=this.$wrapData[t.row];return n.length&&n[0]<t.column?n.indent:0}return 0},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var n=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(n)},this.getDocumentLastRowColumnPosition=function(e,t){var n=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(n,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-(e%this.$tabSize|0)},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t,n){if(e<0)return{row:0,column:0};var r,a,l=0,d=0,h=0,p=0,f=this.$screenRowCache,y=this.$getRowCacheIndex(f,e),w=f.length;if(w&&y>=0){h=f[y],l=this.$docRowCache[y];var x=e>f[w-1]}else x=!w;for(var j=this.getLength()-1,O=this.getNextFoldLine(l),C=O?O.start.row:1/0;h<=e&&!(h+(p=this.getRowLength(l))>e||l>=j);)h+=p,++l>C&&(l=O.end.row+1,C=(O=this.getNextFoldLine(l,O))?O.start.row:1/0),x&&(this.$docRowCache.push(l),this.$screenRowCache.push(h));if(O&&O.start.row<=l)r=this.getFoldDisplayLine(O),l=O.start.row;else{if(h+p<=e||l>j)return{row:j,column:this.getLine(j).length};r=this.getLine(l),O=null}var S=0,_=Math.floor(e-h);if(this.$useWrapMode){var k=this.$wrapData[l];k&&(a=k[_],_>0&&k.length&&(S=k.indent,d=k[_-1]||k[k.length-1],r=r.substring(d)))}return void 0!==n&&this.$bidiHandler.isBidiRow(h+_,l,_)&&(t=this.$bidiHandler.offsetToCol(n)),d+=this.$getStringScreenWidth(r,t-S)[1],this.$useWrapMode&&d>=a&&(d=a-1),O?O.idxToPosition(d):{row:l,column:d}},this.documentToScreenPosition=function(e,t){if(void 0===t)var n=this.$clipPositionToDocument(e.row,e.column);else n=this.$clipPositionToDocument(e,t);e=n.row,t=n.column;var r,a=0,l=null;(r=this.getFoldAt(e,t,1))&&(e=r.start.row,t=r.start.column);var d,h=0,p=this.$docRowCache,f=this.$getRowCacheIndex(p,e),y=p.length;if(y&&f>=0){h=p[f],a=this.$screenRowCache[f];var w=e>p[y-1]}else w=!y;for(var x=this.getNextFoldLine(h),j=x?x.start.row:1/0;h<e;){if(h>=j){if((d=x.end.row+1)>e)break;j=(x=this.getNextFoldLine(d,x))?x.start.row:1/0}else d=h+1;a+=this.getRowLength(h),h=d,w&&(this.$docRowCache.push(h),this.$screenRowCache.push(a))}var O="";x&&h>=j?(O=this.getFoldDisplayLine(x,e,t),l=x.start.row):(O=this.getLine(e).substring(0,t),l=e);var C=0;if(this.$useWrapMode){var S=this.$wrapData[l];if(S){for(var _=0;O.length>=S[_];)a++,_++;O=O.substring(S[_-1]||0,O.length),C=_>0?S.indent:0}}return this.lineWidgets&&this.lineWidgets[h]&&this.lineWidgets[h].rowsAbove&&(a+=this.lineWidgets[h].rowsAbove),{row:a,column:C+this.$getStringScreenWidth(O)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var n=this.$wrapData.length,r=0,a=(h=0,(t=this.$foldData[h++])?t.start.row:1/0);r<n;){var l=this.$wrapData[r];e+=l?l.length+1:1,++r>a&&(r=t.end.row+1,a=(t=this.$foldData[h++])?t.start.row:1/0)}else{e=this.getLength();for(var d=this.$foldData,h=0;h<d.length;h++)e-=(t=d[h]).end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){this.$enableVarChar&&(this.$getStringScreenWidth=function(t,n,r){if(0===n)return[0,0];var a,l;for(n||(n=1/0),r=r||0,l=0;l<t.length&&!((r+="\t"===(a=t.charAt(l))?this.getScreenTabSize(r):e.getCharacterWidth(a))>n);l++);return[r,l]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker(),this.removeAllListeners(),this.selection.detach()},this.isFullWidth=n}.call(O.prototype),e("./edit_session/folding").Folding.call(O.prototype),e("./edit_session/bracket_match").BracketMatch.call(O.prototype),d.defineOptions(O.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e)if(this.$wrap=e,e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){(e=parseInt(e))>0&&this.$tabSize!==e&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),t.EditSession=O})),ace.define("ace/search",[],(function(e,t,n){"use strict";var r=e("./lib/lang"),a=e("./lib/oop"),l=e("./range").Range,d=function(){this.$options={}};(function(){this.set=function(e){return a.mixin(this.$options,e),this},this.getOptions=function(){return r.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var r=null;return n.forEach((function(e,n,a,d){return r=new l(e,n,a,d),!(n==d&&t.start&&t.start.start&&0!=t.skipCurrent&&r.isEqual(t.start))||(r=null,!1)})),r},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var n=t.range,a=n?e.getLines(n.start.row,n.end.row):e.doc.getAllLines(),d=[],h=t.re;if(t.$isMultiLine){var p,f=h.length,y=a.length-f;e:for(var w=h.offset||0;w<=y;w++){for(var x=0;x<f;x++)if(-1==a[w+x].search(h[x]))continue e;var j=a[w],O=a[w+f-1],C=j.length-j.match(h[0])[0].length,S=O.match(h[f-1])[0].length;p&&p.end.row===w&&p.end.column>C||(d.push(p=new l(w,C,w+f-1,S)),f>2&&(w=w+f-2))}}else for(var _=0;_<a.length;_++){var k=r.getMatchOffsets(a[_],h);for(x=0;x<k.length;x++){var E=k[x];d.push(new l(_,E.offset,_,E.offset+E.length))}}if(n){var A=n.start.column,T=n.start.column;for(_=0,x=d.length-1;_<x&&d[_].start.column<A&&d[_].start.row==n.start.row;)_++;for(;_<x&&d[x].end.column>T&&d[x].end.row==n.end.row;)x--;for(d=d.slice(_,x+1),_=0,x=d.length;_<x;_++)d[_].start.row+=n.start.row,d[_].end.row+=n.start.row}return d},this.replace=function(e,t){var n=this.$options,r=this.$assembleRegExp(n);if(n.$isMultiLine)return t;if(r){var a=r.exec(e);if(!a||a[0].length!=e.length)return null;if(t=e.replace(r,t),n.preserveCase){t=t.split("");for(var l=Math.min(e.length,e.length);l--;){var d=e[l];d&&d.toLowerCase()!=d?t[l]=t[l].toUpperCase():t[l]=t[l].toLowerCase()}t=t.join("")}return t}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var n=e.needle;if(!e.needle)return e.re=!1;e.regExp||(n=r.escapeRegExp(n)),e.wholeWord&&(n=function(e,t){function n(e){return/\w/.test(e)||t.regExp?"\\b":""}return n(e[0])+e+n(e[e.length-1])}(n,e));var a=e.caseSensitive?"gm":"gmi";if(e.$isMultiLine=!t&&/[\n\r]/.test(n),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(n,a);try{var l=new RegExp(n,a)}catch(e){l=!1}return e.re=l},this.$assembleMultilineRegExp=function(e,t){for(var n=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),r=[],a=0;a<n.length;a++)try{r.push(new RegExp(n[a],t))}catch(e){return!1}return r},this.$matchIterator=function(e,t){var n=this.$assembleRegExp(t);if(!n)return!1;var r=1==t.backwards,a=0!=t.skipCurrent,l=t.range,d=t.start;d||(d=l?l[r?"end":"start"]:e.selection.getRange()),d.start&&(d=d[a!=r?"end":"start"]);var h=l?l.start.row:0,p=l?l.end.row:e.getLength()-1;if(r)var f=function(e){var n=d.row;if(!w(n,d.column,e)){for(n--;n>=h;n--)if(w(n,Number.MAX_VALUE,e))return;if(0!=t.wrap)for(n=p,h=d.row;n>=h;n--)if(w(n,Number.MAX_VALUE,e))return}};else f=function(e){var n=d.row;if(!w(n,d.column,e)){for(n+=1;n<=p;n++)if(w(n,0,e))return;if(0!=t.wrap)for(n=h,p=d.row;n<=p;n++)if(w(n,0,e))return}};if(t.$isMultiLine)var y=n.length,w=function(t,a,l){var d=r?t-y+1:t;if(!(d<0)){var h=e.getLine(d),p=h.search(n[0]);if(!(!r&&p<a||-1===p)){for(var f=1;f<y;f++)if(-1==(h=e.getLine(d+f)).search(n[f]))return;var w=h.match(n[y-1])[0].length;if(!(r&&w>a))return!!l(d,p,d+y-1,w)||void 0}}};else if(r)w=function(t,r,a){var l,d=e.getLine(t),h=[],p=0;for(n.lastIndex=0;l=n.exec(d);){var f=l[0].length;if(p=l.index,!f){if(p>=d.length)break;n.lastIndex=p+=1}if(l.index+f>r)break;h.push(l.index,f)}for(var y=h.length-1;y>=0;y-=2){var w=h[y-1];if(a(t,w,t,w+(f=h[y])))return!0}};else w=function(t,r,a){var l,d,h=e.getLine(t);for(n.lastIndex=r;d=n.exec(h);){var p=d[0].length;if(a(t,l=d.index,t,l+p))return!0;if(!p&&(n.lastIndex=l+=1,l>=h.length))return!1}};return{forEach:f}}}).call(d.prototype),t.Search=d})),ace.define("ace/keyboard/hash_handler",[],(function(e,t,n){"use strict";var r=e("../lib/keys"),a=e("../lib/useragent"),l=r.KEY_MODS;function d(e,t){this.platform=t||(a.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function h(e,t){d.call(this,e,t),this.$singleCommand=!1}h.prototype=d.prototype,function(){function e(e){return"object"==typeof e&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var n=e&&("string"==typeof e?e:e.name);e=this.commands[n],t||delete this.commands[n];var r=this.commandKeyBinding;for(var a in r){var l=r[a];if(l==e)delete r[a];else if(Array.isArray(l)){var d=l.indexOf(e);-1!=d&&(l.splice(d,1),1==l.length&&(r[a]=l[0]))}}},this.bindKey=function(e,t,n){if("object"==typeof e&&e&&(null==n&&(n=e.position),e=e[this.platform]),e)return"function"==typeof t?this.addCommand({exec:t,bindKey:e,name:t.name||e}):void e.split("|").forEach((function(e){var r="";if(-1!=e.indexOf(" ")){var a=e.split(/\s+/);e=a.pop(),a.forEach((function(e){var t=this.parseKeys(e),n=l[t.hashId]+t.key;r+=(r?" ":"")+n,this._addCommandToBinding(r,"chainKeys")}),this),r+=" "}var d=this.parseKeys(e),h=l[d.hashId]+d.key;this._addCommandToBinding(r+h,t,n)}),this)},this._addCommandToBinding=function(t,n,r){var a,l=this.commandKeyBinding;if(n)if(!l[t]||this.$singleCommand)l[t]=n;else{Array.isArray(l[t])?-1!=(a=l[t].indexOf(n))&&l[t].splice(a,1):l[t]=[l[t]],"number"!=typeof r&&(r=e(n));var d=l[t];for(a=0;a<d.length;a++){if(e(d[a])>r)break}d.splice(a,0,n)}else delete l[t]},this.addCommands=function(e){e&&Object.keys(e).forEach((function(t){var n=e[t];if(n){if("string"==typeof n)return this.bindKey(n,t);"function"==typeof n&&(n={exec:n}),"object"==typeof n&&(n.name||(n.name=t),this.addCommand(n))}}),this)},this.removeCommands=function(e){Object.keys(e).forEach((function(t){this.removeCommand(e[t])}),this)},this.bindKeys=function(e){Object.keys(e).forEach((function(t){this.bindKey(t,e[t])}),this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(e){return e})),n=t.pop(),a=r[n];if(r.FUNCTION_KEYS[a])n=r.FUNCTION_KEYS[a].toLowerCase();else{if(!t.length)return{key:n,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:n.toUpperCase(),hashId:-1}}for(var l=0,d=t.length;d--;){var h=r.KEY_MODS[t[d]];if(null==h)return"undefined"!=typeof console&&console.error("invalid modifier "+t[d]+" in "+e),!1;l|=h}return{key:n,hashId:l}},this.findKeyCommand=function(e,t){var n=l[e]+t;return this.commandKeyBinding[n]},this.handleKeyboard=function(e,t,n,r){if(!(r<0)){var a=l[t]+n,d=this.commandKeyBinding[a];return e.$keyChain&&(e.$keyChain+=" "+a,d=this.commandKeyBinding[e.$keyChain]||d),!d||"chainKeys"!=d&&"chainKeys"!=d[d.length-1]?(e.$keyChain&&(t&&4!=t||1!=n.length?(-1==t||r>0)&&(e.$keyChain=""):e.$keyChain=e.$keyChain.slice(0,-a.length-1)),{command:d}):(e.$keyChain=e.$keyChain||a,{command:"null"})}},this.getStatusText=function(e,t){return t.$keyChain||""}}.call(d.prototype),t.HashHandler=d,t.MultiHashHandler=h})),ace.define("ace/commands/command_manager",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),a=e("../keyboard/hash_handler").MultiHashHandler,l=e("../lib/event_emitter").EventEmitter,d=function(e,t){a.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",(function(e){return e.command.exec(e.editor,e.args||{})}))};r.inherits(d,a),function(){r.implement(this,l),this.exec=function(e,t,n){if(Array.isArray(e)){for(var r=e.length;r--;)if(this.exec(e[r],t,n))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(0!=this.$checkCommandState&&e.isAvailable&&!e.isAvailable(t))return!1;var a={editor:t,command:e,args:n};return a.returnValue=this._emit("exec",a),this._signal("afterExec",a),!1!==a.returnValue},this.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.off("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach((function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map((function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e}))}}.call(d.prototype),t.CommandManager=d})),ace.define("ace/commands/default_commands",[],(function(e,t,n){"use strict";var r=e("../lib/lang"),a=e("../config"),l=e("../range").Range;function d(e,t){return{win:e,mac:t}}t.commands=[{name:"showSettingsMenu",bindKey:d("Ctrl-,","Command-,"),exec:function(e){a.loadModule("ace/ext/settings_menu",(function(t){t.init(e),e.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:d("Alt-E","F4"),exec:function(e){a.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:d("Alt-Shift-E","Shift-F4"),exec:function(e){a.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:d("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:d(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:d("Ctrl-L","Command-L"),exec:function(e,t){"number"!=typeof t||isNaN(t)||e.gotoLine(t),e.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:d("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:d("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:d("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:d("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:d(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldAllComments",description:"Fold all comments",bindKey:d(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAllComments()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:d("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:d("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:d("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:d("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:d("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:d("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:d("Ctrl-F","Command-F"),exec:function(e){a.loadModule("ace/ext/searchbox",(function(t){t.Search(e)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:d("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:d("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:d("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:d("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:d("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:d("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:d("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:d("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:d("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:d("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:d("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:d("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:d("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:d("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:d("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:d("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:d("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:d("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:d("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:d("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:d(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:d("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:d(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:d("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:d("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:d("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:d("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:d("Ctrl-\\|Ctrl-P","Command-\\"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:d("Ctrl-Shift-\\|Ctrl-Shift-P","Command-Shift-\\"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:d("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:d(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(e){},readOnly:!0},{name:"cut",description:"Cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty()?e.selection.getLineRange():e.selection.getRange();e._emit("cut",t),t.isEmpty()||e.session.remove(t),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:d("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:d("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:d("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:d("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:d("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:d("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:d("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:d("Ctrl-H","Command-Option-F"),exec:function(e){a.loadModule("ace/ext/searchbox",(function(t){t.Search(e,!0)}))}},{name:"undo",description:"Undo",bindKey:d("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",description:"Redo",bindKey:d("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:d("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:d("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:d("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:d("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:d("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:d("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:d("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:d("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:d("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:d("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:d("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:d("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:d("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:d("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:d("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:d("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:d("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(e,t){e.insert(r.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:d(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:d("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:d("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:d("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"autoindent",description:"Auto Indent",bindKey:d(null,null),exec:function(e){e.autoIndent()},multiSelectAction:"forEachLine",scrollIntoView:"animate"},{name:"expandtoline",description:"Expand to line",bindKey:d("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",description:"Join lines",bindKey:d(null,null),exec:function(e){for(var t=e.selection.isBackwards(),n=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),a=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),d=e.session.doc.getLine(n.row).length,h=e.session.doc.getTextRange(e.selection.getRange()).replace(/\n\s*/," ").length,p=e.session.doc.getLine(n.row),f=n.row+1;f<=a.row+1;f++){var y=r.stringTrimLeft(r.stringTrimRight(e.session.doc.getLine(f)));0!==y.length&&(y=" "+y),p+=y}a.row+1<e.session.doc.getLength()-1&&(p+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new l(n.row,0,a.row+2,0),p),h>0?(e.selection.moveCursorTo(n.row,n.column),e.selection.selectTo(n.row,n.column+h)):(d=e.session.doc.getLine(n.row).length>d?d+1:d,e.selection.moveCursorTo(n.row,d))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:d(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,r=e.selection.rangeList.ranges,a=[];r.length<1&&(r=[e.selection.getRange()]);for(var d=0;d<r.length;d++)d==r.length-1&&(r[d].end.row===t&&r[d].end.column===n||a.push(new l(r[d].end.row,r[d].end.column,t,n))),0===d?0===r[d].start.row&&0===r[d].start.column||a.push(new l(0,0,r[d].start.row,r[d].start.column)):a.push(new l(r[d-1].end.row,r[d-1].end.column,r[d].start.row,r[d].start.column));e.exitMultiSelectMode(),e.clearSelection();for(d=0;d<a.length;d++)e.selection.addRange(a[d],!1)},readOnly:!0,scrollIntoView:"none"},{name:"addLineAfter",exec:function(e){e.selection.clearSelection(),e.navigateLineEnd(),e.insert("\n")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"addLineBefore",exec:function(e){e.selection.clearSelection();var t=e.getCursorPosition();e.selection.moveTo(t.row-1,Number.MAX_VALUE),e.insert("\n"),0===t.row&&e.navigateUp()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"openCommandPallete",description:"Open command pallete",bindKey:d("F1","F1"),exec:function(e){e.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:d(null,null),exec:function(e){e.prompt({$type:"modes"})},readOnly:!0}];for(var h=1;h<9;h++)t.commands.push({name:"foldToLevel"+h,description:"Fold To Level "+h,level:h,exec:function(e){e.session.foldToLevel(this.level)},scrollIntoView:"center",readOnly:!0})})),ace.define("ace/editor",[],(function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var r=e("./lib/oop"),a=e("./lib/dom"),l=e("./lib/lang"),d=e("./lib/useragent"),h=e("./keyboard/textinput").TextInput,p=e("./mouse/mouse_handler").MouseHandler,f=e("./mouse/fold_handler").FoldHandler,y=e("./keyboard/keybinding").KeyBinding,w=e("./edit_session").EditSession,x=e("./search").Search,j=e("./range").Range,O=e("./lib/event_emitter").EventEmitter,C=e("./commands/command_manager").CommandManager,S=e("./commands/default_commands").commands,_=e("./config"),k=e("./token_iterator").TokenIterator,E=e("./clipboard"),A=function(e,t,n){this.$toDestroy=[];var r=e.getContainerElement();this.container=r,this.renderer=e,this.id="editor"+ ++A.$uid,this.commands=new C(d.isMac?"mac":"win",S),"object"==typeof document&&(this.textInput=new h(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new p(this),new f(this)),this.keyBinding=new y(this),this.$search=(new x).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=l.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(e,t){t._$emitInputEvent.schedule(31)})),this.setSession(t||n&&n.session||new w("")),_.resetOptions(this),n&&this.setOptions(n),_._signal("editor",this)};A.$uid=0,function(){r.implement(this,O),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=l.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(e){if(this.curOp&&this.session){if(e&&!1===e.returnValue||!this.session)return this.curOp=null;if(1==e&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var t=this.curOp.command,n=t&&t.scrollIntoView;if(n){switch(n){case"center-animate":n="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var r=this.selection.getRange(),a=this.renderer.layerConfig;(r.start.row>=a.lastRow||r.end.row<=a.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==n&&this.renderer.animateScrolling(this.curOp.scrollTop)}var l=this.selection.toJSON();this.curOp.selectionAfter=l,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(l),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,n=this.$mergeableCommands,r=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var a=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),r=r&&this.mergeNextCommand&&(!/\s/.test(a)||/\s/.test(t.args)),this.mergeNextCommand=!0}else r=r&&-1!==n.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(r=!1),r?this.session.mergeUndoDeltas=!0:-1!==n.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(e,t){if(e&&"string"==typeof e&&"ace"!=e){this.$keybindingId=e;var n=this;_.loadModule(["keybinding",e],(function(r){n.$keybindingId==e&&n.keyBinding.setKeyboardHandler(r&&r.handler),t&&t()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var n=this.session.getSelection();n.off("changeCursor",this.$onCursorChange),n.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||a.computedStyle(this.container).fontSize},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout((function(){e.$highlightPending=!1;var t=e.session;if(t&&t.bgTokenizer){t.$bracketHighlight&&(t.$bracketHighlight.markerIds.forEach((function(e){t.removeMarker(e)})),t.$bracketHighlight=null);var n=t.getMatchingBracketRanges(e.getCursorPosition());if(!n&&t.$mode.getMatching&&(n=t.$mode.getMatching(e.session)),n){var r="ace_bracket";Array.isArray(n)?1==n.length&&(r="ace_error_bracket"):n=[n],2==n.length&&(0==j.comparePoints(n[0].end,n[1].start)?n=[j.fromPoints(n[0].start,n[1].end)]:0==j.comparePoints(n[0].start,n[1].end)&&(n=[j.fromPoints(n[1].start,n[0].end)])),t.$bracketHighlight={ranges:n,markerIds:n.map((function(e){return t.addMarker(e,r,"text")}))}}}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var e=this;this.$highlightTagPending=!0,setTimeout((function(){e.$highlightTagPending=!1;var t=e.session;if(t&&t.bgTokenizer){var n=e.getCursorPosition(),r=new k(e.session,n.row,n.column),a=r.getCurrentToken();if(!a||!/\b(?:tag-open|tag-name)/.test(a.type))return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);if(-1===a.type.indexOf("tag-open")||(a=r.stepForward())){var l=a.value,d=a.value,h=0,p=r.stepBackward();if("<"===p.value)do{p=a,(a=r.stepForward())&&(-1!==a.type.indexOf("tag-name")?l===(d=a.value)&&("<"===p.value?h++:"</"===p.value&&h--):l===d&&"/>"===a.value&&h--)}while(a&&h>=0);else{do{if(a=p,p=r.stepBackward(),a)if(-1!==a.type.indexOf("tag-name"))l===a.value&&("<"===p.value?h++:"</"===p.value&&h--);else if("/>"===a.value){for(var f=0,y=p;y;){if(-1!==y.type.indexOf("tag-name")&&y.value===l){h--;break}if("<"===y.value)break;y=r.stepBackward(),f++}for(var w=0;w<f;w++)r.stepForward()}}while(p&&h<=0);r.stepForward()}if(!a)return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);var x=r.getCurrentTokenRow(),O=r.getCurrentTokenColumn(),C=new j(x,O,x,O+a.value.length),S=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&null!=S&&0!==C.compareRange(S.range)&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),t.$tagHighlight||(t.$tagHighlight=t.addMarker(C,"ace_bracket","text"))}}}),50)}},this.focus=function(){var e=this;setTimeout((function(){e.isFocused()||e.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:1/0;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(e=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var n=new j(e.row,e.column,e.row,1/0);n.id=t.addMarker(n,"ace_active-line","screenLine"),t.$highlightLineMarker=n}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var n=this.selection.getRange(),r=this.getSelectionStyle();t.$selectionMarker=t.addMarker(n,"ace_selection",r)}var a=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(a),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var n=t.start.column,r=t.end.column,a=e.getLine(t.start.row),l=a.substring(n,r);if(!(l.length>5e3)&&/[\w\d]/.test(l)){var d=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:l}),h=a.substring(n-1,r+1);if(d.test(h))return d}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),n=!1;if(!e&&this.$copyWithEmptySelection){n=!0;for(var r=this.selection.getAllRanges(),a=0;a<r.length;a++){var l=r[a];a&&r[a-1].start.row==l.start.row||(e+=this.session.getLine(l.start.row)+t)}}var d={text:e};return this._signal("copy",d),E.lineMode=n?d.text:"",d.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e,t){var n={text:e,event:t};this.commands.exec("paste",this,n)},this.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var t=e.text,n=t==E.lineMode,r=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)n?r.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(n)this.selection.rangeList.ranges.forEach((function(e){r.insert({row:e.start.row,column:0},t)}));else{var a=t.split(/\r\n|\r|\n/),l=this.selection.rangeList.ranges,d=!(2!=a.length||a[0]&&a[1]);if(a.length!=l.length||d)return this.commands.exec("insertstring",this,t);for(var h=l.length;h--;){var p=l[h];p.isEmpty()||r.remove(p),r.insert(p.start,a[h])}}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var n=this.session,r=n.getMode(),a=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var l=r.transformAction(n.getState(a.row),"insertion",this,n,e);l&&(e!==l.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=l.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==e.indexOf("\n")){(d=new j.fromPoints(a,a)).end.column+=e.length,this.session.remove(d)}}else{var d=this.getSelectionRange();a=this.session.remove(d),this.clearSelection()}if("\n"==e||"\r\n"==e){var h=n.getLine(a.row);if(a.column>h.search(/\S|$/)){var p=h.substr(a.column).search(/\S|$/);n.doc.removeInLine(a.row,a.column,a.column+p)}}this.clearSelection();var f=a.column,y=n.getState(a.row),w=(h=n.getLine(a.row),r.checkOutdent(y,h,e));if(n.insert(a,e),l&&l.selection&&(2==l.selection.length?this.selection.setSelectionRange(new j(a.row,f+l.selection[0],a.row,f+l.selection[1])):this.selection.setSelectionRange(new j(a.row+l.selection[0],l.selection[1],a.row+l.selection[2],l.selection[3]))),this.$enableAutoIndent){if(n.getDocument().isNewLine(e)){var x=r.getNextLineIndent(y,h.slice(0,a.column),n.getTabString());n.insert({row:a.row+1,column:0},x)}w&&r.autoOutdent(y,n,a.row)}},this.autoIndent=function(){var e,t,n=this.session,r=n.getMode();if(this.selection.isEmpty())e=0,t=n.doc.getLength()-1;else{var a=this.getSelectionRange();e=a.start.row,t=a.end.row}for(var l,d,h,p="",f="",y="",w=n.getTabString(),x=e;x<=t;x++)x>0&&(p=n.getState(x-1),f=n.getLine(x-1),y=r.getNextLineIndent(p,f,w)),l=n.getLine(x),y!==(d=r.$getIndent(l))&&(d.length>0&&(h=new j(x,0,x,d.length),n.remove(h)),y.length>0&&n.insert({row:x,column:0},y)),r.autoOutdent(p,n,x)},this.onTextInput=function(e,t){if(!t)return this.keyBinding.onTextInput(e);this.startOperation({command:{name:"insertstring"}});var n=this.applyComposition.bind(this,e,t);this.selection.rangeCount?this.forEachSelection(n):n(),this.endOperation()},this.applyComposition=function(e,t){var n;(t.extendLeft||t.extendRight)&&((n=this.selection.getRange()).start.column-=t.extendLeft,n.end.column+=t.extendRight,n.start.column<0&&(n.start.row--,n.start.column+=this.session.getLine(n.start.row).length+1),this.selection.setRange(n),e||n.isEmpty()||this.remove());(!e&&this.selection.isEmpty()||this.insert(e,!0),t.restoreStart||t.restoreEnd)&&((n=this.selection.getRange()).start.column-=t.restoreStart,n.end.column-=t.restoreEnd,this.selection.setRange(n))},this.onCommandKey=function(e,t,n){return this.keyBinding.onCommandKey(e,t,n)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var n=this.session,r=n.getState(t.start.row),a=n.getMode().transformAction(r,"deletion",this,n,t);if(0===t.end.column){var l=n.getTextRange(t);if("\n"==l[l.length-1]){var d=n.getLine(t.end.row);/^\s+$/.test(d)&&(t.end.column=d.length)}}a&&(t=a)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var n,r,a=this.session.getLine(e.row);t<a.length?(n=a.charAt(t)+a.charAt(t-1),r=new j(e.row,t-1,e.row,t+1)):(n=a.charAt(t-1)+a.charAt(t-2),r=new j(e.row,t-2,e.row,t)),this.session.replace(r,n),this.session.selection.moveToPosition(r.end)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){y=this.$getSelectedRows();return void e.indentRows(y.first,y.last,"\t")}}var r=e.getLine(t.start.row),a=t.start,d=e.getTabSize(),h=e.documentToScreenColumn(a.row,a.column);if(this.session.getUseSoftTabs())var p=d-h%d,f=l.stringRepeat(" ",p);else{for(p=h%d;" "==r[t.start.column-1]&&p;)t.start.column--,p--;this.selection.setSelectionRange(t),f="\t"}return this.insert(f)}var y=this.$getSelectedRows();e.indentRows(y.first,y.last,"\t")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){for(var e=this.$getSelectedRows(),t=this.session,n=[],r=e.first;r<=e.last;r++)n.push(t.getLine(r));n.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}));var a=new j(0,0,0,0);for(r=e.first;r<=e.last;r++){var l=t.getLine(r);a.start.row=r,a.end.row=r,a.end.column=l.length,t.replace(a,n[r-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),n=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,n,e)},this.getNumberAt=function(e,t){var n=/[\-]?[0-9]+(?:\.[0-9]+)?/g;n.lastIndex=0;for(var r=this.session.getLine(e);n.lastIndex<t;){var a=n.exec(r);if(a.index<=t&&a.index+a[0].length>=t)return{value:a[0],start:a.index,end:a.index+a[0].length}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,n=this.selection.getCursor().column,r=new j(t,n-1,t,n),a=this.session.getTextRange(r);if(!isNaN(parseFloat(a))&&isFinite(a)){var l=this.getNumberAt(t,n);if(l){var d=l.value.indexOf(".")>=0?l.start+l.value.indexOf(".")+1:l.end,h=l.start+l.value.length-d,p=parseFloat(l.value);p*=Math.pow(10,h),d!==l.end&&n<d?e*=Math.pow(10,l.end-n-1):e*=Math.pow(10,l.end-n),p+=e;var f=(p/=Math.pow(10,h)).toFixed(h),y=new j(t,l.start,t,l.end);this.session.replace(y,f),this.moveCursorTo(t,Math.max(l.start+1,n+f.length-l.value.length))}}else this.toggleWord()},this.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["in","out"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],this.toggleWord=function(){var e=this.selection.getCursor().row,t=this.selection.getCursor().column;this.selection.selectWord();var n=this.getSelectedText(),r=this.selection.getWordRange().start.column,a=n.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),d=t-r-1;d<0&&(d=0);var h=0,p=0,f=this;n.match(/[A-Za-z0-9_]+/)&&a.forEach((function(t,a){p=h+t.length,d>=h&&d<=p&&(n=t,f.selection.clearSelection(),f.moveCursorTo(e,h+r),f.selection.selectTo(e,p+r)),h=p}));for(var y,w=this.$toggleWordPairs,x=0;x<w.length;x++)for(var j=w[x],O=0;O<=1;O++){var C=+!O,S=n.match(new RegExp("^\\s?_?("+l.escapeRegExp(j[O])+")\\s?$","i"));if(S)n.match(new RegExp("([_]|^|\\s)("+l.escapeRegExp(S[1])+")($|\\s)","g"))&&(y=n.replace(new RegExp(l.escapeRegExp(j[O]),"i"),(function(e){var t=j[C];return e.toUpperCase()==e?t=t.toUpperCase():e.charAt(0).toUpperCase()==e.charAt(0)&&(t=t.substr(0,0)+j[C].charAt(0).toUpperCase()+t.substr(1)),t})),this.insert(y),y="")}},this.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,n=e.getRange(),r=e.isBackwards();if(n.isEmpty()){var a=n.start.row;t.duplicateLines(a,a)}else{var l=r?n.start:n.end,d=t.insert(l,t.getTextRange(n),!1);n.start=l,n.end=d,e.setSelectionRange(n,r)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,n){return this.session.moveText(e,t,n)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var n,r,a=this.selection;if(!a.inMultiSelectMode||this.inVirtualSelectionMode){var l=a.toOrientedRange();n=this.$getSelectedRows(l),r=this.session.$moveLines(n.first,n.last,t?0:e),t&&-1==e&&(r=0),l.moveBy(r,0),a.fromOrientedRange(l)}else{var d=a.rangeList.ranges;a.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var h=0,p=0,f=d.length,y=0;y<f;y++){var w=y;d[y].moveBy(h,0);for(var x=(n=this.$getSelectedRows(d[y])).first,j=n.last;++y<f;){p&&d[y].moveBy(p,0);var O=this.$getSelectedRows(d[y]);if(t&&O.first!=j)break;if(!t&&O.first>j+1)break;j=O.last}for(y--,h=this.session.$moveLines(x,j,t?0:e),t&&-1==e&&(w=y+1);w<=y;)d[w].moveBy(h,0),w++;t||(h=0),p+=h}a.fromOrientedRange(a.ranges[0]),a.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(e)},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var n=this.renderer,r=this.renderer.layerConfig,a=e*Math.floor(r.height/r.lineHeight);!0===t?this.selection.$moveSelection((function(){this.moveCursorBy(a,0)})):!1===t&&(this.selection.moveCursorBy(a,0),this.selection.clearSelection());var l=n.scrollTop;n.scrollBy(0,a*r.lineHeight),null!=t&&n.scrollCursorIntoView(null,.5),n.animateScrolling(l)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,n,r){this.renderer.scrollToLine(e,t,n,r)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var n=this.getCursorPosition(),r=new k(this.session,n.row,n.column),a=r.getCurrentToken(),l=a||r.stepForward();if(l){var d,h,p=!1,f={},y=n.column-l.start,w={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(l.value.match(/[{}()\[\]]/g)){for(;y<l.value.length&&!p;y++)if(w[l.value[y]])switch(h=w[l.value[y]]+"."+l.type.replace("rparen","lparen"),isNaN(f[h])&&(f[h]=0),l.value[y]){case"(":case"[":case"{":f[h]++;break;case")":case"]":case"}":f[h]--,-1===f[h]&&(d="bracket",p=!0)}}else-1!==l.type.indexOf("tag-name")&&(isNaN(f[l.value])&&(f[l.value]=0),"<"===a.value?f[l.value]++:"</"===a.value&&f[l.value]--,-1===f[l.value]&&(d="tag",p=!0));p||(a=l,l=r.stepForward(),y=0)}while(l&&!p);if(d){var x,O;if("bracket"===d)(x=this.session.getBracketRange(n))||(O=(x=new j(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+y-1,r.getCurrentTokenRow(),r.getCurrentTokenColumn()+y-1)).start,(t||O.row===n.row&&Math.abs(O.column-n.column)<2)&&(x=this.session.getBracketRange(O)));else if("tag"===d){if(!l||-1===l.type.indexOf("tag-name"))return;var C=l.value;if(0===(x=new j(r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2,r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2)).compare(n.row,n.column)){p=!1;do{l=a,(a=r.stepBackward())&&(-1!==a.type.indexOf("tag-close")&&x.setEnd(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+1),l.value===C&&-1!==l.type.indexOf("tag-name")&&("<"===a.value?f[C]++:"</"===a.value&&f[C]--,0===f[C]&&(p=!0)))}while(a&&!p)}l&&l.type.indexOf("tag-name")&&(O=x.start).row==n.row&&Math.abs(O.column-n.column)<2&&(O=x.end)}(O=x&&x.cursor||O)&&(e?x&&t?this.selection.setRange(x):x&&x.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(O.row,O.column):this.selection.moveTo(O.row,O.column))}}},this.gotoLine=function(e,t,n){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,n)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var n=this.$search.find(this.session),r=0;return n?(this.$tryReplace(n,e)&&(r=1),this.selection.setSelectionRange(n),this.renderer.scrollSelectionIntoView(n.start,n.end),r):r},this.replaceAll=function(e,t){t&&this.$search.set(t);var n=this.$search.findAll(this.session),r=0;if(!n.length)return r;var a=this.getSelectionRange();this.selection.moveTo(0,0);for(var l=n.length-1;l>=0;--l)this.$tryReplace(n[l],e)&&r++;return this.selection.setSelectionRange(a),r},this.$tryReplace=function(e,t){var n=this.session.getTextRange(e);return null!==(t=this.$search.replace(n,t))?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,n){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&r.mixin(t,e);var a=this.selection.getRange();null==t.needle&&((e=this.session.getTextRange(a)||this.$search.$options.needle)||(a=this.session.getWordRange(a.start.row,a.start.column),e=this.session.getTextRange(a)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:a});var l=this.$search.find(this.session);return t.preventScroll?l:l?(this.revealRange(l,n),l):(t.backwards?a.start=a.end:a.end=a.start,void this.selection.setRange(a))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var n=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(n)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.$toDestroy&&(this.$toDestroy.forEach((function(e){e.destroy()})),this.$toDestroy=null),this.$mouseHandler&&this.$mouseHandler.destroy(),this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy(),this._$emitInputEvent&&this._$emitInputEvent.cancel(),this.removeAllListeners()},this.setAutoScrollEditorIntoView=function(e){if(e){var t,n=this,r=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var a=this.$scrollAnchor;a.style.cssText="position:absolute",this.container.insertBefore(a,this.container.firstChild);var l=this.on("changeSelection",(function(){r=!0})),d=this.renderer.on("beforeRender",(function(){r&&(t=n.renderer.container.getBoundingClientRect())})),h=this.renderer.on("afterRender",(function(){if(r&&t&&(n.isFocused()||n.searchBox&&n.searchBox.isFocused())){var e=n.renderer,l=e.$cursorLayer.$pixelPos,d=e.layerConfig,h=l.top-d.offset;null!=(r=l.top>=0&&h+t.top<0||!(l.top<d.height&&l.top+t.top+d.lineHeight>window.innerHeight)&&null)&&(a.style.top=h+"px",a.style.left=l.left+"px",a.style.height=d.lineHeight+"px",a.scrollIntoView(r)),r=t=null}}));this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",l),this.renderer.off("afterRender",h),this.renderer.off("beforeRender",d))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,a.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))},this.prompt=function(e,t,n){var r=this;_.loadModule("./ext/prompt",(function(a){a.prompt(r,e,t,n)}))}}.call(A.prototype),_.defineOptions(A.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},enableAutoIndent:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(e){this.renderer.$gutterLayer.setShowLineNumbers(e),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),e&&this.$relativeLineNumbers?T.attach(this):T.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(e){this.$showLineNumbers&&e?T.attach(this):T.detach(this)}},placeholder:{set:function(e){this.$updatePlaceholder||(this.$updatePlaceholder=function(){var e=this.session&&(this.renderer.$composition||this.getValue());if(e&&this.renderer.placeholderNode)this.renderer.off("afterRender",this.$updatePlaceholder),a.removeCssClass(this.container,"ace_hasPlaceholder"),this.renderer.placeholderNode.remove(),this.renderer.placeholderNode=null;else if(e||this.renderer.placeholderNode)!e&&this.renderer.placeholderNode&&(this.renderer.placeholderNode.textContent=this.$placeholder||"");else{this.renderer.on("afterRender",this.$updatePlaceholder),a.addCssClass(this.container,"ace_hasPlaceholder");var t=a.createElement("div");t.className="ace_placeholder",t.textContent=this.$placeholder||"",this.renderer.placeholderNode=t,this.renderer.content.appendChild(this.renderer.placeholderNode)}}.bind(this),this.on("input",this.$updatePlaceholder)),this.$updatePlaceholder()}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var T={getText:function(e,t){return(Math.abs(e.selection.lead.row-t)||t+1+(t<9?"·":""))+""},getWidth:function(e,t,n){return Math.max(t.toString().length,(n.lastRow+1).toString().length,2)*n.characterWidth},update:function(e,t){t.renderer.$loop.schedule(t.renderer.CHANGE_GUTTER)},attach:function(e){e.renderer.$gutterLayer.$renderer=this,e.on("changeSelection",this.update),this.update(null,e)},detach:function(e){e.renderer.$gutterLayer.$renderer==this&&(e.renderer.$gutterLayer.$renderer=null),e.off("changeSelection",this.update),this.update(null,e)}};t.Editor=A})),ace.define("ace/undomanager",[],(function(e,t,n){"use strict";var r=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(e){this.$session=e},this.add=function(e,t,n){this.$fromUndo||e!=this.$lastDelta&&(this.$keepRedoStack||(this.$redoStack.length=0),!1!==t&&this.lastDeltas||(this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev),"remove"!=e.action&&"insert"!=e.action||(this.$lastDelta=e),this.lastDeltas.push(e))},this.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,r=n.length;r--;){var a=n[r][0];if(a.id<=e)break;a.id<t&&(a.ignore=!0)}this.lastDeltas=null},this.getSelection=function(e,t){for(var n=this.selections,r=n.length;r--;){var a=n[r];if(a.rev<e)return t&&(a=n[r+1]),a}},this.getRevision=function(){return this.$rev},this.getDeltas=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,r=null,a=0,l=n.length;l--;){var d=n[l][0];if(d.id<t&&!r&&(r=l+1),d.id<=e){a=l+1;break}}return n.slice(a,r)},this.getChangedRanges=function(e,t){null==t&&(t=this.$rev+1)},this.getChangedLines=function(e,t){null==t&&(t=this.$rev+1)},this.undo=function(e,t){this.lastDeltas=null;var n=this.$undoStack;if(function(e,t){for(var n=t;n--;){var r=e[n];if(r&&!r[0].ignore){for(;n<t-1;){var a=y(e[n],e[n+1]);e[n]=a[0],e[n+1]=a[1],n++}return!0}}}(n,n.length)){e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var r=n.pop(),a=null;return r&&(a=e.undoChanges(r,t),this.$redoStack.push(r),this.$syncRev()),this.$fromUndo=!1,a}},this.redo=function(e,t){if(this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var n=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(e,t){for(var n=0;n<t.length;n++)for(var r=t[n],a=0;a<r.length;a++)C(e,r[a])}(this.$redoStack,n),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(e){e[0].id=++this.$maxRev}),this)}var r=this.$redoStack.pop(),a=null;return r&&(a=e.redoChanges(r,t),this.$undoStack.push(r),this.$syncRev()),this.$fromUndo=!1,a},this.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],n=t&&t[0].id||0;this.$redoStackBaseRev=n,this.$rev=n},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(e){null==e&&(e=this.$rev),this.mark=e},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(e){return e?h(e):h(this.$undoStack)+"\n---\n"+h(this.$redoStack)}}).call(r.prototype);var a=e("./range").Range,l=a.comparePoints;a.comparePoints;function d(e){return{row:e.row,column:e.column}}function h(e){if(e=e||this,Array.isArray(e))return e.map(h).join("\n");var t="";return e.action?(t="insert"==e.action?"+":"-",t+="["+e.lines+"]"):e.value&&(t=Array.isArray(e.value)?e.value.map(p).join("\n"):p(e.value)),e.start&&(t+=p(e)),(e.id||e.rev)&&(t+="\t("+(e.id||e.rev)+")"),t}function p(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function f(e,t){var n="insert"==e.action,r="insert"==t.action;if(n&&r)if(l(t.start,e.end)>=0)x(t,e,-1);else{if(!(l(t.start,e.start)<=0))return null;x(e,t,1)}else if(n&&!r)if(l(t.start,e.end)>=0)x(t,e,-1);else{if(!(l(t.end,e.start)<=0))return null;x(e,t,-1)}else if(!n&&r)if(l(t.start,e.start)>=0)x(t,e,1);else{if(!(l(t.start,e.start)<=0))return null;x(e,t,1)}else if(!n&&!r)if(l(t.start,e.start)>=0)x(t,e,1);else{if(!(l(t.end,e.start)<=0))return null;x(e,t,-1)}return[t,e]}function y(e,t){for(var n=e.length;n--;)for(var r=0;r<t.length;r++)if(!f(e[n],t[r])){for(;n<e.length;){for(;r--;)f(t[r],e[n]);r=t.length,n++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function w(e,t){var n="insert"==e.action,r="insert"==t.action;if(n&&r)l(e.start,t.start)<0?x(t,e,1):x(e,t,1);else if(n&&!r)l(e.start,t.end)>=0?x(e,t,-1):(l(e.start,t.start)<=0||x(e,a.fromPoints(t.start,e.start),-1),x(t,e,1));else if(!n&&r)l(t.start,e.end)>=0?x(t,e,-1):(l(t.start,e.start)<=0||x(t,a.fromPoints(e.start,t.start),-1),x(e,t,1));else if(!n&&!r)if(l(t.start,e.end)>=0)x(t,e,-1);else{var d,h;if(!(l(t.end,e.start)<=0))return l(e.start,t.start)<0&&(d=e,e=O(e,t.start)),l(e.end,t.end)>0&&(h=O(e,t.end)),j(t.end,e.start,e.end,-1),h&&!d&&(e.lines=h.lines,e.start=h.start,e.end=h.end,h=e),[t,d,h].filter(Boolean);x(e,t,-1)}return[t,e]}function x(e,t,n){j(e.start,t.start,t.end,n),j(e.end,t.start,t.end,n)}function j(e,t,n,r){e.row==(1==r?t:n).row&&(e.column+=r*(n.column-t.column)),e.row+=r*(n.row-t.row)}function O(e,t){var n=e.lines,r=e.end;e.end=d(t);var a=e.end.row-e.start.row,l=n.splice(a,n.length),h=a?t.column:t.column-e.start.column;return n.push(l[0].substring(0,h)),l[0]=l[0].substr(h),{start:d(t),end:r,lines:l,action:e.action}}function C(e,t){t=function(e){return{start:d(e.start),end:d(e.end),action:e.action,lines:e.lines.slice()}}(t);for(var n=e.length;n--;){for(var r=e[n],a=0;a<r.length;a++){var l=w(r[a],t);t=l[0],2!=l.length&&(l[2]?(r.splice(a+1,1,l[1],l[2]),a++):l[1]||(r.splice(a,1),a--))}r.length||e.splice(n,1)}return e}t.UndoManager=r})),ace.define("ace/layer/lines",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=function(e,t){this.element=e,this.canvasHeight=t||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0};(function(){this.moveContainer=function(e){r.translate(this.element,0,-e.firstRowScreen*e.lineHeight%this.canvasHeight-e.offset*this.$offsetCoefficient)},this.pageChanged=function(e,t){return Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)!==Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)},this.computeLineTop=function(e,t,n){var r=t.firstRowScreen*t.lineHeight,a=Math.floor(r/this.canvasHeight);return n.documentToScreenRow(e,0)*t.lineHeight-a*this.canvasHeight},this.computeLineHeight=function(e,t,n){return t.lineHeight*n.getRowLineCount(e)},this.getLength=function(){return this.cells.length},this.get=function(e){return this.cells[e]},this.shift=function(){this.$cacheCell(this.cells.shift())},this.pop=function(){this.$cacheCell(this.cells.pop())},this.push=function(e){if(Array.isArray(e)){this.cells.push.apply(this.cells,e);for(var t=r.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.appendChild(t)}else this.cells.push(e),this.element.appendChild(e.element)},this.unshift=function(e){if(Array.isArray(e)){this.cells.unshift.apply(this.cells,e);for(var t=r.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.firstChild?this.element.insertBefore(t,this.element.firstChild):this.element.appendChild(t)}else this.cells.unshift(e),this.element.insertAdjacentElement("afterbegin",e.element)},this.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},this.$cacheCell=function(e){e&&(e.element.remove(),this.cellCache.push(e))},this.createCell=function(e,t,n,a){var l=this.cellCache.pop();if(!l){var d=r.createElement("div");a&&a(d),this.element.appendChild(d),l={element:d,text:"",row:e}}return l.row=e,l}}).call(a.prototype),t.Lines=a})),ace.define("ace/layer/gutter",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=e("../lib/oop"),l=e("../lib/lang"),d=e("../lib/event_emitter").EventEmitter,h=e("./lines").Lines,p=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new h(this.element),this.$lines.$offsetCoefficient=1};function f(e){var t=document.createTextNode("");e.appendChild(t);var n=r.createElement("span");return e.appendChild(n),e}(function(){a.implement(this,d),this.setSession=function(e){this.session&&this.session.off("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],r=n.row,a=this.$annotations[r];a||(a=this.$annotations[r]={text:[]});var d=n.text;d=d?l.escapeHTML(d):n.html||"",-1===a.text.indexOf(d)&&a.text.push(d);var h=n.type;"error"==h?a.className=" ace_error":"warning"==h&&" ace_error"!=a.className?a.className=" ace_warning":"info"!=h||a.className||(a.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.start.row,n=e.end.row-t;if(0===n);else if("remove"==e.action)this.$annotations.splice(t,n+1,null);else{var r=new Array(n+1);r.unshift(t,1),this.$annotations.splice.apply(this.$annotations,r)}}},this.update=function(e){this.config=e;var t=this.session,n=e.firstRow,r=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1);this.oldLastRow=r,this.config=e,this.$lines.moveContainer(e),this.$updateCursorRow();for(var a=t.getNextFoldLine(n),l=a?a.start.row:1/0,d=null,h=-1,p=n;;){if(p>l&&(p=a.end.row+1,l=(a=t.getNextFoldLine(p,a))?a.start.row:1/0),p>r){for(;this.$lines.getLength()>h+1;)this.$lines.pop();break}(d=this.$lines.get(++h))?d.row=p:(d=this.$lines.createCell(p,e,this.session,f),this.$lines.push(d)),this.$renderCell(d,e,a,p),p++}this._signal("afterRender"),this.$updateGutterWidth(e)},this.$updateGutterWidth=function(e){var t=this.session,n=t.gutterRenderer||this.$renderer,r=t.$firstLineNumber,a=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||t.$useWrapMode)&&(a=t.getLength()+r-1);var l=n?n.getWidth(t,a,e):a.toString().length*e.characterWidth,d=this.$padding||this.$computePadding();(l+=d.left+d.right)===this.gutterWidth||isNaN(l)||(this.gutterWidth=l,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",l))},this.$updateCursorRow=function(){if(this.$highlightGutterLine){var e=this.session.selection.getCursor();this.$cursorRow!==e.row&&(this.$cursorRow=e.row)}},this.updateLineHighlight=function(){if(this.$highlightGutterLine){var e=this.session.selection.cursor.row;if(this.$cursorRow=e,!this.$cursorCell||this.$cursorCell.row!=e){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var t=this.$lines.cells;this.$cursorCell=null;for(var n=0;n<t.length;n++){var r=t[n];if(r.row>=this.$cursorRow){if(r.row>this.$cursorRow){var a=this.session.getFoldLine(this.$cursorRow);if(!(n>0&&a&&a.start.row==t[n-1].row))break;r=t[n-1]}r.element.className="ace_gutter-active-line "+r.element.className,this.$cursorCell=r;break}}}}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$updateCursorRow(),this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=Math.min(e.lastRow+e.gutterOffset,this.session.getLength()-1),r=this.oldLastRow;if(this.oldLastRow=n,!t||r<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var a=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);a>0;a--)this.$lines.shift();if(r>n)for(a=this.session.getFoldedRowCount(n+1,r);a>0;a--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLines(e,e.firstRow,t.firstRow-1)),n>r&&this.$lines.push(this.$renderLines(e,r+1,n)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(e)},this.$renderLines=function(e,t,n){for(var r=[],a=t,l=this.session.getNextFoldLine(a),d=l?l.start.row:1/0;a>d&&(a=l.end.row+1,d=(l=this.session.getNextFoldLine(a,l))?l.start.row:1/0),!(a>n);){var h=this.$lines.createCell(a,e,this.session,f);this.$renderCell(h,e,l,a),r.push(h),a++}return r},this.$renderCell=function(e,t,n,a){var l=e.element,d=this.session,h=l.childNodes[0],p=l.childNodes[1],f=d.$firstLineNumber,y=d.$breakpoints,w=d.$decorations,x=d.gutterRenderer||this.$renderer,j=this.$showFoldWidgets&&d.foldWidgets,O=n?n.start.row:Number.MAX_VALUE,C="ace_gutter-cell ";if(this.$highlightGutterLine&&(a==this.$cursorRow||n&&a<this.$cursorRow&&a>=O&&this.$cursorRow<=n.end.row)&&(C+="ace_gutter-active-line ",this.$cursorCell!=e&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=e)),y[a]&&(C+=y[a]),w[a]&&(C+=w[a]),this.$annotations[a]&&(C+=this.$annotations[a].className),l.className!=C&&(l.className=C),j){var S=j[a];null==S&&(S=j[a]=d.getFoldWidget(a))}if(S){C="ace_fold-widget ace_"+S;"start"==S&&a==O&&a<n.end.row?C+=" ace_closed":C+=" ace_open",p.className!=C&&(p.className=C);var _=t.lineHeight+"px";r.setStyle(p.style,"height",_),r.setStyle(p.style,"display","inline-block")}else p&&r.setStyle(p.style,"display","none");var k=(x?x.getText(d,a):a+f).toString();return k!==h.data&&(h.data=k),r.setStyle(e.element.style,"height",this.$lines.computeLineHeight(a,t,d)+"px"),r.setStyle(e.element.style,"top",this.$lines.computeLineTop(a,t,d)+"px"),e.text=k,e},this.$fixedWidth=!1,this.$highlightGutterLine=!0,this.$renderer="",this.setHighlightGutterLine=function(e){this.$highlightGutterLine=e},this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return 0},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?r.addCssClass(this.element,"ace_folding-enabled"):r.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=r.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(e.borderLeftWidth)||0)+(parseInt(e.paddingLeft)||0)+1,this.$padding.right=(parseInt(e.borderRightWidth)||0)+(parseInt(e.paddingRight)||0),this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),n=this.element.getBoundingClientRect();return e.x<t.left+n.left?"markers":this.$showFoldWidgets&&e.x>n.right-t.right?"foldWidgets":void 0}}).call(p.prototype),t.Gutter=p})),ace.define("ace/layer/marker",[],(function(e,t,n){"use strict";var r=e("../range").Range,a=e("../lib/dom"),l=function(e){this.element=a.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.elt=function(e,t){var n=-1!=this.i&&this.element.childNodes[this.i];n?this.i++:(n=document.createElement("div"),this.element.appendChild(n),this.i=-1),n.style.cssText=t,n.className=e},this.update=function(e){if(e){var t;for(var n in this.config=e,this.i=0,this.markers){var r=this.markers[n];if(r.range){var a=r.range.clipRows(e.firstRow,e.lastRow);if(!a.isEmpty())if(a=a.toScreenRange(this.session),r.renderer){var l=this.$getTop(a.start.row,e),d=this.$padding+a.start.column*e.characterWidth;r.renderer(t,a,d,l,e)}else"fullLine"==r.type?this.drawFullLineMarker(t,a,r.clazz,e):"screenLine"==r.type?this.drawScreenLineMarker(t,a,r.clazz,e):a.isMultiLine()?"text"==r.type?this.drawTextMarker(t,a,r.clazz,e):this.drawMultiLineMarker(t,a,r.clazz,e):this.drawSingleLineMarker(t,a,r.clazz+" ace_start ace_br15",e)}else r.update(t,this,this.session,e)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,n,a,l){for(var d=this.session,h=t.start.row,p=t.end.row,f=h,y=0,w=0,x=d.getScreenLastRowColumn(f),j=new r(f,t.start.column,f,w);f<=p;f++)j.start.row=j.end.row=f,j.start.column=f==h?t.start.column:d.getRowWrapIndent(f),j.end.column=x,y=w,w=x,x=f+1<p?d.getScreenLastRowColumn(f+1):f==p?0:t.end.column,this.drawSingleLineMarker(e,j,n+(f==h?" ace_start":"")+" ace_br"+((f==h||f==h+1&&t.start.column?1:0)|(y<w?2:0)|(w>x?4:0)|(f==p?8:0)),a,f==p?0:1,l)},this.drawMultiLineMarker=function(e,t,n,r,a){var l=this.$padding,d=r.lineHeight,h=this.$getTop(t.start.row,r),p=l+t.start.column*r.characterWidth;(a=a||"",this.session.$bidiHandler.isBidiRow(t.start.row))?((f=t.clone()).end.row=f.start.row,f.end.column=this.session.getLine(f.start.row).length,this.drawBidiSingleLineMarker(e,f,n+" ace_br1 ace_start",r,null,a)):this.elt(n+" ace_br1 ace_start","height:"+d+"px;right:0;top:"+h+"px;left:"+p+"px;"+(a||""));if(this.session.$bidiHandler.isBidiRow(t.end.row)){var f;(f=t.clone()).start.row=f.end.row,f.start.column=0,this.drawBidiSingleLineMarker(e,f,n+" ace_br12",r,null,a)}else{h=this.$getTop(t.end.row,r);var y=t.end.column*r.characterWidth;this.elt(n+" ace_br12","height:"+d+"px;width:"+y+"px;top:"+h+"px;left:"+l+"px;"+(a||""))}if(!((d=(t.end.row-t.start.row-1)*r.lineHeight)<=0)){h=this.$getTop(t.start.row+1,r);var w=(t.start.column?1:0)|(t.end.column?0:8);this.elt(n+(w?" ace_br"+w:""),"height:"+d+"px;right:0;top:"+h+"px;left:"+l+"px;"+(a||""))}},this.drawSingleLineMarker=function(e,t,n,r,a,l){if(this.session.$bidiHandler.isBidiRow(t.start.row))return this.drawBidiSingleLineMarker(e,t,n,r,a,l);var d=r.lineHeight,h=(t.end.column+(a||0)-t.start.column)*r.characterWidth,p=this.$getTop(t.start.row,r),f=this.$padding+t.start.column*r.characterWidth;this.elt(n,"height:"+d+"px;width:"+h+"px;top:"+p+"px;left:"+f+"px;"+(l||""))},this.drawBidiSingleLineMarker=function(e,t,n,r,a,l){var d=r.lineHeight,h=this.$getTop(t.start.row,r),p=this.$padding;this.session.$bidiHandler.getSelections(t.start.column,t.end.column).forEach((function(e){this.elt(n,"height:"+d+"px;width:"+e.width+(a||0)+"px;top:"+h+"px;left:"+(p+e.left)+"px;"+(l||""))}),this)},this.drawFullLineMarker=function(e,t,n,r,a){var l=this.$getTop(t.start.row,r),d=r.lineHeight;t.start.row!=t.end.row&&(d+=this.$getTop(t.end.row,r)-l),this.elt(n,"height:"+d+"px;top:"+l+"px;left:0;right:0;"+(a||""))},this.drawScreenLineMarker=function(e,t,n,r,a){var l=this.$getTop(t.start.row,r),d=r.lineHeight;this.elt(n,"height:"+d+"px;top:"+l+"px;left:0;right:0;"+(a||""))}}).call(l.prototype),t.Marker=l})),ace.define("ace/layer/text",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),a=e("../lib/dom"),l=e("../lib/lang"),d=e("./lines").Lines,h=e("../lib/event_emitter").EventEmitter,p=function(e){this.dom=a,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new d(this.element)};(function(){r.implement(this,h),this.EOF_CHAR="¶",this.EOL_CHAR_LF="¬",this.EOL_CHAR_CRLF="¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="—",this.SPACE_CHAR="·",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var e=this.session.doc,t="\n"==e.getNewLineCharacter()&&"windows"!=e.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=t)return this.EOL_CHAR=t,!0},this.setPadding=function(e){this.$padding=e,this.element.style.margin="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,e&&this.$computeTabString()},this.showInvisibles=!1,this.showSpaces=!1,this.showTabs=!1,this.showEOL=!1,this.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,"string"==typeof e?(this.showSpaces=/tab/i.test(e),this.showTabs=/space/i.test(e),this.showEOL=/eol/i.test(e)):this.showSpaces=this.showTabs=this.showEOL=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],n=1;n<e+1;n++){if(this.showTabs)(r=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",r.textContent=l.stringRepeat(this.TAB_CHAR,n),t.push(r);else t.push(this.dom.createTextNode(l.stringRepeat(" ",n),this.element))}if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var r,a=this.showSpaces?" ace_invisible ace_invisible_space":"",d=this.showSpaces?l.stringRepeat(this.SPACE_CHAR,this.tabSize):l.stringRepeat(" ",this.tabSize),h=this.showTabs?" ace_invisible ace_invisible_tab":"",p=this.showTabs?l.stringRepeat(this.TAB_CHAR,this.tabSize):d;(r=this.dom.createElement("span")).className="ace_indent-guide"+a,r.textContent=d,this.$tabStrings[" "]=r,(r=this.dom.createElement("span")).className="ace_indent-guide"+h,r.textContent=p,this.$tabStrings["\t"]=r}},this.updateLines=function(e,t,n){if(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)return this.update(e);this.config=e;for(var r=Math.max(t,e.firstRow),a=Math.min(n,e.lastRow),l=this.element.childNodes,d=0,h=e.firstRow;h<r;h++){if(p=this.session.getFoldLine(h)){if(p.containsRow(r)){r=p.start.row;break}h=p.end.row}d++}for(var p,f=!1,y=(h=r,(p=this.session.getNextFoldLine(h))?p.start.row:1/0);h>y&&(h=p.end.row+1,y=(p=this.session.getNextFoldLine(h,p))?p.start.row:1/0),!(h>a);){var w=l[d++];if(w){this.dom.removeChildren(w),this.$renderLine(w,h,h==y&&p),f&&(w.style.top=this.$lines.computeLineTop(h,e,this.session)+"px");var x=e.lineHeight*this.session.getRowLength(h)+"px";w.style.height!=x&&(f=!0,w.style.height=x)}h++}if(f)for(;d<this.$lines.cells.length;){var j=this.$lines.cells[d++];j.element.style.top=this.$lines.computeLineTop(j.row,e,this.session)+"px"}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=e.lastRow,r=t?t.lastRow:-1;if(!t||r<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var a=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);a>0;a--)this.$lines.shift();if(t.lastRow>e.lastRow)for(a=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);a>0;a--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLinesFragment(e,e.firstRow,t.firstRow-1)),e.lastRow>t.lastRow&&this.$lines.push(this.$renderLinesFragment(e,t.lastRow+1,e.lastRow))},this.$renderLinesFragment=function(e,t,n){for(var r=[],l=t,d=this.session.getNextFoldLine(l),h=d?d.start.row:1/0;l>h&&(l=d.end.row+1,h=(d=this.session.getNextFoldLine(l,d))?d.start.row:1/0),!(l>n);){var p=this.$lines.createCell(l,e,this.session),f=p.element;this.dom.removeChildren(f),a.setStyle(f.style,"height",this.$lines.computeLineHeight(l,e,this.session)+"px"),a.setStyle(f.style,"top",this.$lines.computeLineTop(l,e,this.session)+"px"),this.$renderLine(f,l,l==h&&d),this.$useLineGroups()?f.className="ace_line_group":f.className="ace_line",r.push(p),l++}return r},this.update=function(e){this.$lines.moveContainer(e),this.config=e;for(var t=e.firstRow,n=e.lastRow,r=this.$lines;r.getLength();)r.pop();r.push(this.$renderLinesFragment(e,t,n))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,n,r){for(var a,d=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,h=this.dom.createFragment(this.element),p=0;a=d.exec(r);){var f=a[1],y=a[2],w=a[3],x=a[4],j=a[5];if(this.showSpaces||!y){var O=p!=a.index?r.slice(p,a.index):"";if(p=a.index+a[0].length,O&&h.appendChild(this.dom.createTextNode(O,this.element)),f){var C=this.session.getScreenTabSize(t+a.index);h.appendChild(this.$tabStrings[C].cloneNode(!0)),t+=C-1}else if(y){if(this.showSpaces)(_=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",_.textContent=l.stringRepeat(this.SPACE_CHAR,y.length),h.appendChild(_);else h.appendChild(this.com.createTextNode(y,this.element))}else if(w){(_=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",_.textContent=l.stringRepeat(this.SPACE_CHAR,w.length),h.appendChild(_)}else if(x){t+=1,(_=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",_.className=this.showSpaces?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",_.textContent=this.showSpaces?this.SPACE_CHAR:x,h.appendChild(_)}else if(j){t+=1,(_=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",_.className="ace_cjk",_.textContent=j,h.appendChild(_)}}}if(h.appendChild(this.dom.createTextNode(p?r.slice(p):r,this.element)),this.$textToken[n.type])e.appendChild(h);else{var S="ace_"+n.type.replace(/\./g," ace_"),_=this.dom.createElement("span");"fold"==n.type&&(_.style.width=n.value.length*this.config.characterWidth+"px"),_.className=S,_.appendChild(h),e.appendChild(_)}return t+r.length},this.renderIndentGuide=function(e,t,n){var r=t.search(this.$indentGuideRe);if(r<=0||r>=n)return t;if(" "==t[0]){for(var a=(r-=r%this.tabSize)/this.tabSize,l=0;l<a;l++)e.appendChild(this.$tabStrings[" "].cloneNode(!0));return t.substr(r)}if("\t"==t[0]){for(l=0;l<r;l++)e.appendChild(this.$tabStrings["\t"].cloneNode(!0));return t.substr(r)}return t},this.$createLineElement=function(e){var t=this.dom.createElement("div");return t.className="ace_line",t.style.height=this.config.lineHeight+"px",t},this.$renderWrappedLine=function(e,t,n){var r=0,a=0,d=n[0],h=0,p=this.$createLineElement();e.appendChild(p);for(var f=0;f<t.length;f++){var y=t[f],w=y.value;if(0==f&&this.displayIndentGuides){if(r=w.length,!(w=this.renderIndentGuide(p,w,d)))continue;r-=w.length}if(r+w.length<d)h=this.$renderToken(p,h,y,w),r+=w.length;else{for(;r+w.length>=d;)h=this.$renderToken(p,h,y,w.substring(0,d-r)),w=w.substring(d-r),r=d,p=this.$createLineElement(),e.appendChild(p),p.appendChild(this.dom.createTextNode(l.stringRepeat(" ",n.indent),this.element)),h=0,d=n[++a]||Number.MAX_VALUE;0!=w.length&&(r+=w.length,h=this.$renderToken(p,h,y,w))}}n[n.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(p,h,null,"",!0)},this.$renderSimpleLine=function(e,t){var n=0,r=t[0],a=r.value;this.displayIndentGuides&&(a=this.renderIndentGuide(e,a)),a&&(n=this.$renderToken(e,n,r,a));for(var l=1;l<t.length;l++){if(n+(a=(r=t[l]).value).length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,n,r,a);n=this.$renderToken(e,n,r,a)}},this.$renderOverflowMessage=function(e,t,n,r,a){n&&this.$renderToken(e,t,n,r.slice(0,this.MAX_LINE_LENGTH-t));var l=this.dom.createElement("span");l.className="ace_inline_button ace_keyword ace_toggle_wrap",l.textContent=a?"<hide>":"<click to see more...>",e.appendChild(l)},this.$renderLine=function(e,t,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var r=this.$getFoldLineTokens(t,n);else r=this.session.getTokens(t);var a=e;if(r.length){var l=this.session.getRowSplitData(t);if(l&&l.length){this.$renderWrappedLine(e,r,l);a=e.lastChild}else{a=e;this.$useLineGroups()&&(a=this.$createLineElement(),e.appendChild(a)),this.$renderSimpleLine(a,r)}}else this.$useLineGroups()&&(a=this.$createLineElement(),e.appendChild(a));if(this.showEOL&&a){n&&(t=n.end.row);var d=this.dom.createElement("span");d.className="ace_invisible ace_invisible_eol",d.textContent=t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,a.appendChild(d)}},this.$getFoldLineTokens=function(e,t){var n=this.session,r=[];var a=n.getTokens(e);return t.walk((function(e,t,l,d,h){null!=e?r.push({type:"fold",value:e}):(h&&(a=n.getTokens(t)),a.length&&function(e,t,n){for(var a=0,l=0;l+e[a].value.length<t;)if(l+=e[a].value.length,++a==e.length)return;for(l!=t&&((d=e[a].value.substring(t-l)).length>n-t&&(d=d.substring(0,n-t)),r.push({type:e[a].type,value:d}),l=t+d.length,a+=1);l<n&&a<e.length;){var d;(d=e[a].value).length+l>n?r.push({type:e[a].type,value:d.substring(0,n-l)}):r.push(e[a]),l+=d.length,a+=1}}(a,d,l))}),t.end.row,this.session.getLine(t.end.row).length),r},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){}}).call(p.prototype),t.Text=p})),ace.define("ace/layer/cursor",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),r.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)};(function(){this.$updateOpacity=function(e){for(var t=this.cursors,n=t.length;n--;)r.setStyle(t[n].style,"opacity",e?"":"0")},this.$startCssAnimation=function(){for(var e=this.cursors,t=e.length;t--;)e[t].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){r.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){r.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e!=this.smoothBlinking&&(this.smoothBlinking=e,r.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.restartTimer())},this.addCursor=function(){var e=r.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,r.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,r.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&r.removeCssClass(this.element,"ace_smooth-blinking"),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&setTimeout(function(){r.addCssClass(this.element,"ace_smooth-blinking")}.bind(this)),r.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var t=function(){this.timeoutId=setTimeout((function(){e(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){e(!0),t()}),this.blinkInterval),t()}else this.$stopCssAnimation()},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),top:(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight}},this.isCursorInView=function(e,t){return e.top>=0&&e.top<t.maxHeight},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,a=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);n=0;for(var l=t.length;n<l;n++){var d=this.getPixelPosition(t[n].cursor,!0);if(!((d.top>e.height+e.offset||d.top<0)&&n>1)){var h=this.cursors[a++]||this.addCursor(),p=h.style;this.drawCursor?this.drawCursor(h,d,e,t[n],this.session):this.isCursorInView(d,e)?(r.setStyle(p,"display","block"),r.translate(h,d.left,d.top),r.setStyle(p,"width",Math.round(e.characterWidth)+"px"),r.setStyle(p,"height",e.lineHeight+"px")):r.setStyle(p,"display","none")}}for(;this.cursors.length>a;)this.removeCursor();var f=this.session.getOverwrite();this.$setOverwrite(f),this.$pixelPos=d,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?r.addCssClass(this.element,"ace_overwrite-cursors"):r.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(a.prototype),t.Cursor=a})),ace.define("ace/scrollbar",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/dom"),l=e("./lib/event"),d=e("./lib/event_emitter").EventEmitter,h=function(e){this.element=a.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=a.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent=" ",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,l.addListener(this.element,"scroll",this.onScroll.bind(this)),l.addListener(this.element,"mousedown",l.preventDefault)};(function(){r.implement(this,d),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1}}).call(h.prototype);var p=function(e,t){h.call(this,e),this.scrollTop=0,this.scrollHeight=0,t.$scrollbarWidth=this.width=a.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};r.inherits(p,h),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=this.setScrollHeight=function(e){this.scrollHeight=e,e>32768?(this.coeff=32768/e,e=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)}}.call(p.prototype);var f=function(e,t){h.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};r.inherits(f,h),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(f.prototype),t.ScrollBar=p,t.ScrollBarV=p,t.ScrollBarH=f,t.VScrollBar=p,t.HScrollBar=f})),ace.define("ace/renderloop",[],(function(e,t,n){"use strict";var r=e("./lib/event"),a=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=t||window;var n=this;this._flush=function(e){n.pending=!1;var t=n.changes;if(t&&(r.blockIdle(100),n.changes=0,n.onRender(t)),n.changes){if(n.$recursionLimit--<0)return;n.schedule()}else n.$recursionLimit=2}};(function(){this.schedule=function(e){this.changes=this.changes|e,this.changes&&!this.pending&&(r.nextFrame(this._flush),this.pending=!0)},this.clear=function(e){var t=this.changes;return this.changes=0,t}}).call(a.prototype),t.RenderLoop=a})),ace.define("ace/layer/font_metrics",[],(function(e,t,n){var r=e("../lib/oop"),a=e("../lib/dom"),l=e("../lib/lang"),d=e("../lib/event"),h=e("../lib/useragent"),p=e("../lib/event_emitter").EventEmitter,f="function"==typeof ResizeObserver,y=200,w=t.FontMetrics=function(e){this.el=a.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=a.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=a.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.textContent=l.stringRepeat("X",256),this.$characterSize={width:0,height:0},f?this.$addObserver():this.checkForSizeChanges()};(function(){r.implement(this,p),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",h.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(e){if(void 0===e&&(e=this.$measureSizes()),e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver((function(t){e.checkForSizeChanges()})),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=d.onIdle((function t(){e.checkForSizeChanges(),d.onIdle(t,500)}),500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/256};return 0===t.width||0===t.height?null:t},this.$measureCharWidth=function(e){return this.$main.textContent=l.stringRepeat(e,256),this.$main.getBoundingClientRect().width/256},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(t){return t&&t.parentElement?(window.getComputedStyle(t).zoom||1)*e(t.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=a.buildDom([e(0,0),e(y,0),e(0,y),e(y,y)],this.el)},this.transformCoordinates=function(e,t){e&&(e=l(1/this.$getZoom(this.el),e));function n(e,t,n){var r=e[1]*t[0]-e[0]*t[1];return[(-t[1]*n[0]+t[0]*n[1])/r,(+e[1]*n[0]-e[0]*n[1])/r]}function r(e,t){return[e[0]-t[0],e[1]-t[1]]}function a(e,t){return[e[0]+t[0],e[1]+t[1]]}function l(e,t){return[e*t[0],e*t[1]]}function d(e){var t=e.getBoundingClientRect();return[t.left,t.top]}this.els||this.$initTransformMeasureNodes();var h=d(this.els[0]),p=d(this.els[1]),f=d(this.els[2]),w=d(this.els[3]),x=n(r(w,p),r(w,f),r(a(p,f),a(w,h))),j=l(1+x[0],r(p,h)),O=l(1+x[1],r(f,h));if(t){var C=t,S=x[0]*C[0]/y+x[1]*C[1]/y+1,_=a(l(C[0],j),l(C[1],O));return a(l(1/S/y,_),h)}var k=r(e,h),E=n(r(j,l(x[0],k)),r(O,l(x[1],k)),k);return l(y,E)}}).call(w.prototype)})),ace.define("ace/virtual_renderer",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/dom"),l=e("./config"),d=e("./layer/gutter").Gutter,h=e("./layer/marker").Marker,p=e("./layer/text").Text,f=e("./layer/cursor").Cursor,y=e("./scrollbar").HScrollBar,w=e("./scrollbar").VScrollBar,x=e("./renderloop").RenderLoop,j=e("./layer/font_metrics").FontMetrics,O=e("./lib/event_emitter").EventEmitter,C='.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;padding: 0;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;font-variant-ligatures: no-common-ligatures;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {opacity: 0;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_error_bracket {position: absolute;border-bottom: 1px solid #DE5555;border-radius: 0;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_mobile-menu {position: absolute;line-height: 1.5;border-radius: 4px;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;background: white;box-shadow: 1px 3px 2px grey;border: 1px solid #dcdcdc;color: black;}.ace_dark > .ace_mobile-menu {background: #333;color: #ccc;box-shadow: 1px 3px 2px grey;border: 1px solid #444;}.ace_mobile-button {padding: 2px;cursor: pointer;overflow: hidden;}.ace_mobile-button:hover {background-color: #eee;opacity:1;}.ace_mobile-button:active {background-color: #ddd;}.ace_placeholder {font-family: arial;transform: scale(0.9);transform-origin: left;white-space: pre;opacity: 0.7;margin: 0 10px;}',S=e("./lib/useragent"),_=S.isIE;a.importCssString(C,"ace_editor.css");var k=function(e,t){var n=this;this.container=e||a.createElement("div"),a.addCssClass(this.container,"ace_editor"),a.HI_DPI&&a.addCssClass(this.container,"ace_hidpi"),this.setTheme(t),this.$gutter=a.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=a.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=a.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new d(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new h(this.content);var r=this.$textLayer=new p(this.content);this.canvas=r.element,this.$markerFront=new h(this.content),this.$cursorLayer=new f(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new w(this.container,this),this.scrollBarH=new y(this.container,this),this.scrollBarV.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollTop(e.data-n.scrollMargin.top)})),this.scrollBarH.on("scroll",(function(e){n.$scrollAnimation||n.session.setScrollLeft(e.data-n.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new j(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.on("changeCharacterSize",(function(e){n.updateCharacterSize(),n.onResize(!0,n.gutterWidth,n.$size.width,n.$size.height),n._signal("changeCharacterSize",e)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!S.isIOS,this.$loop=new x(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),l.resetOptions(this),l._signal("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,r.implement(this,O),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin(),a.setStyle(this.scroller.style,"line-height",this.lineHeight+"px")},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t,n){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!n)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,n,r){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var a=this.container;r||(r=a.clientHeight||a.scrollHeight),n||(n=a.clientWidth||a.scrollWidth);var l=this.$updateCachedSize(e,t,n,r);if(!this.$size.scrollerHeight||!n&&!r)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(l|this.$changes,!0):this.$loop.schedule(l|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(e,t,n,r){r-=this.$extraHeight||0;var l=0,d=this.$size,h={width:d.width,height:d.height,scrollerHeight:d.scrollerHeight,scrollerWidth:d.scrollerWidth};if(r&&(e||d.height!=r)&&(d.height=r,l|=this.CHANGE_SIZE,d.scrollerHeight=d.height,this.$horizScroll&&(d.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",l|=this.CHANGE_SCROLL),n&&(e||d.width!=n)){l|=this.CHANGE_SIZE,d.width=n,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,a.setStyle(this.scrollBarH.element.style,"left",t+"px"),a.setStyle(this.scroller.style,"left",t+this.margin.left+"px"),d.scrollerWidth=Math.max(0,n-t-this.scrollBarV.getWidth()-this.margin.h),a.setStyle(this.$gutter.style,"left",this.margin.left+"px");var p=this.scrollBarV.getWidth()+"px";a.setStyle(this.scrollBarH.element.style,"right",p),a.setStyle(this.scroller.style,"right",p),a.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(l|=this.CHANGE_FULL)}return d.$dirty=!n||!r,l&&this._signal("resize",h),l},this.onGutterResize=function(e){var t=this.$showGutter?e:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=a.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=a.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var e=this.textarea.style,t=this.$composition;if(this.$keepTextAreaAtCursor||t){var n=this.$cursorLayer.$pixelPos;if(n){t&&t.markerRange&&(n=this.$cursorLayer.getPixelPosition(t.markerRange.start,!0));var r=this.layerConfig,l=n.top,d=n.left;l-=r.offset;var h=t&&t.useTextareaForIME?this.lineHeight:_?0:1;if(l<0||l>r.height-h)a.translate(this.textarea,0,0);else{var p=1,f=this.$size.height-h;if(t)if(t.useTextareaForIME){var y=this.textarea.value;p=this.characterWidth*this.session.$getStringScreenWidth(y)[0]}else l+=this.lineHeight+2;else l+=this.lineHeight;(d-=this.scrollLeft)>this.$size.scrollerWidth-p&&(d=this.$size.scrollerWidth-p),d+=this.gutterWidth+this.margin.left,a.setStyle(e,"height",h+"px"),a.setStyle(e,"width",p+"px"),a.translate(this.textarea,Math.min(d,this.$size.scrollerWidth-p),Math.min(l,f))}}}else a.translate(this.textarea,-100,0)}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow;return this.session.documentToScreenRow(t,0)*e.lineHeight-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,n,r){var a=this.scrollMargin;a.top=0|e,a.bottom=0|t,a.right=0|r,a.left=0|n,a.v=a.top+a.bottom,a.h=a.left+a.right,a.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-a.top),this.updateFull()},this.setMargin=function(e,t,n,r){var a=this.margin;a.top=0|e,a.bottom=0|t,a.right=0|r,a.left=0|n,a.v=a.top+a.bottom,a.h=a.left+a.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||t)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender",e),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig()|this.$loop.clear(),n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var r=this.scrollTop+(n.firstRow-this.layerConfig.firstRow)*this.lineHeight;r>0&&(this.scrollTop=r,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig()|this.$loop.clear())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),a.translate(this.content,-this.scrollLeft,-n.offset);var l=n.width+2*this.$padding+"px",d=n.minHeight+"px";a.setStyle(this.content.style,"width",l),a.setStyle(this.content.style,"height",d)}if(e&this.CHANGE_H_SCROLL&&(a.translate(this.content,-this.scrollLeft,-n.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL)return this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);if(e&this.CHANGE_SCROLL)return this.$changedLines=null,e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&(e&this.CHANGE_GUTTER||e&this.CHANGE_LINES?this.$gutterLayer.update(n):this.$gutterLayer.scrollLines(n)),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender",e);e&this.CHANGE_TEXT?(this.$changedLines=null,this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n):e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER?this.$showGutter&&this.$gutterLayer.update(n):e&this.CHANGE_CURSOR&&this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(n),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender",e)}else this.$changes|=e},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,n=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(n+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&n>this.$maxPixelHeight&&(n=this.$maxPixelHeight);var r=!(n<=2*this.lineHeight)&&e>t;if(n!=this.desiredHeight||this.$size.height!=this.desiredHeight||r!=this.$vScroll){r!=this.$vScroll&&(this.$vScroll=r,this.scrollBarV.setVisible(r));var a=this.container.clientWidth;this.container.style.height=n+"px",this.$updateCachedSize(!0,this.$gutterWidth,a,n),this.desiredHeight=n,this._signal("autosize")}},this.$computeLayerConfig=function(){var e=this.session,t=this.$size,n=t.height<=2*this.lineHeight,r=this.session.getScreenLength()*this.lineHeight,a=this.$getLongestLine(),l=!n&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-a-2*this.$padding<0),d=this.$horizScroll!==l;d&&(this.$horizScroll=l,this.scrollBarH.setVisible(l));var h=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var p=t.scrollerHeight+this.lineHeight,f=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;r+=f;var y=this.scrollMargin;this.session.setScrollTop(Math.max(-y.top,Math.min(this.scrollTop,r-t.scrollerHeight+y.bottom))),this.session.setScrollLeft(Math.max(-y.left,Math.min(this.scrollLeft,a+2*this.$padding-t.scrollerWidth+y.right)));var w=!n&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-r+f<0||this.scrollTop>y.top),x=h!==w;x&&(this.$vScroll=w,this.scrollBarV.setVisible(w));var j,O,C=this.scrollTop%this.lineHeight,S=Math.ceil(p/this.lineHeight)-1,_=Math.max(0,Math.round((this.scrollTop-C)/this.lineHeight)),k=_+S,E=this.lineHeight;_=e.screenToDocumentRow(_,0);var A=e.getFoldLine(_);A&&(_=A.start.row),j=e.documentToScreenRow(_,0),O=e.getRowLength(_)*E,k=Math.min(e.screenToDocumentRow(k,0),e.getLength()-1),p=t.scrollerHeight+e.getRowLength(k)*E+O,C=this.scrollTop-j*E;var T=0;return(this.layerConfig.width!=a||d)&&(T=this.CHANGE_H_SCROLL),(d||x)&&(T|=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),x&&(a=this.$getLongestLine())),this.layerConfig={width:a,padding:this.$padding,firstRow:_,firstRowScreen:j,lastRow:k,lineHeight:E,characterWidth:this.characterWidth,minHeight:p,maxHeight:r,offset:C,gutterOffset:E?Math.max(0,Math.ceil((C+t.height-t.scrollerHeight)/E)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(a-this.$padding),T},this.$updateLines=function(){if(this.$changedLines){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var n=this.layerConfig;if(!(e>n.lastRow+1||t<n.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(n),void this.$textLayer.update(n)):(this.$textLayer.updateLines(n,e,t),!0)}},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,n){this.scrollCursorIntoView(e,n),this.scrollCursorIntoView(t,n)},this.scrollCursorIntoView=function(e,t,n){if(0!==this.$size.scrollerHeight){var r=this.$cursorLayer.getPixelPosition(e),a=r.left,l=r.top,d=n&&n.top||0,h=n&&n.bottom||0,p=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;p+d>l?(t&&p+d>l+this.lineHeight&&(l-=t*this.$size.scrollerHeight),0===l&&(l=-this.scrollMargin.top),this.session.setScrollTop(l)):p+this.$size.scrollerHeight-h<l+this.lineHeight&&(t&&p+this.$size.scrollerHeight-h<l-this.lineHeight&&(l+=t*this.$size.scrollerHeight),this.session.setScrollTop(l+this.lineHeight+h-this.$size.scrollerHeight));var f=this.scrollLeft;f>a?(a<this.$padding+2*this.layerConfig.characterWidth&&(a=-this.scrollMargin.left),this.session.setScrollLeft(a)):f+this.$size.scrollerWidth<a+this.characterWidth?this.session.setScrollLeft(Math.round(a+this.characterWidth-this.$size.scrollerWidth)):f<=this.$padding&&a-f<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),r=this.$size.scrollerHeight-this.lineHeight,a=n.top-r*(t||0);return this.session.setScrollTop(a),a},this.STEPS=8,this.$calcSteps=function(e,t){var n,r,a=0,l=this.STEPS,d=[];for(a=0;a<l;++a)d.push((n=a/this.STEPS,r=e,(t-e)*(Math.pow(n-1,3)+1)+r));return d},this.scrollToLine=function(e,t,n,r){var a=this.$cursorLayer.getPixelPosition({row:e,column:0}).top;t&&(a-=this.$size.scrollerHeight/2);var l=this.scrollTop;this.session.setScrollTop(a),!1!==n&&this.animateScrolling(l,r)},this.animateScrolling=function(e,t){var n=this.scrollTop;if(this.$animatedScroll){var r=this;if(e!=n){if(this.$scrollAnimation){var a=this.$scrollAnimation.steps;if(a.length&&(e=a[0])==n)return}var l=r.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:l},clearInterval(this.$timer),r.session.setScrollTop(l.shift()),r.session.$scrollTop=n,this.$timer=setInterval((function(){if(!r.session)return clearInterval(r.$timer);l.length?(r.session.setScrollTop(l.shift()),r.session.$scrollTop=n):null!=n?(r.session.$scrollTop=-1,r.session.setScrollTop(n),n=null):(r.$timer=clearInterval(r.$timer),r.$scrollAnimation=null,t&&t())}),10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth-this.margin.left,t=r[0]}else n=this.scroller.getBoundingClientRect();var a=e+this.scrollLeft-n.left-this.$padding,l=a/this.characterWidth,d=Math.floor((t+this.scrollTop-n.top)/this.lineHeight),h=this.$blockCursor?Math.floor(l):Math.round(l);return{row:d,column:h,side:l-h>0?1:-1,offsetX:a}},this.screenToTextCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth-this.margin.left,t=r[0]}else n=this.scroller.getBoundingClientRect();var a=e+this.scrollLeft-n.left-this.$padding,l=a/this.characterWidth,d=this.$blockCursor?Math.floor(l):Math.round(l),h=Math.floor((t+this.scrollTop-n.top)/this.lineHeight);return this.session.screenToDocumentPosition(h,Math.max(d,0),a)},this.textToScreenCoordinates=function(e,t){var n=this.scroller.getBoundingClientRect(),r=this.session.documentToScreenPosition(e,t),a=this.$padding+(this.session.$bidiHandler.isBidiRow(r.row,e)?this.session.$bidiHandler.getPosLeft(r.column):Math.round(r.column*this.characterWidth)),l=r.row*this.lineHeight;return{pageX:n.left+a-this.scrollLeft,pageY:n.top+l-this.scrollTop}},this.visualizeFocus=function(){a.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){a.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition=e,e.cssText||(e.cssText=this.textarea.style.cssText),null==e.useTextareaForIME&&(e.useTextareaForIME=this.$useTextareaForIME),this.$useTextareaForIME?(a.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):e.markerId=this.session.addMarker(e.markerRange,"ace_composition_marker","text")},this.setCompositionText=function(e){var t=this.session.selection.cursor;this.addToken(e,"composition_placeholder",t.row,t.column),this.$moveTextAreaToCursor()},this.hideComposition=function(){if(this.$composition){this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),a.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText;var e=this.session.selection.cursor;this.removeExtraToken(e.row,e.column),this.$composition=null,this.$cursorLayer.element.style.display=""}},this.addToken=function(e,t,n,r){var a=this.session;a.bgTokenizer.lines[n]=null;var l={type:t,value:e},d=a.getTokens(n);if(null==r)d.push(l);else for(var h=0,p=0;p<d.length;p++){var f=d[p];if(r<=(h+=f.value.length)){var y=f.value.length-(h-r),w=f.value.slice(0,y),x=f.value.slice(y);d.splice(p,1,{type:f.type,value:w},l,{type:f.type,value:x});break}}this.updateLines(n,n)},this.removeExtraToken=function(e,t){this.updateLines(e,e)},this.setTheme=function(e,t){var n=this;if(this.$themeId=e,n._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)d(e);else{var r=e||this.$options.theme.initialValue;l.loadModule(["theme",r],d)}function d(r){if(n.$themeId!=e)return t&&t();if(!r||!r.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");r.$id&&(n.$themeId=r.$id),a.importCssString(r.cssText,r.cssClass,n.container),n.theme&&a.removeCssClass(n.container,n.theme.cssClass);var l="padding"in r?r.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&l!=n.$padding&&n.setPadding(l),n.$theme=r.cssClass,n.theme=r,a.addCssClass(n.container,r.cssClass),a.setCssClass(n.container,"ace_dark",r.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:r}),t&&t()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){a.setCssClass(this.container,e,!1!==t)},this.unsetStyle=function(e){a.removeCssClass(this.container,e)},this.setCursorStyle=function(e){a.setStyle(this.scroller.style,"cursor",e)},this.setMouseCursor=function(e){a.setStyle(this.scroller.style,"cursor",e)},this.attachToShadowRoot=function(){a.importCssString(C,"ace_editor.css",this.container)},this.destroy=function(){this.freeze(),this.$fontMetrics.destroy(),this.$cursorLayer.destroy(),this.removeAllListeners(),this.container.textContent=""}}).call(k.prototype),l.defineOptions(k.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){a.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){this.$gutterLayer.setHighlightGutterLine(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!S.isMobile&&!S.isIE}}),t.VirtualRenderer=k})),ace.define("ace/worker/worker_client",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),a=e("../lib/net"),l=e("../lib/event_emitter").EventEmitter,d=e("../config");function h(e){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(d.get("loadWorkerFromBlob")){var t=function(e){var t="importScripts('"+a.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(e){var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return n.append(t),n.getBlob("application/javascript")}}(e),n=(window.URL||window.webkitURL).createObjectURL(t);return new Worker(n)}return new Worker(e)}var p=function(e){e.postMessage||(e=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=e,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){r.implement(this,l),this.$createWorkerFromOldConfig=function(t,n,r,a,l){if(e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl),d.get("packaged")||!e.toUrl)a=a||d.moduleUrl(n,"worker");else{var p=this.$normalizePath;a=a||p(e.toUrl("ace/worker/worker.js",null,"_"));var f={};t.forEach((function(t){f[t]=p(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=h(a),l&&this.send("importScripts",l),this.$worker.postMessage({init:!0,tlns:f,module:n,classname:r}),this.$worker},this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return a.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var r=this.callbackId++;this.callbacks[r]=n,t.push(r)}this.send(e,t)},this.emit=function(e,t){try{t.data&&t.data.err&&(t.data.err={message:t.data.err.message,stack:t.data.err.stack,code:t.data.err.code}),this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==e.action?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(p.prototype);t.UIWorkerClient=function(e,t,n){var r=null,a=!1,h=Object.create(l),f=[],y=new p({messageBuffer:f,terminate:function(){},postMessage:function(e){f.push(e),r&&(a?setTimeout(w):w())}});y.setEmitSync=function(e){a=e};var w=function(){var e=f.shift();e.command?r[e.command].apply(r,e.args):e.event&&h._signal(e.event,e.data)};return h.postMessage=function(e){y.onMessage({data:e})},h.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},h.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},d.loadModule(["worker",t],(function(e){for(r=new e[n](h);f.length;)w()})),y},t.WorkerClient=p,t.createWorker=h})),ace.define("ace/placeholder",[],(function(e,t,n){"use strict";var r=e("./range").Range,a=e("./lib/event_emitter").EventEmitter,l=e("./lib/oop"),d=function(e,t,n,r,a,l){var d=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=a,this.othersClass=l,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=r,this.$onCursorChange=function(){setTimeout((function(){d.onCursorChange()}))},this.$pos=n;var h=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=h.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){l.implement(this,a),this.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var a=this.pos;a.$insertRight=!0,a.detach(),a.markerId=n.addMarker(new r(a.row,a.column,a.row,a.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(n){var r=t.createAnchor(n.row,n.column);r.$insertRight=!0,r.detach(),e.others.push(r)})),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach((function(n){n.markerId=e.addMarker(new r(n.row,n.column,n.row,n.column+t.length),t.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){if(this.$updating)return this.updateAnchors(e);var t=e;if(t.start.row===t.end.row&&t.start.row===this.pos.row){this.$updating=!0;var n="insert"===e.action?t.end.column-t.start.column:t.start.column-t.end.column,a=t.start.column>=this.pos.column&&t.start.column<=this.pos.column+this.length+1,l=t.start.column-this.pos.column;if(this.updateAnchors(e),a&&(this.length+=n),a&&!this.session.$fromUndo)if("insert"===e.action)for(var d=this.others.length-1;d>=0;d--){var h={row:(p=this.others[d]).row,column:p.column+l};this.doc.insertMergedLines(h,e.lines)}else if("remove"===e.action)for(d=this.others.length-1;d>=0;d--){var p;h={row:(p=this.others[d]).row,column:p.column+l};this.doc.remove(new r(h.row,h.column,h.row,h.column-n))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var e=this,t=this.session,n=function(n,a){t.removeMarker(n.markerId),n.markerId=t.addMarker(new r(n.row,n.column,n.row,n.column+e.length),a,null,!1)};n(this.pos,this.mainClass);for(var a=this.others.length;a--;)n(this.others[a],this.othersClass)}},this.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.off("change",this.$onUpdate),this.session.selection.off("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,n=0;n<t;n++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(d.prototype),t.PlaceHolder=d})),ace.define("ace/mouse/multi_select_handler",[],(function(e,t,n){var r=e("../lib/event"),a=e("../lib/useragent");function l(e,t){return e.row==t.row&&e.column==t.column}t.onMouseDown=function(e){var t=e.domEvent,n=t.altKey,d=t.shiftKey,h=t.ctrlKey,p=e.getAccelKey(),f=e.getButton();if(h&&a.isMac&&(f=t.button),e.editor.inMultiSelectMode&&2==f)e.editor.textInput.onContextMenu(e.domEvent);else if(h||n||p){if(0===f){var y,w=e.editor,x=w.selection,j=w.inMultiSelectMode,O=e.getDocumentPosition(),C=x.getCursor(),S=e.inSelection()||x.isEmpty()&&l(O,C),_=e.x,k=e.y,E=w.session,A=w.renderer.pixelToScreenCoordinates(_,k),T=A;if(w.$mouseHandler.$enableJumpToDef)h&&n||p&&n?y=d?"block":"add":n&&w.$blockSelectEnabled&&(y="block");else if(p&&!n){if(y="add",!j&&d)return}else n&&w.$blockSelectEnabled&&(y="block");if(y&&a.isMac&&t.ctrlKey&&w.$mouseHandler.cancelContextMenu(),"add"==y){if(!j&&S)return;if(!j){var R=x.toOrientedRange();w.addSelectionMarker(R)}var I=x.rangeList.rangeAtPoint(O);w.inVirtualSelectionMode=!0,d&&(I=null,R=x.ranges[0]||R,w.removeSelectionMarker(R)),w.once("mouseup",(function(){var e=x.toOrientedRange();I&&e.isEmpty()&&l(I.cursor,e.cursor)?x.substractPoint(e.cursor):(d?x.substractPoint(R.cursor):R&&(w.removeSelectionMarker(R),x.addRange(R)),x.addRange(e)),w.inVirtualSelectionMode=!1}))}else if("block"==y){var P;e.stop(),w.inVirtualSelectionMode=!0;var D=[],M=function(){var e=w.renderer.pixelToScreenCoordinates(_,k),t=E.screenToDocumentPosition(e.row,e.column,e.offsetX);l(T,e)&&l(t,x.lead)||(T=e,w.selection.moveToPosition(t),w.renderer.scrollCursorIntoView(),w.removeSelectionMarkers(D),D=x.rectangularRangeBlock(T,A),w.$mouseHandler.$clickSelection&&1==D.length&&D[0].isEmpty()&&(D[0]=w.$mouseHandler.$clickSelection.clone()),D.forEach(w.addSelectionMarker,w),w.updateSelectionMarkers())};j&&!p?x.toSingleRange():!j&&p&&(P=x.toOrientedRange(),w.addSelectionMarker(P)),d?A=E.documentToScreenPosition(x.lead):x.moveToPosition(O),T={row:-1,column:-1};var L=M;r.capture(w.container,(function(e){_=e.clientX,k=e.clientY}),(function(e){M(),clearInterval(F),w.removeSelectionMarkers(D),D.length||(D=[x.toOrientedRange()]),P&&(w.removeSelectionMarker(P),x.toSingleRange(P));for(var t=0;t<D.length;t++)x.addRange(D[t]);w.inVirtualSelectionMode=!1,w.$mouseHandler.$clickSelection=null}));var F=setInterval((function(){L()}),20);return e.preventDefault()}}}else 0===f&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",[],(function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"toggleSplitSelectionIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.rangeCount>1?e.multiSelect.joinSelections():e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"splitSelectionIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.splitIntoLines()},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],t.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var r=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new r(t.multiSelectCommands)})),ace.define("ace/multi_select",[],(function(e,t,n){var r=e("./range_list").RangeList,a=e("./range").Range,l=e("./selection").Selection,d=e("./mouse/multi_select_handler").onMouseDown,h=e("./lib/event"),p=e("./lib/lang"),f=e("./commands/multi_select_commands");t.commands=f.defaultCommands.concat(f.multiSelectCommands);var y=new(0,e("./search").Search);var w=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(w.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var n=this.toOrientedRange();if(this.rangeList.add(n),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(n),this.$onAddRange(n)}e.cursor||(e.cursor=e.end);var r=this.rangeList.add(e);return this.$onAddRange(e),r.length&&this.$onRemoveRange(r),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length&&this.$onRemoveRange(e)},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var n=e.length;n--;){var r=this.ranges.indexOf(e[n]);this.ranges.splice(r,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new r,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){for(var e=this.ranges.length?this.ranges:[this.getRange()],t=[],n=0;n<e.length;n++){var r=e[n],l=r.start.row,d=r.end.row;if(l===d)t.push(r.clone());else{for(t.push(new a(l,r.start.column,l,this.session.getLine(l).length));++l<d;)t.push(this.getLineRange(l,!0));t.push(new a(d,0,d,r.end.column))}0!=n||this.isBackwards()||(t=t.reverse())}this.toSingleRange();for(n=t.length;n--;)this.addRange(t[n])},this.joinSelections=function(){var e=this.rangeList.ranges,t=e[e.length-1],n=a.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=a.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var r=this.session.documentToScreenPosition(this.cursor),l=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(r,l).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,n){var r=[],l=e.column<t.column;if(l)var d=e.column,h=t.column,p=e.offsetX,f=t.offsetX;else d=t.column,h=e.column,p=t.offsetX,f=e.offsetX;var y,w,x,j=e.row<t.row;if(j)var O=e.row,C=t.row;else O=t.row,C=e.row;d<0&&(d=0),O<0&&(O=0),O==C&&(n=!0);for(var S=O;S<=C;S++){var _=a.fromPoints(this.session.screenToDocumentPosition(S,d,p),this.session.screenToDocumentPosition(S,h,f));if(_.isEmpty()){if(y&&(w=_.end,x=y,w.row==x.row&&w.column==x.column))break;y=_.end}_.cursor=l?_.start:_.end,r.push(_)}if(j&&r.reverse(),!n){for(var k=r.length-1;r[k].isEmpty()&&k>0;)k--;if(k>0)for(var E=0;r[E].isEmpty();)E++;for(var A=k;A>=E;A--)r[A].isEmpty()&&r.splice(A,1)}return r}}.call(l.prototype);var x=e("./editor").Editor;function j(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",d),e.commands.addCommands(f.defaultCommands),function(e){if(!e.textInput)return;var t=e.textInput.getElement(),n=!1;function r(t){n&&(e.renderer.setMouseCursor(""),n=!1)}h.addListener(t,"keydown",(function(t){var a=18==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&a?n||(e.renderer.setMouseCursor("crosshair"),n=!0):n&&r()}),e),h.addListener(t,"keyup",r,e),h.addListener(t,"blur",r,e)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,n=e.length;n--;){var r=e[n];if(r.marker){this.session.removeMarker(r.marker);var a=t.indexOf(r);-1!=a&&t.splice(a,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(f.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(f.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,n=e.editor;if(n.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?r=n.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?r=n.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(n.exitMultiSelectMode(),r=t.exec(n,e.args||{})):r=t.multiSelectAction(n,e.args||{});else{var r=t.exec(n,e.args||{});n.multiSelect.addRange(n.multiSelect.toOrientedRange()),n.multiSelect.mergeOverlappingRanges()}return r}},this.forEachSelection=function(e,t,n){if(!this.inVirtualSelectionMode){var r,a=n&&n.keepOrder,d=1==n||n&&n.$byLines,h=this.session,p=this.selection,f=p.rangeList,y=(a?p:f).ranges;if(!y.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var w=p._eventRegistry;p._eventRegistry={};var x=new l(h);this.inVirtualSelectionMode=!0;for(var j=y.length;j--;){if(d)for(;j>0&&y[j].start.row==y[j-1].end.row;)j--;x.fromOrientedRange(y[j]),x.index=j,this.selection=h.selection=x;var O=e.exec?e.exec(this,t||{}):e(this,t||{});r||void 0===O||(r=O),x.toOrientedRange(y[j])}x.detach(),this.selection=h.selection=p,this.inVirtualSelectionMode=!1,p._eventRegistry=w,p.mergeOverlappingRanges(),p.ranges[0]&&p.fromOrientedRange(p.ranges[0]);var C=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),C&&C.from==C.to&&this.renderer.animateScrolling(C.from),r}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,n=[],r=0;r<t.length;r++)n.push(this.session.getTextRange(t[r]));var a=this.session.getDocument().getNewLineCharacter();(e=n.join(a)).length==(n.length-1)*a.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var n=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var r=t==this.multiSelect.anchor?n.cursor==n.start?n.end:n.start:n.cursor;r.row!=t.row||this.session.$clipPositionToDocument(r.row,r.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,n){if((t=t||{}).needle=e||t.needle,null==t.needle){var r=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(r)}this.$search.set(t);var a=this.$search.findAll(this.session);if(!a.length)return 0;var l=this.multiSelect;n||l.toSingleRange(a[0]);for(var d=a.length;d--;)l.addRange(a[d],!0);return r&&l.rangeList.rangeAtPoint(r.start)&&l.addRange(r,!0),a.length},this.selectMoreLines=function(e,t){var n=this.selection.toOrientedRange(),r=n.cursor==n.end,l=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(l.column=this.selection.$desiredColumn);var d,h=this.session.screenToDocumentPosition(l.row+e,l.column);if(n.isEmpty())f=h;else var p=this.session.documentToScreenPosition(r?n.end:n.start),f=this.session.screenToDocumentPosition(p.row+e,p.column);r?(d=a.fromPoints(h,f)).cursor=d.start:(d=a.fromPoints(f,h)).cursor=d.end;if(d.desiredColumn=l.column,this.selection.inMultiSelectMode){if(t)var y=n.cursor}else this.selection.addRange(n);this.selection.addRange(d),y&&this.selection.substractPoint(y)},this.transposeSelections=function(e){for(var t=this.session,n=t.multiSelect,r=n.ranges,a=r.length;a--;){if((h=r[a]).isEmpty()){var l=t.getWordRange(h.start.row,h.start.column);h.start.row=l.start.row,h.start.column=l.start.column,h.end.row=l.end.row,h.end.column=l.end.column}}n.mergeOverlappingRanges();var d=[];for(a=r.length;a--;){var h=r[a];d.unshift(t.getTextRange(h))}e<0?d.unshift(d.pop()):d.push(d.shift());for(a=r.length;a--;){l=(h=r[a]).clone();t.replace(h,d[a]),h.start.row=l.start.row,h.start.column=l.start.column}n.fromOrientedRange(n.ranges[0])},this.selectMore=function(e,t,n){var r=this.session,a=r.multiSelect.toOrientedRange();if(!a.isEmpty()||((a=r.getWordRange(a.start.row,a.start.column)).cursor=-1==e?a.start:a.end,this.multiSelect.addRange(a),!n)){var l=r.getTextRange(a),d=function(e,t,n){return y.$options.wrap=!0,y.$options.needle=t,y.$options.backwards=-1==n,y.find(e)}(r,l,e);d&&(d.cursor=-1==e?d.start:d.end,this.session.unfold(d),this.multiSelect.addRange(d),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(a.cursor)}},this.alignCursors=function(){var e=this.session,t=e.multiSelect,n=t.ranges,r=-1,l=n.filter((function(e){if(e.cursor.row==r)return!0;r=e.cursor.row}));if(n.length&&l.length!=n.length-1){l.forEach((function(e){t.substractPoint(e.cursor)}));var d=0,h=1/0,f=n.map((function(t){var n=t.cursor,r=e.getLine(n.row).substr(n.column).search(/\S/g);return-1==r&&(r=0),n.column>d&&(d=n.column),r<h&&(h=r),r}));n.forEach((function(t,n){var r=t.cursor,l=d-r.column,y=f[n]-h;l>y?e.insert(r,p.stringRepeat(" ",l-y)):e.remove(new a(r.row,r.column,r.row,r.column-l+y)),t.start.column=t.end.column=d,t.start.row=t.end.row=r.row,t.cursor=t.end})),t.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var y=this.selection.getRange(),w=y.start.row,x=y.end.row,j=w==x;if(j){var O,C=this.session.getLength();do{O=this.session.getLine(x)}while(/[=:]/.test(O)&&++x<C);do{O=this.session.getLine(w)}while(/[=:]/.test(O)&&--w>0);w<0&&(w=0),x>=C&&(x=C-1)}var S=this.session.removeFullLines(w,x);S=this.$reAlignText(S,j),this.session.insert({row:w,column:0},S.join("\n")+"\n"),j||(y.start.column=0,y.end.column=S[S.length-1].length),this.selection.setRange(y)}},this.$reAlignText=function(e,t){var n,r,a,l=!0,d=!0;return e.map((function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==n?(n=t[1].length,r=t[2].length,a=t[3].length,t):(n+r+a!=t[1].length+t[2].length+t[3].length&&(d=!1),n!=t[1].length&&(l=!1),n>t[1].length&&(n=t[1].length),r<t[2].length&&(r=t[2].length),a>t[3].length&&(a=t[3].length),t):[e]})).map(t?f:l?d?function(e){return e[2]?h(n+r-e[2].length)+e[2]+h(a)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:f:function(e){return e[2]?h(n)+e[2]+h(a)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function h(e){return p.stringRepeat(" ",e)}function f(e){return e[2]?h(n)+e[2]+h(r-e[2].length+a)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(x.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var n=e.oldSession;n&&(n.multiSelect.off("addRange",this.$onAddRange),n.multiSelect.off("removeRange",this.$onRemoveRange),n.multiSelect.off("multiSelect",this.$onMultiSelect),n.multiSelect.off("singleSelect",this.$onSingleSelect),n.multiSelect.lead.off("change",this.$checkMultiselectChange),n.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=j,e("./config").defineOptions(x.prototype,"editor",{enableMultiselect:{set:function(e){j(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",d)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",d))},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})})),ace.define("ace/mode/folding/fold_mode",[],(function(e,t,n){"use strict";var r=e("../../range").Range,a=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,n){var r=e.getLine(n);return this.foldingStartMarker.test(r)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(r)?"end":""},this.getFoldWidgetRange=function(e,t,n){return null},this.indentationBlock=function(e,t,n){var a=/\S/,l=e.getLine(t),d=l.search(a);if(-1!=d){for(var h=n||l.length,p=e.getLength(),f=t,y=t;++t<p;){var w=e.getLine(t).search(a);if(-1!=w){if(w<=d){var x=e.getTokenAt(t,0);if(!x||"string"!==x.type)break}y=t}}if(y>f){var j=e.getLine(y).length;return new r(f,h,y,j)}}},this.openingBracketBlock=function(e,t,n,a,l){var d={row:n,column:a+1},h=e.$findClosingBracket(t,d,l);if(h){var p=e.foldWidgets[h.row];return null==p&&(p=e.getFoldWidget(h.row)),"start"==p&&h.row>d.row&&(h.row--,h.column=e.getLine(h.row).length),r.fromPoints(d,h)}},this.closingBracketBlock=function(e,t,n,a,l){var d={row:n,column:a},h=e.$findOpeningBracket(t,d);if(h)return h.column++,d.column--,r.fromPoints(h,d)}}).call(a.prototype)})),ace.define("ace/theme/textmate",[],(function(e,t,n){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t.$id="ace/theme/textmate",e("../lib/dom").importCssString(t.cssText,t.cssClass)})),ace.define("ace/line_widgets",[],(function(e,t,n){"use strict";var r=e("./lib/dom");function a(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach((function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)})),e},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var n=this.session.lineWidgets;n&&n.forEach((function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))}))}},this.updateOnFold=function(e,t){var n=t.lineWidgets;if(n&&e.action){for(var r=e.data,a=r.start.row,l=r.end.row,d="add"==e.action,h=a+1;h<l;h++)n[h]&&(n[h].hidden=d);n[l]&&(d?n[a]?n[l].hidden=d:n[a]=n[l]:(n[a]==n[l]&&(n[a]=void 0),n[l].hidden=d))}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var n=e.start.row,r=e.end.row-n;if(0===r);else if("remove"==e.action){var a=t.splice(n+1,r);!t[n]&&a[a.length-1]&&(t[n]=a.pop()),a.forEach((function(e){e&&this.removeLineWidget(e)}),this),this.$updateRows()}else{var l=new Array(r);t[n]&&null!=t[n].column&&e.start.column>t[n].column&&n++,l.unshift(n,0),t.splice.apply(t,l),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach((function(e,n){if(e)for(t=!1,e.row=n;e.$oldWidget;)e.$oldWidget.row=n,e=e.$oldWidget})),t&&(this.session.lineWidgets=null)}},this.$registerLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var t=this.session.lineWidgets[e.row];return t&&(e.$oldWidget=t,t.el&&t.el.parentNode&&(t.el.parentNode.removeChild(t.el),t._inDocument=!1)),this.session.lineWidgets[e.row]=e,e},this.addLineWidget=function(e){if(this.$registerLineWidget(e),e.session=this.session,!this.editor)return e;var t=this.editor.renderer;e.html&&!e.el&&(e.el=r.createElement("div"),e.el.innerHTML=e.html),e.el&&(r.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,t.container.appendChild(e.el),e._inDocument=!0,e.coverGutter||(e.el.style.zIndex=3),null==e.pixelHeight&&(e.pixelHeight=e.el.offsetHeight)),null==e.rowCount&&(e.rowCount=e.pixelHeight/t.layerConfig.lineHeight);var n=this.session.getFoldAt(e.row,0);if(e.$fold=n,n){var a=this.session.lineWidgets;e.row!=n.end.row||a[n.start.row]?e.hidden=!0:a[n.start.row]=e}return this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,t),this.onWidgetChanged(e),e},this.removeLineWidget=function(e){if(e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}if(this.session.lineWidgets){var t=this.session.lineWidgets[e.row];if(t==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else for(;t;){if(t.$oldWidget==e){t.$oldWidget=e.$oldWidget;break}t=t.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(e){for(var t=this.session.lineWidgets,n=t&&t[e],r=[];n;)r.push(n),n=n.$oldWidget;return r},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var n=this.session._changedWidgets,r=t.layerConfig;if(n&&n.length){for(var a=1/0,l=0;l<n.length;l++){var d=n[l];if(d&&d.el&&d.session==this.session){if(!d._inDocument){if(this.session.lineWidgets[d.row]!=d)continue;d._inDocument=!0,t.container.appendChild(d.el)}d.h=d.el.offsetHeight,d.fixedWidth||(d.w=d.el.offsetWidth,d.screenWidth=Math.ceil(d.w/r.characterWidth));var h=d.h/r.lineHeight;d.coverLine&&(h-=this.session.getRowLineCount(d.row))<0&&(h=0),d.rowCount!=h&&(d.rowCount=h,d.row<a&&(a=d.row))}}a!=1/0&&(this.session._emit("changeFold",{data:{start:{row:a}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var n=t.layerConfig,r=this.session.lineWidgets;if(r){for(var a=Math.min(this.firstRow,n.firstRow),l=Math.max(this.lastRow,n.lastRow,r.length);a>0&&!r[a];)a--;this.firstRow=n.firstRow,this.lastRow=n.lastRow,t.$cursorLayer.config=n;for(var d=a;d<=l;d++){var h=r[d];if(h&&h.el)if(h.hidden)h.el.style.top=-100-(h.pixelHeight||0)+"px";else{h._inDocument||(h._inDocument=!0,t.container.appendChild(h.el));var p=t.$cursorLayer.getPixelPosition({row:d,column:0},!0).top;h.coverLine||(p+=n.lineHeight*this.session.getRowLineCount(h.row)),h.el.style.top=p-n.offset+"px";var f=h.coverGutter?0:t.gutterWidth;h.fixedWidth||(f-=t.scrollLeft),h.el.style.left=f+"px",h.fullWidth&&h.screenWidth&&(h.el.style.minWidth=n.width+2*n.padding+"px"),h.fixedWidth?h.el.style.right=t.scrollBar.getWidth()+"px":h.el.style.right=""}}}}}).call(a.prototype),t.LineWidgets=a})),ace.define("ace/ext/error_marker",[],(function(e,t,n){"use strict";var r=e("../line_widgets").LineWidgets,a=e("../lib/dom"),l=e("../range").Range;t.showErrorMarker=function(e,t){var n=e.session;n.widgetManager||(n.widgetManager=new r(n),n.widgetManager.attach(e));var d=e.getCursorPosition(),h=d.row,p=n.widgetManager.getWidgetsAtRow(h).filter((function(e){return"errorMarker"==e.type}))[0];p?p.destroy():h-=t;var f,y=function(e,t,n){var r=e.getAnnotations().sort(l.comparePoints);if(r.length){var a=function(e,t,n){for(var r=0,a=e.length-1;r<=a;){var l=r+a>>1,d=n(t,e[l]);if(d>0)r=l+1;else{if(!(d<0))return l;a=l-1}}return-(r+1)}(r,{row:t,column:-1},l.comparePoints);a<0&&(a=-a-1),a>=r.length?a=n>0?0:r.length-1:0===a&&n<0&&(a=r.length-1);var d=r[a];if(d&&n){if(d.row===t){do{d=r[a+=n]}while(d&&d.row===t);if(!d)return r.slice()}var h=[];t=d.row;do{h[n<0?"unshift":"push"](d),d=r[a+=n]}while(d&&d.row==t);return h.length&&h}}}(n,h,t);if(y){var w=y[0];d.column=(w.pos&&"number"!=typeof w.column?w.pos.sc:w.column)||0,d.row=w.row,f=e.renderer.$gutterLayer.$annotations[d.row]}else{if(p)return;f={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(d.row),e.selection.moveToPosition(d);var x={row:d.row,fixedWidth:!0,coverGutter:!0,el:a.createElement("div"),type:"errorMarker"},j=x.el.appendChild(a.createElement("div")),O=x.el.appendChild(a.createElement("div"));O.className="error_widget_arrow "+f.className;var C=e.renderer.$cursorLayer.getPixelPosition(d).left;O.style.left=C+e.renderer.gutterWidth-5+"px",x.el.className="error_widget_wrapper",j.className="error_widget "+f.className,j.innerHTML=f.text.join("<br>"),j.appendChild(a.createElement("div"));var S=function(e,t,n){if(0===t&&("esc"===n||"return"===n))return x.destroy(),{command:"null"}};x.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(S),n.widgetManager.removeLineWidget(x),e.off("changeSelection",x.destroy),e.off("changeSession",x.destroy),e.off("mouseup",x.destroy),e.off("change",x.destroy))},e.keyBinding.addKeyboardHandler(S),e.on("changeSelection",x.destroy),e.on("changeSession",x.destroy),e.on("mouseup",x.destroy),e.on("change",x.destroy),e.session.widgetManager.addLineWidget(x),x.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:x.el.offsetHeight})},a.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",[],(function(e,t,r){"use strict";e("./lib/fixoldbrowsers");var a=e("./lib/dom"),l=e("./lib/event"),d=e("./range").Range,h=e("./editor").Editor,p=e("./edit_session").EditSession,f=e("./undomanager").UndoManager,y=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.require=e,t.define=n(590),t.edit=function(e,n){if("string"==typeof e){var r=e;if(!(e=document.getElementById(r)))throw new Error("ace.edit can't find div #"+r)}if(e&&e.env&&e.env.editor instanceof h)return e.env.editor;var d="";if(e&&/input|textarea/i.test(e.tagName)){var p=e;d=p.value,e=a.createElement("pre"),p.parentNode.replaceChild(e,p)}else e&&(d=e.textContent,e.innerHTML="");var f=t.createEditSession(d),w=new h(new y(e),f,n),x={document:f,editor:w,onResize:w.resize.bind(w,null)};return p&&(x.textarea=p),l.addListener(window,"resize",x.onResize),w.on("destroy",(function(){l.removeListener(window,"resize",x.onResize),x.editor.container.env=null})),w.container.env=w.env=x,w},t.createEditSession=function(e,t){var n=new p(e,t);return n.setUndoManager(new f),n},t.Range=d,t.Editor=h,t.EditSession=p,t.UndoManager=f,t.VirtualRenderer=y,t.version=t.config.version})),ace.require(["ace/ace"],(function(t){for(var n in t&&(t.config.init(!0),t.define=ace.define),window.ace||(window.ace=t),t)t.hasOwnProperty(n)&&(window.ace[n]=t[n]);window.ace.default=window.ace,e&&(e.exports=window.ace)}))}).call(this,n(151)(e))},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,f(e,t)}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return h(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function h(e,t,n){return(h=p()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&f(a,n.prototype),a}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=n(214),x=n(563),j=n(473),O=n(474),C=n(475),S=n(851),_=n(853),k=n(854),E=n(565),A=n(856),T=n(566),R=n(857),I=n(858),P=I.justErrorsLogger,D=I.debugLogger,M=n(860),L=function(e){function RestrictionError(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).isRestriction=!0,t}return l(RestrictionError,e),RestrictionError}(d(Error));"undefined"==typeof AggregateError&&(AggregateError=function(e){function AggregateError(t,n){var r;return(r=e.call(this,t)||this).errors=n,r}return l(AggregateError,e),AggregateError}(d(Error)));var F=function(e){function AggregateRestrictionError(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).isRestriction=!0,t}return l(AggregateRestrictionError,e),AggregateRestrictionError}(AggregateError),q=function(){function e(e){var t=this;this.defaultLocale={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",exceedsSize2:"%{backwardsCompat} %{size}",exceedsSize:"%{file} exceeds maximum allowed size of",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noNewAlreadyUploading:"Cannot add new files: already uploading",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},selectAllFilesFromFolderNamed:"Select all files from folder %{name}",unselectAllFilesFromFolderNamed:"Unselect all files from folder %{name}",selectFileNamed:"Select file %{name}",unselectFileNamed:"Unselect file %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",backToSearch:"Back to Search",emptyFolderAdded:"No files were added from empty folder",folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}};var n={id:"uppy",autoProceed:!1,allowMultipleUploads:!0,debug:!1,restrictions:{maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},meta:{},onBeforeFileAdded:function(e){return e},onBeforeUpload:function(e){return e},store:_(),logger:P,infoTimeout:5e3};if(this.opts=r({},n,e,{restrictions:r({},n.restrictions,e&&e.restrictions)}),e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=D),this.log("Using Core v"+this.constructor.VERSION),this.opts.restrictions.allowedFileTypes&&null!==this.opts.restrictions.allowedFileTypes&&!Array.isArray(this.opts.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");this.i18nInit(),this.plugins={},this.getState=this.getState.bind(this),this.getPlugin=this.getPlugin.bind(this),this.setFileMeta=this.setFileMeta.bind(this),this.setFileState=this.setFileState.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.hideInfo=this.hideInfo.bind(this),this.addFile=this.addFile.bind(this),this.removeFile=this.removeFile.bind(this),this.pauseResume=this.pauseResume.bind(this),this.validateRestrictions=this.validateRestrictions.bind(this),this.calculateProgress=O(this.calculateProgress.bind(this),500,{leading:!0,trailing:!0}),this.updateOnlineStatus=this.updateOnlineStatus.bind(this),this.resetProgress=this.resetProgress.bind(this),this.pauseAll=this.pauseAll.bind(this),this.resumeAll=this.resumeAll.bind(this),this.retryAll=this.retryAll.bind(this),this.cancelAll=this.cancelAll.bind(this),this.retryUpload=this.retryUpload.bind(this),this.upload=this.upload.bind(this),this.emitter=x(),this.on=this.on.bind(this),this.off=this.off.bind(this),this.once=this.emitter.once.bind(this.emitter),this.emit=this.emitter.emit.bind(this.emitter),this.preProcessors=[],this.uploaders=[],this.postProcessors=[],this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:R(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:r({},this.opts.meta),info:{isHidden:!0,type:"info",message:""},recoveredState:null}),this.storeUnsubscribe=this.store.subscribe((function(e,n,r){t.emit("state-update",e,n,r),t.updateAll(n)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),this.addListeners()}var t,n,l,d=e.prototype;return d.on=function(e,t){return this.emitter.on(e,t),this},d.off=function(e,t){return this.emitter.off(e,t),this},d.updateAll=function(e){this.iteratePlugins((function(t){t.update(e)}))},d.setState=function(e){this.store.setState(e)},d.getState=function(){return this.store.getState()},d.setFileState=function(e,t){var n;if(!this.getState().files[e])throw new Error("Can’t set state for "+e+" (the file could have been removed)");this.setState({files:r({},this.getState().files,(n={},n[e]=r({},this.getState().files[e],t),n))})},d.i18nInit=function(){this.translator=new w([this.defaultLocale,this.opts.locale]),this.locale=this.translator.locale,this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator)},d.setOptions=function(e){this.opts=r({},this.opts,e,{restrictions:r({},this.opts.restrictions,e&&e.restrictions)}),e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((function(e){e.setOptions()})),this.setState()},d.resetProgress=function(){var e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t=r({},this.getState().files),n={};Object.keys(t).forEach((function(a){var l=r({},t[a]);l.progress=r({},l.progress,e),n[a]=l})),this.setState({files:n,totalProgress:0}),this.emit("reset-progress")},d.addPreProcessor=function(e){this.preProcessors.push(e)},d.removePreProcessor=function(e){var t=this.preProcessors.indexOf(e);-1!==t&&this.preProcessors.splice(t,1)},d.addPostProcessor=function(e){this.postProcessors.push(e)},d.removePostProcessor=function(e){var t=this.postProcessors.indexOf(e);-1!==t&&this.postProcessors.splice(t,1)},d.addUploader=function(e){this.uploaders.push(e)},d.removeUploader=function(e){var t=this.uploaders.indexOf(e);-1!==t&&this.uploaders.splice(t,1)},d.setMeta=function(e){var t=r({},this.getState().meta,e),n=r({},this.getState().files);Object.keys(n).forEach((function(t){n[t]=r({},n[t],{meta:r({},n[t].meta,e)})})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:n})},d.setFileMeta=function(e,t){var n=r({},this.getState().files);if(n[e]){var a=r({},n[e].meta,t);n[e]=r({},n[e],{meta:a}),this.setState({files:n})}else this.log("Was trying to set metadata for a file that has been removed: ",e)},d.getFile=function(e){return this.getState().files[e]},d.getFiles=function(){var e=this.getState().files;return Object.keys(e).map((function(t){return e[t]}))},d.validateRestrictions=function(e,t){try{return this.checkRestrictions(e,t),{result:!0}}catch(e){return{result:!1,reason:e.message}}},d.checkRestrictions=function(e,t){void 0===t&&(t=this.getFiles());var n=this.opts.restrictions,r=n.maxFileSize,a=n.minFileSize,l=n.maxTotalFileSize,d=n.maxNumberOfFiles,h=n.allowedFileTypes;if(d&&t.length+1>d)throw new L(""+this.i18n("youCanOnlyUploadX",{smart_count:d}));if(h&&!h.some((function(t){return t.indexOf("/")>-1?!!e.type&&S(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.substr(1).toLowerCase()}))){var p=h.join(", ");throw new L(this.i18n("youCanOnlyUploadFileTypes",{types:p}))}if(l&&null!=e.size){var f=0;if(f+=e.size,t.forEach((function(e){f+=e.size})),f>l)throw new L(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:C(l),file:e.name}))}if(r&&null!=e.size&&e.size>r)throw new L(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:C(r),file:e.name}));if(a&&null!=e.size&&e.size<a)throw new L(this.i18n("inferiorSize",{size:C(a)}))},d.checkMinNumberOfFiles=function(e){var t=this.opts.restrictions.minNumberOfFiles;if(Object.keys(e).length<t)throw new L(""+this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))},d.checkRequiredMetaFields=function(e){for(var t=this.opts.restrictions.requiredMetaFields,n=Object.prototype.hasOwnProperty,r=[],a=Object.keys(e),l=0;l<a.length;l++)for(var d=this.getFile(a[l]),h=0;h<t.length;h++)if(!n.call(d.meta,t[h])||""===d.meta[t[h]]){var p=new L(""+this.i18n("missingRequiredMetaFieldOnFile",{fileName:d.name}));r.push(p),this.showOrLogErrorAndThrow(p,{file:d,throwErr:!1})}if(r.length)throw new F(""+this.i18n("missingRequiredMetaField"),r)},d.showOrLogErrorAndThrow=function(e,t){var n=void 0===t?{}:t,r=n.showInformer,a=void 0===r||r,l=n.file,d=void 0===l?null:l,h=n.throwErr,p=void 0===h||h,f="object"==typeof e?e.message:e,y="object"==typeof e&&e.details?e.details:"",w=f;if(y&&(w+=" "+y),e.isRestriction?(this.log(w),this.emit("restriction-failed",d,e)):this.log(w,"error"),a&&this.info({message:f,details:y},"error",this.opts.infoTimeout),p)throw"object"==typeof e?e:new Error(e)},d.assertNewUploadAllowed=function(e){!1===this.getState().allowNewUpload&&this.showOrLogErrorAndThrow(new L(this.i18n("noNewAlreadyUploading")),{file:e})},d.checkAndCreateFileStateObject=function(e,t){var n=k(t),a=t;a.type=n;var l,d=this.opts.onBeforeFileAdded(a,e);!1===d&&this.showOrLogErrorAndThrow(new L("Cannot add the file because onBeforeFileAdded returned false."),{showInformer:!1,file:a}),"object"==typeof d&&d&&(a=d),l=a.name?a.name:"image"===n.split("/")[0]?n.split("/")[0]+"."+n.split("/")[1]:"noname";var h=E(l).extension,p=a.isRemote||!1,f=A(a);e[f]&&!e[f].isGhost&&this.showOrLogErrorAndThrow(new L(this.i18n("noDuplicates",{fileName:l})),{file:a});var y=a.meta||{};y.name=l,y.type=n;var w=isFinite(a.data.size)?a.data.size:null,x={source:a.source||"",id:f,name:l,extension:h||"",meta:r({},this.getState().meta,y),type:n,data:a.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:w,uploadComplete:!1,uploadStarted:null},size:w,isRemote:p,remote:a.remote||"",preview:a.preview};try{var j=Object.keys(e).map((function(t){return e[t]}));this.checkRestrictions(x,j)}catch(e){this.showOrLogErrorAndThrow(e,{file:x})}return x},d.startIfAutoProceed=function(){var e=this;this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((function(){e.scheduledAutoProceed=null,e.upload().catch((function(t){t.isRestriction||e.log(t.stack||t.message||t)}))}),4))},d.addFile=function(e){var t;this.assertNewUploadAllowed(e);var n=this.getState().files,a=this.checkAndCreateFileStateObject(n,e);return n[a.id]&&n[a.id].isGhost&&(a=r({},n[a.id],{data:e.data,isGhost:!1}),this.log("Replaced the blob in the restored ghost file: "+a.name+", "+a.id)),this.setState({files:r({},n,(t={},t[a.id]=a,t))}),this.emit("file-added",a),this.emit("files-added",[a]),this.log("Added file: "+a.name+", "+a.id+", mime type: "+a.type),this.startIfAutoProceed(),a.id},d.addFiles=function(e){var t=this;this.assertNewUploadAllowed();for(var n=r({},this.getState().files),a=[],l=[],d=0;d<e.length;d++)try{var h=this.checkAndCreateFileStateObject(n,e[d]);n[h.id]&&n[h.id].isGhost&&(h=r({},n[h.id],{data:e[d].data,isGhost:!1}),this.log("Replaced blob in a ghost file: "+h.name+", "+h.id)),n[h.id]=h,a.push(h)}catch(f){f.isRestriction||l.push(f)}if(this.setState({files:n}),a.forEach((function(e){t.emit("file-added",e)})),this.emit("files-added",a),a.length>5?this.log("Added batch of "+a.length+" files"):Object.keys(a).forEach((function(e){t.log("Added file: "+a[e].name+"\n id: "+a[e].id+"\n type: "+a[e].type)})),a.length>0&&this.startIfAutoProceed(),l.length>0){var p="Multiple errors occurred while adding files:\n";if(l.forEach((function(e){p+="\n * "+e.message})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:l.length}),details:p},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(l,p);var f=new Error(p);throw f.errors=l,f}},d.removeFiles=function(e,t){var n=this,a=this.getState(),l=a.files,d=a.currentUploads,h=r({},l),p=r({},d),f=Object.create(null);function y(e){return void 0===f[e]}e.forEach((function(e){l[e]&&(f[e]=l[e],delete h[e])})),Object.keys(p).forEach((function(e){var t=d[e].fileIDs.filter(y);0!==t.length?p[e]=r({},d[e],{fileIDs:t}):delete p[e]}));var w={currentUploads:p,files:h};0===Object.keys(h).length&&(w.allowNewUpload=!0,w.error=null,w.recoveredState=null),this.setState(w),this.calculateTotalProgress();var x=Object.keys(f);x.forEach((function(e){n.emit("file-removed",f[e],t)})),x.length>5?this.log("Removed "+x.length+" files"):this.log("Removed files: "+x.join(", "))},d.removeFile=function(e,t){void 0===t&&(t=null),this.removeFiles([e],t)},d.pauseResume=function(e){if(this.getState().capabilities.resumableUploads&&!this.getFile(e).uploadComplete){var t=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}},d.pauseAll=function(){var e=r({},this.getState().files);Object.keys(e).filter((function(t){return!e[t].progress.uploadComplete&&e[t].progress.uploadStarted})).forEach((function(t){var n=r({},e[t],{isPaused:!0});e[t]=n})),this.setState({files:e}),this.emit("pause-all")},d.resumeAll=function(){var e=r({},this.getState().files);Object.keys(e).filter((function(t){return!e[t].progress.uploadComplete&&e[t].progress.uploadStarted})).forEach((function(t){var n=r({},e[t],{isPaused:!1,error:null});e[t]=n})),this.setState({files:e}),this.emit("resume-all")},d.retryAll=function(){var e=r({},this.getState().files),t=Object.keys(e).filter((function(t){return e[t].error}));if(t.forEach((function(t){var n=r({},e[t],{isPaused:!1,error:null});e[t]=n})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});var n=this.createUpload(t,{forceAllowNewUpload:!0});return this.runUpload(n)},d.cancelAll=function(){this.emit("cancel-all");var e=this.getState().files,t=Object.keys(e);t.length&&this.removeFiles(t,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})},d.retryUpload=function(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);var t=this.createUpload([e],{forceAllowNewUpload:!0});return this.runUpload(t)},d.reset=function(){this.cancelAll()},d.logout=function(){this.iteratePlugins((function(e){e.provider&&e.provider.logout&&e.provider.logout()}))},d.calculateProgress=function(e,t){if(this.getFile(e.id)){var n=isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:r({},this.getFile(e.id).progress,{bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:n?Math.round(t.bytesUploaded/t.bytesTotal*100):0})}),this.calculateTotalProgress()}else this.log("Not setting progress for a file that has been removed: "+e.id)},d.calculateTotalProgress=function(){var e=this.getFiles().filter((function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess}));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});var t=e.filter((function(e){return null!=e.progress.bytesTotal})),n=e.filter((function(e){return null==e.progress.bytesTotal}));if(0!==t.length){var r=t.reduce((function(e,t){return e+t.progress.bytesTotal}),0),a=r/t.length;r+=a*n.length;var l=0;t.forEach((function(e){l+=e.progress.bytesUploaded})),n.forEach((function(e){l+=a*(e.progress.percentage||0)/100}));var d=0===r?0:Math.round(l/r*100);d>100&&(d=100),this.setState({totalProgress:d}),this.emit("progress",d)}else{var h=100*e.length,p=n.reduce((function(e,t){return e+t.progress.percentage}),0),f=Math.round(p/h*100);this.setState({totalProgress:f})}},d.addListeners=function(){var e=this,t=function(t,n,r){var a=t.message||"Unknown error";t.details&&(a+=" "+t.details),e.setState({error:a}),null!=n&&"string"==typeof n.id&&e.setFileState(n.id,{error:a,response:r})};this.on("error",t),this.on("upload-error",(function(n,r,a){if(t(r,n,a),"object"==typeof r&&r.message){var l=new Error(r.message);l.details=r.message,r.details&&(l.details+=" "+r.details),l.message=e.i18n("failedToUpload",{file:n.name}),e.showOrLogErrorAndThrow(l,{throwErr:!1})}else e.showOrLogErrorAndThrow(r,{throwErr:!1})})),this.on("upload",(function(){e.setState({error:null})})),this.on("upload-started",(function(t){e.getFile(t.id)?e.setFileState(t.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:t.size}}):e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",(function(t,n){if(e.getFile(t.id)){var a=e.getFile(t.id).progress;e.setFileState(t.id,{progress:r({},a,{postprocess:e.postProcessors.length>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:a.bytesTotal}),response:n,uploadURL:n.uploadURL,isPaused:!1}),null==t.size&&e.setFileState(t.id,{size:n.bytesUploaded||a.bytesTotal}),e.calculateTotalProgress()}else e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("preprocess-progress",(function(t,n){e.getFile(t.id)?e.setFileState(t.id,{progress:r({},e.getFile(t.id).progress,{preprocess:n})}):e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("preprocess-complete",(function(t){if(e.getFile(t.id)){var n=r({},e.getState().files);n[t.id]=r({},n[t.id],{progress:r({},n[t.id].progress)}),delete n[t.id].progress.preprocess,e.setState({files:n})}else e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("postprocess-progress",(function(t,n){e.getFile(t.id)?e.setFileState(t.id,{progress:r({},e.getState().files[t.id].progress,{postprocess:n})}):e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("postprocess-complete",(function(t){if(e.getFile(t.id)){var n=r({},e.getState().files);n[t.id]=r({},n[t.id],{progress:r({},n[t.id].progress)}),delete n[t.id].progress.postprocess,e.setState({files:n})}else e.log("Not setting progress for a file that has been removed: "+t.id)})),this.on("restored",(function(){e.calculateTotalProgress()})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",(function(){return e.updateOnlineStatus()})),window.addEventListener("offline",(function(){return e.updateOnlineStatus()})),setTimeout((function(){return e.updateOnlineStatus()}),3e3))},d.updateOnlineStatus=function(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)},d.getID=function(){return this.opts.id},d.use=function(e,t){if("function"!=typeof e)throw new TypeError("Expected a plugin class, but got "+(null===e?"null":typeof e)+". Please verify that the plugin was imported and spelled correctly.");var n=new e(this,t),r=n.id;if(this.plugins[n.type]=this.plugins[n.type]||[],!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");var a=this.getPlugin(r);if(a){var l="Already found a plugin named '"+a.id+"'. Tried to use: '"+r+"'.\nUppy plugins must have unique `id` options. See https://uppy.io/docs/plugins/#id.";throw new Error(l)}return e.VERSION&&this.log("Using "+r+" v"+e.VERSION),this.plugins[n.type].push(n),n.install(),this},d.getPlugin=function(e){var t=null;return this.iteratePlugins((function(n){if(n.id===e)return t=n,!1})),t},d.iteratePlugins=function(e){var t=this;Object.keys(this.plugins).forEach((function(n){t.plugins[n].forEach(e)}))},d.removePlugin=function(e){var t;this.log("Removing plugin "+e.id),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();var n=this.plugins[e.type].slice(),a=T(n,(function(t){return t.id===e.id}));-1!==a&&(n.splice(a,1),this.plugins[e.type]=n);var l={plugins:r({},this.getState().plugins,(t={},t[e.id]=void 0,t))};this.setState(l)},d.close=function(){var e=this;this.log("Closing Uppy instance "+this.opts.id+": removing all files and uninstalling plugins"),this.reset(),this.storeUnsubscribe(),this.iteratePlugins((function(t){e.removePlugin(t)}))},d.info=function(e,t,n){void 0===t&&(t="info"),void 0===n&&(n=3e3);var r="object"==typeof e;this.setState({info:{isHidden:!1,type:t,message:r?e.message:e,details:r?e.details:null}}),this.emit("info-visible"),clearTimeout(this.infoTimeoutID),this.infoTimeoutID=0!==n?setTimeout(this.hideInfo,n):void 0},d.hideInfo=function(){var e=r({},this.getState().info,{isHidden:!0});this.setState({info:e}),this.emit("info-hidden")},d.log=function(e,t){var n=this.opts.logger;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e)}},d.run=function(){return this.log("Calling run() is no longer necessary.","warning"),this},d.restore=function(e){return this.log('Core: attempting to restore upload "'+e+'"'),this.getState().currentUploads[e]?this.runUpload(e):(this.removeUpload(e),Promise.reject(new Error("Nonexistent upload")))},d.createUpload=function(e,t){var n;void 0===t&&(t={});var a=t.forceAllowNewUpload,l=void 0!==a&&a,d=this.getState(),h=d.allowNewUpload,p=d.currentUploads;if(!h&&!l)throw new Error("Cannot create a new upload: already uploading.");var f=j();return this.emit("upload",{id:f,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploads,currentUploads:r({},p,(n={},n[f]={fileIDs:e,step:0,result:{}},n))}),f},d.getUpload=function(e){return this.getState().currentUploads[e]},d.addResultData=function(e,t){var n;if(this.getUpload(e)){var a=this.getState().currentUploads,l=r({},a[e],{result:r({},a[e].result,t)});this.setState({currentUploads:r({},a,(n={},n[e]=l,n))})}else this.log("Not setting result for an upload that has been removed: "+e)},d.removeUpload=function(e){var t=r({},this.getState().currentUploads);delete t[e],this.setState({currentUploads:t})},d.runUpload=function(e){var t=this,n=this.getState().currentUploads[e].step,a=[].concat(this.preProcessors,this.uploaders,this.postProcessors),l=Promise.resolve();return a.forEach((function(a,d){d<n||(l=l.then((function(){var n,l=t.getState().currentUploads,h=l[e];if(h){var p=r({},h,{step:d});return t.setState({currentUploads:r({},l,(n={},n[e]=p,n))}),a(p.fileIDs,e)}})).then((function(){return null})))})),l.catch((function(n){t.emit("error",n),t.removeUpload(e)})),l.then((function(){var n=t.getState().currentUploads[e];if(n){n.fileIDs.forEach((function(e){var n=t.getFile(e);n&&n.progress.postprocess&&t.emit("postprocess-complete",n)}));var r=n.fileIDs.map((function(e){return t.getFile(e)})),a=r.filter((function(e){return!e.error})),l=r.filter((function(e){return e.error}));t.addResultData(e,{successful:a,failed:l,uploadID:e})}})).then((function(){var n=t.getState().currentUploads;if(n[e]){var r=n[e].result;return t.emit("complete",r),t.removeUpload(e),r}})).then((function(n){return null==n&&t.log("Not setting result for an upload that has been removed: "+e),n}))},d.upload=function(){var e=this;this.plugins.uploader||this.log("No uploader type plugins are used","warning");var t=this.getState().files,n=this.opts.onBeforeUpload(t);return!1===n?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&"object"==typeof n&&(t=n,this.setState({files:t})),Promise.resolve().then((function(){e.checkMinNumberOfFiles(t),e.checkRequiredMetaFields(t)})).catch((function(t){e.showOrLogErrorAndThrow(t)})).then((function(){var n=e.getState().currentUploads,r=Object.keys(n).reduce((function(e,t){return e.concat(n[t].fileIDs)}),[]),a=[];Object.keys(t).forEach((function(t){var n=e.getFile(t);n.progress.uploadStarted||-1!==r.indexOf(t)||a.push(n.id)}));var l=e.createUpload(a);return e.runUpload(l)})).catch((function(t){e.showOrLogErrorAndThrow(t,{showInformer:!1})})))},t=e,(n=[{key:"state",get:function(){return this.getState()}}])&&a(t.prototype,n),l&&a(t,l),e}();q.VERSION="1.20.1",e.exports=function(e){return new q(e)},e.exports.Uppy=q,e.exports.Plugin=M,e.exports.debugLogger=D},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(127),a=!1;function l(){a||Object(r.a)()&&(MathJax.Hub.Config({messageStyle:"none",imageFont:null,"fast-preview":{disabled:!0},"HTML-CSS":{availableFonts:["TeX"],scale:110,matchFontHeight:!1},TeX:{equationNumbers:{autoNumber:"AMS"},useLabelIDs:!1},skipStartupTypeset:!0,tex2jax:{processEscapes:!0,inlineMath:[["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]}}),a=!0)}},function(e,t,n){"use strict";n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(309),a=n(15),l=n(2),d=n(1),h=n.n(d),p=n(0);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e){var t=e.delay,n=void 0===t?500:t,d=Object(r.a)().t,h=f(Object(l.useState)(!1),2),y=h[0],w=h[1];return Object(l.useEffect)((function(){var e=window.setTimeout((function(){w(!0)}),n);return function(){window.clearTimeout(e)}}),[n]),y?Object(p.jsxs)("div",{className:"loading",children:[Object(p.jsx)(a.a,{type:"refresh",fw:!0,spin:!0})," ",d("loading"),"…"]}):null}w.propTypes={delay:h.a.number},t.a=w},,function(e,t,n){"use strict";n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2),a=n(128);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=Object(r.useState)((function(){var n;return null!==(n=a.a.getItem(e))&&void 0!==n?n:t})),h=l(d,2),p=h[0],f=h[1],y=Object(r.useCallback)((function(n){f((function(r){var l="function"==typeof n?n(r):n;return l===t?a.a.removeItem(e):a.a.setItem(e,l),l}))}),[e,t]);return Object(r.useEffect)((function(){if(n){var t=function(t){t.key===e&&f(a.a.getItem(e))};return window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)}}}),[e,n]),[p,y]}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return d[e];var n,l=String(e);return(n=r[l.toLowerCase()])?n:(n=a[l.toLowerCase()])||(1===l.length?l.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var l;if(l=r[t.toLowerCase()])return l===n;if(l=a[t.toLowerCase()])return l===n}else if("number"==typeof t)return t===n;return!1}};var r=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},a=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(l=97;l<123;l++)r[String.fromCharCode(l)]=l-32;for(var l=48;l<58;l++)r[l-48]=l;for(l=1;l<13;l++)r["f"+l]=l+111;for(l=0;l<10;l++)r["numpad "+l]=l+96;var d=t.names=t.title={};for(l in r)d[r[l]]=l;for(var h in a)r[h]=a[h]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(346)("wks"),a=n(348),l=n(161).Symbol,d="function"==typeof l;(e.exports=function(e){return r[e]||(r[e]=d&&l[e]||(d?l:a)("Symbol."+e))}).store=r},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=n(848);e.exports=function(){function e(e){var t=this;this.locale={strings:{},pluralize:function(e){return 1===e?0:1}},Array.isArray(e)?e.forEach((function(e){return t._apply(e)})):this._apply(e)}var t=e.prototype;return t._apply=function(e){if(e&&e.strings){var t=this.locale;this.locale=r({},t,{strings:r({},t.strings,e.strings)}),this.locale.pluralize=e.pluralize||t.pluralize}},t.interpolate=function(e,t){var n=String.prototype,r=n.split,l=n.replace,d=/\$/g,h=[e];for(var p in t)if("_"!==p&&a(t,p)){var f=t[p];"string"==typeof f&&(f=l.call(t[p],d,"$$$$")),h=y(h,new RegExp("%\\{"+p+"\\}","g"),f)}return h;function y(e,t,n){var a=[];return e.forEach((function(e){if("string"!=typeof e)return a.push(e);r.call(e,t).forEach((function(e,t,r){""!==e&&a.push(e),t<r.length-1&&a.push(n)}))})),a}},t.translate=function(e,t){return this.translateArray(e,t).join("")},t.translateArray=function(e,t){if(!a(this.locale.strings,e))throw new Error("missing string: "+e);var n=this.locale.strings[e];if("object"==typeof n){if(t&&void 0!==t.smart_count){var r=this.locale.pluralize(t.smart_count);return this.interpolate(n[r],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return this.interpolate(n,t)},e}()},,,,,function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return r}))},,,function(e,t,n){var r=n(925),a=n(926),l=a;l.v1=r,l.v4=a,e.exports=l},,function(e,t,n){"use strict";n.d(t,"a",(function(){return me})),n.d(t,"b",(function(){return ke}));var r=n(105),a=n(39),l=(n(103),n(363),n(1)),d=n.n(l),h=n(2),p=(n(494),n(307));var f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.create;Object.create;var y=0;function w(){}function x(e,t){e&&Object(p.a)(e,{boundary:t,block:"nearest",scrollMode:"if-needed"}).forEach((function(e){var t=e.el,n=e.top,r=e.left;t.scrollTop=n,t.scrollLeft=r}))}function j(e,t,n){return e===t||t instanceof n.Node&&e.contains&&e.contains(t)}function O(e,t){var n;function r(){n&&clearTimeout(n)}function a(){for(var a=arguments.length,l=new Array(a),d=0;d<a;d++)l[d]=arguments[d];r(),n=setTimeout((function(){n=null,e.apply(void 0,l)}),t)}return a.cancel=r,a}function C(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return t.some((function(t){return t&&t.apply(void 0,[e].concat(r)),e.preventDownshiftDefault||e.hasOwnProperty("nativeEvent")&&e.nativeEvent.preventDownshiftDefault}))}}function S(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){"function"==typeof t?t(e):t&&(t.current=e)}))}}function _(){return String(y++)}function k(e){var t=e.isOpen,n=e.resultCount,r=e.previousResultCount;return t?n?n!==r?n+" result"+(1===n?" is":"s are")+" available, use up and down arrow keys to navigate. Press Enter key to select.":"":"No results are available.":""}function E(e,t){return Object.keys(e).reduce((function(n,r){return n[r]=A(t,r)?t[r]:e[r],n}),{})}function A(e,t){return void 0!==e[t]}function T(e){var t=e.key,n=e.keyCode;return n>=37&&n<=40&&0!==t.indexOf("Arrow")?"Arrow"+t:t}function R(e,t,n,r,a){if(void 0===a&&(a=!0),0===n)return-1;var l=n-1;("number"!=typeof t||t<0||t>=n)&&(t=e>0?-1:l+1);var d=t+e;d<0?d=a?l:0:d>l&&(d=a?0:l);var h=I(e,d,n,r,a);return-1===h?t>=n?-1:t:h}function I(e,t,n,r,a){var l=r(t);if(!l||!l.hasAttribute("disabled"))return t;if(e>0){for(var d=t+1;d<n;d++)if(!r(d).hasAttribute("disabled"))return d}else for(var h=t-1;h>=0;h--)if(!r(h).hasAttribute("disabled"))return h;return a?e>0?I(1,0,n,r,!1):I(-1,n-1,n,r,!1):-1}function P(e,t,n,r){return void 0===r&&(r=!0),t.some((function(t){return t&&(j(t,e,n)||r&&j(t,n.document.activeElement,n))}))}var D=O((function(e){L(e).textContent=""}),500);function M(e,t){var n=L(t);e&&(n.textContent=e,D(t))}function L(e){void 0===e&&(e=document);var t=e.getElementById("a11y-status-message");return t||((t=e.createElement("div")).setAttribute("id","a11y-status-message"),t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-relevant","additions text"),Object.assign(t.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),e.body.appendChild(t),t)}var F=["isInitialMount","highlightedIndex","items","environment"],q={highlightedIndex:-1,isOpen:!1,selectedItem:null,inputValue:""};function N(e,t,n){var r=e.props,l=e.type,d={};Object.keys(t).forEach((function(r){!function(e,t,n,r){var l=t.props,d=t.type,h="on"+V(e)+"Change";l[h]&&void 0!==r[e]&&r[e]!==n[e]&&l[h](Object(a.a)({type:d},r))}(r,e,t,n),n[r]!==t[r]&&(d[r]=n[r])})),r.onStateChange&&Object.keys(d).length&&r.onStateChange(Object(a.a)({type:l},d))}var B=O((function(e,t){M(e(),t)}),200),U="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?h.useLayoutEffect:h.useEffect;function H(e){var t=e.id,n=void 0===t?"downshift-"+_():t,r=e.labelId,a=e.menuId,l=e.getItemId,d=e.toggleButtonId,p=e.inputId;return Object(h.useRef)({labelId:r||n+"-label",menuId:a||n+"-menu",getItemId:l||function(e){return n+"-item-"+e},toggleButtonId:d||n+"-toggle-button",inputId:p||n+"-input"}).current}function z(e,t,n){return void 0!==e?e:0===n.length?-1:n.indexOf(t)}function V(e){return""+e.slice(0,1).toUpperCase()+e.slice(1)}function W(e){var t=Object(h.useRef)(e);return t.current=e,t}function K(e,t,n){var r=Object(h.useRef)(),l=Object(h.useRef)(),d=Object(h.useCallback)((function(t,n){l.current=n,t=E(t,n.props);var r=e(t,n);return n.props.stateReducer(t,Object(a.a)({},n,{changes:r}))}),[e]),p=Object(h.useReducer)(d,t),f=p[0],y=p[1],w=W(n),x=Object(h.useCallback)((function(e){return y(Object(a.a)({props:w.current},e))}),[w]),j=l.current;return Object(h.useEffect)((function(){j&&r.current&&r.current!==f&&N(j,E(r.current,j.props),f),r.current=f}),[f,n,j]),[f,x]}function G(e,t,n){var r=K(e,t,n),a=r[0],l=r[1];return[E(a,n),l]}var Y={itemToString:function(e){return e?String(e):""},stateReducer:function(e,t){return t.changes},getA11ySelectionMessage:function(e){var t=e.selectedItem,n=e.itemToString;return t?n(t)+" has been selected.":""},scrollIntoView:x,circularNavigation:!1,environment:"undefined"==typeof window?{}:window};function X(e,t,n){void 0===n&&(n=q);var r="default"+V(t);return r in e?e[r]:n[t]}function J(e,t,n){if(void 0===n&&(n=q),t in e)return e[t];var r="initial"+V(t);return r in e?e[r]:X(e,t,n)}function Q(e){var t=J(e,"selectedItem"),n=J(e,"isOpen"),r=J(e,"highlightedIndex"),a=J(e,"inputValue");return{highlightedIndex:r<0&&t&&n?e.items.indexOf(t):r,isOpen:n,selectedItem:t,inputValue:a}}function Z(e,t,n,r){var a=e.items,l=e.initialHighlightedIndex,d=e.defaultHighlightedIndex,h=t.selectedItem,p=t.highlightedIndex;return 0===a.length?-1:void 0!==l&&p===l?l:void 0!==d?d:h?0===n?a.indexOf(h):R(n,a.indexOf(h),a.length,r,!1):0===n?-1:n<0?a.length-1:0}function ee(e,t,n,r){var a=Object(h.useRef)({isMouseDown:!1,isTouchMove:!1});return Object(h.useEffect)((function(){var l=function(){a.current.isMouseDown=!0},d=function(l){a.current.isMouseDown=!1,e&&!P(l.target,t.map((function(e){return e.current})),n)&&r()},h=function(){a.current.isTouchMove=!1},p=function(){a.current.isTouchMove=!0},f=function(l){!e||a.current.isTouchMove||P(l.target,t.map((function(e){return e.current})),n,!1)||r()};return n.addEventListener("mousedown",l),n.addEventListener("mouseup",d),n.addEventListener("touchstart",h),n.addEventListener("touchmove",p),n.addEventListener("touchend",f),function(){n.removeEventListener("mousedown",l),n.removeEventListener("mouseup",d),n.removeEventListener("touchstart",h),n.removeEventListener("touchmove",p),n.removeEventListener("touchend",f)}}),[e,n]),a}var te=function(){return w};function ne(e,t,n){var l=n.isInitialMount,d=n.highlightedIndex,p=n.items,f=n.environment,y=Object(r.a)(n,F);Object(h.useEffect)((function(){l||B((function(){return e(Object(a.a)({highlightedIndex:d,highlightedItem:p[d],resultCount:p.length},y))}),f.document)}),t)}function re(e){var t=e.highlightedIndex,n=e.isOpen,r=e.itemRefs,a=e.getItemNodeFromIndex,l=e.menuElement,d=e.scrollIntoView,p=Object(h.useRef)(!0);return U((function(){t<0||!n||!Object.keys(r.current).length||(!1===p.current?p.current=!0:d(a(t),l))}),[t]),p}var oe=w;function ae(e,t,n){var r,l=t.type,d=t.props;switch(l){case n.ItemMouseMove:r={highlightedIndex:t.index};break;case n.MenuMouseLeave:r={highlightedIndex:-1};break;case n.ToggleButtonClick:case n.FunctionToggleMenu:r={isOpen:!e.isOpen,highlightedIndex:e.isOpen?-1:Z(d,e,0)};break;case n.FunctionOpenMenu:r={isOpen:!0,highlightedIndex:Z(d,e,0)};break;case n.FunctionCloseMenu:r={isOpen:!1};break;case n.FunctionSetHighlightedIndex:r={highlightedIndex:t.highlightedIndex};break;case n.FunctionSetInputValue:r={inputValue:t.inputValue};break;case n.FunctionReset:r={highlightedIndex:X(d,"highlightedIndex"),isOpen:X(d,"isOpen"),selectedItem:X(d,"selectedItem"),inputValue:X(d,"inputValue")};break;default:throw new Error("Reducer called without proper action type.")}return Object(a.a)({},e,r)}d.a.array.isRequired,d.a.func,d.a.func,d.a.func,d.a.bool,d.a.number,d.a.number,d.a.number,d.a.bool,d.a.bool,d.a.bool,d.a.any,d.a.any,d.a.any,d.a.string,d.a.string,d.a.string,d.a.func,d.a.string,d.a.func,d.a.func,d.a.func,d.a.func,d.a.func,d.a.shape({addEventListener:d.a.func,removeEventListener:d.a.func,document:d.a.shape({getElementById:d.a.func,activeElement:d.a.any,body:d.a.any})});f(f({},Y),{getA11yStatusMessage:function(e){var t=e.isOpen,n=e.resultCount,r=e.previousResultCount;return t?n?n!==r?n+" result"+(1===n?" is":"s are")+" available, use up and down arrow keys to navigate. Press Enter or Space Bar keys to select.":"":"No results are available.":""}});var se=Object.freeze({__proto__:null,InputKeyDownArrowDown:0,InputKeyDownArrowUp:1,InputKeyDownEscape:2,InputKeyDownHome:3,InputKeyDownEnd:4,InputKeyDownEnter:5,InputChange:6,InputBlur:7,MenuMouseLeave:8,ItemMouseMove:9,ItemClick:10,ToggleButtonClick:11,FunctionToggleMenu:12,FunctionOpenMenu:13,FunctionCloseMenu:14,FunctionSetHighlightedIndex:15,FunctionSelectItem:16,FunctionSetInputValue:17,FunctionReset:18,ControlledPropUpdatedSelectedItem:19});d.a.array.isRequired,d.a.func,d.a.func,d.a.func,d.a.bool,d.a.number,d.a.number,d.a.number,d.a.bool,d.a.bool,d.a.bool,d.a.any,d.a.any,d.a.any,d.a.string,d.a.string,d.a.string,d.a.string,d.a.string,d.a.string,d.a.func,d.a.string,d.a.string,d.a.func,d.a.func,d.a.func,d.a.func,d.a.func,d.a.func,d.a.shape({addEventListener:d.a.func,removeEventListener:d.a.func,document:d.a.shape({getElementById:d.a.func,activeElement:d.a.any,body:d.a.any})});var le=w;var ce=Object(a.a)({},Y,{getA11yStatusMessage:k,circularNavigation:!0});function ue(e,t){var n,r=t.type,l=t.props,d=t.shiftKey;switch(r){case 10:n={isOpen:X(l,"isOpen"),highlightedIndex:X(l,"highlightedIndex"),selectedItem:l.items[t.index],inputValue:l.itemToString(l.items[t.index])};break;case 0:n=e.isOpen?{highlightedIndex:R(d?5:1,e.highlightedIndex,l.items.length,t.getItemNodeFromIndex,l.circularNavigation)}:{highlightedIndex:Z(l,e,1,t.getItemNodeFromIndex),isOpen:l.items.length>=0};break;case 1:n=e.isOpen?{highlightedIndex:R(d?-5:-1,e.highlightedIndex,l.items.length,t.getItemNodeFromIndex,l.circularNavigation)}:{highlightedIndex:Z(l,e,-1,t.getItemNodeFromIndex),isOpen:l.items.length>=0};break;case 5:n=Object(a.a)({},e.isOpen&&e.highlightedIndex>=0&&{selectedItem:l.items[e.highlightedIndex],isOpen:X(l,"isOpen"),highlightedIndex:X(l,"highlightedIndex"),inputValue:l.itemToString(l.items[e.highlightedIndex])});break;case 2:n=Object(a.a)({isOpen:!1,highlightedIndex:-1},!e.isOpen&&{selectedItem:null,inputValue:""});break;case 3:n={highlightedIndex:I(1,0,l.items.length,t.getItemNodeFromIndex,!1)};break;case 4:n={highlightedIndex:I(-1,l.items.length-1,l.items.length,t.getItemNodeFromIndex,!1)};break;case 7:n=Object(a.a)({isOpen:!1,highlightedIndex:-1},e.highlightedIndex>=0&&t.selectItem&&{selectedItem:l.items[e.highlightedIndex],inputValue:l.itemToString(l.items[e.highlightedIndex])});break;case 6:n={isOpen:!0,highlightedIndex:X(l,"highlightedIndex"),inputValue:t.inputValue};break;case 16:n={selectedItem:t.selectedItem,inputValue:l.itemToString(t.selectedItem)};break;case 19:n={inputValue:t.inputValue};break;default:return ae(e,t,se)}return Object(a.a)({},e,n)}var de=["onMouseLeave","refKey","ref"],he=["item","index","refKey","ref","onMouseMove","onClick","onPress"],pe=["onClick","onPress","refKey","ref"],fe=["onKeyDown","onChange","onInput","onBlur","onChangeText","refKey","ref"],ge=["refKey","ref"];function me(e){void 0===e&&(e={}),le(e,me);var t=Object(a.a)({},ce,e),n=t.initialIsOpen,l=t.defaultIsOpen,d=t.items,p=t.scrollIntoView,f=t.environment,y=t.getA11yStatusMessage,w=t.getA11ySelectionMessage,x=t.itemToString,j=function(e,t,n){var r=Object(h.useRef)(),a=K(e,t,n),l=a[0],d=a[1];return Object(h.useEffect)((function(){A(n,"selectedItem")&&(r.current!==n.selectedItem&&d({type:19,inputValue:n.itemToString(n.selectedItem)}),r.current=l.selectedItem===r.current?n.selectedItem:l.selectedItem)})),[E(l,n),d]}(ue,function(e){var t=Q(e),n=t.selectedItem,r=t.inputValue;return""===r&&n&&void 0===e.defaultInputValue&&void 0===e.initialInputValue&&void 0===e.inputValue&&(r=e.itemToString(n)),Object(a.a)({},t,{inputValue:r})}(t),t),O=j[0],_=j[1],k=O.isOpen,R=O.highlightedIndex,I=O.selectedItem,P=O.inputValue,D=Object(h.useRef)(null),M=Object(h.useRef)({}),L=Object(h.useRef)(null),F=Object(h.useRef)(null),q=Object(h.useRef)(null),N=Object(h.useRef)(!0),B=H(t),U=Object(h.useRef)(),V=W({state:O,props:t}),G=Object(h.useCallback)((function(e){return M.current[B.getItemId(e)]}),[B]);ne(y,[k,R,P,d],Object(a.a)({isInitialMount:N.current,previousResultCount:U.current,items:d,environment:f,itemToString:x},O)),ne(w,[I],Object(a.a)({isInitialMount:N.current,previousResultCount:U.current,items:d,environment:f,itemToString:x},O));var Y=re({menuElement:D.current,highlightedIndex:R,isOpen:k,itemRefs:M,scrollIntoView:p,getItemNodeFromIndex:G});oe({isInitialMount:N.current,props:t,state:O}),Object(h.useEffect)((function(){(n||l||k)&&L.current&&L.current.focus()}),[]),Object(h.useEffect)((function(){N.current||(U.current=d.length)}));var X=ee(k,[q,D,F],f,(function(){_({type:7,selectItem:!1})})),J=te();Object(h.useEffect)((function(){N.current=!1}),[]),Object(h.useEffect)((function(){k||(M.current={})}),[k]);var Z=Object(h.useMemo)((function(){return{ArrowDown:function(e){e.preventDefault(),_({type:0,shiftKey:e.shiftKey,getItemNodeFromIndex:G})},ArrowUp:function(e){e.preventDefault(),_({type:1,shiftKey:e.shiftKey,getItemNodeFromIndex:G})},Home:function(e){V.current.state.isOpen&&(e.preventDefault(),_({type:3,getItemNodeFromIndex:G}))},End:function(e){V.current.state.isOpen&&(e.preventDefault(),_({type:4,getItemNodeFromIndex:G}))},Escape:function(){var e=V.current.state;(e.isOpen||e.inputValue||e.selectedItem||e.highlightedIndex>-1)&&_({type:2})},Enter:function(e){var t=V.current.state;!t.isOpen||t.highlightedIndex<0||229===e.which||(e.preventDefault(),_({type:5,getItemNodeFromIndex:G}))}}}),[_,V,G]),ae=Object(h.useCallback)((function(e){return Object(a.a)({id:B.labelId,htmlFor:B.inputId},e)}),[B]),se=Object(h.useCallback)((function(e,t){var n,l=void 0===e?{}:e,d=l.onMouseLeave,h=l.refKey,p=void 0===h?"ref":h,f=l.ref,y=Object(r.a)(l,de),w=(void 0===t?{}:t).suppressRefError;return J("getMenuProps",void 0!==w&&w,p,D),Object(a.a)(((n={})[p]=S(f,(function(e){D.current=e})),n.id=B.menuId,n.role="listbox",n["aria-labelledby"]=B.labelId,n.onMouseLeave=C(d,(function(){_({type:8})})),n),y)}),[_,J,B]),ve=Object(h.useCallback)((function(e){var t,n,l=void 0===e?{}:e,d=l.item,h=l.index,p=l.refKey,f=void 0===p?"ref":p,y=l.ref,w=l.onMouseMove,x=l.onClick;l.onPress;var j=Object(r.a)(l,he),O=V.current,k=O.props,E=O.state,A=z(h,d,k.items);if(A<0)throw new Error("Pass either item or item index in getItemProps!");var T=x;return Object(a.a)(((t={})[f]=S(y,(function(e){e&&(M.current[B.getItemId(A)]=e)})),t.role="option",t["aria-selected"]=""+(A===E.highlightedIndex),t.id=B.getItemId(A),t),!j.disabled&&((n={onMouseMove:C(w,(function(){h!==E.highlightedIndex&&(Y.current=!1,_({type:9,index:h}))}))}).onClick=C(T,(function(){_({type:10,index:h}),L.current&&L.current.focus()})),n),j)}),[_,V,Y,B]),be=Object(h.useCallback)((function(e){var t,n=void 0===e?{}:e,l=n.onClick;n.onPress;var d=n.refKey,h=void 0===d?"ref":d,p=n.ref,f=Object(r.a)(n,pe);return Object(a.a)(((t={})[h]=S(p,(function(e){F.current=e})),t.id=B.toggleButtonId,t.tabIndex=-1,t),!f.disabled&&Object(a.a)({},{onClick:C(l,(function(){_({type:11}),!V.current.state.isOpen&&L.current&&L.current.focus()}))}),f)}),[_,V,B]),ye=Object(h.useCallback)((function(e,t){var n,l=void 0===e?{}:e,d=l.onKeyDown,h=l.onChange,p=l.onInput,f=l.onBlur;l.onChangeText;var y=l.refKey,w=void 0===y?"ref":y,x=l.ref,j=Object(r.a)(l,fe),O=(void 0===t?{}:t).suppressRefError;J("getInputProps",void 0!==O&&O,w,L);var k,E=V.current.state,A={};j.disabled||((k={}).onChange=C(h,p,(function(e){_({type:6,inputValue:e.target.value})})),k.onKeyDown=C(d,(function(e){var t=T(e);t&&Z[t]&&Z[t](e)})),k.onBlur=C(f,(function(){E.isOpen&&!X.current.isMouseDown&&_({type:7,selectItem:!0})})),A=k);return Object(a.a)(((n={})[w]=S(x,(function(e){L.current=e})),n.id=B.inputId,n["aria-autocomplete"]="list",n["aria-controls"]=B.menuId,n),E.isOpen&&E.highlightedIndex>-1&&{"aria-activedescendant":B.getItemId(E.highlightedIndex)},{"aria-labelledby":B.labelId,autoComplete:"off",value:E.inputValue},A,j)}),[_,Z,V,X,J,B]),we=Object(h.useCallback)((function(e,t){var n,l=void 0===e?{}:e,d=l.refKey,h=void 0===d?"ref":d,p=l.ref,f=Object(r.a)(l,ge),y=(void 0===t?{}:t).suppressRefError;return J("getComboboxProps",void 0!==y&&y,h,q),Object(a.a)(((n={})[h]=S(p,(function(e){q.current=e})),n.role="combobox",n["aria-haspopup"]="listbox",n["aria-owns"]=B.menuId,n["aria-expanded"]=V.current.state.isOpen,n),f)}),[V,J,B]),xe=Object(h.useCallback)((function(){_({type:12})}),[_]),je=Object(h.useCallback)((function(){_({type:14})}),[_]),Oe=Object(h.useCallback)((function(){_({type:13})}),[_]),Ce=Object(h.useCallback)((function(e){_({type:15,highlightedIndex:e})}),[_]),Se=Object(h.useCallback)((function(e){_({type:16,selectedItem:e})}),[_]);return{getItemProps:ve,getLabelProps:ae,getMenuProps:se,getInputProps:ye,getComboboxProps:we,getToggleButtonProps:be,toggleMenu:xe,openMenu:Oe,closeMenu:je,setHighlightedIndex:Ce,setInputValue:Object(h.useCallback)((function(e){_({type:17,inputValue:e})}),[_]),selectItem:Se,reset:Object(h.useCallback)((function(){_({type:18})}),[_]),highlightedIndex:R,isOpen:k,selectedItem:I,inputValue:P}}me.stateChangeTypes=se;var ve={activeIndex:-1,selectedItems:[]};function be(e,t){return J(e,t,ve)}function ye(e,t){return X(e,t,ve)}function we(e){if(e.shiftKey||e.metaKey||e.ctrlKey||e.altKey)return!1;var t=e.target;return!(t instanceof HTMLInputElement&&""!==t.value)||0===t.selectionStart&&0===t.selectionEnd}d.a.array,d.a.array,d.a.array,d.a.func,d.a.func,d.a.func,d.a.number,d.a.number,d.a.number,d.a.func,d.a.func,d.a.string,d.a.string,d.a.shape({addEventListener:d.a.func,removeEventListener:d.a.func,document:d.a.shape({getElementById:d.a.func,activeElement:d.a.any,body:d.a.any})});var xe={itemToString:Y.itemToString,stateReducer:Y.stateReducer,environment:Y.environment,getA11yRemovalMessage:function(e){var t=e.removedSelectedItem;return(0,e.itemToString)(t)+" has been removed."},keyNavigationNext:"ArrowRight",keyNavigationPrevious:"ArrowLeft"},je=w;var Oe=Object.freeze({__proto__:null,SelectedItemClick:0,SelectedItemKeyDownDelete:1,SelectedItemKeyDownBackspace:2,SelectedItemKeyDownNavigationNext:3,SelectedItemKeyDownNavigationPrevious:4,DropdownKeyDownNavigationPrevious:5,DropdownKeyDownBackspace:6,DropdownClick:7,FunctionAddSelectedItem:8,FunctionRemoveSelectedItem:9,FunctionSetSelectedItems:10,FunctionSetActiveIndex:11,FunctionReset:12});function Ce(e,t){var n,r=t.type,l=t.index,d=t.props,h=t.selectedItem,p=e.activeIndex,f=e.selectedItems;switch(r){case 0:n={activeIndex:l};break;case 4:n={activeIndex:p-1<0?0:p-1};break;case 3:n={activeIndex:p+1>=f.length?-1:p+1};break;case 2:case 1:var y=p;1===f.length?y=-1:p===f.length-1&&(y=f.length-2),n=Object(a.a)({selectedItems:[].concat(f.slice(0,p),f.slice(p+1))},{activeIndex:y});break;case 5:n={activeIndex:f.length-1};break;case 6:n={selectedItems:f.slice(0,f.length-1)};break;case 8:n={selectedItems:[].concat(f,[h])};break;case 7:n={activeIndex:-1};break;case 9:var w=p,x=f.indexOf(h);1===f.length?w=-1:x===f.length-1&&(w=f.length-2),n=Object(a.a)({selectedItems:[].concat(f.slice(0,x),f.slice(x+1))},{activeIndex:w});break;case 10:n={selectedItems:t.selectedItems};break;case 11:n={activeIndex:t.activeIndex};break;case 12:n={activeIndex:ye(d,"activeIndex"),selectedItems:ye(d,"selectedItems")};break;default:throw new Error("Reducer called without proper action type.")}return Object(a.a)({},e,n)}var Se=["refKey","ref","onClick","onKeyDown","selectedItem","index"],_e=["refKey","ref","onKeyDown","onClick","preventKeyAction"];function ke(e){void 0===e&&(e={}),je(e,ke);var t=Object(a.a)({},xe,e),n=t.getA11yRemovalMessage,l=t.itemToString,d=t.environment,p=t.keyNavigationNext,f=t.keyNavigationPrevious,y=G(Ce,function(e){return{activeIndex:be(e,"activeIndex"),selectedItems:be(e,"selectedItems")}}(t),t),w=y[0],x=y[1],j=w.activeIndex,O=w.selectedItems,_=Object(h.useRef)(!0),k=Object(h.useRef)(null),E=Object(h.useRef)(O),A=Object(h.useRef)();A.current=[];var R=W({state:w,props:t});Object(h.useEffect)((function(){if(!_.current){if(O.length<E.current.length){var e=E.current.find((function(e){return O.indexOf(e)<0}));M(n({itemToString:l,resultCount:O.length,removedSelectedItem:e,activeIndex:j,activeSelectedItem:O[j]}),d.document)}E.current=O}}),[O.length]),Object(h.useEffect)((function(){_.current||(-1===j&&k.current?k.current.focus():A.current[j]&&A.current[j].focus())}),[j]),oe({isInitialMount:_.current,props:t,state:w});var I=te();Object(h.useEffect)((function(){_.current=!1}),[]);var P=Object(h.useMemo)((function(){var e;return(e={})[f]=function(){x({type:4})},e[p]=function(){x({type:3})},e.Delete=function(){x({type:1})},e.Backspace=function(){x({type:2})},e}),[x,p,f]),D=Object(h.useMemo)((function(){var e;return(e={})[f]=function(e){we(e)&&x({type:5})},e.Backspace=function(e){we(e)&&x({type:6})},e}),[x,f]);return{getSelectedItemProps:Object(h.useCallback)((function(e){var t,n=void 0===e?{}:e,l=n.refKey,d=void 0===l?"ref":l,h=n.ref,p=n.onClick,f=n.onKeyDown,y=n.selectedItem,w=n.index,j=Object(r.a)(n,Se),O=R.current.state;if(z(w,y,O.selectedItems)<0)throw new Error("Pass either selectedItem or index in getSelectedItemProps!");return Object(a.a)(((t={})[d]=S(h,(function(e){e&&A.current.push(e)})),t.tabIndex=w===O.activeIndex?0:-1,t.onClick=C(p,(function(){x({type:0,index:w})})),t.onKeyDown=C(f,(function(e){var t=T(e);t&&P[t]&&P[t](e)})),t),j)}),[x,R,P]),getDropdownProps:Object(h.useCallback)((function(e,t){var n,l=void 0===e?{}:e,d=l.refKey,h=void 0===d?"ref":d,p=l.ref,f=l.onKeyDown,y=l.onClick,w=l.preventKeyAction,j=void 0!==w&&w,O=Object(r.a)(l,_e),_=(void 0===t?{}:t).suppressRefError;I("getDropdownProps",void 0!==_&&_,h,k);return Object(a.a)(((n={})[h]=S(p,(function(e){e&&(k.current=e)})),n),!j&&{onKeyDown:C(f,(function(e){var t=T(e);t&&D[t]&&D[t](e)})),onClick:C(y,(function(){x({type:7})}))},O)}),[x,D,I]),addSelectedItem:Object(h.useCallback)((function(e){x({type:8,selectedItem:e})}),[x]),removeSelectedItem:Object(h.useCallback)((function(e){x({type:9,selectedItem:e})}),[x]),setSelectedItems:Object(h.useCallback)((function(e){x({type:10,selectedItems:e})}),[x]),setActiveIndex:Object(h.useCallback)((function(e){x({type:11,activeIndex:e})}),[x]),reset:Object(h.useCallback)((function(){x({type:12})}),[x]),selectedItems:O,activeIndex:j}}ke.stateChangeTypes=Oe},,,function(e,t,n){var r=n(41),a=n(206);r({target:"Object",stat:!0,forced:Object.assign!==a},{assign:a})},,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(e){return Array.prototype.slice.call(e||[],0)}},function(e,t,n){var r=n(1),a=n(145).Uppy,l=r.instanceOf(a).isRequired,d=r.arrayOf(r.string),h=r.shape({strings:r.object,pluralize:r.func}),p=r.shape({id:r.string.isRequired,name:r.string.isRequired,placeholder:r.string}),f=r.oneOfType([r.arrayOf(p),r.func]),y=r.oneOfType([r.string,r.number]),w={uppy:l,inline:r.bool,plugins:d,width:y,height:y,showProgressDetails:r.bool,hideUploadButton:r.bool,hideProgressAfterFinish:r.bool,note:r.string,metaFields:f,proudlyDisplayPoweredByUppy:r.bool,disableStatusBar:r.bool,disableInformer:r.bool,disableThumbnailGenerator:r.bool,thumbnailWidth:r.number,locale:h};e.exports={uppy:l,locale:h,dashboard:w}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=null;return t.forEach((function(e){if(null==a){var t=e.apply(void 0,n);null!=t&&(a=t)}})),a}return(0,l.default)(r)};var r,a=n(178),l=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},,function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},,function(e,t,n){"use strict";var r,a=n(41),l=n(40),d=n(149).f,h=n(147),p=n(66),f=n(277),y=n(100),w=n(278),x=n(124),j=l("".startsWith),O=l("".slice),C=Math.min,S=w("startsWith");a({target:"String",proto:!0,forced:!!(x||S||(r=d(String.prototype,"startsWith"),!r||r.writable))&&!S},{startsWith:function(e){var t=p(y(this));f(e);var n=h(C(arguments.length>1?arguments[1]:void 0,t.length)),r=p(e);return j?j(t,r,n):O(t,n,n+r.length)===r}})},,,,,,,,,,,,,,,function(e,t){!function(e,t,n){"use strict";var r=n.PassField=n.PassField||{};r.Config=r.Config||{},r.Config.locales={en:{lower:!0,msg:{pass:"password",and:"and",showPass:"Show password",hidePass:"Hide password",genPass:"Random password",passTooShort:"password is too short (min. length: {})",noCharType:"password must contain {}",digits:"digits",letters:"letters",letters_up:"letters in UPPER case",symbols:"symbols",inBlackList:"password is in list of top used passwords",passRequired:"password is required",equalTo:"password is equal to login",repeat:"password consists of repeating characters",badChars:"password contains bad characters: “{}”",weakWarn:"weak",invalidPassWarn:"*",weakTitle:"This password is weak",generateMsg:"To generate a strong password, click {} button."}},de:{lower:!1,msg:{pass:"Passwort",and:"und",showPass:"Passwort anzeigen",hidePass:"Passwort verbergen",genPass:"Zufallspasswort",passTooShort:"Passwort ist zu kurz (Mindestlänge: {})",noCharType:"Passwort muss {} enthalten",digits:"Ziffern",letters:"Buchstaben",letters_up:"Buchstaben in GROSSSCHRIFT",symbols:"Symbole",inBlackList:"Passwort steht auf der Liste der beliebtesten Passwörter",passRequired:"Passwort wird benötigt",equalTo:"Passwort ist wie Anmeldung",repeat:"Passwort besteht aus sich wiederholenden Zeichen",badChars:"Passwort enthält ungültige Zeichen: “{}”",weakWarn:"Schwach",invalidPassWarn:"*",weakTitle:"Dieses Passwort ist schwach",generateMsg:"Klicken Sie auf den {}-Button, um ein starkes Passwort zu generieren."}},fr:{lower:!0,msg:{pass:"mot de passe",and:"et",showPass:"Montrer le mot de passe",hidePass:"Cacher le mot de passe",genPass:"Mot de passe aléatoire",passTooShort:"le mot de passe est trop court (min. longueur: {})",noCharType:"le mot de passe doit contenir des {}",digits:"chiffres",letters:"lettres",letters_up:"lettres en MAJUSCULES",symbols:"symboles",inBlackList:"le mot de passe est dans la liste des plus utilisés",passRequired:"le mot de passe est requis",equalTo:"le mot de passe est le même que l'identifiant",repeat:"le mot de passe est une répétition de caractères",badChars:"le mot de passe contient des caractères incorrects: “{}”",weakWarn:"faible",invalidPassWarn:"*",weakTitle:"Ce mot de passe est faible",generateMsg:"Pour créer un mot de passe fort cliquez sur le bouton {}."}},it:{lower:!1,msg:{pass:"password",and:"e",showPass:"Mostra password",hidePass:"Nascondi password",genPass:"Password casuale",passTooShort:"la password è troppo breve (lunghezza min.: {})",noCharType:"la password deve contenere {}",digits:"numeri",letters:"lettere",letters_up:"lettere in MAIUSCOLO",symbols:"simboli",inBlackList:"la password è nella lista delle password più usate",passRequired:"è necessaria una password",equalTo:"la password è uguale al login",repeat:"la password è composta da caratteri che si ripetono",badChars:"la password contiene caratteri non accettati: “{}”",weakWarn:"debole",invalidPassWarn:"*",weakTitle:"Questa password è debole",generateMsg:"Per generare una password forte, clicca sul tasto {}."}},ru:{lower:!0,msg:{pass:"пароль",and:"и",showPass:"Показать пароль",hidePass:"Скрыть пароль",genPass:"Случайный пароль",passTooShort:"пароль слишком короткий (мин. длина: {})",noCharType:"в пароле должны быть {}",digits:"цифры",letters:"буквы",letters_up:"буквы в ВЕРХНЕМ регистре",symbols:"символы",inBlackList:"этот пароль часто используется в Интернете",passRequired:"пароль обязателен",equalTo:"пароль совпадает с логином",repeat:"пароль состоит из повторяющихся символов",badChars:"в пароле есть недопустимые символы: «{}»",weakWarn:"слабый",invalidPassWarn:"*",weakTitle:"Пароль слабый, его легко взломать",generateMsg:"Чтобы сгенерировать пароль, нажмите кнопку {}."}},ua:{lower:!0,msg:{pass:"пароль",and:"i",showPass:"Показати пароль",hidePass:"Сховати пароль",genPass:"Випадковий пароль",passTooShort:"пароль є занадто коротким (мiн. довжина: {})",noCharType:"пароль повинен містити {}",digits:"цифри",letters:"букви",letters_up:"букви у ВЕРХНЬОМУ регістрі",symbols:"cимволи",inBlackList:"пароль входить до списку паролей, що використовуються найчастіше",passRequired:"пароль є обов'язковим",equalTo:"пароль та логін однакові",repeat:"пароль містить повторювані символи",badChars:"пароль містить неприпустимі символи: «{}»",weakWarn:"слабкий",invalidPassWarn:"*",weakTitle:"Цей пароль є слабким",generateMsg:"Щоб ​​створити надійний пароль, натисніть кнопку {}."}},es:{lower:!0,msg:{pass:"contraseña",and:"y",showPass:"Mostrar contraseña",hidePass:"Ocultar contraseña",genPass:"Contraseña aleatoria",passTooShort:"contraseña demasiado corta (longitud mín.: {})",noCharType:"la contraseña debe contener {}",digits:"dígitos",letters:"letras",letters_up:"letras en MAYÚSCULAS",symbols:"símbolos",inBlackList:"la contraseña está en la lista de las contraseñas más usadas",passRequired:"se requiere contraseña",equalTo:"la contraseña es igual al inicio de sesión",repeat:"la contraseña tiene caracteres repetidos",badChars:"la contraseña contiene caracteres no permitidos: “{}”",weakWarn:"débil",invalidPassWarn:"*",weakTitle:"Esta contraseña es débil",generateMsg:"Para generar una contraseña segura, haga clic en el botón de {}."}},el:{lower:!0,msg:{pass:"πρόσβασης",and:"και",showPass:"Προβολή κωδικού πρόσβασης",hidePass:"Απόκρυψη κωδικού πρόσβασης",genPass:"Τυχαίος κωδικός πρόσβασης",passTooShort:"ο κωδικός πρόσβασης είναι πολύ μικρός (ελάχιστο μήκος: {})",noCharType:"ο κωδικός πρόσβασης πρέπει να περιέχει {}",digits:"ψηφία",letters:"λατινικά γράμματα",letters_up:"λατινικά γράμματα με ΚΕΦΑΛΑΙΑ",symbols:"σύμβολα",inBlackList:"ο κωδικός πρόσβασης βρίσκεται σε κατάλογο δημοφιλέστερων κωδικών",passRequired:"απαιτείται κωδικός πρόσβασης",equalTo:"ο κωδικός είναι όμοιος με το όνομα χρήστη",repeat:"ο κωδικός αποτελείται από επαναλαμβανόμενους χαρακτήρες",badChars:"ο κωδικός περιέχει μη επιτρεπτούς χαρακτήρες: “{}”",weakWarn:"αδύναμος",invalidPassWarn:"*",weakTitle:"Αυτός ο κωδικός πρόσβασης είναι αδύναμος",generateMsg:"Για να δημιουργήσετε δυνατό κωδικό πρόσβασης, κάντε κλικ στο κουμπί {}."}},pt:{lower:!0,msg:{pass:"senha",and:"e",showPass:"Mostrar senha",hidePass:"Ocultar senha",genPass:"Senha aleatória",passTooShort:"senha muito curta (tamanho mínimo: {})",noCharType:"Senha deve conter {}",digits:"dígito",letters:"letras",letters_up:"letras maiúsculas",symbols:"símbolos",inBlackList:"senha está na lista das senhas mais usadas",passRequired:"senha é obrigatória",equalTo:"senha igual ao login",repeat:"senha consiste em uma repetição de caracteres",badChars:"senha tem caracteres inválidos: “{}”",weakWarn:"fraca",invalidPassWarn:"*",weakTitle:"Esta senha é fraca",generateMsg:"Para gerar uma senha forte, clique no botão {}."}}}}(window.jQuery,document,window),function(e,t,n,r){"use strict";var a=n.PassField=n.PassField||{};a.CharTypes={DIGIT:"digits",LETTER:"letters",LETTER_UP:"letters_up",SYMBOL:"symbols",UNKNOWN:"unknown"},a.CheckModes={MODERATE:0,STRICT:1},a.Config={defaults:{pattern:"abcdef12",acceptRate:.8,allowEmpty:!0,isMasked:!0,showToggle:!0,showGenerate:!0,showWarn:!0,showTip:!0,tipPopoverStyle:{},strengthCheckTimeout:500,validationCallback:null,blackList:[],locale:"",localeMsg:{},warnMsgClassName:"help-inline",errorWrapClassName:"error",allowAnyChars:!0,checkMode:a.CheckModes.MODERATE,chars:{digits:"1234567890",letters:"abcdefghijklmnopqrstuvwxyzßабвгедёжзийклмнопрстуфхцчшщъыьэюяґєåäâáàãéèêëíìîїóòôõöüúùûýñçøåæþðαβγδεζηθικλμνξοπρσςτυφχψω",letters_up:"ABCDEFGHIJKLMNOPQRSTUVWXYZАБВГЕДЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯҐЄÅÄÂÁÀÃÉÈÊËÍÌÎЇÓÒÔÕÖÜÚÙÛÝÑÇØÅÆÞÐΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ",symbols:"@#$%^&*()-_=+[]{};:<>/?!"},events:{generated:null,switched:null},nonMatchField:null,length:{min:null,max:null},maskBtn:{textMasked:"abc",textUnmasked:"&bull;&bull;&bull;",className:!1,classMasked:!1,classUnmasked:!1}},locales:a.Config?a.Config.locales:{},blackList:["password","123456","12345678","abc123","qwerty","monkey","letmein","dragon","111111","baseball","iloveyou","trustno1","1234567","sunshine","master","123123","welcome","shadow","ashley","football","jesus","michael","ninja","mustang","password1","p@ssw0rd","miss","root","secret"],generationChars:{digits:"1234567890",letters:"abcdefghijklmnopqrstuvwxyz",letters_up:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},dataAttr:"PassField.Field"},a.Field=function(d,h){function p(t){if(ue.showTip)if(ue.tipPopoverStyle&&e&&"function"==typeof e.fn.popover)e(ce.mainInput).popover(l.extend({title:null,placement:ue.tipPopoverStyle.placement||function(t,r){var a=e(r).position().top-e(n).scrollTop(),l=e(n).height()-a;return l>300||l>a?"bottom":"top"},animation:!1},ue.tipPopoverStyle,{trigger:"manual",html:!0,content:function(){return ye}}));else{ce.tip=q("div",{id:"tip",className:"tip"},{position:"absolute",margin:"0",padding:"0",width:t.width+"px"}),G(ce.mainInput,ce.tip);var r=q("div",{id:"tip-arr-wrap",className:"tip-arr-wrap"});ce.tip.appendChild(r),r.appendChild(q("div",{id:"tip-arr",className:"tip-arr"})),r.appendChild(q("div",{id:"tip-arr-in",className:"tip-arr-in"})),ce.tipBody=q("div",{id:"tip-body",className:"tip-body"}),ce.tip.appendChild(ce.tipBody)}}function f(){ce.genBtn&&(ce.genBtn.style.display=fe||ge&&!me?"block":"none"),ce.maskBtn&&(ce.maskBtn.style.display=fe||ge&&!ve?"block":"none"),w();var e=z(x()),t=y();ce.maskBtn&&"none"!=ce.maskBtn.style.display&&(t+=K(ce.maskBtn,"width"),V(ce.maskBtn,{top:e.top,left:e.left+e.width-t,height:e.height})),ce.genBtn&&"none"!=ce.genBtn.style.display&&(t+=K(ce.genBtn,"width"),V(ce.genBtn,{top:e.top,left:e.left+e.width-t,height:e.height}),ce.genBtnInner.style.marginTop=Math.max(0,Math.round((e.height-19)/2))+"px"),ce.placeholder&&"none"!=ce.placeholder.style.display&&V(ce.placeholder,{top:e.top,left:e.left+7,height:e.height}),ce.tip&&"none"!=ce.tip.style.display&&V(ce.tip,{left:e.left,top:e.top+e.height,width:e.width})}function y(){var e=K(x(),"paddingRight");return Math.max(je,e)}function w(){if(ue.showTip)if(ce.tip)ce.tip.style.display=he&&ge?"block":"none";else if(he&&ge){if(!be||ye!=be){var t=e(ce.mainInput).data("popover")||e(ce.mainInput).data("bs.popover"),n=t.options,r=n.animation;be&&(n.animation=!1);var a=x().offsetWidth-2,l=t.$tip;l?l.width(a):t.options.template&&(t.options.template=t.options.template.replace('class="popover"','class="popover" style="width: '+a+'px"')),ce.clearInput&&(t.$element=e(x())),e(ce.mainInput).popover("show"),be=ye,n.animation=r}}else be&&(be=null,e(ce.mainInput).popover("hide"))}function x(){return de?ce.mainInput:ce.clearInput||ce.mainInput}function j(){x().focus()}function O(e){var t="mouseover"===e.type,n=e.relatedTarget?e.relatedTarget:t?e.fromElement:e.toElement;(!n||!n.id||0!=n.id.indexOf(we+"btn")&&n!==ce.mainInput&&n!==ce.clearInput)&&(fe=t,f())}function C(e){var t,n=e?e.which||e.keyCode:null,r=n===Ce||n===Oe;t=ce.clearInput?de?ce.clearInput.value=ce.mainInput.value:ce.mainInput.value=ce.clearInput.value:ce.mainInput.value,ue.strengthCheckTimeout>0&&!he&&!r?(re&&clearTimeout(re),re=setTimeout(P,ue.strengthCheckTimeout)):P(),ce.placeholder&&!t&&(ce.placeholder.style.display="block"),S()}function S(){if(ce.passLengthChecker){var e=x().value;de&&(e=e.replace(/./g,se.passSymbol)),Y(ce.passLengthChecker,e);var t=ce.passLengthChecker.offsetWidth;t+=K(ce.mainInput,"paddingLeft");var n=0,r=H(x()).width,a=!1,l=y();if(ce.maskBtn){var d=t>r-(n=K(ce.maskBtn,"width"))-l;ve!=d&&(a=!0,ve=d)}if(ce.genBtn){var h=t>r-n-K(ce.genBtn,"width")-l;me!=h&&(a=!0,me=h)}a&&f()}}function _(){ce.placeholder&&(ce.placeholder.style.display="none")}function k(){oe&&(clearTimeout(oe),oe=null),ae&&(clearTimeout(ae),ae=null),ge=!0,f()}function E(){oe=setTimeout((function(){oe=null,ge=!1,f(),ue.isMasked&&!ae&&(ae=setTimeout((function(){ae=null,T(!0,!1)}),1500))}),100)}function A(){he&&P()}function T(e,t){t===r&&(t=!0);var n=e!=de;if(e=e===r?!de:!!e,se.changeType){var a=x(),d=R(a);a.setAttribute("type",e?"password":"text"),t&&(I(a,d),a.focus())}else{var h=W(x(),"display")||"block",p=e?ce.clearInput:ce.mainInput,y=e?ce.mainInput:ce.clearInput;de!=e&&l.each(["paddingRight","width","backgroundImage","backgroundPosition","backgroundRepeat","backgroundAttachment","border"],(function(e){var t=p.style[e];t&&(y.style[e]=t)}));var w=R(p);y.style.display=h,p.style.display="none",y.value=p.value,t&&(I(y,w),y.focus()),ce.mainInput.nextSibling!=ce.clearInput&&G(ce.mainInput,ce.clearInput)}ce.maskBtn&&(Y(ce.maskBtn,e?ue.maskBtn.textMasked:ue.maskBtn.textUnmasked),e?(ue.maskBtn.classUnmasked&&Q(ce.maskBtn,ue.maskBtn.classUnmasked,!0),ue.maskBtn.classMasked&&J(ce.maskBtn,ue.maskBtn.classMasked,!0)):(ue.maskBtn.classMasked&&Q(ce.maskBtn,ue.maskBtn.classMasked,!0),ue.maskBtn.classUnmasked&&J(ce.maskBtn,ue.maskBtn.classUnmasked,!0)),ce.maskBtn.title=e?te.msg.showPass:te.msg.hidePass),de=e,S(),f(),n&&ee("switched",de)}function R(e){return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?{start:e.selectionStart,end:e.selectionEnd}:null}function I(e,t){t&&"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd&&(e.selectionStart=t.start,e.selectionEnd=t.end)}function P(){re&&(clearTimeout(re),re=null);var e=x().value,t=function(e){var t=L(ue.pattern,a.CharTypes.SYMBOL),n=L(e,ue.allowAnyChars?a.CharTypes.SYMBOL:a.CharTypes.UNKNOWN),r=[],d=0;l.each(t,(function(e){if(d++,!n[e]){var t=te.msg[e];if(e==a.CharTypes.SYMBOL){var l=ue.chars[e];l.length>4&&(l=l.substring(0,4)),t=t+" ("+l+")"}r.push(t)}}));var h=1-r.length/d;if(r.length&&(r=[D(r)]),ue.checkMode==a.CheckModes.MODERATE){var p=0;l.each(n,(function(e){t[e]||p++})),h+=p/d}var f=ue.pattern.length,y=e.length/f-1;if(ue.length&&ue.length.min&&e.length<ue.length.min&&(y=-10,ue.length.min>f&&(f=ue.length.min)),0>y?(h+=y,r.push(te.msg.passTooShort.replace("{}",f.toString()))):ue.checkMode==a.CheckModes.MODERATE&&(h+=y/d),e.length>2){for(var w=e.charAt(0),x=!0,j=0;j<e.length;j++)if(e.charAt(j)!=w){x=!1;break}x&&(h=0,r=[te.msg.repeat])}return 0>h&&(h=0),h>1&&(h=1),{strength:h,messages:r,charTypes:n}}(e);if(0==e.length)t={strength:ue.allowEmpty?0:null,messages:[te.msg.passRequired]};else{!ue.allowAnyChars&&t.charTypes[a.CharTypes.UNKNOWN]&&(t={strength:null,messages:[te.msg.badChars.replace("{}",t.charTypes[a.CharTypes.UNKNOWN])]}),delete t.charTypes;var n=!1;l.each(ue.blackList,(function(t){return t!=e||(n=!0,!1)})),n&&(t={strength:0,messages:[te.msg.inBlackList]}),e&&e===function(){if(!ue.nonMatchField)return null;var e=X(ue.nonMatchField);return e?e.value:null}()&&(t={strength:0,messages:[te.msg.equalTo]})}if("function"==typeof ue.validationCallback){var r,d,h=ue.validationCallback(ce.mainInput,t);h&&h.messages&&l.isArray(h.messages)&&(r=h.messages),h&&Object.prototype.hasOwnProperty.call(h,"strength")&&("number"==typeof h.strength||null===h.strength)&&(d=h.strength),r&&r.length?(t.messages=r,t.strength=d):d&&d>t.strength&&(t.strength=d)}return 0==e.length&&ue.allowEmpty?(M(),pe={strength:0},!0):null===t.strength||t.strength<ue.acceptRate?(function(e,t){var n="",r="";if(null===e)n=te.msg.invalidPassWarn,r=t[0].charAt(0).toUpperCase()+t[0].substring(1);else if(n=te.msg.weakWarn,r="",t)for(var a=0;a<t.length;a++){var l=t[a].charAt(0);0==a?(r+=te.msg.weakTitle+": ",te.lower&&(l=l.toLowerCase())):(r+="<br/>",l=l.toUpperCase()),(r+=l+t[a].substring(1))&&"."!=r.charAt(r.length-1)&&(r+=".")}if(r&&"."!=r.charAt(r.length-1)&&(r+="."),pe={strength:e,message:r},ce.warnMsg&&(Y(ce.warnMsg,n),ce.warnMsg.title=r,ue.errorWrapClassName&&J(ce.wrapper,ue.errorWrapClassName,!0)),ue.showTip){var d=r;ce.genBtn&&(d+="<br/>"+te.msg.generateMsg.replace("{}",'<div class="'+F("btn-gen-help")+'"></div>')),ye=d,ce.tipBody&&Y(ce.tipBody,d)}he=!0,f()}(t.strength,t.messages),!1):(M(),pe={strength:t.strength},!0)}function D(e){for(var t=e[0],n=1;n<e.length;n++)t+=n==e.length-1?" "+te.msg.and+" ":", ",t+=e[n];return te.msg.noCharType.replace("{}",t)}function M(){ce.warnMsg&&(Y(ce.warnMsg,""),ce.warnMsg.title="",ue.errorWrapClassName&&Q(ce.wrapper,ue.errorWrapClassName,!0)),ye=null,he=!1,f()}function L(e,t){for(var n={},r=0;r<e.length;r++){var a=e.charAt(r),d=t;l.each(ue.chars,(function(e,t){return!(t.indexOf(a)>=0)||(d=e,!1)})),n[d]=(n[d]||"")+a}return n}function F(e){return we+e}function q(e,t,n){return t.id&&(t.id=function(e){return we+e+"-"+ne}(t.id)),t.className&&(t.className=F(t.className)),l.newEl(e,t,n)}function N(e){try{return e.getBoundingClientRect()}catch(e){return{top:0,left:0}}}function B(e){var t=e.ownerDocument;if(!t)return{top:0,left:0};var r=N(e);return{top:r.top+(n.pageYOffset||0)-(t.documentElement.clientTop||0),left:r.left+(n.pageXOffset||0)-(t.documentElement.clientLeft||0)}}function U(e){var n;try{n=e.offsetParent}catch(e){}for(n||(n=t.documentElement);n&&"html"!=n.nodeName.toLowerCase()&&"static"===W(n,"position");)n=n.offsetParent;return n||t.documentElement}function H(e){return{width:e.offsetWidth,height:e.offsetHeight}}function z(e){return l.extend(B(e),H(e))}function V(e,t){if(t.height&&!isNaN(t.height)&&(e.style.height=t.height+"px",e.style.lineHeight=t.height+"px"),t.width&&!isNaN(t.width)&&(e.style.width=t.width+"px"),t.top||t.left){if("none"==W(e,"display"))return e.style.top=t.top+"px",void(e.style.left=t.left+"px");var n,r,a;if(a=B(e),((r=W(e,"top")||0)+(n=W(e,"left")||0)+"").indexOf("auto")>-1){var l=function(e){var t,n={top:0,left:0};if("fixed"===W(e,"position"))t=N(e);else{var r=U(e);t=B(e),"html"!=r.nodeName.toLowerCase()&&(n=B(r)),n.top+=K(r,"borderTopWidth"),n.left+=K(r,"borderLeftWidth")}return{top:t.top-n.top-K(e,"marginTop"),left:t.left-n.left-K(e,"marginLeft")}}(e);r=l.top,n=l.left}else r=parseFloat(r)||0,n=parseFloat(n)||0;t.top&&(e.style.top=t.top-a.top+r+"px"),t.left&&(e.style.left=t.left-a.left+n+"px")}}function W(e,t){var r="function"==typeof n.getComputedStyle?n.getComputedStyle(e,null):e.currentStyle;return r?r[t]:null}function K(e,t){var n=W(e,t);if(!n)return 0;var r=parseFloat(n);return isNaN(r)?0:r}function G(e,t){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)}function Y(e,n){try{e.innerHTML=n}catch(a){var r=t.createElement("c");for(r.innerHTML=n;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(r)}}function X(e){return"string"==typeof e?t.getElementById(e):e.jquery?e[0]:e}function J(e,t,n){Z(e,t,n)||(e.className=e.className+(e.className?" ":"")+(!0===n?t:F(t)))}function Q(e,t,n){Z(e,t,n)&&(e.className=(" "+e.className+" ").replace((!0===n?t:F(t))+" ","").replace(/^\s+|\s+$/g,""))}function Z(e,t,n){return t=" "+(!0===n?t:F(t))+" ",(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(t)>-1}function ee(t,n){if(e)try{e(ce.mainInput).trigger(xe+t,n)}catch(e){}if(ue.events&&"function"==typeof ue.events[t])try{ue.events[t].call(ce.mainInput,n)}catch(e){}}var te,ne,re,oe,ae,se,le=a.Config,ce={},ue=l.extend({},le.defaults,h),de=!0,he=!1,pe=null,fe=!1,ge=!1,me=!1,ve=!1,be=!1,ye=null,we="a_pf-",xe="pass:",je=5,Oe=46,Ce=8;this.toggleMasking=function(e){T(e)},this.setPass=function(e){ce.mainInput.value=e,ce.clearInput&&(ce.clearInput.value=e),C()},this.validatePass=P,this.getPassValidationMessage=function(){return pe?pe.message:null},this.getPassStrength=function(){return pe?pe.strength:-1},function(){ue.blackList=(ue.blackList||[]).concat(a.Config.blackList),"string"==typeof d&&(d=t.getElementById(d)),ce.mainInput=d,ce.mainInput&&(function(){var e=ue.locale;!e&&navigator.language&&(e=navigator.language.replace(/\-.*/g,"")),e&&(te=le.locales[e]),te&&(te=l.extend({},le.locales.en,te)),te||(te=l.extend({},le.locales.en)),ue.localeMsg&&l.extend(te.msg,ue.localeMsg)}(),(ne=ce.mainInput.id)||(ne="i"+Math.round(1e5*Math.random()),ce.mainInput.id=ne),function(){var e=!0,n=!0,r=t.createElement("input");"placeholder"in r||(e=!1),r.setAttribute("style","position:absolute;left:-10000px;top:-10000px;"),t.body.appendChild(r);try{r.setAttribute("type","password")}catch(e){n=!1}t.body.removeChild(r);var a=t.createElement("div");a.setAttribute("style","display:inline-block"),a.style.paddingLeft=a.style.width="1px",t.body.appendChild(a);var l=2==a.offsetWidth,d="inline-block"===W(a,"display");t.body.removeChild(a);var h=navigator.userAgent.indexOf("AppleWebKit")>=0||navigator.userAgent.indexOf("Opera")>=0||navigator.userAgent.indexOf("Firefox")>=0&&navigator.platform.indexOf("Mac")>=0?"•":"●";se={placeholders:e,changeType:n,boxModel:l,hasInlineBlock:d,passSymbol:h}}(),function(){var e=z(ce.mainInput);e.top+=K(ce.mainInput,"marginTop"),ce.wrapper=ce.mainInput.parentNode,J(ce.wrapper,"wrap"),se.hasInlineBlock||J(ce.wrapper,"wrap-no-ib"),"static"==W(ce.wrapper,"position")&&(ce.wrapper.style.position="relative"),ue.length&&ue.length.max&&ce.mainInput.setAttribute("maxLength",ue.length.max.toString()),function(){if(!se.changeType){ce.clearInput=q("input",{type:"text",id:"txt-clear",className:"txt-clear",value:ce.mainInput.value},{display:"none"});var e=ce.mainInput.className;e&&J(ce.clearInput,e,!0);var t=ce.mainInput.style.cssText;t&&(ce.clearInput.style.cssText=t),l.each(["maxLength","size","placeholder"],(function(e){var t=ce.mainInput.getAttribute(e);t&&ce.clearInput.setAttribute(e,t)})),G(ce.mainInput,ce.clearInput)}J(ce.mainInput,"txt-pass")}(),ue.showWarn&&(ce.warnMsg=q("div",{id:"warn",className:"warn"},{margin:"0 0 0 3px"}),ue.warnMsgClassName&&J(ce.warnMsg,ue.warnMsgClassName,!0),G(ce.clearInput||ce.mainInput,ce.warnMsg)),ue.showToggle&&(ce.maskBtn=q("div",{id:"btn-mask",className:"btn-mask",title:te.msg.showPass},{position:"absolute",margin:"0",padding:"0"}),J(ce.maskBtn,"btn"),ue.maskBtn.className&&J(ce.maskBtn,ue.maskBtn.className,!0),ue.maskBtn.classMasked&&J(ce.maskBtn,ue.maskBtn.classMasked,!0),Y(ce.maskBtn,ue.maskBtn.textMasked),G(ce.mainInput,ce.maskBtn)),ue.showGenerate&&(ce.genBtn=q("div",{id:"btn-gen",className:"btn-gen",title:te.msg.genPass},{position:"absolute",margin:"0",padding:"0"}),J(ce.genBtn,"btn"),G(ce.mainInput,ce.genBtn),ce.genBtnInner=q("div",{id:"btn-gen-i",className:"btn-gen-i",title:te.msg.genPass}),ce.genBtn.appendChild(ce.genBtnInner)),p(e),function(e){if(se.placeholders)!ce.mainInput.getAttribute("placeholder")&&ce.mainInput.getAttribute("data-placeholder")&&ce.mainInput.setAttribute("placeholder",ce.mainInput.getAttribute("data-placeholder"));else{var t=ce.mainInput.getAttribute("placeholder")||ce.mainInput.getAttribute("data-placeholder");t&&(ce.placeholder=q("div",{id:"placeholder",className:"placeholder"},{position:"absolute",margin:"0",padding:"0",height:e.height+"px",lineHeight:e.height+"px"}),Y(ce.placeholder,t),G(ce.mainInput,ce.placeholder))}}(e),se.passSymbol&&(ce.passLengthChecker=q("div",{id:"len"},{position:"absolute",height:W(ce.mainInput,"height"),top:"-10000px",left:"-10000px",display:"block",color:"transparent",border:"none"}),G(ce.mainInput,ce.passLengthChecker),setTimeout((function(){l.each(["marginLeft","fontFamily","fontSize","fontWeight","fontStyle","fontVariant"],(function(e){var t=W(ce.mainInput,e);t&&(ce.passLengthChecker.style[e]=t)}))}),50)),setTimeout(f,0)}(),function(){if(l.each(ce.clearInput?[ce.mainInput,ce.clearInput]:[ce.mainInput],(function(e){l.attachEvent(e,"onkeyup",C),l.attachEvent(e,"onfocus",k),l.attachEvent(e,"onblur",E),l.attachEvent(e,"onmouseover",O),l.attachEvent(e,"onmouseout",O),ce.placeholder&&l.attachEvent(e,"onkeydown",_)})),l.attachEvent(n,"onresize",f),ce.maskBtn&&(l.attachEvent(ce.maskBtn,"onclick",(function(){T()})),l.attachEvent(ce.maskBtn,"onmouseover",O),l.attachEvent(ce.maskBtn,"onmouseout",O)),ce.genBtn&&(l.attachEvent(ce.genBtn,"onclick",(function(){!function(){var e=function(){var e="",t=L(ue.pattern,a.CharTypes.SYMBOL),n=[];return l.each(t,(function(e,t){for(var r=0;r<t.length;r++)n.push(e)})),n.sort((function(){return.7-Math.random()})),l.each(n,(function(t){var n=le.generationChars[t];n?ue.chars[t]&&ue.chars[t].indexOf(n)<0&&(n=ue.chars[t]):n=ue.chars[t],e+=l.selectRandom(n)})),e}();ce.mainInput.value=e,ce.clearInput&&(ce.clearInput.value=e),ee("generated",e),T(!1),re&&(clearTimeout(re),re=null),P(),ce.placeholder&&(ce.placeholder.style.display="none")}()})),l.attachEvent(ce.genBtn,"onmouseover",O),l.attachEvent(ce.genBtn,"onmouseout",O)),ce.placeholder&&l.attachEvent(ce.placeholder,"onclick",j),ue.nonMatchField){var e=X(ue.nonMatchField);e&&l.attachEvent(e,"onkeyup",A)}}(),T(ue.isMasked,!1),("function"==typeof ce.mainInput.hasAttribute&&ce.mainInput.hasAttribute("autofocus")||ce.mainInput.getAttribute("autofocus"))&&(ce.mainInput.focus(),k()),function(t,n){e&&e(ce.mainInput).data(t,n)}(a.Config.dataAttr,this))}.call(this)};var l={extend:function(){for(var e=arguments,t=1;t<e.length;t++)l.each(e[t],(function(t,n){e[0][t]=l.isArray(e[0][t])||l.isArray(n)?e[0][t]?e[0][t].concat(n||[]):n:l.isElement(n)?n:"object"==typeof e[0][t]&&"object"==typeof n&&null!==n?l.extend({},e[0][t],n):"object"==typeof n&&null!==n?l.extend({},n):n}));return e[0]},newEl:function(e,n,r){var a=t.createElement(e);return n&&l.each(n,(function(e,t){t&&(a[e]=t)})),r&&l.each(r,(function(e,t){t&&(a.style[e]=t)})),a},attachEvent:function(e,t,r){var a=e[t];e[t]=function(e){e||(e=n.event),r(e),"function"==typeof a&&a(e)}},each:function(e,t){if(l.isArray(e)){for(var n=0;n<e.length;n++)if(!1===t(e[n]))return}else for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!1===t(r,e[r]))return},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isElement:function(t){if(!t)return!1;try{return t instanceof HTMLElement||e&&t instanceof jQuery}catch(e){return"object"==typeof t&&t.nodeType||t.jquery}},selectRandom:function(e){var t=Math.floor(Math.random()*e.length);return l.isArray(e)?e[t]:e.charAt(t)},contains:function(e,t){if(!e)return!1;var n=!1;return l.each(e,(function(e){return e!==t||(n=!0,!1)})),n}};e&&(e.fn.passField=function(e){return this.each((function(){new a.Field(this,e)}))},e.fn.togglePassMasking=function(t){return this.each((function(){var n=e(this).data(a.Config.dataAttr);n&&n.toggleMasking(t)}))},e.fn.setPass=function(t){return this.each((function(){var n=e(this).data(a.Config.dataAttr);n&&n.setPass(t)}))},e.fn.validatePass=function(){var t=!0;return this.each((function(){var n=e(this).data(a.Config.dataAttr);n&&!n.validatePass()&&(t=!1)})),t},e.fn.getPassValidationMessage=function(){var e=this.first();if(e){var t=e.data(a.Config.dataAttr);if(t)return t.getPassValidationMessage()}return null},e.fn.getPassStrength=function(){var e=this.first();if(e){var t=e.data(a.Config.dataAttr);if(t)return t.getPassStrength()}return null}),e&&e.validator&&jQuery.validator.addMethod("passfield",(function(t,n){return e(n).validatePass()}),(function(t,n){return e(n).getPassValidationMessage()}))}(window.jQuery,document,window)},,function(e,t,n){"use strict";function r(){try{var e;return(e=$).localStorage.apply(e,arguments)}catch(e){return console.error("localStorage exception",e),null}}angular.module("localStorage",[]).value("localStorage",r)},,,,,,,,,,,,,,,,,,,function(e,t){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var r=["accept","acceptCharset","acceptCharset","accessKey","action","allowFullScreen","alt","as","async","autoCapitalize","autoComplete","autoCorrect","autoFocus","autoPlay","autoSave","capture","cellPadding","cellSpacing","challenge","charSet","checked","children","cite","className","classID","className","cols","colSpan","content","contentEditable","contextMenu","controls","controlsList","coords","crossOrigin","dangerouslySetInnerHTML","data","dateTime","default","defaultChecked","defaultValue","defer","dir","disabled","disablePictureInPicture","disableRemotePlayback","download","draggable","encType","enterKeyHint","htmlFor","form","formMethod","formAction","formEncType","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","htmlFor","httpEquiv","httpEquiv","icon","id","innerHTML","inputMode","integrity","is","itemID","itemProp","itemRef","itemScope","itemType","keyParams","keyType","kind","label","lang","list","loop","low","manifest","marginWidth","marginHeight","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noModule","nonce","noValidate","open","optimum","pattern","placeholder","playsInline","poster","preload","profile","radioGroup","readOnly","referrerPolicy","rel","required","reversed","role","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","spellCheck","src","srcDoc","srcLang","srcSet","start","step","style","summary","tabIndex","title","type","useMap","value","wmode","wrap"];e.exports=function(e){var t;return(t=e,Object.entries?Object.entries(t):Object.keys(t).map((function(e){return[e,t[e]]}))).reduce((function(e,t){var a,l=t[0],d=t[1];return r.includes(l)?n({},e,((a={})[l]=d,a)):e}),{})}},,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;!function(global){var qq=function(e){"use strict";return{hide:function(){return e.style.display="none",this},attach:function(t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),function(){qq(e).detach(t,n)}},detach:function(t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n),this},contains:function(t){return!!t&&(e===t||(e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e))))},insertBefore:function(t){return t.parentNode.insertBefore(e,t),this},remove:function(){return e.parentNode.removeChild(e),this},css:function(t){if(null==e.style)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return null!=t.opacity&&"string"!=typeof e.style.opacity&&void 0!==e.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t),this},hasClass:function(t,n){var r=new RegExp("(^| )"+t+"( |$)");return r.test(e.className)||!(!n||!r.test(e.parentNode.className))},addClass:function(t){return qq(e).hasClass(t)||(e.className+=" "+t),this},removeClass:function(t){var n=new RegExp("(^| )"+t+"( |$)");return e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t,n){var r,a=[];return n&&e.querySelector?e.querySelector("."+t):e.querySelectorAll?e.querySelectorAll("."+t):(r=e.getElementsByTagName("*"),qq.each(r,(function(e,n){qq(n).hasClass(t)&&a.push(n)})),n?a[0]:a)},getFirstByClass:function(t){return qq(e).getByClass(t,!0)},children:function(){for(var t=[],n=e.firstChild;n;)1===n.nodeType&&t.push(n),n=n.nextSibling;return t},setText:function(t){return e.innerText=t,e.textContent=t,this},clearText:function(){return qq(e).setText("")},hasAttribute:function(t){var n;return e.hasAttribute?!!e.hasAttribute(t)&&null==/^false$/i.exec(e.getAttribute(t)):void 0!==(n=e[t])&&null==/^false$/i.exec(n)}}},ExifRestorer;!function(){"use strict";var div;qq.canvasToBlob=function(e,t,n){return qq.dataUriToBlob(e.toDataURL(t,n))},qq.dataUriToBlob=function(e){var t,n,r,a,l,d,h,p;return n=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURI(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(n.length),r=new Uint8Array(t),qq.each(n,(function(e,t){r[e]=t.charCodeAt(0)})),l=t,d=a,h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,(p=h&&new h)?(p.append(l),p.getBlob(d)):new Blob([l],{type:d})},qq.log=function(e,t){window.console&&(t&&"info"!==t?window.console[t]?window.console[t](e):window.console.log("<"+t+"> "+e):window.console.log(e))},qq.isObject=function(e){return e&&!e.nodeType&&"[object Object]"===Object.prototype.toString.call(e)},qq.isFunction=function(e){return"function"==typeof e},qq.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)||e&&window.ArrayBuffer&&e.buffer&&e.buffer.constructor===ArrayBuffer},qq.isItemList=function(e){return"[object DataTransferItemList]"===Object.prototype.toString.call(e)},qq.isNodeList=function(e){return"[object NodeList]"===Object.prototype.toString.call(e)||e.item&&e.namedItem},qq.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},qq.trimStr=function(e){return String.prototype.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},qq.format=function(e){var t=Array.prototype.slice.call(arguments,1),n=e,r=n.indexOf("{}");return qq.each(t,(function(e,t){var a=n.substring(0,r),l=n.substring(r+2);if((r=(n=a+t+l).indexOf("{}",r+t.length))<0)return!1})),n},qq.isFile=function(e){return window.File&&"[object File]"===Object.prototype.toString.call(e)},qq.isFileList=function(e){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(e)},qq.isFileOrInput=function(e){return qq.isFile(e)||qq.isInput(e)},qq.isInput=function(e,t){var n=function(e){var n=e.toLowerCase();return t?"file"!==n:"file"===n};return!!(window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(e)&&e.type&&n(e.type))||!!(e.tagName&&"input"===e.tagName.toLowerCase()&&e.type&&n(e.type))},qq.isBlob=function(e){if(window.Blob&&"[object Blob]"===Object.prototype.toString.call(e))return!0},qq.isXhrUploadSupported=function(){var e=document.createElement("input");return e.type="file",void 0!==e.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&void 0!==qq.createXhrInstance().upload},qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){return qq.log("Neither XHR or ActiveX are supported!","error"),null}},qq.isFolderDropSupported=function(e){return e.items&&e.items.length>0&&e.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){return!qq.androidStock()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)},qq.sliceBlob=function(e,t,n){return(e.slice||e.mozSlice||e.webkitSlice).call(e,t,n)},qq.arrayBufferToHex=function(e){var t="",n=new Uint8Array(e);return qq.each(n,(function(e,n){var r=n.toString(16);r.length<2&&(r="0"+r),t+=r})),t},qq.readBlobToHex=function(e,t,n){var r=qq.sliceBlob(e,t,t+n),a=new FileReader,l=new qq.Promise;return a.onload=function(){l.success(qq.arrayBufferToHex(a.result))},a.onerror=l.failure,a.readAsArrayBuffer(r),l},qq.extend=function(e,t,n){return qq.each(t,(function(t,r){n&&qq.isObject(r)?(void 0===e[t]&&(e[t]={}),qq.extend(e[t],r,!0)):e[t]=r})),e},qq.override=function(e,t){var n={},r=t(n);return qq.each(r,(function(t,r){void 0!==e[t]&&(n[t]=e[t]),e[t]=r})),e},qq.indexOf=function(e,t,n){if(e.indexOf)return e.indexOf(t,n);n=n||0;var r=e.length;for(n<0&&(n+=r);n<r;n+=1)if(e.hasOwnProperty(n)&&e[n]===t)return n;return-1},qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.userAgent.indexOf("Trident")},qq.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")},qq.ie8=function(){return-1!==navigator.userAgent.indexOf("MSIE 8")},qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")},qq.ie11=function(){return qq.ie()&&-1!==navigator.userAgent.indexOf("rv:11")},qq.edge=function(){return navigator.userAgent.indexOf("Edge")>=0},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.opera=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Opera")},qq.firefox=function(){return!qq.edge()&&!qq.ie11()&&-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},qq.androidStock=function(){return qq.android()&&navigator.userAgent.toLowerCase().indexOf("chrome")<0},qq.ios6=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 6_")},qq.ios7=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")},qq.ios8=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_")},qq.ios800=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_0 ")},qq.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")},qq.iosChrome=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf("CriOS")},qq.iosSafari=function(){return qq.ios()&&!qq.iosChrome()&&-1!==navigator.userAgent.indexOf("Safari")},qq.iosSafariWebView=function(){return qq.ios()&&!qq.iosChrome()&&!qq.iosSafari()},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=(div=document.createElement("div"),function(e){div.innerHTML=e;var t=div.firstChild;return div.removeChild(t),t}),qq.each=function(e,t){var n;if(e)if(window.Storage&&e.constructor===window.Storage)for(n=0;n<e.length&&!1!==t(e.key(n),e.getItem(e.key(n)));n++);else if(qq.isArray(e)||qq.isItemList(e)||qq.isNodeList(e))for(n=0;n<e.length&&!1!==t(n,e[n]);n++);else if(qq.isString(e))for(n=0;n<e.length&&!1!==t(n,e.charAt(n));n++);else for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!1===t(n,e[n]))break},qq.bind=function(e,t){if(qq.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return function(){var r=qq.extend([],n);return arguments.length&&(r=r.concat(Array.prototype.slice.call(arguments))),e.apply(t,r)}}throw new Error("first parameter must be a function!")},qq.obj2url=function(e,t,n){var r=[],a="&",l=function(e,n){var a=t?/\[\]$/.test(t)?t:t+"["+n+"]":n;"undefined"!==a&&"undefined"!==n&&r.push("object"==typeof e?qq.obj2url(e,a,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(a)+"="+encodeURIComponent(e()):encodeURIComponent(a)+"="+encodeURIComponent(e))};return!n&&t?(a=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",r.push(t),r.push(qq.obj2url(e))):"[object Array]"===Object.prototype.toString.call(e)&&void 0!==e?qq.each(e,(function(e,t){l(t,e)})):null!=e&&"object"==typeof e?qq.each(e,(function(e,t){l(t,e)})):r.push(encodeURIComponent(t)+"="+encodeURIComponent(e)),t?r.join(a):r.join(a).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(e,t,n){return t||(t=new FormData),qq.each(e,(function(e,r){e=n?n+"["+e+"]":e,qq.isObject(r)?qq.obj2FormData(r,t,e):qq.isFunction(r)?t.append(e,r()):t.append(e,r)})),t},qq.obj2Inputs=function(e,t){var n;return t||(t=document.createElement("form")),qq.obj2FormData(e,{append:function(e,r){(n=document.createElement("input")).setAttribute("name",e),n.setAttribute("value",r),t.appendChild(n)}}),t},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.getExtension=function(e){var t=e.lastIndexOf(".")+1;if(t>0)return e.substr(t,e.length-t)},qq.getFilename=function(e){return qq.isInput(e)?e.value.replace(/.*(\/|\\)/,""):qq.isFile(e)&&null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name},qq.DisposeSupport=function(){var e=[];return{dispose:function(){var t;do{(t=e.shift())&&t()}while(t)},attach:function(){var e=arguments;this.addDisposer(qq(e[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(t){e.push(t)}}}}(),function(){"use strict";void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return qq}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(),function(){"use strict";qq.Error=function(e){this.message="[Fine Uploader "+qq.version+"] "+e},qq.Error.prototype=new Error}(),qq.version="5.15.4",qq.supportedFeatures=function(){"use strict";var e,t,n,r,a,l,d,h,p,f,y,w,x,j,O,C;function S(){return!!window.XMLHttpRequest&&void 0!==qq.createXhrInstance().withCredentials}function _(){return void 0!==window.XDomainRequest}return e=function(){var e,t=!0;try{(e=document.createElement("input")).type="file",qq(e).hide(),e.disabled&&(t=!1)}catch(e){t=!1}return t}(),t=(r=e&&qq.isXhrUploadSupported())&&!qq.androidStock(),a=(n=r&&(("draggable"in(C=document.createElement("span"))||"ondragstart"in C&&"ondrop"in C)&&!qq.android()&&!qq.ios()))&&(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/),l=r&&qq.isFileChunkingSupported(),d=r&&l&&function(){try{return!!window.localStorage&&qq.isFunction(window.localStorage.setItem)}catch(e){return!1}}(),h=r&&(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/),p=e&&(void 0!==window.postMessage||r),y=S(),f=_(),w=!!S()||_(),x=void 0!==document.createElement("input").webkitdirectory,j=r&&void 0!==window.FileReader,O=!!r&&!qq.androidStock()&&!qq.iosChrome(),{ajaxUploading:r,blobUploading:t,canDetermineSize:r,chunking:l,deleteFileCors:w,deleteFileCorsXdr:f,deleteFileCorsXhr:y,dialogElement:!!window.HTMLDialogElement,fileDrop:n,folderDrop:a,folderSelection:x,imagePreviews:j,imageValidation:j,itemSizeValidation:r,pause:l,progressBar:O,resume:d,scaling:j&&t,tiffPreviews:qq.safari(),unlimitedScaledImageSize:!qq.ios(),uploading:e,uploadCors:p,uploadCustomHeaders:r,uploadNonMultipart:r,uploadViaPaste:h}}(),qq.isGenericPromise=function(e){"use strict";return!!(e&&e.then&&qq.isFunction(e.then))},qq.Promise=function(){"use strict";var e,t,n=[],r=[],a=[],l=0;qq.extend(this,{then:function(a,d){return 0===l?(a&&n.push(a),d&&r.push(d)):-1===l?d&&d.apply(null,t):a&&a.apply(null,e),this},done:function(n){return 0===l?a.push(n):n.apply(null,void 0===t?e:t),this},success:function(){return l=1,e=arguments,n.length&&qq.each(n,(function(t,n){n.apply(null,e)})),a.length&&qq.each(a,(function(t,n){n.apply(null,e)})),this},failure:function(){return l=-1,t=arguments,r.length&&qq.each(r,(function(e,n){n.apply(null,t)})),a.length&&qq.each(a,(function(e,n){n.apply(null,t)})),this}})},qq.BlobProxy=function(e,t){"use strict";qq.extend(this,{referenceBlob:e,create:function(){return t(e)}})},qq.UploadButton=function(e){"use strict";var t,n,r=this,a=new qq.DisposeSupport,l={acceptFiles:null,element:null,focusClass:"qq-upload-button-focus",folders:!1,hoverClass:"qq-upload-button-hover",ios8BrowserCrashWorkaround:!1,multiple:!1,name:"qqfile",onChange:function(e){},title:null};function d(){var e=document.createElement("input");return e.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,n),e.setAttribute("title",l.title),r.setMultiple(l.multiple,e),l.folders&&qq.supportedFeatures.folderSelection&&e.setAttribute("webkitdirectory",""),l.acceptFiles&&e.setAttribute("accept",l.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",l.name),qq(e).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:qq.ie()&&!qq.ie8()?"3500px":"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),!qq.ie7()&&qq(e).css({height:"100%"}),l.element.appendChild(e),a.attach(e,"change",(function(){l.onChange(e)})),a.attach(e,"mouseover",(function(){qq(l.element).addClass(l.hoverClass)})),a.attach(e,"mouseout",(function(){qq(l.element).removeClass(l.hoverClass)})),a.attach(e,"focus",(function(){qq(l.element).addClass(l.focusClass)})),a.attach(e,"blur",(function(){qq(l.element).removeClass(l.focusClass)})),e}qq.extend(l,e),n=qq.getUniqueId(),qq(l.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),qq.extend(this,{getInput:function(){return t},getButtonId:function(){return n},setMultiple:function(e,t){var n=t||this.getInput();l.ios8BrowserCrashWorkaround&&qq.ios8()&&(qq.iosChrome()||qq.iosSafariWebView())||e?n.setAttribute("multiple",""):n.removeAttribute("multiple")},setAcceptFiles:function(e){e!==l.acceptFiles&&t.setAttribute("accept",e)},reset:function(){t.parentNode&&qq(t).remove(),qq(l.element).removeClass(l.focusClass),t=null,t=d()}}),t=d()},qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id",qq.UploadData=function(e){"use strict";var t=[],n={},r={},a={},l={};qq.extend(this,{addFile:function(d){var h=d.status||qq.status.SUBMITTING,p=t.push({name:d.name,originalName:d.name,uuid:d.uuid,size:null==d.size?-1:d.size,status:h})-1;return d.batchId&&(t[p].batchId=d.batchId,void 0===l[d.batchId]&&(l[d.batchId]=[]),l[d.batchId].push(p)),d.proxyGroupId&&(t[p].proxyGroupId=d.proxyGroupId,void 0===a[d.proxyGroupId]&&(a[d.proxyGroupId]=[]),a[d.proxyGroupId].push(p)),t[p].id=p,n[d.uuid]=p,void 0===r[h]&&(r[h]=[]),r[h].push(p),d.onBeforeStatusChange&&d.onBeforeStatusChange(p),e.onStatusChange(p,null,h),p},retrieve:function(e){return qq.isObject(e)&&t.length?void 0!==e.id?function(e){if(qq.isArray(e)){var n=[];return qq.each(e,(function(e,r){n.push(t[r])})),n}return t[e]}(e.id):void 0!==e.uuid?function(e){if(qq.isArray(e)){var r=[];return qq.each(e,(function(e,a){r.push(t[n[a]])})),r}return t[n[e]]}(e.uuid):e.status?(a=e.status,l=[],d=[].concat(a),qq.each(d,(function(e,n){var a=r[n];void 0!==a&&qq.each(a,(function(e,n){l.push(t[n])}))})),l):void 0:qq.extend([],t,!0);var a,l,d},reset:function(){t=[],n={},r={},l={}},setStatus:function(n,a){var l=t[n].status,d=qq.indexOf(r[l],n);r[l].splice(d,1),t[n].status=a,void 0===r[a]&&(r[a]=[]),r[a].push(n),e.onStatusChange(n,l,a)},uuidChanged:function(e,r){var a=t[e].uuid;t[e].uuid=r,n[r]=e,delete n[a]},updateName:function(e,n){t[e].name=n},updateSize:function(e,n){t[e].size=n},setParentId:function(e,n){t[e].parentId=n},getIdsInProxyGroup:function(e){var n=t[e].proxyGroupId;return n?a[n]:[]},getIdsInBatch:function(e){var n=t[e].batchId;return l[n]}})},qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={addBlobs:function(e,t,n){this.addFiles(e,t,n)},addInitialFiles:function(e){var t=this;qq.each(e,(function(e,n){t._addCannedFile(n)}))},addFiles:function(e,t,n){this._maybeHandleIos8SafariWorkaround();var r=0===this._storedIds.length?qq.getUniqueId():this._currentBatchId,a=qq.bind((function(e){this._handleNewFile({blob:e,name:this._options.blobs.defaultName},r,y)}),this),l=qq.bind((function(e){this._handleNewFile(e,r,y)}),this),d=qq.bind((function(e){var t=qq.canvasToBlob(e);this._handleNewFile({blob:t,name:this._options.blobs.defaultName+".png"},r,y)}),this),h=qq.bind((function(e){var t=e.quality&&e.quality/100,n=qq.canvasToBlob(e.canvas,e.type,t);this._handleNewFile({blob:n,name:e.name},r,y)}),this),p=qq.bind((function(e){if(qq.isInput(e)&&qq.supportedFeatures.ajaxUploading){var t=Array.prototype.slice.call(e.files),n=this;qq.each(t,(function(e,t){n._handleNewFile(t,r,y)}))}else this._handleNewFile(e,r,y)}),this),f=this,y=[];this._currentBatchId=r,e&&(qq.isFileList(e)&&(e=Array.prototype.slice.call(e)),e=[].concat(e),qq.each(e,(function(e,t){qq.isFileOrInput(t)?p(t):qq.isBlob(t)?a(t):qq.isObject(t)?t.blob&&t.name?l(t):t.canvas&&t.name&&h(t):t.tagName&&"canvas"===t.tagName.toLowerCase()?d(t):f.log(t+" is not a valid file container!  Ignoring!","warn")})),this.log("Received "+y.length+" files."),this._prepareItemsForUpload(y,t,n))},cancel:function(e){this._handler.cancel(e)},cancelAll:function(){var e=[],t=this;qq.extend(e,this._storedIds),qq.each(e,(function(e,n){t.cancel(n)})),this._handler.cancelAll()},clearStoredFiles:function(){this._storedIds=[]},continueUpload:function(e){var t=this._uploadData.retrieve({id:e});return!(!qq.supportedFeatures.pause||!this._options.chunking.enabled)&&(t.status===qq.status.PAUSED?(this.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",e,this.getName(e))),this._uploadFile(e),!0):(this.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",e,this.getName(e)),"error"),!1))},deleteFile:function(e){return this._onSubmitDelete(e)},doesExist:function(e){return this._handler.isValid(e)},drawThumbnail:function(e,t,n,r,a){var l,d,h=new qq.Promise;return this._imageGenerator?(l=this._thumbnailUrls[e],d={customResizeFunction:a,maxSize:n>0?n:null,scale:n>0},!r&&qq.supportedFeatures.imagePreviews&&(l=this.getFile(e)),null==l?h.failure({container:t,error:"File or URL not found."}):this._imageGenerator.generate(l,t,d).then((function(e){h.success(e)}),(function(e,t){h.failure({container:e,error:t||"Problem generating thumbnail"})}))):h.failure({container:t,error:"Missing image generator module"}),h},getButton:function(e){return this._getButton(this._buttonIdsForFileIds[e])},getEndpoint:function(e){return this._endpointStore.get(e)},getFile:function(e){return this._handler.getFile(e)||null},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getName:function(e){return this._uploadData.retrieve({id:e}).name},getParentId:function(e){var t=this.getUploads({id:e}),n=null;return t&&void 0!==t.parentId&&(n=t.parentId),n},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(e){return this._uploadData.retrieve({id:e}).size},getNetUploads:function(){return this._netUploaded},getRemainingAllowedItems:function(){var e=this._currentItemLimit;return e>0?e-this._netUploadedOrQueued:null},getUploads:function(e){return this._uploadData.retrieve(e)},getUuid:function(e){return this._uploadData.retrieve({id:e}).uuid},log:function(e,t){!this._options.debug||t&&"info"!==t?t&&"info"!==t&&qq.log("[Fine Uploader "+qq.version+"] "+e,t):qq.log("[Fine Uploader "+qq.version+"] "+e)},pauseUpload:function(e){var t=this._uploadData.retrieve({id:e});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],t.status)>=0){if(this._handler.pause(e))return this._uploadData.setStatus(e,qq.status.PAUSED),!0;this.log(qq.format("Unable to pause file ID {} ({}).",e,this.getName(e)),"error")}else this.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",e,this.getName(e)),"error");return!1},removeFileRef:function(e){this._handler.expunge(e)},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],qq.each(this._buttons,(function(e,t){t.reset()})),this._paramsStore.reset(),this._endpointStore.reset(),this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData.reset(),this._buttonIdsForFileIds=[],this._pasteHandler&&this._pasteHandler.reset(),this._options.session.refreshOnReset&&this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._totalProgress&&this._totalProgress.reset()},retry:function(e){return this._manualRetry(e)},scaleImage:function(e,t){return qq.Scaler.prototype.scaleImage(e,t,{log:qq.bind(this.log,this),getFile:qq.bind(this.getFile,this),uploadData:this._uploadData})},setCustomHeaders:function(e,t){this._customHeadersStore.set(e,t)},setDeleteFileCustomHeaders:function(e,t){this._deleteFileCustomHeadersStore.set(e,t)},setDeleteFileEndpoint:function(e,t){this._deleteFileEndpointStore.set(e,t)},setDeleteFileParams:function(e,t){this._deleteFileParamsStore.set(e,t)},setEndpoint:function(e,t){this._endpointStore.set(e,t)},setForm:function(e){this._updateFormSupportAndParams(e)},setItemLimit:function(e){this._currentItemLimit=e},setName:function(e,t){this._uploadData.updateName(e,t)},setParams:function(e,t){this._paramsStore.set(e,t)},setUuid:function(e,t){return this._uploadData.uuidChanged(e,t)},setStatus:function(e,t){if(!this.getUploads({id:e}))throw new qq.Error(e+" is not a valid file ID.");switch(t){case qq.status.DELETED:this._onDeleteComplete(e,null,!1);break;case qq.status.DELETE_FAILED:this._onDeleteComplete(e,null,!0);break;default:var n="Method setStatus called on '"+name+"' not implemented yet for "+t;throw this.log(n),new qq.Error(n)}},uploadStoredFiles:function(){0===this._storedIds.length?this._itemError("noFilesError"):this._uploadStoredFiles()}},qq.basePrivateApi={_addCannedFile:function(e){var t=this;return this._uploadData.addFile({uuid:e.uuid,name:e.name,size:e.size,status:qq.status.UPLOAD_SUCCESSFUL,onBeforeStatusChange:function(n){e.deleteFileEndpoint&&t.setDeleteFileEndpoint(e.deleteFileEndpoint,n),e.deleteFileParams&&t.setDeleteFileParams(e.deleteFileParams,n),e.thumbnailUrl&&(t._thumbnailUrls[n]=e.thumbnailUrl),t._netUploaded++,t._netUploadedOrQueued++}})},_annotateWithButtonId:function(e,t){qq.isFile(e)&&(e.qqButtonId=this._getButtonId(t))},_batchError:function(e){this._options.callbacks.onError(null,null,e,void 0)},_createDeleteHandler:function(){var e=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._deleteFileCustomHeadersStore,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,cors:this._options.cors,log:qq.bind(e.log,e),onDelete:function(t){e._onDelete(t),e._options.callbacks.onDelete(t)},onDeleteComplete:function(t,n,r){e._onDeleteComplete(t,n,r),e._options.callbacks.onDeleteComplete(t,n,r)}})},_createPasteHandler:function(){var e=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(e.log,e),pasteReceived:function(t){e._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(e._options.callbacks.onPasteReceived,e,t),onSuccess:qq.bind(e._handlePasteSuccess,e,t),identifier:"pasted image"})}}})},_createStore:function(e,t){var n={},r=e,a={},l=t,d=function(e){return qq.isObject(e)?qq.extend({},e):e},h=function(e,t){l&&qq.isObject(t)&&qq.extend(t,qq.isFunction(l)?l():l),a[e]&&qq.extend(t,a[e])};return{set:function(e,t){null==t?(n={},r=d(e)):n[t]=d(e)},get:function(e){var t;return t=null!=e&&n[e]?n[e]:d(r),h(e,t),d(t)},addReadOnly:function(e,t){qq.isObject(n)&&(null===e?qq.isFunction(t)?l=t:(l=l||{},qq.extend(l,t)):(a[e]=a[e]||{},qq.extend(a[e],t)))},remove:function(e){return delete n[e]},reset:function(){n={},a={},r=e}}},_createUploadDataTracker:function(){var e=this;return new qq.UploadData({getName:function(t){return e.getName(t)},getUuid:function(t){return e.getUuid(t)},getSize:function(t){return e.getSize(t)},onStatusChange:function(t,n,r){e._onUploadStatusChange(t,n,r),e._options.callbacks.onStatusChange(t,n,r),e._maybeAllComplete(t,r),e._totalProgress&&setTimeout((function(){e._totalProgress.onStatusChange(t,n,r)}),0)}})},_createUploadButton:function(e){var t,n=this,r=e.accept||this._options.validation.acceptFiles,a=e.allowedExtensions||this._options.validation.allowedExtensions;return t=new qq.UploadButton({acceptFiles:r,element:e.element,focusClass:this._options.classes.buttonFocus,folders:e.folders,hoverClass:this._options.classes.buttonHover,ios8BrowserCrashWorkaround:this._options.workarounds.ios8BrowserCrash,multiple:!!qq.supportedFeatures.ajaxUploading&&!(n._options.workarounds.iosEmptyVideos&&qq.ios()&&!qq.ios6()&&n._isAllowedExtension(a,".mov"))&&(void 0===e.multiple?n._options.multiple:e.multiple),name:this._options.request.inputName,onChange:function(e){n._onInputChange(e)},title:null==e.title?this._options.text.fileInputTitle:e.title}),this._disposeSupport.addDisposer((function(){t.dispose()})),n._buttons.push(t),t},_createUploadHandler:function(e,t){var n=this,r={},a={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(n.log,n),preventRetryParam:this._options.retry.preventRetryResponseProperty,onProgress:function(e,t,a,l){a<0||l<0||(r[e]&&r[e].loaded===a&&r[e].total===l||(n._onProgress(e,t,a,l),n._options.callbacks.onProgress(e,t,a,l)),r[e]={loaded:a,total:l})},onComplete:function(e,t,a,l){delete r[e];var d,h=n.getUploads({id:e}).status;h!==qq.status.UPLOAD_SUCCESSFUL&&h!==qq.status.UPLOAD_FAILED&&((d=n._onComplete(e,t,a,l))instanceof qq.Promise?d.done((function(){n._options.callbacks.onComplete(e,t,a,l)})):n._options.callbacks.onComplete(e,t,a,l))},onCancel:function(e,t,r){var a=new qq.Promise;return n._handleCheckedCallback({name:"onCancel",callback:qq.bind(n._options.callbacks.onCancel,n,e,t),onFailure:a.failure,onSuccess:function(){r.then((function(){n._onCancel(e,t)})),a.success()},identifier:e}),a},onUploadPrep:qq.bind(this._onUploadPrep,this),onUpload:function(e,t){n._onUpload(e,t),n._options.callbacks.onUpload(e,t)},onUploadChunk:function(e,t,r){n._onUploadChunk(e,r),n._options.callbacks.onUploadChunk(e,t,r)},onUploadChunkSuccess:function(e,t,r,a){n._options.callbacks.onUploadChunkSuccess.apply(n,arguments)},onResume:function(e,t,r){return n._options.callbacks.onResume(e,t,r)},onAutoRetry:function(e,t,r,a){return n._onAutoRetry.apply(n,arguments)},onUuidChanged:function(e,t){n.log("Server requested UUID change from '"+n.getUuid(e)+"' to '"+t+"'"),n.setUuid(e,t)},getName:qq.bind(n.getName,n),getUuid:qq.bind(n.getUuid,n),getSize:qq.bind(n.getSize,n),setSize:qq.bind(n._setSize,n),getDataByUuid:function(e){return n.getUploads({uuid:e})},isQueued:function(e){var t=n.getUploads({id:e}).status;return t===qq.status.QUEUED||t===qq.status.SUBMITTED||t===qq.status.UPLOAD_RETRYING||t===qq.status.PAUSED},getIdsInProxyGroup:n._uploadData.getIdsInProxyGroup,getIdsInBatch:n._uploadData.getIdsInBatch};return qq.each(this._options.request,(function(e,t){a[e]=t})),a.customHeaders=this._customHeadersStore,e&&qq.each(e,(function(e,t){a[e]=t})),new qq.UploadHandlerController(a,t)},_fileOrBlobRejected:function(e){this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.REJECTED)},_formatSize:function(e){if(0===e)return e+this._options.text.sizeSymbols[0];var t=-1;do{e/=1e3,t++}while(e>999);return Math.max(e,.1).toFixed(1)+this._options.text.sizeSymbols[t]},_generateExtraButtonSpecs:function(){var e=this;this._extraButtonSpecs={},qq.each(this._options.extraButtons,(function(t,n){var r=n.multiple,a=qq.extend({},e._options.validation,!0),l=qq.extend({},n);void 0===r&&(r=e._options.multiple),l.validation&&qq.extend(a,n.validation,!0),qq.extend(l,{multiple:r,validation:a},!0),e._initExtraButton(l)}))},_getButton:function(e){var t=this._extraButtonSpecs[e];return t?t.element:e===this._defaultButtonId?this._options.button:void 0},_getButtonId:function(e){var t,n,r=e;if(r instanceof qq.BlobProxy&&(r=r.referenceBlob),r&&!qq.isBlob(r)){if(qq.isFile(r))return r.qqButtonId;if("input"===r.tagName.toLowerCase()&&"file"===r.type.toLowerCase())return r.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(t=r.getElementsByTagName("input"),qq.each(t,(function(e,t){if("file"===t.getAttribute("type"))return n=t,!1})),n)return n.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_getNotFinished:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED,qq.status.SUBMITTING,qq.status.SUBMITTED,qq.status.PAUSED]}).length},_getValidationBase:function(e){var t=this._extraButtonSpecs[e];return t?t.validation:this._options.validation},_getValidationDescriptor:function(e){return e.file instanceof qq.BlobProxy?{name:qq.getFilename(e.file.referenceBlob),size:e.file.referenceBlob.size}:{name:this.getUploads({id:e.id}).name,size:this.getUploads({id:e.id}).size}},_getValidationDescriptors:function(e){var t=this,n=[];return qq.each(e,(function(e,r){n.push(t._getValidationDescriptor(r))})),n},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){var e=this._options.camera.button,t=e?this._getButtonId(e):this._defaultButtonId,n=this._options;t&&t!==this._defaultButtonId&&(n=this._extraButtonSpecs[t]),n.multiple=!1,null===n.validation.acceptFiles?n.validation.acceptFiles="image/*;capture=camera":n.validation.acceptFiles+=",image/*;capture=camera",qq.each(this._buttons,(function(e,r){if(r.getButtonId()===t)return r.setMultiple(n.multiple),r.setAcceptFiles(n.acceptFiles),!1}))}},_handleCheckedCallback:function(e){var t=this,n=e.callback();return qq.isGenericPromise(n)?(this.log(e.name+" - waiting for "+e.name+" promise to be fulfilled for "+e.identifier),n.then((function(n){t.log(e.name+" promise success for "+e.identifier),e.onSuccess(n)}),(function(){e.onFailure?(t.log(e.name+" promise failure for "+e.identifier),e.onFailure()):t.log(e.name+" promise failure for "+e.identifier)}))):(!1!==n?e.onSuccess(n):e.onFailure?(this.log(e.name+" - return value was 'false' for "+e.identifier+".  Invoking failure callback."),e.onFailure()):this.log(e.name+" - return value was 'false' for "+e.identifier+".  Will not proceed."),n)},_handleNewFile:function(e,t,n){var r=this,a=qq.getUniqueId(),l=-1,d=qq.getFilename(e),h=e.blob||e,p=this._customNewFileHandler?this._customNewFileHandler:qq.bind(r._handleNewFileGeneric,r);!qq.isInput(h)&&h.size>=0&&(l=h.size),p(h,d,a,l,n,t,this._options.request.uuidName,{uploadData:r._uploadData,paramsStore:r._paramsStore,addFileToHandler:function(e,t){r._handler.add(e,t),r._netUploadedOrQueued++,r._trackButton(e)}})},_handleNewFileGeneric:function(e,t,n,r,a,l){var d=this._uploadData.addFile({uuid:n,name:t,size:r,batchId:l});this._handler.add(d,e),this._trackButton(d),this._netUploadedOrQueued++,a.push({id:d,file:e})},_handlePasteSuccess:function(e,t){var n=e.type.split("/")[1],r=t;null==r&&(r=this._options.paste.defaultName),r+="."+n,this.addFiles({name:r,blob:e})},_handleDeleteSuccess:function(e){if(this.getUploads({id:e}).status!==qq.status.DELETED){var t=this.getName(e);this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(e),this._uploadData.setStatus(e,qq.status.DELETED),this.log("Delete request for '"+t+"' has succeeded.")}},_handleDeleteFailed:function(e,t){var n=this.getName(e);this._uploadData.setStatus(e,qq.status.DELETE_FAILED),this.log("Delete request for '"+n+"' has failed.","error"),t&&void 0!==t.withCredentials?this._options.callbacks.onError(e,n,"Delete request failed with response code "+t.status,t):this._options.callbacks.onError(e,n,"Delete request failed",t)},_initExtraButton:function(e){var t=this._createUploadButton({accept:e.validation.acceptFiles,allowedExtensions:e.validation.allowedExtensions,element:e.element,folders:e.folders,multiple:e.multiple,title:e.fileInputTitle});this._extraButtonSpecs[t.getButtonId()]=e},_initFormSupportAndParams:function(){this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm?(this._paramsStore=this._createStore(this._options.request.params,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&(this._options.request.endpoint=this._formSupport.newEndpoint)):this._paramsStore=this._createStore(this._options.request.params)},_isDeletePossible:function(){return!(!qq.DeleteFileAjaxRequester||!this._options.deleteFile.enabled)&&(!this._options.cors.expected||(!!qq.supportedFeatures.deleteFileCorsXhr||!(!qq.supportedFeatures.deleteFileCorsXdr||!this._options.cors.allowXdr)))},_isAllowedExtension:function(e,t){var n=!1;return!e.length||(qq.each(e,(function(e,r){if(qq.isString(r)){var a=new RegExp("\\."+r+"$","i");if(null!=t.match(a))return n=!0,!1}})),n)},_itemError:function(e,t,n){var r,a,l=this._options.messages[e],d=[],h=[].concat(t),p=h[0],f=this._getButtonId(n),y=this._getValidationBase(f);function w(e,t){l=l.replace(e,t)}return qq.each(y.allowedExtensions,(function(e,t){qq.isString(t)&&d.push(t)})),r=d.join(", ").toLowerCase(),w("{file}",this._options.formatFileName(p)),w("{extensions}",r),w("{sizeLimit}",this._formatSize(y.sizeLimit)),w("{minSizeLimit}",this._formatSize(y.minSizeLimit)),null!==(a=l.match(/(\{\w+\})/g))&&qq.each(a,(function(e,t){w(t,h[e])})),this._options.callbacks.onError(null,p,l,void 0),l},_manualRetry:function(e,t){if(this._onBeforeManualRetry(e))return this._netUploadedOrQueued++,this._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),t?t(e):this._handler.retry(e),!0},_maybeAllComplete:function(e,t){var n=this,r=this._getNotFinished();t===qq.status.UPLOAD_SUCCESSFUL?this._succeededSinceLastAllComplete.push(e):t===qq.status.UPLOAD_FAILED&&this._failedSinceLastAllComplete.push(e),0===r&&(this._succeededSinceLastAllComplete.length||this._failedSinceLastAllComplete.length)&&setTimeout((function(){n._onAllComplete(n._succeededSinceLastAllComplete,n._failedSinceLastAllComplete)}),0)},_maybeHandleIos8SafariWorkaround:function(){var e=this;if(this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari())throw setTimeout((function(){window.alert(e._options.messages.unsupportedBrowserIos8Safari)}),0),new qq.Error(this._options.messages.unsupportedBrowserIos8Safari)},_maybeParseAndSendUploadError:function(e,t,n,r){if(!n.success)if(r&&200!==r.status&&!n.error)this._options.callbacks.onError(e,t,"XHR returned response code "+r.status,r);else{var a=n.error?n.error:this._options.text.defaultResponseError;this._options.callbacks.onError(e,t,a,r)}},_maybeProcessNextItemAfterOnValidateCallback:function(e,t,n,r,a){var l=this;if(t.length>n)if(e||!this._options.validation.stopOnFirstInvalidFile)setTimeout((function(){var e=l._getValidationDescriptor(t[n]),d=l._getButtonId(t[n].file),h=l._getButton(d);l._handleCheckedCallback({name:"onValidate",callback:qq.bind(l._options.callbacks.onValidate,l,e,h),onSuccess:qq.bind(l._onValidateCallbackSuccess,l,t,n,r,a),onFailure:qq.bind(l._onValidateCallbackFailure,l,t,n,r,a),identifier:"Item '"+e.name+"', size: "+e.size})}),0);else if(!e)for(;n<t.length;n++)l._fileOrBlobRejected(t[n].id)},_onAllComplete:function(e,t){this._totalProgress&&this._totalProgress.onAllComplete(e,t,this._preventRetries),this._options.callbacks.onAllComplete(qq.extend([],e),qq.extend([],t)),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[]},_onAutoRetry:function(e,t,n,r,a){var l=this;if(l._preventRetries[e]=n[l._options.retry.preventRetryResponseProperty],l._shouldAutoRetry(e,t,n)){var d=1e3*l._options.retry.autoAttemptDelay;return l._maybeParseAndSendUploadError.apply(l,arguments),l._options.callbacks.onAutoRetry(e,t,l._autoRetries[e]),l._onBeforeAutoRetry(e,t),l._uploadData.setStatus(e,qq.status.UPLOAD_RETRYING),l._retryTimeouts[e]=setTimeout((function(){l.log("Starting retry for "+t+"..."),a?a(e):l._handler.retry(e)}),d),!0}},_onBeforeAutoRetry:function(e,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onBeforeManualRetry:function(e){var t,n=this._currentItemLimit;return this._preventRetries[e]?(this.log("Retries are forbidden for id "+e,"warn"),!1):this._handler.isValid(e)?(t=this.getName(e),!1!==this._options.callbacks.onManualRetry(e,t)&&(n>0&&this._netUploadedOrQueued+1>n?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+t+"' (id: "+e+")..."),!0))):(this.log("'"+e+"' is not a valid file ID","error"),!1)},_onCancel:function(e,t){this._netUploadedOrQueued--,clearTimeout(this._retryTimeouts[e]);var n=qq.indexOf(this._storedIds,e);!this._options.autoUpload&&n>=0&&this._storedIds.splice(n,1),this._uploadData.setStatus(e,qq.status.CANCELED)},_onComplete:function(e,t,n,r){return n.success?(n.thumbnailUrl&&(this._thumbnailUrls[e]=n.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(e,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(e,qq.status.UPLOAD_FAILED),!0===n[this._options.retry.preventRetryResponseProperty]&&(this._preventRetries[e]=!0)),this._maybeParseAndSendUploadError(e,t,n,r),!!n.success},_onDelete:function(e){this._uploadData.setStatus(e,qq.status.DELETING)},_onDeleteComplete:function(e,t,n){this.getName(e);n?this._handleDeleteFailed(e,t):this._handleDeleteSuccess(e)},_onInputChange:function(e){var t;if(qq.supportedFeatures.ajaxUploading){for(t=0;t<e.files.length;t++)this._annotateWithButtonId(e.files[t],e);this.addFiles(e.files)}else e.value.length>0&&this.addFiles(e);qq.each(this._buttons,(function(e,t){t.reset()}))},_onProgress:function(e,t,n,r){this._totalProgress&&this._totalProgress.onIndividualProgress(e,n,r)},_onSubmit:function(e,t){},_onSubmitCallbackSuccess:function(e,t){this._onSubmit.apply(this,arguments),this._uploadData.setStatus(e,qq.status.SUBMITTED),this._onSubmitted.apply(this,arguments),this._options.autoUpload?(this._options.callbacks.onSubmitted.apply(this,arguments),this._uploadFile(e)):(this._storeForLater(e),this._options.callbacks.onSubmitted.apply(this,arguments))},_onSubmitDelete:function(e,t,n){var r,a=this.getUuid(e);return t&&(r=qq.bind(t,this,e,a,n)),this._isDeletePossible()?(this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,e),onSuccess:r||qq.bind(this._deleteHandler.sendDelete,this,e,a,n),identifier:e}),!0):(this.log("Delete request ignored for ID "+e+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onSubmitted:function(e){},_onTotalProgress:function(e,t){this._options.callbacks.onTotalProgress(e,t)},_onUploadPrep:function(e){},_onUpload:function(e,t){this._uploadData.setStatus(e,qq.status.UPLOADING)},_onUploadChunk:function(e,t){},_onUploadStatusChange:function(e,t,n){n===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[e])},_onValidateBatchCallbackFailure:function(e){var t=this;qq.each(e,(function(e,n){t._fileOrBlobRejected(n.id)}))},_onValidateBatchCallbackSuccess:function(e,t,n,r,a){var l,d=this._currentItemLimit,h=this._netUploadedOrQueued;0===d||h<=d?t.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,e[0],a),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,t,0,n,r),onFailure:qq.bind(this._onValidateCallbackFailure,this,t,0,n,r),identifier:"Item '"+t[0].file.name+"', size: "+t[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(t),l=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,h).replace(/\{itemLimit\}/g,d),this._batchError(l))},_onValidateCallbackFailure:function(e,t,n,r){var a=t+1;this._fileOrBlobRejected(e[t].id,e[t].file.name),this._maybeProcessNextItemAfterOnValidateCallback(!1,e,a,n,r)},_onValidateCallbackSuccess:function(e,t,n,r){var a=this,l=t+1,d=this._getValidationDescriptor(e[t]);this._validateFileOrBlobData(e[t],d).then((function(){a._upload(e[t].id,n,r),a._maybeProcessNextItemAfterOnValidateCallback(!0,e,l,n,r)}),(function(){a._maybeProcessNextItemAfterOnValidateCallback(!1,e,l,n,r)}))},_prepareItemsForUpload:function(e,t,n){if(0!==e.length){var r=this._getValidationDescriptors(e),a=this._getButtonId(e[0].file),l=this._getButton(a);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,r,l),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,r,e,t,n,l),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,e),identifier:"batch validation"})}else this._itemError("noFilesError")},_preventLeaveInProgress:function(){var e=this;this._disposeSupport.attach(window,"beforeunload",(function(t){if(e.getInProgress())return(t=t||window.event).returnValue=e._options.messages.onLeave,e._options.messages.onLeave}))},_refreshSessionData:function(){var e=this,t=this._options.session;qq.Session&&null!=this._options.session.endpoint&&(this._session||(qq.extend(t,{cors:this._options.cors}),t.log=qq.bind(this.log,this),t.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(t)),setTimeout((function(){e._session.refresh().then((function(t,n){e._sessionRequestComplete(),e._options.callbacks.onSessionRequestComplete(t,!0,n)}),(function(t,n){e._options.callbacks.onSessionRequestComplete(t,!1,n)}))}),0))},_sessionRequestComplete:function(){},_setSize:function(e,t){this._uploadData.updateSize(e,t),this._totalProgress&&this._totalProgress.onNewSize(e)},_shouldAutoRetry:function(e,t,n){var r=this._uploadData.retrieve({id:e});return!!(!this._preventRetries[e]&&this._options.retry.enableAuto&&r.status!==qq.status.PAUSED&&(void 0===this._autoRetries[e]&&(this._autoRetries[e]=0),this._autoRetries[e]<this._options.retry.maxAutoAttempts))&&(this._autoRetries[e]+=1,!0)},_storeForLater:function(e){this._storedIds.push(e)},_trackButton:function(e){var t;(t=qq.supportedFeatures.ajaxUploading?this._handler.getFile(e).qqButtonId:this._getButtonId(this._handler.getInput(e)))&&(this._buttonIdsForFileIds[e]=t)},_updateFormSupportAndParams:function(e){this._options.form.element=e,this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm&&(this._paramsStore.addReadOnly(null,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&this.setEndpoint(this._formSupport.newEndpoint))},_upload:function(e,t,n){var r=this.getName(e);t&&this.setParams(t,e),n&&this.setEndpoint(n,e),this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,e,r),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,e,r),onFailure:qq.bind(this._fileOrBlobRejected,this,e,r),identifier:e})},_uploadFile:function(e){this._handler.upload(e)||this._uploadData.setStatus(e,qq.status.QUEUED)},_uploadStoredFiles:function(){for(var e,t,n=this;this._storedIds.length;)e=this._storedIds.shift(),this._uploadFile(e);(t=this.getUploads({status:qq.status.SUBMITTING}).length)&&(qq.log("Still waiting for "+t+" files to clear submit queue. Will re-parse stored IDs array shortly."),setTimeout((function(){n._uploadStoredFiles()}),1e3))},_validateFileOrBlobData:function(e,t){var n=this,r=e.file instanceof qq.BlobProxy?e.file.referenceBlob:e.file,a=t.name,l=t.size,d=this._getButtonId(e.file),h=this._getValidationBase(d),p=new qq.Promise;return p.then((function(){}),(function(){n._fileOrBlobRejected(e.id,a)})),qq.isFileOrInput(r)&&!this._isAllowedExtension(h.allowedExtensions,a)?(this._itemError("typeError",a,r),p.failure()):this._options.validation.allowEmpty||0!==l?l>0&&h.sizeLimit&&l>h.sizeLimit?(this._itemError("sizeError",a,r),p.failure()):l>0&&l<h.minSizeLimit?(this._itemError("minSizeError",a,r),p.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(r)?new qq.ImageValidation(r,qq.bind(n.log,n)).validate(h.image).then(p.success,(function(e){n._itemError(e+"ImageError",a,r),p.failure()})):p.success(),p):(this._itemError("emptyError",a,r),p.failure())},_wrapCallbacks:function(){var e,t,n;for(n in e=this,t=function(t,n,r){var a;try{return n.apply(e,r)}catch(n){a=n.message||n.toString(),e.log("Caught exception in '"+t+"' callback - "+a,"error")}},this._options.callbacks)!function(){var r,a;r=n,a=e._options.callbacks[r],e._options.callbacks[r]=function(){return t(r,a,arguments)}}()}}}(),function(){"use strict";qq.FineUploaderBasic=function(e){var t=this;this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{customHeaders:{},endpoint:"/server/upload",filenameParam:"qqfilename",forceMultipart:!0,inputName:"qqfile",method:"POST",params:{},paramsInBody:!0,totalFileSizeName:"qqtotalfilesize",uuidName:"qquuid"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0},allowEmpty:!1},callbacks:{onSubmit:function(e,t){},onSubmitted:function(e,t){},onComplete:function(e,t,n,r){},onAllComplete:function(e,t){},onCancel:function(e,t){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,r){},onResume:function(e,t,n){},onProgress:function(e,t,n,r){},onTotalProgress:function(e,t){},onError:function(e,t,n,r){},onAutoRetry:function(e,t,n){},onManualRetry:function(e,t){},onValidateBatch:function(e){},onValidate:function(e){},onSubmitDelete:function(e){},onDelete:function(e){},onDeleteComplete:function(e,t,n){},onPasteReceived:function(e){},onStatusChange:function(e,t,n){},onSessionRequestComplete:function(e,t,n){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled.",unsupportedBrowserIos8Safari:"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,concurrent:{enabled:!1},mandatory:!1,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"},partSize:2e6,success:{endpoint:null}},resume:{enabled:!1,recordsExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(e){return e},text:{defaultResponseError:"Upload failure reason unknown",fileInputTitle:"file input",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0},form:{element:"qq-form",autoUpload:!1,interceptSubmit:!0},scaling:{customResizer:null,sendOriginal:!0,orient:!0,defaultType:null,defaultQuality:80,failureText:"Failed to scale",includeExif:!1,sizes:[]},workarounds:{iosEmptyVideos:!0,ios8SafariUploads:!0,ios8BrowserCrash:!1}},qq.extend(this._options,e,!0),this._buttons=[],this._extraButtonSpecs={},this._buttonIdsForFileIds=[],this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData=this._createUploadDataTracker(),this._initFormSupportAndParams(),this._customHeadersStore=this._createStore(this._options.request.customHeaders),this._deleteFileCustomHeadersStore=this._createStore(this._options.deleteFile.customHeaders),this._deleteFileParamsStore=this._createStore(this._options.deleteFile.params),this._endpointStore=this._createStore(this._options.request.endpoint),this._deleteFileEndpointStore=this._createStore(this._options.deleteFile.endpoint),this._handler=this._createUploadHandler(),this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler(),this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button,title:this._options.text.fileInputTitle}).getButtonId()),this._generateExtraButtonSpecs(),this._handleCameraAccess(),this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():this.log("Paste support module not found","error")),this._preventLeaveInProgress(),this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this)),this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._scaler=qq.Scaler&&new qq.Scaler(this._options.scaling,qq.bind(this.log,this))||{},this._scaler.enabled&&(this._customNewFileHandler=qq.bind(this._scaler.handleNewFile,this._scaler)),qq.TotalProgress&&qq.supportedFeatures.progressBar&&(this._totalProgress=new qq.TotalProgress(qq.bind(this._onTotalProgress,this),(function(e){var n=t._uploadData.retrieve({id:e});return n&&n.size||0}))),this._currentItemLimit=this._options.validation.itemLimit},qq.FineUploaderBasic.prototype=qq.basePublicApi,qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}(),qq.AjaxRequester=function(e){"use strict";var t,n,r=[],a={},l={acceptHeader:null,validMethods:["PATCH","POST","PUT"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],PATCH:[200,201,202,203,204],POST:[200,201,202,203,204],PUT:[200,201,202,203,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onSend:function(e){},onComplete:function(e,t,n){},onProgress:null};if(qq.extend(l,e),t=l.log,qq.indexOf(l.validMethods,l.method)<0)throw new Error("'"+l.method+"' is not a supported method for this type of request!");function d(e){return l.cors.expected&&void 0===e.withCredentials}function h(e,t){var n=a[e].xhr;return n||(n=t||(l.cors.expected?function(){var e;return(window.XMLHttpRequest||window.ActiveXObject)&&void 0===(e=qq.createXhrInstance()).withCredentials&&((e=new XDomainRequest).onload=function(){},e.onerror=function(){},e.ontimeout=function(){},e.onprogress=function(){}),e}():qq.createXhrInstance()),a[e].xhr=n),n}function p(e){var t=qq.indexOf(r,e),n=l.maxConnections;delete a[e],r.splice(t,1),r.length>=n&&t<n&&y(r[n-1])}function f(e,n){var r,a=h(e),f=l.method,y=!0===n;p(e),y?t(f+" request for "+e+" has failed","error"):d(a)||(r=a.status,qq.indexOf(l.successfulResponseCodes[l.method],r)>=0)||(y=!0,t(f+" request for "+e+" has failed - response code "+a.status,"error")),l.onComplete(e,a,y)}function y(e,r){var p,y=h(e,r),w=l.method,x=function(e){var t,n=a[e].additionalParams,r=l.mandatedParams;return l.paramsStore.get&&(t=l.paramsStore.get(e)),n&&qq.each(n,(function(e,n){(t=t||{})[e]=n})),r&&qq.each(r,(function(e,n){(t=t||{})[e]=n})),t}(e),j=a[e].payload;return l.onSend(e),p=function(e,t,r){var d=l.endpointStore.get(e),h=a[e].addToPath;null!=h&&(d+="/"+h);n&&t&&(d=qq.obj2url(t,d));r&&(d=qq.obj2url(r,d));return d}(e,x,a[e].additionalQueryParams),d(y)?(y.onload=function(e){return function(){f(e)}}(e),y.onerror=function(e){return function(){f(e,!0)}}(e)):y.onreadystatechange=function(e){return function(){4===h(e).readyState&&f(e)}}(e),function(e){var t=l.onProgress;t&&(h(e).upload.onprogress=function(n){n.lengthComputable&&t(e,n.loaded,n.total)})}(e),y.open(w,p,!0),l.cors.expected&&l.cors.sendCredentials&&!d(y)&&(y.withCredentials=!0),function(e){var t=h(e),n=l.customHeaders,r=a[e].additionalHeaders||{},p=l.method,f={};d(t)||(l.acceptHeader&&t.setRequestHeader("Accept",l.acceptHeader),l.allowXRequestedWithAndCacheControl&&(l.cors.expected&&qq.indexOf(["GET","POST","HEAD"],l.method)>=0&&(y=!1,qq.each(y,(function(e,t){if(qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],t)<0)return y=!0,!1})),!y)||(t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Cache-Control","no-cache"))),!l.contentType||"POST"!==p&&"PUT"!==p||t.setRequestHeader("Content-Type",l.contentType),qq.extend(f,qq.isFunction(n)?n(e):n),qq.extend(f,r),qq.each(f,(function(e,n){t.setRequestHeader(e,n)})));var y}(e),t("Sending "+w+" request for "+e),j?y.send(j):n||!x?y.send():x&&l.contentType&&l.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?y.send(qq.obj2url(x,"")):x&&l.contentType&&l.contentType.toLowerCase().indexOf("application/json")>=0?y.send(JSON.stringify(x)):y.send(x),y}n="GET"===l.method||"DELETE"===l.method,qq.extend(this,{initTransport:function(e){var t,n,d,h,p,f;return{withPath:function(e){return t=e,this},withParams:function(e){return n=e,this},withQueryParams:function(e){return f=e,this},withHeaders:function(e){return d=e,this},withPayload:function(e){return h=e,this},withCacheBuster:function(){return p=!0,this},send:function(w){return p&&qq.indexOf(["GET","DELETE"],l.method)>=0&&(n.qqtimestamp=(new Date).getTime()),function(e,t,n,d,h,p,f){if(a[e]={addToPath:n,additionalParams:d,additionalQueryParams:h,additionalHeaders:p,payload:f},r.push(e)<=l.maxConnections)return y(e,t)}(e,w,t,n,f,d,h)}}},canceled:function(e){p(e)}})},qq.UploadHandler=function(e){"use strict";var t=e.proxy,n={},r=t.onCancel,a=t.getName;qq.extend(this,{add:function(e,t){n[e]=t,n[e].temp={}},cancel:function(e){var t=this,l=new qq.Promise;r(e,a(e),l).then((function(){t.isValid(e)&&(n[e].canceled=!0,t.expunge(e)),l.success()}))},expunge:function(e){delete n[e]},getThirdPartyFileId:function(e){return n[e].key},isValid:function(e){return void 0!==n[e]},reset:function(){n={}},_getFileState:function(e){return n[e]},_setThirdPartyFileId:function(e,t){n[e].key=t},_wasCanceled:function(e){return!!n[e].canceled}})},qq.UploadHandlerController=function(e,t){"use strict";var n,r,a,l,d=this,h=!1,p=!1,f={paramsStore:{},maxConnections:3,chunking:{enabled:!1,multiple:{enabled:!1}},log:function(e,t){},onProgress:function(e,t,n,r){},onComplete:function(e,t,n,r){},onCancel:function(e,t){},onUploadPrep:function(e){},onUpload:function(e,t){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,r){},onAutoRetry:function(e,t,n,r){},onResume:function(e,t,n){},onUuidChanged:function(e,t){},getName:function(e){},setSize:function(e,t){},isQueued:function(e){},getIdsInProxyGroup:function(e){},getIdsInBatch:function(e){}},y={done:function(e,t,n,r){var l=a._getChunkData(e,t);a._getFileState(e).attemptingResume=!1,delete a._getFileState(e).temp.chunkProgress[t],a._getFileState(e).loaded+=l.size,f.onUploadChunkSuccess(e,a._getChunkDataForCallback(l),n,r)},finalize:function(e){var t=f.getSize(e),n=f.getName(e);r("All chunks have been uploaded for "+e+" - finalizing...."),a.finalizeChunks(e).then((function(l,d){r("Finalize successful for "+e);var h=j.normalizeResponse(l,!0);f.onProgress(e,n,t,t),a._maybeDeletePersistedChunkData(e),j.cleanup(e,h,d)}),(function(t,a){var l=j.normalizeResponse(t,!1);r("Problem finalizing chunks for file ID "+e+" - "+l.error,"error"),l.reset&&y.reset(e),f.onAutoRetry(e,n,l,a)||j.cleanup(e,l,a)}))},handleFailure:function(e,t,n,l){var d=f.getName(t);r("Chunked upload request failed for "+t+", chunk "+e),a.clearCachedChunk(t,e);var h,x=j.normalizeResponse(n,!1);x.reset?y.reset(t):(h=qq.indexOf(a._getFileState(t).chunking.inProgress,e))>=0&&(a._getFileState(t).chunking.inProgress.splice(h,1),a._getFileState(t).chunking.remaining.unshift(e)),a._getFileState(t).temp.ignoreFailure||(p&&(a._getFileState(t).temp.ignoreFailure=!0,r(qq.format("Going to attempt to abort these chunks: {}. These are currently in-progress: {}.",JSON.stringify(Object.keys(a._getXhrs(t))),JSON.stringify(a._getFileState(t).chunking.inProgress))),qq.each(a._getXhrs(t),(function(e,n){r(qq.format("Attempting to abort file {}.{}. XHR readyState {}. ",t,e,n.readyState)),n.abort(),n._cancelled=!0})),a.moveInProgressToRemaining(t),w.free(t,!0)),f.onAutoRetry(t,d,x,l)||j.cleanup(t,x,l))},hasMoreParts:function(e){return!!a._getFileState(e).chunking.remaining.length},nextPart:function(e){var t=a._getFileState(e).chunking.remaining.shift();return t>=a._getTotalChunks(e)&&(t=null),t},reset:function(e){r("Server or callback has ordered chunking effort to be restarted on next attempt for item ID "+e,"error"),a._maybeDeletePersistedChunkData(e),a.reevaluateChunking(e),a._getFileState(e).loaded=0},sendNext:function(e){var t=f.getSize(e),n=f.getName(e),l=y.nextPart(e),d=a._getChunkData(e,l),h=a._getFileState(e).attemptingResume,x=a._getFileState(e).chunking.inProgress||[];null==a._getFileState(e).loaded&&(a._getFileState(e).loaded=0),h&&!1===f.onResume(e,n,d)&&(y.reset(e),l=y.nextPart(e),d=a._getChunkData(e,l),h=!1),null==l&&0===x.length?y.finalize(e):(r(qq.format("Sending chunked upload request for item {}.{}, bytes {}-{} of {}.",e,l,d.start+1,d.end,t)),f.onUploadChunk(e,n,a._getChunkDataForCallback(d)),x.push(l),a._getFileState(e).chunking.inProgress=x,p&&w.open(e,l),p&&w.available()&&a._getFileState(e).chunking.remaining.length&&y.sendNext(e),0===d.blob.size?(r(qq.format("Chunk {} for file {} will not be uploaded, zero sized chunk.",l,e),"error"),y.handleFailure(l,e,"File is no longer available",null)):a.uploadChunk(e,l,h).then((function(t,n){r("Chunked upload request succeeded for "+e+", chunk "+l),a.clearCachedChunk(e,l);var d=a._getFileState(e).chunking.inProgress||[],h=j.normalizeResponse(t,!0),p=qq.indexOf(d,l);r(qq.format("Chunk {} for file {} uploaded successfully.",l,e)),y.done(e,l,h,n),p>=0&&d.splice(p,1),a._maybePersistChunkedState(e),y.hasMoreParts(e)||0!==d.length?y.hasMoreParts(e)?y.sendNext(e):r(qq.format("File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}",e,JSON.stringify(d))):y.finalize(e)}),(function(t,n){y.handleFailure(l,e,t,n)})).done((function(){a.clearXhr(e,l)})))}},w={_open:[],_openChunks:{},_waiting:[],available:function(){var e=f.maxConnections,t=0,n=0;return qq.each(w._openChunks,(function(e,r){t++,n+=r.length})),e-(w._open.length-t+n)},free:function(e,t){var n,l=!t,d=qq.indexOf(w._waiting,e),h=qq.indexOf(w._open,e);delete w._openChunks[e],j.getProxyOrBlob(e)instanceof qq.BlobProxy&&(r("Generated blob upload has ended for "+e+", disposing generated blob."),delete a._getFileState(e).file),d>=0?w._waiting.splice(d,1):l&&h>=0&&(w._open.splice(h,1),(n=w._waiting.shift())>=0&&(w._open.push(n),j.start(n)))},getWaitingOrConnected:function(){var e=[];return qq.each(w._openChunks,(function(t,n){n&&n.length&&e.push(parseInt(t))})),qq.each(w._open,(function(t,n){w._openChunks[n]||e.push(parseInt(n))})),e=e.concat(w._waiting)},isUsingConnection:function(e){return qq.indexOf(w._open,e)>=0},open:function(e,t){return null==t&&w._waiting.push(e),!!w.available()&&(null==t?(w._waiting.pop(),w._open.push(e)):((n=w._openChunks[e]||[]).push(t),w._openChunks[e]=n),!0);var n},reset:function(){w._waiting=[],w._open=[]}},x=function(e,t){a._getFileState(e).loaded=0,r("Sending simple upload request for "+e),a.uploadFile(e).then((function(n,a){r("Simple upload request succeeded for "+e);var l=j.normalizeResponse(n,!0),d=f.getSize(e);f.onProgress(e,t,d,d),j.maybeNewUuid(e,l),j.cleanup(e,l,a)}),(function(n,a){r("Simple upload request failed for "+e);var l=j.normalizeResponse(n,!1);f.onAutoRetry(e,t,l,a)||j.cleanup(e,l,a)}))},j={cancel:function(e){r("Cancelling "+e),f.paramsStore.remove(e),w.free(e)},cleanup:function(e,t,n){var r=f.getName(e);f.onComplete(e,r,t,n),a._getFileState(e)&&a._clearXhrs&&a._clearXhrs(e),w.free(e)},getProxyOrBlob:function(e){return a.getProxy&&a.getProxy(e)||a.getFile&&a.getFile(e)},initHandler:function(){var e=t?qq[t]:qq.traditional,n=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";(a=new e[n+"UploadHandler"](f,{getDataByUuid:f.getDataByUuid,getName:f.getName,getSize:f.getSize,getUuid:f.getUuid,log:r,onCancel:f.onCancel,onProgress:f.onProgress,onUuidChanged:f.onUuidChanged}))._removeExpiredChunkingRecords&&a._removeExpiredChunkingRecords()},isDeferredEligibleForUpload:function(e){return f.isQueued(e)},maybeDefer:function(e,t){return t&&!a.getFile(e)&&t instanceof qq.BlobProxy?(f.onUploadPrep(e),r("Attempting to generate a blob on-demand for "+e),t.create().then((function(t){r("Generated an on-demand blob for "+e),a.updateBlob(e,t),f.setSize(e,t.size),a.reevaluateChunking(e),j.maybeSendDeferredFiles(e)}),(function(t){var a={};t&&(a.error=t),r(qq.format("Failed to generate blob for ID {}.  Error message: {}.",e,t),"error"),f.onComplete(e,f.getName(e),qq.extend(a,n),null),j.maybeSendDeferredFiles(e),w.free(e)})),!1):j.maybeSendDeferredFiles(e)},maybeSendDeferredFiles:function(e){var t=f.getIdsInProxyGroup(e),n=!1;return t&&t.length?(r("Maybe ready to upload proxy group file "+e),qq.each(t,(function(t,r){if(j.isDeferredEligibleForUpload(r)&&a.getFile(r))n=r===e,j.now(r);else if(j.isDeferredEligibleForUpload(r))return!1}))):(n=!0,j.now(e)),n},maybeNewUuid:function(e,t){void 0!==t.newUuid&&f.onUuidChanged(e,t.newUuid)},normalizeResponse:function(e,t){var n=e;return qq.isObject(e)||(n={},qq.isString(e)&&!t&&(n.error=e)),n.success=t,n},now:function(e){var t=f.getName(e);if(!d.isValid(e))throw new qq.Error(e+" is not a valid file ID to upload!");f.onUpload(e,t),h&&a._shouldChunkThisFile(e)?y.sendNext(e):x(e,t)},start:function(e){var t=j.getProxyOrBlob(e);return t?j.maybeDefer(e,t):(j.now(e),!0)}};qq.extend(this,{add:function(e,t){a.add.apply(this,arguments)},upload:function(e){return!!w.open(e)&&j.start(e)},retry:function(e){return p&&(a._getFileState(e).temp.ignoreFailure=!1),w.isUsingConnection(e)?j.start(e):d.upload(e)},cancel:function(e){var t=a.cancel(e);qq.isGenericPromise(t)?t.then((function(){j.cancel(e)})):!1!==t&&j.cancel(e)},cancelAll:function(){var e,t=w.getWaitingOrConnected();if(t.length)for(e=t.length-1;e>=0;e--)d.cancel(t[e]);w.reset()},getFile:function(e){return a.getProxy&&a.getProxy(e)?a.getProxy(e).referenceBlob:a.getFile&&a.getFile(e)},isProxied:function(e){return!(!a.getProxy||!a.getProxy(e))},getInput:function(e){if(a.getInput)return a.getInput(e)},reset:function(){r("Resetting upload handler"),d.cancelAll(),w.reset(),a.reset()},expunge:function(e){if(d.isValid(e))return a.expunge(e)},isValid:function(e){return a.isValid(e)},getResumableFilesData:function(){return a.getResumableFilesData?a.getResumableFilesData():[]},getThirdPartyFileId:function(e){if(d.isValid(e))return a.getThirdPartyFileId(e)},pause:function(e){return!!(d.isResumable(e)&&a.pause&&d.isValid(e)&&a.pause(e))&&(w.free(e),a.moveInProgressToRemaining(e),!0)},isResumable:function(e){return!!a.isResumable&&a.isResumable(e)}}),qq.extend(f,e),r=f.log,h=f.chunking.enabled&&qq.supportedFeatures.chunking,p=h&&f.chunking.concurrent.enabled,(l={})[f.preventRetryParam]=!0,n=l,j.initHandler()},qq.WindowReceiveMessage=function(e){"use strict";var t={};qq.extend({log:function(e,t){}},e),qq.extend(this,{receiveMessage:function(e,n){window.postMessage?t[e]=qq(window).attach("message",(function(e){n(e.data)})):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(e){if(window.postMessage){var n=t[e];n&&n()}}})},qq.FormUploadHandler=function(e){"use strict";var t=e.options,n=this,r=e.proxy,a=qq.getUniqueId(),l={},d={},h={},p=t.isCors,f=t.inputName,y=r.getUuid,w=r.log,x=new qq.WindowReceiveMessage({log:w});function j(e){return e.split("_")[0]}qq.extend(this,new qq.UploadHandler(e)),qq.override(this,(function(e){return{add:function(t,n){e.add(t,{input:n}),n.setAttribute("name",f),n.parentNode&&qq(n).remove()},expunge:function(t){!function(e){delete d[e],p&&(clearTimeout(h[e]),delete h[e],x.stopReceivingMessages(e));var t=document.getElementById(n._getIframeName(e));t&&(t.setAttribute("src","javascript:false;"),qq(t).remove())}(t),e.expunge(t)},isValid:function(t){return e.isValid(t)&&void 0!==n._getFileState(t).input}}})),qq.extend(this,{getInput:function(e){return n._getFileState(e).input},_attachLoadEvent:function(e,t){var r;p?function(e,t){var r=e.id,a=j(r),p=y(a);l[p]=t,d[a]=qq(e).attach("load",(function(){n.getInput(a)&&(w("Received iframe load event for CORS upload request (iframe name "+r+")"),h[r]=setTimeout((function(){var e="No valid message received from loaded iframe for iframe name "+r;w(e,"error"),t({error:e})}),1e3))})),x.receiveMessage(r,(function(e){w("Received the following window message: '"+e+"'");j(r);var t,a=n._parseJsonResponse(e),d=a.uuid;d&&l[d]?(w("Handling response for iframe name "+r),clearTimeout(h[r]),delete h[r],n._detachLoadEvent(r),t=l[d],delete l[d],x.stopReceivingMessages(r),t(a)):d||w("'"+e+"' does not contain a UUID - ignoring.")}))}(e,t):d[e.id]=qq(e).attach("load",(function(){if(w("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return}catch(e){w("Error when attempting to access iframe during handling of upload response ("+e.message+")","error"),r={success:!1}}t(r)}}))},_createIframe:function(e){return function(e){var t=qq.toElement("<iframe src='javascript:false;' name='"+e+"' />");return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t}(n._getIframeName(e))},_detachLoadEvent:function(e){void 0!==d[e]&&(d[e](),delete d[e])},_getIframeName:function(e){return e+"_"+a},_initFormForUpload:function(e){var t=e.method,n=e.endpoint,r=e.params,a=e.paramsInBody,l=e.targetName,d=qq.toElement("<form method='"+t+"' enctype='multipart/form-data'></form>"),h=n;return a?qq.obj2Inputs(r,d):h=qq.obj2url(r,n),d.setAttribute("action",h),d.setAttribute("target",l),d.style.display="none",document.body.appendChild(d),d},_parseJsonResponse:function(e){var t={};try{t=qq.parseJson(e)}catch(e){w("Error when attempting to parse iframe upload response ("+e.message+")","error")}return t}})},qq.XhrUploadHandler=function(e){"use strict";var t=this,n=e.options.namespace,r=e.proxy,a=e.options.chunking,l=e.options.resume,d=a&&e.options.chunking.enabled&&qq.supportedFeatures.chunking,h=l&&e.options.resume.enabled&&d&&qq.supportedFeatures.resume,p=r.getName,f=r.getSize,y=r.getUuid,w=r.getEndpoint,x=r.getDataByUuid,j=r.onUuidChanged,O=r.onProgress,C=r.log;function S(e){qq.each(t._getXhrs(e),(function(n,r){var a=t._getAjaxRequester(e,n);r.onreadystatechange=null,r.upload.onprogress=null,r.abort(),a&&a.canceled&&a.canceled(e)}))}qq.extend(this,new qq.UploadHandler(e)),qq.override(this,(function(e){return{add:function(n,r){if(qq.isFile(r)||qq.isBlob(r))e.add(n,{file:r});else{if(!(r instanceof qq.BlobProxy))throw new Error("Passed obj is not a File, Blob, or proxy");e.add(n,{proxy:r})}t._initTempState(n),h&&t._maybePrepareForResume(n)},expunge:function(n){S(n),t._maybeDeletePersistedChunkData(n),t._clearXhrs(n),e.expunge(n)}}})),qq.extend(this,{clearCachedChunk:function(e,n){delete t._getFileState(e).temp.cachedChunks[n]},clearXhr:function(e,n){var r=t._getFileState(e).temp;r.xhrs&&delete r.xhrs[n],r.ajaxRequesters&&delete r.ajaxRequesters[n]},finalizeChunks:function(e,n){var r=t._getTotalChunks(e)-1,a=t._getXhr(e,r);return n?(new qq.Promise).success(n(a),a):(new qq.Promise).success({},a)},getFile:function(e){return t.isValid(e)&&t._getFileState(e).file},getProxy:function(e){return t.isValid(e)&&t._getFileState(e).proxy},getResumableFilesData:function(){var e=[];return t._iterateResumeRecords((function(n,r){t.moveInProgressToRemaining(null,r.chunking.inProgress,r.chunking.remaining);var a={name:r.name,remaining:r.chunking.remaining,size:r.size,uuid:r.uuid};r.key&&(a.key=r.key),e.push(a)})),e},isResumable:function(e){return!!a&&t.isValid(e)&&!t._getFileState(e).notResumable},moveInProgressToRemaining:function(e,n,r){var a=n||t._getFileState(e).chunking.inProgress,l=r||t._getFileState(e).chunking.remaining;a&&(C(qq.format("Moving these chunks from in-progress {}, to remaining.",JSON.stringify(a))),a.reverse(),qq.each(a,(function(e,t){l.unshift(t)})),a.length=0)},pause:function(e){if(t.isValid(e))return C(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",e,p(e))),t._getFileState(e).paused=!0,S(e),!0},reevaluateChunking:function(e){if(a&&t.isValid(e)){var n,r,l=t._getFileState(e);if(delete l.chunking,l.chunking={},(n=t._getTotalChunks(e))>1||a.mandatory){for(l.chunking.enabled=!0,l.chunking.parts=n,l.chunking.remaining=[],r=0;r<n;r++)l.chunking.remaining.push(r);t._initTempState(e)}else l.chunking.enabled=!1}},updateBlob:function(e,n){t.isValid(e)&&(t._getFileState(e).file=n)},_clearXhrs:function(e){var n=t._getFileState(e).temp;qq.each(n.ajaxRequesters,(function(e){delete n.ajaxRequesters[e]})),qq.each(n.xhrs,(function(e){delete n.xhrs[e]}))},_createXhr:function(e,n){return t._registerXhr(e,n,qq.createXhrInstance())},_getAjaxRequester:function(e,n){var r=null==n?-1:n;return t._getFileState(e).temp.ajaxRequesters[r]},_getChunkData:function(e,n){var r=a.partSize,l=f(e),d=t.getFile(e),h=r*n,p=h+r>=l?l:h+r,y=t._getTotalChunks(e),w=this._getFileState(e).temp.cachedChunks,x=w[n]||qq.sliceBlob(d,h,p);return w[n]=x,{part:n,start:h,end:p,count:y,blob:x,size:p-h}},_getChunkDataForCallback:function(e){return{partIndex:e.part,startByte:e.start+1,endByte:e.end,totalParts:e.count}},_getLocalStorageId:function(e){var t=p(e),r=f(e),l=a.partSize,d=w(e);return qq.format("qq{}resume{}-{}-{}-{}-{}",n,"5.0",t,r,l,d)},_getMimeType:function(e){return t.getFile(e).type},_getPersistableData:function(e){return t._getFileState(e).chunking},_getTotalChunks:function(e){if(a){var t=f(e),n=a.partSize;return Math.ceil(t/n)}},_getXhr:function(e,n){var r=null==n?-1:n;return t._getFileState(e).temp.xhrs[r]},_getXhrs:function(e){return t._getFileState(e).temp.xhrs},_iterateResumeRecords:function(e){h&&qq.each(localStorage,(function(t,r){if(0===t.indexOf(qq.format("qq{}resume",n))){var a=JSON.parse(r);e(t,a)}}))},_initTempState:function(e){t._getFileState(e).temp={ajaxRequesters:{},chunkProgress:{},xhrs:{},cachedChunks:{}}},_markNotResumable:function(e){t._getFileState(e).notResumable=!0},_maybeDeletePersistedChunkData:function(e){var n;return!!(h&&t.isResumable(e)&&(n=t._getLocalStorageId(e))&&localStorage.getItem(n))&&(localStorage.removeItem(n),!0)},_maybePrepareForResume:function(e){var n,r,a=t._getFileState(e);h&&void 0===a.key&&(n=t._getLocalStorageId(e),(r=localStorage.getItem(n))&&(r=JSON.parse(r),x(r.uuid)?t._markNotResumable(e):(C(qq.format("Identified file with ID {} and name of {} as resumable.",e,p(e))),j(e,r.uuid),a.key=r.key,a.chunking=r.chunking,a.loaded=r.loaded,a.attemptingResume=!0,t.moveInProgressToRemaining(e))))},_maybePersistChunkedState:function(e){var n,r,a=t._getFileState(e);if(h&&t.isResumable(e)){n=t._getLocalStorageId(e),r={name:p(e),size:f(e),uuid:y(e),key:a.key,chunking:a.chunking,loaded:a.loaded,lastUpdated:Date.now()};try{localStorage.setItem(n,JSON.stringify(r))}catch(t){C(qq.format("Unable to save resume data for '{}' due to error: '{}'.",e,t.toString()),"warn")}}},_registerProgressHandler:function(e,n,r){var a=t._getXhr(e,n),l=p(e),d={simple:function(t,n){var r=f(e);O(e,l,t===n?r:t>=r?r-1:t,r)},chunked:function(a,d){var h=t._getFileState(e).temp.chunkProgress,p=t._getFileState(e).loaded,y=a,w=d,x=f(e),j=y-(w-r),C=p;h[n]=j,qq.each(h,(function(e,t){C+=t})),O(e,l,C,x)}};a.upload.onprogress=function(e){e.lengthComputable&&d[null==r?"simple":"chunked"](e.loaded,e.total)}},_registerXhr:function(e,n,r,a){var l=null==n?-1:n,d=t._getFileState(e).temp;return d.xhrs=d.xhrs||{},d.ajaxRequesters=d.ajaxRequesters||{},d.xhrs[l]=r,a&&(d.ajaxRequesters[l]=a),r},_removeExpiredChunkingRecords:function(){var e=l.recordsExpireIn;t._iterateResumeRecords((function(t,n){var r=new Date(n.lastUpdated);r.setDate(r.getDate()+e),r.getTime()<=Date.now()&&(C("Removing expired resume record with key "+t),localStorage.removeItem(t))}))},_shouldChunkThisFile:function(e){var n=t._getFileState(e);return n.chunking||t.reevaluateChunking(e),n.chunking.enabled}})},qq.DeleteFileAjaxRequester=function(e){"use strict";var t,n={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:function(e){return{}},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(e,t){},onDelete:function(e){},onDeleteComplete:function(e,t,n){}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["POST","DELETE"],method:n.method,endpointStore:n.endpointStore,paramsStore:n.paramsStore,mandatedParams:"POST"===n.method.toUpperCase()?{_method:"DELETE"}:{},maxConnections:n.maxConnections,customHeaders:function(e){return n.customHeaders.get(e)},log:n.log,onSend:n.onDelete,onComplete:n.onDeleteComplete,cors:n.cors})),qq.extend(this,{sendDelete:function(e,r,a){var l=a||{};n.log("Submitting delete file request for "+e),"DELETE"===n.method?t.initTransport(e).withPath(r).withParams(l).send():(l[n.uuidParamName]=r,t.initTransport(e).withParams(l).send())}})},function(){function e(e,n,r,a,l){var d,h=e.naturalWidth,p=e.naturalHeight,f=a.width,y=a.height,w=r.getContext("2d"),x=new qq.Promise;return w.save(),a.resize?function(e){var n=e.blob,r=e.image,a=e.imageHeight,l=e.imageWidth,d=e.orientation,h=new qq.Promise,p=e.resize,f=document.createElement("canvas"),y=f.getContext("2d"),w=e.canvas,x=e.targetHeight,j=e.targetWidth;return t(f,l,a,d),w.height=x,w.width=j,y.drawImage(r,0,0),p({blob:n,height:x,image:r,sourceCanvas:f,targetCanvas:w,width:j}).then((function(){w.qqImageRendered&&w.qqImageRendered(),h.success()}),h.failure),h}({blob:n,canvas:r,image:e,imageHeight:p,imageWidth:h,orientation:a.orientation,resize:a.resize,targetHeight:y,targetWidth:f}):(qq.supportedFeatures.unlimitedScaledImageSize||(d=function(e){if(!qq.ios())throw new qq.Error("Downsampled dimensions can only be reliably calculated for iOS!");if(e.origHeight*e.origWidth>5241e3)return{newHeight:Math.round(Math.sqrt(e.origHeight/e.origWidth*5241e3)),newWidth:Math.round(Math.sqrt(e.origWidth/e.origHeight*5241e3))}}({origWidth:f,origHeight:y}))&&(qq.log(qq.format("Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h",f,y,d.newWidth,d.newHeight),"warn"),f=d.newWidth,y=d.newHeight),t(r,f,y,a.orientation),qq.ios()?function(){(function(e){var t,n=e.naturalWidth,r=e.naturalHeight,a=document.createElement("canvas");return n*r>1048576&&(a.width=a.height=1,(t=a.getContext("2d")).drawImage(e,1-n,0),0===t.getImageData(0,0,1,1).data[3])})(e)&&(h/=2,p/=2);var t,n,r,a=1024,d=document.createElement("canvas"),x=l?function(e,t,n){var r,a,l,d=document.createElement("canvas"),h=0,p=n,f=n;for(d.width=1,d.height=n,(r=d.getContext("2d")).drawImage(e,0,0),a=r.getImageData(0,0,1,n).data;f>h;)0===a[4*(f-1)+3]?p=f:h=f,f=p+h>>1;return 0===(l=f/n)?1:l}(e,0,p):1,j=Math.ceil(a*f/h),O=Math.ceil(a*y/p/x),C=0,S=0;for(d.width=d.height=a,t=d.getContext("2d");C<p;){for(n=0,r=0;n<h;)t.clearRect(0,0,a,a),t.drawImage(e,-n,-C),w.drawImage(d,0,0,a,a,r,S,j,O),n+=a,r+=j;C+=a,S+=O}w.restore(),d=t=null}():w.drawImage(e,0,0,f,y),r.qqImageRendered&&r.qqImageRendered(),x.success(),x)}function t(e,t,n,r){switch(r){case 5:case 6:case 7:case 8:e.width=n,e.height=t;break;default:e.width=t,e.height=n}var a=e.getContext("2d");switch(r){case 2:a.translate(t,0),a.scale(-1,1);break;case 3:a.translate(t,n),a.rotate(Math.PI);break;case 4:a.translate(0,n),a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI),a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI),a.translate(0,-n);break;case 7:a.rotate(.5*Math.PI),a.translate(t,-n),a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI),a.translate(-t,0)}}function n(e,t){var n=this;window.Blob&&e instanceof Blob&&function(){var t=new Image,r=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!r)throw Error("No createObjectURL function found to create blob url");t.src=r.createObjectURL(e),n.blob=e,e=t}(),e.naturalWidth||e.naturalHeight||(e.onload=function(){var e=n.imageLoadListeners;e&&(n.imageLoadListeners=null,setTimeout((function(){for(var t=0,n=e.length;t<n;t++)e[t]()}),0))},e.onerror=t,this.imageLoadListeners=[]),this.srcImage=e}n.prototype.render=function(t,n){n=n||{};var r,a,l=this,d=this.srcImage.naturalWidth,h=this.srcImage.naturalHeight,p=n.width,f=n.height,y=n.maxWidth,w=n.maxHeight,x=!this.blob||"image/jpeg"===this.blob.type,j=t.tagName.toLowerCase();this.imageLoadListeners?this.imageLoadListeners.push((function(){l.render(t,n)})):(p&&!f?f=h*p/d<<0:f&&!p?p=d*f/h<<0:(p=d,f=h),y&&p>y&&(f=h*(p=y)/d<<0),w&&f>w&&(p=d*(f=w)/h<<0),r={width:p,height:f},qq.each(n,(function(e,t){r[e]=t})),"img"===j?(a=t.src,function(t,n,r,a){var l=document.createElement("canvas"),d=r.mime||"image/jpeg",h=new qq.Promise;return e(t,n,l,r,a).then((function(){h.success(l.toDataURL(d,r.quality||.8))})),h}(l.srcImage,l.blob,r,x).then((function(e){t.src=e,a===t.src&&t.onload()}))):"canvas"===j&&e(this.srcImage,this.blob,t,r,x),"function"==typeof this.onrender&&this.onrender(t))},qq.MegaPixImage=n}(),qq.ImageGenerator=function(e){"use strict";function t(e){return"img"===e.tagName.toLowerCase()}function n(e){return"canvas"===e.tagName.toLowerCase()}function r(e){var t=e.split("/"),n=t[t.length-1].split("?")[0],r=qq.getExtension(n);switch(r=r&&r.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function a(e){var t,n,r,a=document.createElement("a");return a.href=e,t=a.protocol,r=a.port,n=a.hostname,t.toLowerCase()!==window.location.protocol.toLowerCase()||(n.toLowerCase()!==window.location.hostname.toLowerCase()||r!==window.location.port&&!qq.ie())}function l(r,a){var l=t(r)||n(r);return t(r)?function(t,n){t.onload=function(){t.onload=null,t.onerror=null,n.success(t)},t.onerror=function(){t.onload=null,t.onerror=null,e("Problem drawing thumbnail!","error"),n.failure(t,"Problem drawing thumbnail!")}}(r,a):n(r)?function(e,t){e.qqImageRendered=function(){t.success(e)}}(r,a):(a.failure(r),e(qq.format("Element container of type {} is not supported!",r.tagName),"error")),l}function d(e,t,n,d,h){var p=new Image,f=new qq.Promise;l(p,f),a(e)&&(p.crossOrigin="anonymous"),p.src=e,f.then((function(){l(t,n),new qq.MegaPixImage(p).render(t,{maxWidth:d,maxHeight:d,mime:r(e),resize:h})}),n.failure)}function h(e,t,n,r){l(t,n),qq(t).css({maxWidth:r+"px",maxHeight:r+"px"}),t.src=e}function p(e,r,p){var f,y=new qq.Promise,w=p.scale,x=w?p.maxSize:null;return w&&t(r)?(f=document.createElement("canvas")).getContext&&f.getContext("2d")?a(e)&&void 0===(new Image).crossOrigin?h(e,r,y,x):d(e,r,y,x):h(e,r,y,x):n(r)?d(e,r,y,x):l(r,y)&&(r.src=e),y}qq.extend(this,{generate:function(t,n,r){return qq.isString(t)?(e("Attempting to update thumbnail based on server response."),p(t,n,r||{})):(e("Attempting to draw client-side image preview."),function(t,n,r){var a=new qq.Promise,d=new qq.Identify(t,e),h=r.maxSize,p=null==r.orient||r.orient,f=function(){n.onerror=null,n.onload=null,e("Could not render preview, file may be too large!","error"),a.failure(n,"Browser cannot render image!")};return d.isPreviewable().then((function(d){var y={parse:function(){return(new qq.Promise).success()}},w=p?new qq.Exif(t,e):y,x=new qq.MegaPixImage(t,f);l(n,a)&&w.parse().then((function(e){var t=e&&e.Orientation;x.render(n,{maxWidth:h,maxHeight:h,orientation:t,mime:d,resize:r.customResizeFunction})}),(function(t){e(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",t)),x.render(n,{maxWidth:h,maxHeight:h,mime:d,resize:r.customResizeFunction})}))}),(function(){e("Not previewable"),a.failure(n,"Not previewable")})),a}(t,n,r||{}))}}),this._testing={},this._testing.isImg=t,this._testing.isCanvas=n,this._testing.isCrossOrigin=a,this._testing.determineMimeOfFileName=r},qq.Exif=function(e,t){"use strict";var n=[274],r={274:{name:"Orientation",bytes:2}};function a(e){for(var t=0,n=0;e.length>0;)t+=parseInt(e.substring(0,2),16)*Math.pow(2,n),e=e.substring(2,e.length),n+=8;return t}function l(){var t=new qq.Promise;return qq.readBlobToHex(e,0,6).then((function(n){0!==n.indexOf("ffd8")?t.failure("Not a valid JPEG!"):function t(n,r){var a=n,l=r;return void 0===a&&(a=2,l=new qq.Promise),qq.readBlobToHex(e,a,4).then((function(e){var n,r=/^ffe([0-9])/.exec(e);r?"1"!==r[1]?(n=parseInt(e.slice(4,8),16),t(a+n+2,l)):l.success(a):l.failure("No EXIF header to be found!")})),l}().then((function(e){t.success(e)}),(function(e){t.failure(e)}))})),t}qq.extend(this,{parse:function(){var d=new qq.Promise,h=function(e){t(qq.format("EXIF header parse failed: '{}' ",e)),d.failure(e)};return l().then((function(l){var p,f;t(qq.format("Moving forward with EXIF header parsing for '{}'",void 0===e.name?"blob":e.name)),(p=l,f=new qq.Promise,qq.readBlobToHex(e,p+10,2).then((function(e){f.success("4949"===e)})),f).then((function(p){t(qq.format("EXIF Byte order is {} endian",p?"little":"big")),function(t,n){var r=new qq.Promise;return qq.readBlobToHex(e,t+18,2).then((function(e){if(n)return r.success(a(e));r.success(parseInt(e,16))})),r}(l,p).then((function(f){t(qq.format("Found {} APP1 directory entries",f)),function(t,n){var r=t+20,a=12*n;return qq.readBlobToHex(e,r,a)}(l,f).then((function(e){var l=function(e){for(var t=[],n=0;n+24<=e.length;)t.push(e.slice(n,n+24)),n+=24;return t}(e),h=function(e,t){var l=qq.extend([],n),d={};return qq.each(t,(function(t,n){var h,p,f,y=n.slice(0,4),w=e?a(y):parseInt(y,16),x=l.indexOf(w);if(x>=0&&(p=r[w].name,f=r[w].bytes,h=n.slice(16,16+2*f),d[p]=e?a(h):parseInt(h,16),l.splice(x,1)),0===l.length)return!1})),d}(p,l);t("Successfully parsed some EXIF tags"),d.success(h)}),h)}),h)}),h)}),h),d}}),this._testing={},this._testing.parseLittleEndian=a},qq.Identify=function(e,t){"use strict";qq.extend(this,{isPreviewable:function(){var n=this,r=new qq.Promise,a=!1,l=void 0===e.name?"blob":e.name;return t(qq.format("Attempting to determine if {} can be rendered in this browser",l)),t("First pass: check type attribute of blob object."),this.isPreviewableSync()?(t("Second pass: check for magic bytes in file header."),qq.readBlobToHex(e,0,4).then((function(e){qq.each(n.PREVIEWABLE_MIME_TYPES,(function(t,n){if(l=e,d=!1,h=[].concat(n),qq.each(h,(function(e,t){if(0===l.indexOf(t))return d=!0,!1})),d)return("image/tiff"!==t||qq.supportedFeatures.tiffPreviews)&&(a=!0,r.success(t)),!1;var l,d,h})),t(qq.format("'{}' is {} able to be rendered in this browser",l,a?"":"NOT")),a||r.failure()}),(function(){t("Error reading file w/ name '"+l+"'.  Not able to be rendered in this browser."),r.failure()}))):r.failure(),r},isPreviewableSync:function(){var n=e.type,r=qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES),n)>=0,a=!1,l=void 0===e.name?"blob":e.name;return r&&(a="image/tiff"!==n||qq.supportedFeatures.tiffPreviews),!a&&t(l+" is not previewable in this browser per the blob's type attr"),a}})},qq.Identify.prototype.PREVIEWABLE_MIME_TYPES={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]},qq.ImageValidation=function(e,t){"use strict";this.validate=function(n){var r,a=new qq.Promise;return t("Attempting to validate image."),!function(e){var t=!1;return qq.each(e,(function(e,n){if(n>0)return t=!0,!1})),t}(n)?a.success():(r=new qq.Promise,new qq.Identify(e,t).isPreviewable().then((function(){var n=new Image,a=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;a?(n.onerror=function(){t("Cannot determine dimensions for image.  May be too large.","error"),r.failure()},n.onload=function(){r.success({width:this.width,height:this.height})},n.src=a.createObjectURL(e)):(t("No createObjectURL function available to generate image URL!","error"),r.failure())}),r.failure),r).then((function(e){var t=function(e,t){var n;return qq.each(e,(function(e,r){if(r>0){var a=/(max|min)(Width|Height)/.exec(e),l=a[2].charAt(0).toLowerCase()+a[2].slice(1),d=t[l];switch(a[1]){case"min":if(d<r)return n=e,!1;break;case"max":if(d>r)return n=e,!1}}})),n}(n,e);t?a.failure(t):a.success()}),a.success),a}},qq.Session=function(e){"use strict";var t={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(e){},log:function(e,t){}};function n(e,n,r,a){var l=!1;(n=n&&function(e){if(qq.isArray(e))return!0;t.log("Session response is not an array.","error")}(e))&&qq.each(e,(function(e,n){if(null==n.uuid)l=!0,t.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",e),"error");else if(null==n.name)l=!0,t.log(qq.format("Session response item {} did not include a valid name - ignoring.",e),"error");else try{return t.addFileRecord(n),!0}catch(e){l=!0,t.log(e.message,"error")}return!1})),a[n&&!l?"success":"failure"](e,r)}qq.extend(t,e,!0),this.refresh=function(){var e=new qq.Promise,r=qq.extend({},t);return new qq.SessionAjaxRequester(qq.extend(r,{onComplete:function(t,r,a){n(t,r,a,e)}})).queryServer(),e}},qq.SessionAjaxRequester=function(e){"use strict";var t,n={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(e,t,n){},log:function(e,t){}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["GET"],method:"GET",endpointStore:{get:function(){return n.endpoint}},customHeaders:n.customHeaders,log:n.log,onComplete:function(e,t,r){var a=null;if(null!=t.responseText)try{a=qq.parseJson(t.responseText)}catch(e){n.log("Problem parsing session response: "+e.message,"error"),r=!0}n.onComplete(a,!r,t)},cors:n.cors})),qq.extend(this,{queryServer:function(){var e=qq.extend({},n.params);n.log("Session query request."),t.initTransport("sessionRefresh").withParams(e).withCacheBuster().send()}})},qq.Scaler=function(e,t){"use strict";var n=e.customResizer,r=e.sendOriginal,a=e.orient,l=e.defaultType,d=e.defaultQuality/100,h=e.failureText,p=e.includeExif,f=this._getSortedSizes(e.sizes);qq.extend(this,{enabled:qq.supportedFeatures.scaling&&f.length>0,getFileRecords:function(e,y,w){var x=this,j=[],O=w.blob?w.blob:w;return new qq.Identify(O,t).isPreviewableSync()?(qq.each(f,(function(e,r){var f=x._determineOutputType({defaultType:l,requestedType:r.type,refType:O.type});j.push({uuid:qq.getUniqueId(),name:x._getName(y,{name:r.name,type:f,refType:O.type}),blob:new qq.BlobProxy(O,qq.bind(x._generateScaledImage,x,{customResizeFunction:n,maxSize:r.maxSize,orient:a,type:f,quality:d,failedText:h,includeExif:p,log:t}))})})),j.push({uuid:e,name:y,size:O.size,blob:r?O:null})):j.push({uuid:e,name:y,size:O.size,blob:O}),j},handleNewFile:function(e,t,n,r,a,l,d,h){e.qqButtonId||e.blob&&e.blob.qqButtonId;var p,f=[],y=null,w=h.addFileToHandler,x=h.uploadData,j=h.paramsStore,O=qq.getUniqueId();qq.each(this.getFileRecords(n,t,e),(function(e,t){var n,r=t.size;t.blob instanceof qq.BlobProxy&&(r=-1),n=x.addFile({uuid:t.uuid,name:t.name,size:r,batchId:l,proxyGroupId:O}),t.blob instanceof qq.BlobProxy?f.push(n):y=n,t.blob?(w(n,t.blob),a.push({id:n,file:t.blob})):x.setStatus(n,qq.status.REJECTED)})),null!==y&&(qq.each(f,(function(e,t){var n={qqparentuuid:x.retrieve({id:y}).uuid,qqparentsize:x.retrieve({id:y}).size};n[d]=x.retrieve({id:t}).uuid,x.setParentId(t,y),j.addReadOnly(t,n)})),f.length&&((p={})[d]=x.retrieve({id:y}).uuid,j.addReadOnly(y,p)))}})},qq.extend(qq.Scaler.prototype,{scaleImage:function(e,t,n){"use strict";if(!qq.supportedFeatures.scaling)throw new qq.Error("Scaling is not supported in this browser!");var r=new qq.Promise,a=n.log,l=n.getFile(e),d=n.uploadData.retrieve({id:e}),h=d&&d.name,p=d&&d.uuid,f={customResizer:t.customResizer,sendOriginal:!1,orient:t.orient,defaultType:t.type||null,defaultQuality:t.quality,failedToScaleText:"Unable to scale",sizes:[{name:"",maxSize:t.maxSize}]},y=new qq.Scaler(f,a);return qq.Scaler&&qq.supportedFeatures.imagePreviews&&l?qq.bind((function(){var t=y.getFileRecords(p,h,l)[0];t&&t.blob instanceof qq.BlobProxy?t.blob.create().then(r.success,r.failure):(a(e+" is not a scalable image!","error"),r.failure())}),this)():(r.failure(),a("Could not generate requested scaled image for "+e+".  Scaling is either not possible in this browser, or the file could not be located.","error")),r},_determineOutputType:function(e){"use strict";var t=e.requestedType,n=e.defaultType,r=e.refType;return n||t?t&&qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES),t)>=0?"image/tiff"===t?qq.supportedFeatures.tiffPreviews?t:n:t:n:"image/jpeg"!==r?"image/png":r},_getName:function(e,t){"use strict";var n=e.lastIndexOf("."),r=t.type||"image/png",a=t.refType,l="",d=qq.getExtension(e),h="";return t.name&&t.name.trim().length&&(h=" ("+t.name+")"),n>=0?(l=e.substr(0,n),a!==r&&(d=r.split("/")[1]),l+=h+"."+d):l=e+h,l},_getSortedSizes:function(e){"use strict";return(e=qq.extend([],e)).sort((function(e,t){return e.maxSize>t.maxSize?1:e.maxSize<t.maxSize?-1:0}))},_generateScaledImage:function(e,t){"use strict";var n=this,r=e.customResizeFunction,a=e.log,l=e.maxSize,d=e.orient,h=e.type,p=e.quality,f=e.failedText,y=e.includeExif&&"image/jpeg"===t.type&&"image/jpeg"===h,w=new qq.Promise,x=new qq.ImageGenerator(a),j=document.createElement("canvas");return a("Attempting to generate scaled version for "+t.name),x.generate(t,j,{maxSize:l,orient:d,customResizeFunction:r}).then((function(){var e=j.toDataURL(h,p),r=function(){a("Success generating scaled version for "+t.name);var n=qq.dataUriToBlob(e);w.success(n)};y?n._insertExifHeader(t,e,a).then((function(t){e=t,r()}),(function(){a("Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.","error"),r()})):r()}),(function(){a("Failed attempt to generate scaled version for "+t.name,"error"),w.failure(f)})),w},_insertExifHeader:function(e,t,n){"use strict";var r=new FileReader,a=new qq.Promise,l="";return r.onload=function(){l=r.result,a.success(qq.ExifRestorer.restore(l,t))},r.onerror=function(){n("Problem reading "+e.name+" during attempt to transfer EXIF data to scaled version.","error"),a.failure()},r.readAsDataURL(e),a},_dataUriToBlob:function(e){"use strict";var t,n,r,a;return t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURI(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),a=new Uint8Array(r),qq.each(t,(function(e,t){a[e]=t.charCodeAt(0)})),this._createBlob(r,n)},_createBlob:function(e,t){"use strict";var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,r=n&&new n;return r?(r.append(e),r.getBlob(t)):new Blob([e],{type:t})}}),qq.ExifRestorer=(ExifRestorer={KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode64:function(e){var t,n,r,a,l,d="",h="",p="",f=0;do{r=(t=e[f++])>>2,a=(3&t)<<4|(n=e[f++])>>4,l=(15&n)<<2|(h=e[f++])>>6,p=63&h,isNaN(n)?l=p=64:isNaN(h)&&(p=64),d=d+this.KEY_STR.charAt(r)+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(l)+this.KEY_STR.charAt(p),t=n=h="",r=a=l=p=""}while(f<e.length);return d},restore:function(e,t){if(!e.match("data:image/jpeg;base64,"))return t;var n=this.decode64(e.replace("data:image/jpeg;base64,","")),r=this.slice2Segments(n),a=this.exifManipulation(t,r);return"data:image/jpeg;base64,"+this.encode64(a)},exifManipulation:function(e,t){var n=this.getExifArray(t),r=this.insertExif(e,n);return new Uint8Array(r)},getExifArray:function(e){for(var t,n=0;n<e.length;n++)if(255==(t=e[n])[0]&225==t[1])return t;return[]},insertExif:function(e,t){var n=e.replace("data:image/jpeg;base64,",""),r=this.decode64(n),a=r.indexOf(255,3),l=r.slice(0,a),d=r.slice(a),h=l;return h=(h=h.concat(t)).concat(d)},slice2Segments:function(e){for(var t=0,n=[];!(255==e[t]&218==e[t+1]);){if(255==e[t]&216==e[t+1])t+=2;else{var r=t+(256*e[t+2]+e[t+3])+2,a=e.slice(t,r);n.push(a),t=r}if(t>e.length)break}return n},decode64:function(e){var t,n,r,a,l="",d="",h=0,p=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(e))throw new Error("There were invalid base64 characters in the input text.  Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='");e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=this.KEY_STR.indexOf(e.charAt(h++))<<2|(r=this.KEY_STR.indexOf(e.charAt(h++)))>>4,n=(15&r)<<4|(a=this.KEY_STR.indexOf(e.charAt(h++)))>>2,l=(3&a)<<6|(d=this.KEY_STR.indexOf(e.charAt(h++))),p.push(t),64!=a&&p.push(n),64!=d&&p.push(l),t=n=l="",r=a=d=""}while(h<e.length);return p}},ExifRestorer),qq.TotalProgress=function(e,t){"use strict";var n={},r=0,a=0,l=-1,d=-1,h=function(t,n){t===l&&n===d||e(t,n),l=t,d=n},p=function(e){var r=t(e);r>0&&(f(e,0,r),n[e]={loaded:0,total:r})},f=function(e,t,l){var d=n[e]?n[e].loaded:0,p=n[e]?n[e].total:0;-1===t&&-1===l?(r-=d,a-=p):(t&&(r+=t-d),l&&(a+=l-p)),h(r,a)};qq.extend(this,{onAllComplete:function(e,t,n){(0===t.length||function(e,t){var n=!0;return qq.each(e,(function(e,r){if(qq.indexOf(t,r)>=0)return n=!1,!1})),n}(t,n))&&(h(a,a),this.reset())},onStatusChange:function(e,t,r){r===qq.status.CANCELED||r===qq.status.REJECTED?function(e){f(e,-1,-1),delete n[e]}(e):r===qq.status.SUBMITTING&&p(e)},onIndividualProgress:function(e,t,r){f(e,t,r),n[e]={loaded:t,total:r}},onNewSize:function(e){p(e)},reset:function(){n={},r=0,a=0}})},qq.PasteSupport=function(e){"use strict";var t,n;t={targetElement:null,callbacks:{log:function(e,t){},pasteReceived:function(e){}}},qq.extend(t,e),n=qq(t.targetElement).attach("paste",(function(e){var n=e.clipboardData;n&&qq.each(n.items,(function(e,n){if(function(e){return e.type&&0===e.type.indexOf("image/")}(n)){var r=n.getAsFile();t.callbacks.pasteReceived(r)}}))})),qq.extend(this,{reset:function(){n&&n()}})},qq.FormSupport=function(e,t,n){"use strict";var r=this,a=e.interceptSubmit,l=e.element,d=e.autoUpload;function h(e,t){if(!e.checkValidity||e.checkValidity())return!0;n("Form did not pass validation checks - will not upload.","error"),t()}qq.extend(this,{newEndpoint:null,newAutoUpload:d,attachedToForm:!1,getFormInputsAsObject:function(){return null==l?null:r._form2Obj(l)}}),l=function(e){return e&&(qq.isString(e)&&(e=document.getElementById(e)),e&&(n("Attaching to form element."),function(e){e.getAttribute("action")&&(r.newEndpoint=e.getAttribute("action"))}(e),a&&function(e){var n=e.submit;qq(e).attach("submit",(function(r){(r=r||window.event).preventDefault?r.preventDefault():r.returnValue=!1,h(e,n)&&t()})),e.submit=function(){h(e,n)&&t()}}(e))),e}(l),this.attachedToForm=!!l},qq.extend(qq.FormSupport.prototype,{_form2Obj:function(e){"use strict";var t={},n=function(e){return t=e.type,qq.indexOf(["checkbox","radio"],t.toLowerCase())>=0&&!e.checked||e.disabled&&"hidden"!==e.type.toLowerCase();var t};return qq.each(e.elements,(function(e,r){if((qq.isInput(r,!0)||"textarea"===r.tagName.toLowerCase())&&(l=r.type,qq.indexOf(["button","image","reset","submit"],l.toLowerCase())<0)&&!n(r))t[r.name]=r.value;else if("select"===r.tagName.toLowerCase()&&!n(r)){var a=function(e){var t=null;return qq.each(qq(e).children(),(function(e,n){if("option"===n.tagName.toLowerCase()&&n.selected)return t=n.value,!1})),t}(r);null!==a&&(t[r.name]=a)}var l})),t}}),qq.traditional=qq.traditional||{},qq.traditional.FormUploadHandler=function(e,t){"use strict";var n=this,r=t.getName,a=t.getUuid,l=t.log;this.uploadFile=function(t){var d,h=n.getInput(t),p=n._createIframe(t),f=new qq.Promise;return(d=function(t,l){var d=e.paramsStore.get(t),h="get"===e.method.toLowerCase()?"GET":"POST",p=e.endpointStore.get(t),f=r(t);return d[e.uuidName]=a(t),d[e.filenameParam]=f,n._initFormForUpload({method:h,endpoint:p,params:d,paramsInBody:e.paramsInBody,targetName:l.name})}(t,p)).appendChild(h),n._attachLoadEvent(p,(function(r){l("iframe loaded");var a=r||function(e,t){var r,a,d;try{d=(a=t.contentDocument||t.contentWindow.document).body.innerHTML,l("converting iframe's innerHTML to JSON"),l("innerHTML = "+d),d&&d.match(/^<pre/i)&&(d=a.body.firstChild.firstChild.nodeValue),r=n._parseJsonResponse(d)}catch(e){l("Error when attempting to parse form upload response ("+e.message+")","error"),r={success:!1}}return r}(0,p);n._detachLoadEvent(t),e.cors.expected||qq(p).remove(),a.success?f.success(a):f.failure(a)})),l("Sending upload request for "+t),d.submit(),qq(d).remove(),f},qq.extend(this,new qq.FormUploadHandler({options:{isCors:e.cors.expected,inputName:e.inputName},proxy:{onCancel:e.onCancel,getName:r,getUuid:a,log:l}}))},qq.traditional=qq.traditional||{},qq.traditional.XhrUploadHandler=function(e,t){"use strict";var n=this,r=t.getName,a=t.getSize,l=t.getUuid,d=t.log,h=e.forceMultipart||e.paramsInBody,p=new qq.traditional.AllChunksDoneAjaxRequester({cors:e.cors,endpoint:e.chunking.success.endpoint,log:d}),f=function(e,t){var n=new qq.Promise;return t.onreadystatechange=function(){if(4===t.readyState){var r=w(e,t);r.success?n.success(r.response,t):n.failure(r.response,t)}},n},y=function(e,t){return qq.indexOf([200,201,202,203,204],e.status)<0||!t.success||t.reset},w=function(e,t){var n;return d("xhr - server response received for "+e),d("responseText = "+t.responseText),n=x(!0,t),{success:!y(t,n),response:n}},x=function(e,t){var n={};try{d(qq.format("Received response status {} with body: {}",t.status,t.responseText)),n=qq.parseJson(t.responseText)}catch(t){e&&d("Error when attempting to parse xhr response text ("+t.message+")","error")}return n},j=function(t){var d=new qq.Promise;return p.complete(t,n._createXhr(t),function(t){var d=e.paramsStore.get(t),h=r(t),p=a(t);return d[e.uuidName]=l(t),d[e.filenameParam]=h,d[e.totalFileSizeName]=p,d[e.chunking.paramNames.totalParts]=n._getTotalChunks(t),d}(t),e.customHeaders.get(t)).then((function(e){d.success(x(!1,e),e)}),(function(e){d.failure(x(!1,e),e)})),d},O=function(t,n,d,p){var f=new FormData,y=e.method,w=e.endpointStore.get(p),x=r(p),j=a(p);return t[e.uuidName]=l(p),t[e.filenameParam]=x,h&&(t[e.totalFileSizeName]=j),e.paramsInBody||(h||(t[e.inputName]=x),w=qq.obj2url(t,w)),n.open(y,w,!0),e.cors.expected&&e.cors.sendCredentials&&(n.withCredentials=!0),h?(e.paramsInBody&&qq.obj2FormData(t,f),f.append(e.inputName,d),f):d},C=function(t,r){var a=e.customHeaders.get(t),l=n.getFile(t);r.setRequestHeader("Accept","application/json"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Cache-Control","no-cache"),h||(r.setRequestHeader("Content-Type","application/octet-stream"),r.setRequestHeader("X-Mime-Type",l.type)),qq.each(a,(function(e,t){r.setRequestHeader(e,t)}))};qq.extend(this,{uploadChunk:function(t,l,d){var p,y,w,x=n._getChunkData(t,l),j=n._createXhr(t,l);a(t);return p=f(t,j),n._registerProgressHandler(t,l,x.size),function(t,n,l){var d=a(t),p=r(t);n[e.chunking.paramNames.partIndex]=l.part,n[e.chunking.paramNames.partByteOffset]=l.start,n[e.chunking.paramNames.chunkSize]=l.size,n[e.chunking.paramNames.totalParts]=l.count,n[e.totalFileSizeName]=d,h&&(n[e.filenameParam]=p)}(t,w=e.paramsStore.get(t),x),d&&(w[e.resume.paramNames.resuming]=!0),y=O(w,j,x.blob,t),C(t,j),j.send(y),p},uploadFile:function(t){var r,a,l,d,h=n.getFile(t);return a=n._createXhr(t),n._registerProgressHandler(t),r=f(t,a),l=e.paramsStore.get(t),d=O(l,a,h,t),C(t,a),a.send(d),r}}),qq.extend(this,new qq.XhrUploadHandler({options:qq.extend({namespace:"traditional"},e),proxy:qq.extend({getEndpoint:e.endpointStore.get},t)})),qq.override(this,(function(t){return{finalizeChunks:function(n){return e.chunking.success.endpoint?j(n):t.finalizeChunks(n,qq.bind(x,this,!0))}}}))},qq.traditional.AllChunksDoneAjaxRequester=function(e){"use strict";var t,n={cors:{allowXdr:!1,expected:!1,sendCredentials:!1},endpoint:null,log:function(e,t){}},r={},a={get:function(e){return n.endpoint}};qq.extend(n,e),t=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["POST"],method:"POST",endpointStore:a,allowXRequestedWithAndCacheControl:!1,cors:n.cors,log:n.log,onComplete:function(e,t,n){var a=r[e];delete r[e],n?a.failure(t):a.success(t)}})),qq.extend(this,{complete:function(e,a,l,d){var h=new qq.Promise;return n.log("Submitting All Chunks Done request for "+e),r[e]=h,t.initTransport(e).withParams(l).withHeaders(d).send(a),h}})},qq.DragAndDrop=function(e){"use strict";var t,n,r,a=[],l=[],d=new qq.DisposeSupport;function h(e){var n=new qq.Promise;return e.isFile?e.file((function(t){var r=e.name,a=e.fullPath,d=a.indexOf(r);"/"===(a=a.substr(0,d)).charAt(0)&&(a=a.substr(1)),t.qqPath=a,l.push(t),n.success()}),(function(r){t.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+r.code+".","error"),n.failure()})):e.isDirectory&&function e(t,n,r,a){var l=a||new qq.Promise,d=n||t.createReader();return d.readEntries((function(n){var a=r?r.concat(n):n;n.length?setTimeout((function(){e(t,d,a,l)}),0):l.success(a)}),l.failure),l}(e).then((function(e){var t=e.length;qq.each(e,(function(e,r){h(r).done((function(){0===(t-=1)&&n.success()}))})),e.length||n.success()}),(function(r){t.callbacks.dropLog("Problem parsing '"+e.fullPath+"'.  FileError code "+r.code+".","error"),n.failure()})),n}function p(e){var n=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:"qq-hidezones",element:e,onEnter:function(n){qq(e).addClass(t.classes.dropActive),n.stopPropagation()},onLeaveNotDescendants:function(n){qq(e).removeClass(t.classes.dropActive)},onDrop:function(e){var r,a,d,p;(r=e.dataTransfer,a=n,d=[],p=new qq.Promise,t.callbacks.processingDroppedFiles(),a.dropDisabled(!0),r.files.length>1&&!t.allowMultipleItems?(t.callbacks.processingDroppedFilesComplete([]),t.callbacks.dropError("tooManyFilesError",""),a.dropDisabled(!1),p.failure()):(l=[],qq.isFolderDropSupported(r)?qq.each(r.items,(function(e,t){var n=t.webkitGetAsEntry();n&&(n.isFile?l.push(t.getAsFile()):d.push(h(n).done((function(){d.pop(),0===d.length&&p.success()}))))})):l=r.files,0===d.length&&p.success()),p).then((function(){!function(e,n){var r=Array.prototype.slice.call(e);t.callbacks.dropLog("Grabbed "+e.length+" dropped files."),n.dropDisabled(!1),t.callbacks.processingDroppedFilesComplete(r,n.getElement())}(l,n)}),(function(){t.callbacks.dropLog("Drop event DataTransfer parsing failed.  No files will be uploaded.","error")}))}});return d.addDisposer((function(){n.dispose()})),qq(e).hasAttribute("qq-hide-dropzone")&&qq(e).hide(),a.push(n),n}function f(e){var t;return qq.each(e.dataTransfer.types,(function(e,n){if("Files"===n)return t=!0,!1})),t}t={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks},qq.extend(t,e,!0),n=t.dropZoneElements,r=function(){setTimeout((function(){qq.each(n,(function(e,n){qq(n).hasAttribute("qq-hide-dropzone")&&qq(n).hide(),qq(n).removeClass(t.classes.dropActive)}))}),10)},qq.each(n,(function(e,t){var r=p(t);n.length&&qq.supportedFeatures.fileDrop&&d.attach(document,"dragenter",(function(e){!r.dropDisabled()&&f(e)&&qq.each(n,(function(e,t){t instanceof HTMLElement&&qq(t).hasAttribute("qq-hide-dropzone")&&qq(t).css({display:"block"})}))}))})),d.attach(document,"dragleave",(function(e){(function(e){return qq.safari()?e.x<0||e.y<0:0===e.x&&0===e.y})(e)&&r()})),d.attach(qq(document).children()[0],"mouseenter",(function(e){r()})),d.attach(document,"drop",(function(e){f(e)&&(e.preventDefault(),r())})),d.attach(document,"qq-hidezones",r),qq.extend(this,{setupExtraDropzone:function(e){t.dropZoneElements.push(e),p(e)},removeDropzone:function(e){var n,r=t.dropZoneElements;for(n in r)if(r[n]===e)return r.splice(n,1)},dispose:function(){d.dispose(),qq.each(a,(function(e,t){t.dispose()}))}})},qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(e,t){},dropError:function(e,t){qq.log("Drag & drop error code '"+e+" with these specifics: '"+t+"'","error")},dropLog:function(e,t){qq.log(e,t)}}},qq.UploadDropZone=function(e){"use strict";var t,n,r,a,l=new qq.DisposeSupport;function d(){return qq.safari()||qq.firefox()&&qq.windows()}function h(e){if(!qq.supportedFeatures.fileDrop)return!1;var t,n=e.dataTransfer,r=qq.safari();return t=!(!qq.ie()||!qq.supportedFeatures.fileDrop)||"none"!==n.effectAllowed,n&&t&&(n.files&&n.files.length||!r&&n.types.contains&&n.types.contains("Files")||n.types.includes&&n.types.includes("Files"))}function p(e){return void 0!==e&&(r=e),r}t={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(t,e),n=t.element,a||(d?l.attach(document,"dragover",(function(e){e.preventDefault()})):l.attach(document,"dragover",(function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())})),a=!0),l.attach(n,"dragover",(function(e){if(h(e)){var t=qq.ie()&&qq.supportedFeatures.fileDrop?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===t||"linkMove"===t?"move":"copy",e.stopPropagation(),e.preventDefault()}})),l.attach(n,"dragenter",(function(e){if(!p()){if(!h(e))return;t.onEnter(e)}})),l.attach(n,"dragleave",(function(e){if(h(e)){t.onLeave(e);var n=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(n)||t.onLeaveNotDescendants(e)}})),l.attach(n,"drop",(function(e){if(!p()){if(!h(e))return;e.preventDefault(),e.stopPropagation(),t.onDrop(e),function(){var e;function n(){(e=document.createEvent("Event")).initEvent(t.HIDE_ZONES_EVENT_NAME,!0,!0)}if(window.CustomEvent)try{e=new CustomEvent(t.HIDE_ZONES_EVENT_NAME)}catch(e){n()}else n();document.dispatchEvent(e)}()}})),qq.extend(this,{dropDisabled:function(e){return p(e)},dispose:function(){l.dispose()},getElement:function(){return n}}),this._testing={},this._testing.isValidFileDrag=h},function(){"use strict";qq.uiPublicApi={addInitialFiles:function(e){this._parent.prototype.addInitialFiles.apply(this,arguments),this._templating.addCacheToDom()},clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments),this._templating.clearFiles()},addExtraDropzone:function(e){this._dnd&&this._dnd.setupExtraDropzone(e)},removeExtraDropzone:function(e){if(this._dnd)return this._dnd.removeDropzone(e)},getItemByFileId:function(e){if(!this._templating.isHiddenForever(e))return this._templating.getFileContainer(e)},reset:function(){this._parent.prototype.reset.apply(this,arguments),this._templating.reset(),!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop()),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0,this._setupClickAndEditEventHandlers()},setName:function(e,t){var n=this._options.formatFileName(t);this._parent.prototype.setName.apply(this,arguments),this._templating.updateFilename(e,n)},pauseUpload:function(e){var t=this._parent.prototype.pauseUpload.apply(this,arguments);return t&&this._templating.uploadPaused(e),t},continueUpload:function(e){var t=this._parent.prototype.continueUpload.apply(this,arguments);return t&&this._templating.uploadContinued(e),t},getId:function(e){return this._templating.getFileId(e)},getDropTarget:function(e){return this.getFile(e).qqDropTarget}},qq.uiPrivateApi={_getButton:function(e){var t=this._parent.prototype._getButton.apply(this,arguments);return t||e===this._defaultButtonId&&(t=this._templating.getButton()),t},_removeFileItem:function(e){this._templating.removeFile(e)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent(),this._focusinEventSupported=!qq.firefox(),this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var e=this,t=this._options.dragAndDrop.extraDropzones,n=this._templating,r=n.getDropZone();return r&&t.push(r),new qq.DragAndDrop({dropZoneElements:t,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){n.showDropProcessing()},processingDroppedFilesComplete:function(t,r){n.hideDropProcessing(),qq.each(t,(function(e,t){t.qqDropTarget=r})),t.length&&e.addFiles(t,null,null)},dropError:function(t,n){e._itemError(t,n)},dropLog:function(t,n){e.log(t,n)}}})},_bindFileButtonsClickEvent:function(){var e=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(t,n){e.log(t,n)},onDeleteFile:function(t){e.deleteFile(t)},onCancel:function(t){e.cancel(t)},onRetry:function(t){e.retry(t)},onPause:function(t){e.pauseUpload(t)},onContinue:function(t){e.continueUpload(t)},onGetName:function(t){return e.getName(t)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var e=this,t=this._templating;return{templating:t,log:function(t,n){e.log(t,n)},onGetUploadStatus:function(t){return e.getUploads({id:t}).status},onGetName:function(t){return e.getName(t)},onSetName:function(t,n){e.setName(t,n)},onEditingStatusChange:function(e,n){var r=qq(t.getEditInput(e)),a=qq(t.getFileContainer(e));n?(r.addClass("qq-editing"),t.hideFilename(e),t.hideEditIcon(e)):(r.removeClass("qq-editing"),t.showFilename(e),t.showEditIcon(e)),a.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(e,t,n){this._parent.prototype._onUploadStatusChange.apply(this,arguments),this._isEditFilenameEnabled()&&this._templating.getFileContainer(e)&&n!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(e),this._templating.hideEditIcon(e)),t===qq.status.UPLOAD_RETRYING&&n===qq.status.UPLOADING?(this._templating.hideRetry(e),this._templating.setStatusText(e),qq(this._templating.getFileContainer(e)).removeClass(this._classes.retrying)):n===qq.status.UPLOAD_FAILED&&this._templating.hidePause(e)},_bindFilenameInputFocusInEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(e)},_bindFilenameInputFocusEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(e)},_bindFilenameClickEvent:function(){var e=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(e)},_storeForLater:function(e){this._parent.prototype._storeForLater.apply(this,arguments),this._templating.hideSpinner(e)},_onAllComplete:function(e,t){this._parent.prototype._onAllComplete.apply(this,arguments),this._templating.resetTotalProgress()},_onSubmit:function(e,t){var n=this.getFile(e);n&&n.qqPath&&this._options.dragAndDrop.reportDirectoryPaths&&this._paramsStore.addReadOnly(e,{qqpath:n.qqPath}),this._parent.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onSubmitted:function(e){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(e),this._templating.showEditIcon(e),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(e)))},_onProgress:function(e,t,n,r){this._parent.prototype._onProgress.apply(this,arguments),this._templating.updateProgress(e,n,r),0===r||100===Math.round(n/r*100)?(this._templating.hideCancel(e),this._templating.hidePause(e),this._templating.hideProgress(e),this._templating.setStatusText(e,this._options.text.waitingForResponse),this._displayFileSize(e)):this._displayFileSize(e,n,r)},_onTotalProgress:function(e,t){this._parent.prototype._onTotalProgress.apply(this,arguments),this._templating.updateTotalProgress(e,t)},_onComplete:function(e,t,n,r){var a=this._parent.prototype._onComplete.apply(this,arguments),l=this._templating,d=l.getFileContainer(e),h=this;function p(t){d&&(l.setStatusText(e),qq(d).removeClass(h._classes.retrying),l.hideProgress(e),h.getUploads({id:e}).status!==qq.status.UPLOAD_FAILED&&l.hideCancel(e),l.hideSpinner(e),t.success?h._markFileAsSuccessful(e):(qq(d).addClass(h._classes.fail),l.showCancel(e),l.isRetryPossible()&&!h._preventRetries[e]&&(qq(d).addClass(h._classes.retryable),l.showRetry(e)),h._controlFailureTextDisplay(e,t)))}return a instanceof qq.Promise?a.done((function(e){p(e)})):p(n),a},_markFileAsSuccessful:function(e){var t=this._templating;this._isDeletePossible()&&t.showDeleteButton(e),qq(t.getFileContainer(e)).addClass(this._classes.success),this._maybeUpdateThumbnail(e)},_onUploadPrep:function(e){this._parent.prototype._onUploadPrep.apply(this,arguments),this._templating.showSpinner(e)},_onUpload:function(e,t){var n=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(e),n},_onUploadChunk:function(e,t){this._parent.prototype._onUploadChunk.apply(this,arguments),t.partIndex>0&&this._handler.isResumable(e)&&this._templating.allowPause(e)},_onCancel:function(e,t){this._parent.prototype._onCancel.apply(this,arguments),this._removeFileItem(e),0===this._getNotFinished()&&this._templating.resetTotalProgress()},_onBeforeAutoRetry:function(e){var t,n,r;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments),this._showCancelLink(e),this._options.retry.showAutoRetryNote&&(t=this._autoRetries[e],n=this._options.retry.maxAutoAttempts,r=(r=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,t)).replace(/\{maxAuto\}/g,n),this._templating.setStatusText(e,r),qq(this._templating.getFileContainer(e)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(e){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(e),qq(this._templating.getFileContainer(e)).removeClass(this._classes.fail),this._templating.setStatusText(e),this._templating.showSpinner(e),this._showCancelLink(e),!0):(qq(this._templating.getFileContainer(e)).addClass(this._classes.retryable),this._templating.showRetry(e),!1)},_onSubmitDelete:function(e){var t=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,e,t)},_onSubmitDeleteSuccess:function(e,t,n){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(e,t,n){this._parent.prototype._onDeleteComplete.apply(this,arguments),this._templating.hideSpinner(e),n?(this._templating.setStatusText(e,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(e)):this._removeFileItem(e)},_sendDeleteRequest:function(e,t,n){this._templating.hideDeleteButton(e),this._templating.showSpinner(e),this._templating.setStatusText(e,this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(e,t,n){var r,a=this.getName(e),l=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,a),d=(t=this.getUuid(e),arguments),h=this;r=this._options.showConfirm(l),qq.isGenericPromise(r)?r.then((function(){h._sendDeleteRequest.apply(h,d)})):!1!==r&&h._sendDeleteRequest.apply(h,d)},_addToList:function(e,t,n){var r,a,l=0,d=this._handler.isProxied(e)&&this._options.scaling.hideScaled;this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(l=this._filesInBatchAddedToUi-1),r={index:l}),n||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(a=this.getUploads({id:e}),this._handledProxyGroup=this._handledProxyGroup||a.proxyGroupId,a.proxyGroupId===this._handledProxyGroup&&a.proxyGroupId||(this._handler.cancelAll(),this._clearList(),this._handledProxyGroup=null))),n?(this._templating.addFileToCache(e,this._options.formatFileName(t),r,d),this._templating.updateThumbnail(e,this._thumbnailUrls[e],!0,this._options.thumbnails.customResizer)):(this._templating.addFile(e,this._options.formatFileName(t),r,d),this._templating.generatePreview(e,this.getFile(e),this._options.thumbnails.customResizer)),this._filesInBatchAddedToUi+=1,(n||this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading)&&this._displayFileSize(e)},_clearList:function(){this._templating.clearFiles(),this.clearStoredFiles()},_displayFileSize:function(e,t,n){var r=this.getSize(e),a=this._formatSize(r);r>=0&&(void 0!==t&&void 0!==n&&(a=this._formatProgress(t,n)),this._templating.updateSize(e,a))},_formatProgress:function(e,t){var n=this._options.text.formatProgress;function r(e,t){n=n.replace(e,t)}return r("{percent}",Math.round(e/t*100)),r("{total_size}",this._formatSize(t)),n},_controlFailureTextDisplay:function(e,t){var n,r,a;n=this._options.failedUploadTextDisplay.mode,r=this._options.failedUploadTextDisplay.responseProperty,"custom"===n?((a=t[r])||(a=this._options.text.failUpload),this._templating.setStatusText(e,a),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(e,a)):"default"===n?this._templating.setStatusText(e,this._options.text.failUpload):"none"!==n&&this.log("failedUploadTextDisplay.mode value of '"+n+"' is not valid","warn")},_showTooltip:function(e,t){this._templating.getFileContainer(e).title=t},_showCancelLink:function(e){this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading||this._templating.showCancel(e)},_itemError:function(e,t,n){var r=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(r)},_batchError:function(e){this._parent.prototype._batchError.apply(this,arguments),this._options.showMessage(e)},_setupPastePrompt:function(){var e=this;this._options.callbacks.onPasteReceived=function(){var t=e._options.paste.namePromptMessage,n=e._options.paste.defaultName;return e._options.showPrompt(t,n)}},_fileOrBlobRejected:function(e,t){this._totalFilesInBatch-=1,this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(e,t,n){this._totalFilesInBatch=e.length,this._filesInBatchAddedToUi=0,this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(e){var t=this._thumbnailUrls[e];this.getUploads({id:e}).status===qq.status.DELETED||!t&&!this._options.thumbnails.placeholders.waitUntilResponse&&qq.supportedFeatures.imagePreviews||this._templating.updateThumbnail(e,t,this._options.thumbnails.customResizer)},_addCannedFile:function(e){var t=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(t,this.getName(t),!0),this._templating.hideSpinner(t),this._templating.hideCancel(t),this._markFileAsSuccessful(t),t},_setSize:function(e,t){this._parent.prototype._setSize.apply(this,arguments),this._templating.updateSize(e,this._formatSize(t))},_sessionRequestComplete:function(){this._templating.addCacheToDom(),this._parent.prototype._sessionRequestComplete.apply(this,arguments)}}}(),qq.FineUploader=function(e,t){"use strict";var n=this;this._parent=t?qq[t].FineUploaderBasic:qq.FineUploaderBasic,this._parent.apply(this,arguments),qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[],reportDirectoryPaths:!1},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{customResizer:null,maxCount:0,placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null},timeBetweenThumbs:750},scaling:{hideScaled:!1},showMessage:function(e){if(n._templating.hasDialog("alert"))return n._templating.showDialog("alert",e);setTimeout((function(){window.alert(e)}),0)},showConfirm:function(e){return n._templating.hasDialog("confirm")?n._templating.showDialog("confirm",e):window.confirm(e)},showPrompt:function(e,t){return n._templating.hasDialog("prompt")?n._templating.showDialog("prompt",e,t):window.prompt(e,t)}},!0),qq.extend(this._options,e,!0),this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},limits:{maxThumbs:this._options.thumbnails.maxCount,timeBetweenThumbs:this._options.thumbnails.timeBetweenThumbs},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text}),this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari()?this._templating.renderFailure(this._options.messages.unsupportedBrowserIos8Safari):!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._templating.renderFailure(this._options.messages.unsupportedBrowser):(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():this.log("Paste support module not found.","error")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0)},qq.extend(qq.FineUploader.prototype,qq.basePublicApi),qq.extend(qq.FineUploader.prototype,qq.basePrivateApi),qq.extend(qq.FineUploader.prototype,qq.uiPublicApi),qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi),qq.Templating=function(e){"use strict";var t,n,r,a,l,d,h,p,f={content:document.createDocumentFragment(),map:{}},y=!1,w=0,x=!1,j=[],O=-1,C={log:null,limits:{maxThumbs:0,timeBetweenThumbs:750},templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},S={button:"qq-upload-button-selector",alertDialog:"qq-alert-dialog-selector",dialogCancelButton:"qq-cancel-button-selector",confirmDialog:"qq-confirm-dialog-selector",dialogMessage:"qq-dialog-message-selector",dialogOkButton:"qq-ok-button-selector",promptDialog:"qq-prompt-dialog-selector",uploader:"qq-uploader-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",totalProgressBarContainer:"qq-total-progress-bar-container-selector",totalProgressBar:"qq-total-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropText:"qq-upload-drop-area-text-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},_={},k=new qq.Promise,E=new qq.Promise,A=function(e){var t=new qq.Promise;return E.then((function(n){G(n,e),e.src?t.success():(e.src=n.src,e.onload=function(){e.onload=null,Z(e),t.success()})}),(function(){K(e),t.success()})),t},T=function(){if(j.length){x=!0;var e=j.shift();e.update?J(e):X(e)}else x=!1},R=function(e){return V(F(e),S.cancel)},I=function(e){return V(F(e),S.continueButton)},P=function(e){return V(l,S[e+"Dialog"])},D=function(e){return V(F(e),S.deleteButton)},M=function(){return V(l,S.dropProcessing)},L=function(e){return V(F(e),S.editNameIcon)},F=function(e){return f.map[e]||qq(d).getFirstByClass("qq-file-id-"+e)},q=function(e){return V(F(e),S.file)},N=function(e){return V(F(e),S.pause)},B=function(e){return null==e?V(l,S.totalProgressBarContainer)||V(l,S.totalProgressBar):V(F(e),S.progressBarContainer)||V(F(e),S.progressBar)},U=function(e){return V(F(e),S.retry)},H=function(e){return V(F(e),S.size)},z=function(e){return V(F(e),S.spinner)},V=function(e,t){return e&&qq(e).getFirstByClass(t)},W=function(e){return h&&V(F(e),S.thumbnail)},K=function(e){e&&qq(e).addClass(C.classes.hide)},G=function(e,t){var n=e.style.maxWidth,r=e.style.maxHeight;r&&n&&!t.style.maxWidth&&!t.style.maxHeight&&qq(t).css({maxWidth:n,maxHeight:r})},Y=function(e,t){var n=_[e]||(new qq.Promise).failure(),r=new qq.Promise;return k.then((function(e){n.then((function(){r.success()}),(function(){G(e,t),t.onload=function(){t.onload=null,r.success()},t.src=e.src,Z(t)}))})),r},X=function(e){var n=e.id,r=e.optFileOrBlob,a=r&&r.qqThumbnailId,l=W(n),d={customResizeFunction:e.customResizeFunction,maxSize:O,orient:!0,scale:!0};qq.supportedFeatures.imagePreviews?l?C.limits.maxThumbs&&C.limits.maxThumbs<=w?(Y(n,l),T()):A(l).done((function(){_[n]=new qq.Promise,_[n].done((function(){setTimeout(T,C.limits.timeBetweenThumbs)})),null!=a?ee(n,a):function(e,n,r){var a=W(e);t("Generating new thumbnail for "+e),n.qqThumbnailId=e,C.imageGenerator.generate(n,a,r).then((function(){w++,Z(a),_[e].success()}),(function(){_[e].failure(),C.placeholders.waitUntilUpdate||Y(e,a)}))}(n,r,d)})):T():l&&(A(l),T())},J=function(e){var t=e.id,n=e.thumbnailUrl,r=e.showWaitingImg,a=W(t),l={customResizeFunction:e.customResizeFunction,scale:p,maxSize:O};if(a)if(n){if(!(C.limits.maxThumbs&&C.limits.maxThumbs<=w))return r&&A(a),C.imageGenerator.generate(n,a,l).then((function(){Z(a),w++,setTimeout(T,C.limits.timeBetweenThumbs)}),(function(){Y(t,a),setTimeout(T,C.limits.timeBetweenThumbs)}));Y(t,a),T()}else Y(t,a),T()},Q=function(e,t){var n=B(e),r=null==e?S.totalProgressBar:S.progressBar;n&&!qq(n).hasClass(r)&&(n=qq(n).getFirstByClass(r)),n&&(qq(n).css({width:t+"%"}),n.setAttribute("aria-valuenow",t))},Z=function(e){e&&qq(e).removeClass(C.classes.hide)},ee=function(e,n){var r=W(e),a=W(n);t(qq.format("ID {} is the same file as ID {}.  Will use generated thumbnail from ID {} instead.",e,n,n)),_[n].then((function(){w++,_[e].success(),t(qq.format("Now using previously generated thumbnail created for ID {} on ID {}.",n,e)),r.src=a.src,Z(r)}),(function(){_[e].failure(),C.placeholders.waitUntilUpdate||Y(e,r)}))};qq.extend(C,e),t=C.log,qq.supportedFeatures.imagePreviews||(C.limits.timeBetweenThumbs=0,C.limits.maxThumbs=0),l=C.containerEl,h=void 0!==C.imageGenerator,a=function(){var e,a,l,d,f,y,w,x,j,_,k;if(t("Parsing template"),null==C.templateIdOrEl)throw new Error("You MUST specify either a template element or ID!");if(qq.isString(C.templateIdOrEl)){if(null===(e=document.getElementById(C.templateIdOrEl)))throw new Error(qq.format("Cannot find template script at ID '{}'!",C.templateIdOrEl));a=e.innerHTML}else{if(void 0===C.templateIdOrEl.innerHTML)throw new Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");a=C.templateIdOrEl.innerHTML}if(a=qq.trimStr(a),(d=document.createElement("div")).appendChild(qq.toElement(a)),k=qq(d).getFirstByClass(S.uploader),C.button&&(y=qq(d).getFirstByClass(S.button))&&qq(y).remove(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(j=qq(d).getFirstByClass(S.dropProcessing))&&qq(j).remove(),(w=qq(d).getFirstByClass(S.drop))&&!qq.DragAndDrop&&(t("DnD module unavailable.","info"),qq(w).remove()),qq.supportedFeatures.fileDrop?qq(k).hasAttribute("qq-drop-area-text")&&w&&(_=qq(w).getFirstByClass(S.dropText))&&qq(_).remove():(k.removeAttribute("qq-drop-area-text"),w&&qq(w).hasAttribute("qq-hide-dropzone")&&qq(w).css({display:"none"})),x=qq(d).getFirstByClass(S.thumbnail),h?x&&(O=(O=parseInt(x.getAttribute("qq-max-size")))>0?O:null,p=qq(x).hasAttribute("qq-server-scale")):x&&qq(x).remove(),h=h&&x,n=qq(d).getByClass(S.editFilenameInput).length>0,r=qq(d).getByClass(S.retry).length>0,null==(l=qq(d).getFirstByClass(S.list)))throw new Error("Could not find the file list container in the template!");return f=l.children[0].cloneNode(!0),l.innerHTML="",d.getElementsByTagName("DIALOG").length&&document.createElement("dialog"),t("Template parsing complete"),{template:d,fileTemplate:f}}(),function(){var e=C.placeholders.thumbnailNotAvailable,n=C.placeholders.waitingForThumbnail,r={maxSize:O,scale:p};h&&(e?C.imageGenerator.generate(e,new Image,r).then((function(e){k.success(e)}),(function(){k.failure(),t("Problem loading 'not available' placeholder image at "+e,"error")})):k.failure(),n?C.imageGenerator.generate(n,new Image,r).then((function(e){E.success(e)}),(function(){E.failure(),t("Problem loading 'waiting for thumbnail' placeholder image at "+n,"error")})):E.failure())}(),qq.extend(this,{render:function(){t("Rendering template in DOM."),w=0,l.appendChild(a.template.cloneNode(!0)),K(M()),this.hideTotalProgress(),d=C.fileContainerEl||V(l,S.list),t("Template rendering complete")},renderFailure:function(e){var t=qq.toElement(e);l.innerHTML="",l.appendChild(t)},reset:function(){this.render()},clearFiles:function(){d.innerHTML=""},disableCancel:function(){y=!0},addFile:function(e,t,n,r,h){var p,w=a.fileTemplate.cloneNode(!0),x=V(w,S.file),j=V(l,S.uploader),O=h?f.content:d;h&&(f.map[e]=w),qq(w).addClass("qq-file-id-"+e),j.removeAttribute("qq-drop-area-text"),x&&(qq(x).setText(t),x.setAttribute("title",t)),w.setAttribute("qq-file-id",e),n?function(e,t,n){var r=n,a=r.firstChild;t>0&&(a=qq(r).children()[t].nextSibling),r.insertBefore(e,a)}(w,n.index,O):O.appendChild(w),r?(w.style.display="none",qq(w).addClass("qq-hidden-forever")):(K(B(e)),K(H(e)),K(D(e)),K(U(e)),K(N(e)),K(I(e)),y&&this.hideCancel(e),(p=W(e))&&!p.src&&E.then((function(e){p.src=e.src,e.style.maxHeight&&e.style.maxWidth&&qq(p).css({maxHeight:e.style.maxHeight,maxWidth:e.style.maxWidth}),Z(p)})))},addFileToCache:function(e,t,n,r){this.addFile(e,t,n,r,!0)},addCacheToDom:function(){d.appendChild(f.content),f.content=document.createDocumentFragment(),f.map={}},removeFile:function(e){qq(F(e)).remove()},getFileId:function(e){var t=e;if(t){for(;null==t.getAttribute("qq-file-id");)t=t.parentNode;return parseInt(t.getAttribute("qq-file-id"))}},getFileList:function(){return d},markFilenameEditable:function(e){var t=q(e);t&&qq(t).addClass(C.classes.editable)},updateFilename:function(e,t){var n=q(e);n&&(qq(n).setText(t),n.setAttribute("title",t))},hideFilename:function(e){K(q(e))},showFilename:function(e){Z(q(e))},isFileName:function(e){return qq(e).hasClass(S.file)},getButton:function(){return C.button||V(l,S.button)},hideDropProcessing:function(){K(M())},showDropProcessing:function(){Z(M())},getDropZone:function(){return V(l,S.drop)},isEditFilenamePossible:function(){return n},hideRetry:function(e){K(U(e))},isRetryPossible:function(){return r},showRetry:function(e){Z(U(e))},getFileContainer:function(e){return F(e)},showEditIcon:function(e){var t=L(e);t&&qq(t).addClass(C.classes.editable)},isHiddenForever:function(e){return qq(F(e)).hasClass("qq-hidden-forever")},hideEditIcon:function(e){var t=L(e);t&&qq(t).removeClass(C.classes.editable)},isEditIcon:function(e){return qq(e).hasClass(S.editNameIcon,!0)},getEditInput:function(e){return V(F(e),S.editFilenameInput)},isEditInput:function(e){return qq(e).hasClass(S.editFilenameInput,!0)},updateProgress:function(e,t,n){var r,a=B(e);a&&n>0&&(100===(r=Math.round(t/n*100))?K(a):Z(a),Q(e,r))},updateTotalProgress:function(e,t){this.updateProgress(null,e,t)},hideProgress:function(e){var t=B(e);t&&K(t)},hideTotalProgress:function(){this.hideProgress()},resetProgress:function(e){Q(e,0),this.hideTotalProgress(e)},resetTotalProgress:function(){this.resetProgress()},showCancel:function(e){if(!y){var t=R(e);t&&qq(t).removeClass(C.classes.hide)}},hideCancel:function(e){K(R(e))},isCancel:function(e){return qq(e).hasClass(S.cancel,!0)},allowPause:function(e){Z(N(e)),K(I(e))},uploadPaused:function(e){this.setStatusText(e,C.text.paused),this.allowContinueButton(e),K(z(e))},hidePause:function(e){K(N(e))},isPause:function(e){return qq(e).hasClass(S.pause,!0)},isContinueButton:function(e){return qq(e).hasClass(S.continueButton,!0)},allowContinueButton:function(e){Z(I(e)),K(N(e))},uploadContinued:function(e){this.setStatusText(e,""),this.allowPause(e),Z(z(e))},showDeleteButton:function(e){Z(D(e))},hideDeleteButton:function(e){K(D(e))},isDeleteButton:function(e){return qq(e).hasClass(S.deleteButton,!0)},isRetry:function(e){return qq(e).hasClass(S.retry,!0)},updateSize:function(e,t){var n=H(e);n&&(Z(n),qq(n).setText(t))},setStatusText:function(e,t){var n=V(F(e),S.statusText);n&&(null==t?qq(n).clearText():qq(n).setText(t))},hideSpinner:function(e){qq(F(e)).removeClass("qq-in-progress"),K(z(e))},showSpinner:function(e){qq(F(e)).addClass("qq-in-progress"),Z(z(e))},generatePreview:function(e,t,n){this.isHiddenForever(e)||(j.push({id:e,customResizeFunction:n,optFileOrBlob:t}),!x&&T())},updateThumbnail:function(e,t,n,r){this.isHiddenForever(e)||(j.push({customResizeFunction:r,update:!0,id:e,thumbnailUrl:t,showWaitingImg:n}),!x&&T())},hasDialog:function(e){return qq.supportedFeatures.dialogElement&&!!P(e)},showDialog:function(e,t,n){var r=P(e),a=V(r,S.dialogMessage),l=r.getElementsByTagName("INPUT")[0],d=V(r,S.dialogCancelButton),h=V(r,S.dialogOkButton),p=new qq.Promise,f=function(){d.removeEventListener("click",y),h&&h.removeEventListener("click",w),p.failure()},y=function(){d.removeEventListener("click",y),r.close()},w=function(){r.removeEventListener("close",f),h.removeEventListener("click",w),r.close(),p.success(l&&l.value)};return r.addEventListener("close",f),d.addEventListener("click",y),h&&h.addEventListener("click",w),l&&(l.value=n),a.textContent=t,r.showModal(),p}})},qq.UiEventHandler=function(e,t){"use strict";var n=new qq.DisposeSupport,r={eventType:"click",attachTo:null,onHandled:function(e,t){}};function a(e){n.attach(e,r.eventType,(function(e){var t=(e=e||window.event).target||e.srcElement;r.onHandled(t,e)}))}qq.extend(this,{addHandler:function(e){a(e)},dispose:function(){n.dispose()}}),qq.extend(t,{getFileIdFromItem:function(e){return e.qqFileId},getDisposeSupport:function(){return n}}),qq.extend(r,e),r.attachTo&&a(r.attachTo)},qq.FileButtonsClickHandler=function(e){"use strict";var t={templating:null,log:function(e,t){},onDeleteFile:function(e){},onCancel:function(e){},onRetry:function(e){},onPause:function(e){},onContinue:function(e){},onGetName:function(e){}},n={cancel:function(e){t.onCancel(e)},retry:function(e){t.onRetry(e)},deleteButton:function(e){t.onDeleteFile(e)},pause:function(e){t.onPause(e)},continueButton:function(e){t.onContinue(e)}};qq.extend(t,e),t.eventType="click",t.onHandled=function(e,r){qq.each(n,(function(n,a){var l,d=n.charAt(0).toUpperCase()+n.slice(1);if(t.templating["is"+d](e))return l=t.templating.getFileId(e),qq.preventDefault(r),t.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",t.onGetName(l),l)),a(l),!1}))},t.attachTo=t.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(t,{}))},qq.FilenameClickHandler=function(e){"use strict";var t={},n={templating:null,log:function(e,t){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(e){},onGetName:function(e){}};qq.extend(n,e),n.eventType="click",n.onHandled=function(e,r){if(n.templating.isFileName(e)||n.templating.isEditIcon(e)){var a=n.templating.getFileId(e);n.onGetUploadStatus(a)===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",n.onGetName(a),a)),qq.preventDefault(r),t.handleFilenameEdit(a,e,!0))}},qq.extend(this,new qq.FilenameEditHandler(n,t))},qq.FilenameInputFocusInHandler=function(e,t){"use strict";var n={templating:null,onGetUploadStatus:function(e){},log:function(e,t){}};t||(t={}),n.eventType="focusin",n.onHandled=function(e,r){if(n.templating.isEditInput(e)){var a=n.templating.getFileId(e);n.onGetUploadStatus(a)===qq.status.SUBMITTED&&(n.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",n.onGetName(a),a)),t.handleFilenameEdit(a,e))}},qq.extend(n,e),qq.extend(this,new qq.FilenameEditHandler(n,t))},qq.FilenameInputFocusHandler=function(e){"use strict";e.eventType="focus",e.attachTo=null,qq.extend(this,new qq.FilenameInputFocusInHandler(e,{}))},qq.FilenameEditHandler=function(e,t){"use strict";var n={templating:null,log:function(e,t){},onGetUploadStatus:function(e){},onGetName:function(e){},onSetName:function(e,t){},onEditingStatusChange:function(e,t){}};function r(e,t){var r,a=e.value;void 0!==a&&qq.trimStr(a).length>0&&(void 0!==(r=function(e){var t=n.onGetName(e);return qq.getExtension(t)}(t))&&(a=a+"."+r),n.onSetName(t,a)),n.onEditingStatusChange(t,!1)}qq.extend(n,e),n.attachTo=n.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(n,t)),qq.extend(t,{handleFilenameEdit:function(e,a,l){var d,h,p,f=n.templating.getEditInput(e);n.onEditingStatusChange(e,!0),f.value=(d=e,h=n.onGetName(d),(p=h.lastIndexOf("."))>0&&(h=h.substr(0,p)),h),l&&f.focus(),function(e,n){t.getDisposeSupport().attach(e,"blur",(function(){r(e,n)}))}(f,e),function(e,n){t.getDisposeSupport().attach(e,"keyup",(function(t){13===(t.keyCode||t.which)&&r(e,n)}))}(f,e)}})}}(window)},,,,,,,,function(e,t,n){var r,a,l;"undefined"!=typeof window&&window,a=[n(306)],void 0===(l="function"==typeof(r=function(){var e,t,n,r,a=400,l="___sysend___",d=new RegExp(l),h=Math.random(),p={},f={},y=[],w=0,x=!0,j=0,O=0,C=(n=(new Date).getTime(),r=performance&&performance.now&&1e3*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random();return n>0?(t=(n+t)%16|0,n=Math.floor(n/16)):(t=(r+t)%16|0,r=Math.floor(r/16)),("x"===e?t:3&t|8).toString(16)}))),S=1,_={primary:[],close:[],open:[],secondary:[],message:[],visbility:[]},k=Object.keys(_),E=M(p,"to"),A=M(p,"from"),T={id:C,broadcast:function(e,n){var r,a;t?t.postMessage({name:e,data:E(n)}):(r=e,a=function(e){var t=[j++,h];void 0!==e&&t.push(e);var n=E(t);return n===t?JSON.stringify(t):n}(n),0==j&&localStorage.setItem(l+r,h),localStorage.setItem(l+r,a),setTimeout((function(){var t;t=e,localStorage.removeItem(l+t)}),0)),function(e,t){y.forEach((function(n){var r={name:l,key:e,data:t};n.window.postMessage(JSON.stringify(r),"*")}))}(e,n)},emit:function(e,t){T.broadcast(e,t),L(e,t)},serializer:function(e,t){if("function"!=typeof e||"function"!=typeof t)throw new Error("sysend::serializer: Invalid argument, expecting function");p.to=e,p.from=t},proxy:function(e){if("string"==typeof e&&R(e)!==window.location.host){var t=document.createElement("iframe");t.style.width=t.style.height=0,t.style.border="none";var n=e;e.match(/\.html$/)||(n=e.replace(/\/$/,"")+"/proxy.html"),t.addEventListener("error",(function n(){setTimeout((function(){throw new Error('html proxy file not found on "'+e+'" url')}),0),t.removeEventListener("error",n)})),t.addEventListener("load",(function e(){var n;try{n=t.contentWindow}catch(e){n=t.contentWindow}y.push({window:n,node:t}),t.removeEventListener("load",e)})),document.body.appendChild(t),t.src=n}},on:function(e,t){f[e]||(f[e]=[]),f[e].push(t)},off:function(e,t){if(f[e])if(t)for(var n=f[e].length;n--;)f[e][n]==t&&f[e].splice(n,1);else f[e]=[]},track:function(e,t){k.includes(e)&&_[e].push(t)},untrack:function(e,t){k.includes(e)&&_[e].length&&(_[e]=void 0===t?[]:_[e].filter((function(e){return e!==t})))},post:function(e,t){T.broadcast("__message__",{target:e,data:t,origin:C})},list:function(){var e=O++,t={target:C,id:e},n=I(T.timeout);return new Promise((function(r){var a=[];T.on("__window_ack__",(function(t){t.origin.target===C&&t.origin.id===e&&a.push({id:t.id,primary:t.primary})})),T.broadcast("__window__",{id:t}),n().then((function(){r(a)}))}))},isPrimary:function(){return x}};Object.defineProperty(T,"timeout",{enumerable:!0,get:function(){return a},set:function(e){"number"!=typeof e||isNaN(e)||(a=e)}});var R=function(){if("undefined"!=typeof URL)return function(e){return(e=new URL(e)).host};var e=document.createElement("a");return function(t){return e.href=t,e.host}}();function I(e){return function(){return new Promise((function(t){setTimeout(t,e)}))}}function P(){var e=Array.from(document.querySelectorAll("iframe"));return Promise.all(e.filter((function(e){return e.src})).map((function(e){return new Promise((function(t,n){e.addEventListener("load",()=>{t()},!0),e.addEventListener("error",n,!0)}))}))).then(I(T.timeout))}function D(e){var t=[].slice.call(arguments,1);e.forEach((function(e){e.apply(null,t)}))}function M(e,t){var n={from:"Unserialize",to:"Serialize"}[t]+" Error: ";return function(r){var a=e[t];try{return a?a(r):r}catch(e){console.warn(n+e.message)}}}function L(e,t){f[e].forEach((function(n){n(t,e)}))}return function(){if("function"==typeof window.BroadcastChannel)(t=new window.BroadcastChannel(l)).addEventListener("message",(function(e){if(e.target.name===l){var t=e.data&&e.data.name;f[t]&&L(t,A(e.data.data))}}));else if(function(){try{return localStorage.setItem(l,1),localStorage.removeItem(l),!1}catch(e){return!0}}())console.warn('Your browser don\'t support localStorgage. In Safari this is most of the time because of "Private Browsing Mode"');else{var n=new RegExp("^"+l);for(var r in localStorage)r.match(n)&&localStorage.removeItem(r);window.addEventListener("storage",(function(e){if(e.key.match(n)&&w++%2==0){var t=e.key.replace(n,"");if(f[t]){var r=e.newValue||function(e){return localStorage.getItem(l+e)}(t);if(r&&r!=h){var a=(p=A(d=r))===d?JSON.parse(d):p;a&&a[1]!=h&&L(t,a[2])}}}var d,p}),!1)}var a,p;!function(){try{return window.self!==window.top}catch(e){return!0}}()?(void 0!==document.hidden?(a="hidden",p="visibilitychange"):void 0!==document.msHidden?(a="msHidden",p="msvisibilitychange"):void 0!==document.webkitHidden&&(a="webkitHidden",p="webkitvisibilitychange"),"function"==typeof document.addEventListener&&a&&document.addEventListener(p,(function(){D(_.visbility,!document[a])}),!1),T.track("visbility",(function(t){t&&!e&&(x=!0,D(_.primary),T.emit("__primary__"))})),T.on("__primary__",(function(){e=!0})),T.on("__open__",(function(e){e.id,S++,x&&T.broadcast("__ack__"),D(_.open,{count:S,primary:e.primary,id:e.id})})),T.on("__ack__",(function(){x||D(_.secondary)})),T.on("__close__",(function(t){--S,t.wasPrimary&&!x&&(e=!1);var n={id:t.id,count:S,primary:t.wasPrimary,self:t.id===C};D(_.close,n)})),T.on("__window__",(function(e){T.broadcast("__window_ack__",{id:C,origin:e.id,primary:x})})),T.on("__message__",(function(e){e.target===C&&D(_.message,e)})),addEventListener("beforeunload",(function(){T.emit("__close__",{id:C,wasPrimary:x})}),{capture:!0}),new Promise((function(e){window.addEventListener("load",e,!0)})).then(P).then((function(){T.list().then((function(t){S=t.length,x=0===t.length,(t.find((function(e){return e.primary}))||x)&&(e=!0),T.emit("__open__",{id:C,primary:x}),x&&D(_.primary)}))}))):window.addEventListener("message",(function(e){if("string"==typeof e.data&&e.data.match(d))try{var t=JSON.parse(e.data);if(t&&t.name===l){var n=A(t.data);T.broadcast(t.key,n)}}catch(e){}}))}(),T})?r.apply(t,a):r)||(e.exports=l)},function(e,t,n){"use strict";function r(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function a(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function l(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return a(n.overflowY,t)||a(n.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function d(e,t,n,r,a,l,d,h){return l<e&&d>t||l>e&&d<t?0:l<=e&&h<=n||d>=t&&h>=n?l-e-r:d>t&&h<n||l<e&&h>n?d-t+a:0}t.a=function(e,t){var n=window,a=t.scrollMode,h=t.block,p=t.inline,f=t.boundary,y=t.skipOverflowHiddenElements,w="function"==typeof f?f:function(e){return e!==f};if(!r(e))throw new TypeError("Invalid target");for(var x=document.scrollingElement||document.documentElement,j=[],O=e;r(O)&&w(O);){if((O=O.parentElement)===x){j.push(O);break}null!=O&&O===document.body&&l(O)&&!l(document.documentElement)||null!=O&&l(O,y)&&j.push(O)}for(var C=n.visualViewport?n.visualViewport.width:innerWidth,S=n.visualViewport?n.visualViewport.height:innerHeight,_=window.scrollX||pageXOffset,k=window.scrollY||pageYOffset,E=e.getBoundingClientRect(),A=E.height,T=E.width,R=E.top,I=E.right,P=E.bottom,D=E.left,M="start"===h||"nearest"===h?R:"end"===h?P:R+A/2,L="center"===p?D+T/2:"end"===p?I:D,F=[],q=0;q<j.length;q++){var N=j[q],B=N.getBoundingClientRect(),U=B.height,H=B.width,z=B.top,V=B.right,W=B.bottom,K=B.left;if("if-needed"===a&&R>=0&&D>=0&&P<=S&&I<=C&&R>=z&&P<=W&&D>=K&&I<=V)return F;var G=getComputedStyle(N),Y=parseInt(G.borderLeftWidth,10),X=parseInt(G.borderTopWidth,10),J=parseInt(G.borderRightWidth,10),Q=parseInt(G.borderBottomWidth,10),Z=0,ee=0,te="offsetWidth"in N?N.offsetWidth-N.clientWidth-Y-J:0,ne="offsetHeight"in N?N.offsetHeight-N.clientHeight-X-Q:0;if(x===N)Z="start"===h?M:"end"===h?M-S:"nearest"===h?d(k,k+S,S,X,Q,k+M,k+M+A,A):M-S/2,ee="start"===p?L:"center"===p?L-C/2:"end"===p?L-C:d(_,_+C,C,Y,J,_+L,_+L+T,T),Z=Math.max(0,Z+k),ee=Math.max(0,ee+_);else{Z="start"===h?M-z-X:"end"===h?M-W+Q+ne:"nearest"===h?d(z,W,U,X,Q+ne,M,M+A,A):M-(z+U/2)+ne/2,ee="start"===p?L-K-Y:"center"===p?L-(K+H/2)+te/2:"end"===p?L-V+J+te:d(K,V,H,Y,J+te,L,L+T,T);var re=N.scrollLeft,oe=N.scrollTop;M+=oe-(Z=Math.max(0,Math.min(oe+Z,N.scrollHeight-U+ne))),L+=re-(ee=Math.max(0,Math.min(re+ee,N.scrollWidth-H+te)))}F.push({el:N,top:Z,left:ee})}return F}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ze})),n.d(t,"b",(function(){return et}));var r=n(2);n(219);function a(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var l="function"==typeof Symbol&&Symbol.observable||"@@observable",d=function(){return Math.random().toString(36).substring(7).split("").join(".")},h={INIT:"@@redux/INIT"+d(),REPLACE:"@@redux/REPLACE"+d(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+d()}};function p(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function f(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(a(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(a(1));return n(f)(e,t)}if("function"!=typeof e)throw new Error(a(2));var d=e,y=t,w=[],x=w,j=!1;function O(){x===w&&(x=w.slice())}function C(){if(j)throw new Error(a(3));return y}function S(e){if("function"!=typeof e)throw new Error(a(4));if(j)throw new Error(a(5));var t=!0;return O(),x.push(e),function(){if(t){if(j)throw new Error(a(6));t=!1,O();var n=x.indexOf(e);x.splice(n,1),w=null}}}function _(e){if(!p(e))throw new Error(a(7));if(void 0===e.type)throw new Error(a(8));if(j)throw new Error(a(9));try{j=!0,y=d(y,e)}finally{j=!1}for(var t=w=x,n=0;n<t.length;n++){(0,t[n])()}return e}function k(e){if("function"!=typeof e)throw new Error(a(10));d=e,_({type:h.REPLACE})}function E(){var e,t=S;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(a(11));function n(){e.next&&e.next(C())}return n(),{unsubscribe:t(n)}}})[l]=function(){return this},e}return _({type:h.INIT}),(r={dispatch:_,subscribe:S,getState:C,replaceReducer:k})[l]=E,r}var y="dnd-core/INIT_COORDS",w="dnd-core/BEGIN_DRAG",x="dnd-core/PUBLISH_DRAG_SOURCE",j="dnd-core/HOVER",O="dnd-core/DROP",C="dnd-core/END_DRAG",S=function(e,t){return e===t};function _(e,t){return!e&&!t||!(!e||!t)&&(e.x===t.x&&e.y===t.y)}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case y:case w:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case j:return _(e.clientOffset,n.clientOffset)?e:A(A({},e),{},{clientOffset:n.clientOffset});case C:case O:return R;default:return e}}var P="dnd-core/ADD_SOURCE",D="dnd-core/ADD_TARGET",M="dnd-core/REMOVE_SOURCE",L="dnd-core/REMOVE_TARGET";function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t,n){return t.split(".").reduce((function(e,t){return e&&e[t]?e[t]:n||null}),e)}function N(e,t){return e.filter((function(e){return e!==t}))}function B(e){return"object"===F(e)}function U(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var a=[];return n.forEach((function(e,t){1===e&&a.push(t)})),a}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case w:return z(z({},e),{},{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case x:return z(z({},e),{},{isSourcePublic:!0});case j:return z(z({},e),{},{targetIds:n.targetIds});case L:return-1===e.targetIds.indexOf(n.targetId)?e:z(z({},e),{},{targetIds:N(e.targetIds,n.targetId)});case O:return z(z({},e),{},{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case C:return z(z({},e),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:case D:return e+1;case M:case L:return e-1;default:return e}}var Y=[],X=[];function J(e,t){return e!==Y&&(e===X||void 0===t||(n=e,t.filter((function(e){return n.indexOf(e)>-1}))).length>0);var n}function Q(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case j:break;case P:case D:case L:case M:return Y;case w:case x:case C:case O:default:return X}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,a=t.prevTargetIds,l=void 0===a?[]:a,d=U(r,l),h=d.length>0||!k(r,l);if(!h)return Y;var p=l[l.length-1],f=r[r.length-1];return p!==f&&(p&&d.push(p),f&&d.push(f)),d}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e+1}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:Q(e.dirtyHandlerIds,{type:t.type,payload:te(te({},t.payload),{},{prevTargetIds:q(e,"dragOperation.targetIds",[])})}),dragOffset:I(e.dragOffset,t),refCount:G(e.refCount,t),dragOperation:K(e.dragOperation,t),stateId:Z(e.stateId)}}Y.__IS_NONE__=!0,X.__IS_ALL__=!0;var oe=n(44);function ae(e,t){return{type:y,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}var se={type:y,payload:{clientOffset:null,sourceClientOffset:null}};function le(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,a=void 0===r||r,l=n.clientOffset,d=n.getSourceClientOffset,h=e.getMonitor(),p=e.getRegistry();e.dispatch(ae(l)),ce(t,h,p);var f=he(t,h);if(null!==f){var y=null;if(l){if(!d)throw new Error("getSourceClientOffset must be defined");ue(d),y=d(f)}e.dispatch(ae(l,y));var x=p.getSource(f),j=x.beginDrag(h,f);de(j),p.pinSource(f);var O=p.getSourceType(f);return{type:w,payload:{itemType:O,item:j,sourceId:f,clientOffset:l||null,sourceClientOffset:y||null,isSourcePublic:!!a}}}e.dispatch(se)}}function ce(e,t,n){Object(oe.a)(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){Object(oe.a)(n.getSource(e),"Expected sourceIds to be registered.")}))}function ue(e){Object(oe.a)("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}function de(e){Object(oe.a)(B(e),"Item must be an object.")}function he(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}function pe(e){return function(){if(e.getMonitor().isDragging())return{type:x}}}function fe(e,t){return null===t?null===e:Array.isArray(e)?e.some((function(e){return e===t})):e===t}function ge(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.clientOffset;me(t);var a=t.slice(0),l=e.getMonitor(),d=e.getRegistry();ve(a,l,d);var h=l.getItemType();return be(a,d,h),ye(a,l,d),{type:j,payload:{targetIds:a,clientOffset:r||null}}}}function me(e){Object(oe.a)(Array.isArray(e),"Expected targetIds to be an array.")}function ve(e,t,n){Object(oe.a)(t.isDragging(),"Cannot call hover while not dragging."),Object(oe.a)(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var a=e[r];Object(oe.a)(e.lastIndexOf(a)===r,"Expected targetIds to be unique in the passed array.");var l=n.getTarget(a);Object(oe.a)(l,"Expected targetIds to be registered.")}}function be(e,t,n){for(var r=e.length-1;r>=0;r--){var a=e[r];fe(t.getTargetType(a),n)||e.splice(r,1)}}function ye(e,t,n){e.forEach((function(e){n.getTarget(e).hover(t,e)}))}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();Ce(n);var a=_e(n);a.forEach((function(a,l){var d=Se(a,l,r,n),h={type:O,payload:{dropResult:xe(xe({},t),d)}};e.dispatch(h)}))}}function Ce(e){Object(oe.a)(e.isDragging(),"Cannot call drop while not dragging."),Object(oe.a)(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function Se(e,t,n,r){var a=n.getTarget(e),l=a?a.drop(r,e):void 0;return function(e){Object(oe.a)(void 0===e||B(e),"Drop result must either be an object or undefined.")}(l),void 0===l&&(l=0===t?{}:r.getDropResult()),l}function _e(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function ke(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){Object(oe.a)(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:C}}}function Ee(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e,Te=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.registry=n}var t,n,r;return t=e,(n=[{key:"subscribeToStateChange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0},r=n.handlerIds;Object(oe.a)("function"==typeof e,"listener must be a function."),Object(oe.a)(void 0===r||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");var a=this.store.getState().stateId,l=function(){var n=t.store.getState(),l=n.stateId;try{l===a||l===a+1&&!J(n.dirtyHandlerIds,r)||e()}finally{a=l}};return this.store.subscribe(l)}},{key:"subscribeToOffsetChange",value:function(e){var t=this;Object(oe.a)("function"==typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())}))}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return Object(oe.a)(t,"Expected to find a valid source."),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return Object(oe.a)(t,"Expected to find a valid target."),!(!this.isDragging()||this.didDrop())&&fe(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return Object(oe.a)(t,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1};if(!e)return!1;var n=t.shallow;if(!this.isDragging())return!1;var r=this.registry.getTargetType(e),a=this.getItemType();if(a&&!fe(r,a))return!1;var l=this.getTargetIds();if(!l.length)return!1;var d=l.indexOf(e);return n?d===l.length-1:d>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return e=this.store.getState().dragOffset,r=e.clientOffset,a=e.initialClientOffset,l=e.initialSourceClientOffset,r&&a&&l?Ee((n=l,{x:(t=r).x+n.x,y:t.y+n.y}),a):null;var e,t,n,r,a,l}},{key:"getDifferenceFromInitialOffset",value:function(){return e=this.store.getState().dragOffset,t=e.clientOffset,n=e.initialClientOffset,t&&n?Ee(t,n):null;var e,t,n}}])&&Ae(t.prototype,n),r&&Ae(t,r),e}(),Re=0;function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){t&&Array.isArray(e)?e.forEach((function(e){return Pe(e,!1)})):Object(oe.a)("string"==typeof e||"symbol"===Ie(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}($e||($e={}));var De=n(492),Me=[],Le=[],Fe=De.a.makeRequestCallFromTimer((function throwFirstError(){if(Le.length)throw Le.shift()}));function qe(e){var t;(t=Me.length?Me.pop():new Ne).task=e,Object(De.a)(t)}var Ne=function(){function e(){}return e.prototype.call=function(){try{this.task.call()}catch(e){qe.onerror?qe.onerror(e):(Le.push(e),Fe())}finally{this.task=null,Me[Me.length]=this}},e}();function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ze(e){var t=(Re++).toString();switch(e){case $e.SOURCE:return"S".concat(t);case $e.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function Ve(e){switch(e[0]){case"S":return $e.SOURCE;case"T":return $e.TARGET;default:Object(oe.a)(!1,"Cannot parse handler ID: ".concat(e))}}function We(e,t){var n=e.entries(),r=!1;do{var a=n.next(),l=a.done;if(Ue(a.value,2)[1]===t)return!0;r=!!l}while(!r);return!1}var Ke=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}var t,n,r;return t=e,(n=[{key:"addSource",value:function(e,t){Pe(e),function(e){Object(oe.a)("function"==typeof e.canDrag,"Expected canDrag to be a function."),Object(oe.a)("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),Object(oe.a)("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler($e.SOURCE,e,t);return this.store.dispatch(function(e){return{type:P,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){Pe(e,!0),function(e){Object(oe.a)("function"==typeof e.canDrop,"Expected canDrop to be a function."),Object(oe.a)("function"==typeof e.hover,"Expected hover to be a function."),Object(oe.a)("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler($e.TARGET,e,t);return this.store.dispatch(function(e){return{type:D,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return We(this.dragSources,e)||We(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(oe.a)(this.isSourceId(e),"Expected a valid source ID.");var n=t&&e===this.pinnedSourceId,r=n?this.pinnedSource:this.dragSources.get(e);return r}},{key:"getTarget",value:function(e){return Object(oe.a)(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return Object(oe.a)(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return Object(oe.a)(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return Ve(e)===$e.SOURCE}},{key:"isTargetId",value:function(e){return Ve(e)===$e.TARGET}},{key:"removeSource",value:function(e){var t=this;Object(oe.a)(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:M,payload:{sourceId:e}}}(e)),qe((function(){t.dragSources.delete(e),t.types.delete(e)}))}},{key:"removeTarget",value:function(e){Object(oe.a)(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:L,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);Object(oe.a)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){Object(oe.a)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=ze(e);return this.types.set(r,t),e===$e.SOURCE?this.dragSources.set(r,n):e===$e.TARGET&&this.dropTargets.set(r,n),r}}])&&Be(t.prototype,n),r&&Be(t,r),e}();function Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return f(re,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}var Je=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ge(this,e),this.isSetUp=!1,this.handleRefCountChange=function(){var e=t.store.getState().refCount>0;t.backend&&(e&&!t.isSetUp?(t.backend.setup(),t.isSetUp=!0):!e&&t.isSetUp&&(t.backend.teardown(),t.isSetUp=!1))};var r=Xe(n);this.store=r,this.monitor=new Te(r,new Ke(r)),r.subscribe(this.handleRefCountChange)}var t,n,r;return t=e,(n=[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch,n=function(e){return{beginDrag:le(e),publishDragSource:pe(e),hover:ge(e),drop:Oe(e),endDrag:ke(e)}}(this);return Object.keys(n).reduce((function(r,a){var l,d=n[a];return r[a]=(l=d,function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var d=l.apply(e,r);void 0!==d&&t(d)}),r}),{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}])&&Ye(t.prototype,n),r&&Ye(t,r),e}();function Qe(e,t,n,r){var a=new Je(r),l=e(a,t,n);return a.receiveBackend(l),a}var Ze=r.createContext({dragDropManager:void 0});function et(e,t,n,r){return{dragDropManager:Qe(e,t,n,r)}}},,,function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},,,function(e,t,n){var r=n(41),a=n(353).entries;r({target:"Object",stat:!0},{entries:function(e){return a(e)}})},,,,,,,,,,,,,,,function(e,t,n){"use strict";n(13),n(8),n(29),n(11),n(12),n(4),n(14),n(6),n(9),n(16),n(10),n(7),n(17);function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(3).a.factory("queuedHttp",["$http","$q",function(e,t){var n=[],a=!1;function l(){if(!a){var e=n.shift();return null!=e?(a=!0,e().then((function(){return a=!1,l()})).catch((function(){return a=!1,l()}))):void 0}}var d=function(){for(var t=arguments.length,a=new Array(t),d=0;d<t;d++)a[d]=arguments[d];var h={},p=[],f=[];h.then=function(e,t){return p.push(e),null!=t&&f.push(t),h},h.catch=function(e){return f.push(e),h};var y=function(){return e.apply(void 0,r(Array.from(a||[]))).then((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(p).map((function(e){return e.apply(void 0,r(Array.from(t||[])))}))})).catch((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(f).map((function(e){return e.apply(void 0,r(Array.from(t||[])))}))}))};return n.push(y),l(),h};return d.post=function(e,t){return d({method:"POST",url:e,data:t})},d}])},,,function(e,t,n){"use strict";n(7),n(72);var r=n(5),a=n.n(r),l=n(3),d=n(75),h=n.n(d),p=n(21);l.a.factory("algoliaSearch",(function(){var e,t=Object(p.a)("ol-algolia"),n=a.a.get(t,"indexes.wiki");n&&(e=h()(t.appId,t.apiKey).initIndex(n));return{searchWiki:e?e.search.bind(e):null}}))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(85),a=n(40),l=n(190),d=n(134),h=a(n(202).f),p=a([].push),f=function(e){return function(t){for(var n,a=d(t),f=l(a),y=f.length,w=0,x=[];y>w;)n=f[w++],r&&!h(a,n)||p(x,e?[n,a[n]]:a[n]);return x}};e.exports={entries:f(!0),values:f(!1)}},function(e,t,n){"use strict";var r=n(15),a=n(309),l=n(2),d=n(0);function h(){var e=Object(a.a)().t;return Object(d.jsxs)("ul",{className:"list-unstyled upgrade-benefits",children:[Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("unlimited_projects")]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("collabs_per_proj",{collabcount:"Multiple"})]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("full_doc_history")]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("sync_to_dropbox")]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("sync_to_github")]}),Object(d.jsxs)("li",{children:[Object(d.jsx)(r.a,{type:"check"})," ",e("compile_larger_projects")]})]})}t.a=Object(l.memo)(h)},function(e,t,n){"use strict";n(6),n(4),n(24),n(8),n(9);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=n(219);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach((function(t){Object(a.a)(e,t,n[t])}))}return e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var f=n(103);function y(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Object(f.a)(e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=n(220);function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Object(x.a)(e,t)}var O={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},C=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,e),this.init(t,n)}return p(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||O,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,l({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]),e}()),S=function(){function e(){d(this,e),this.observers={}}return p(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.observers[e]){var a=[].concat(this.observers[e]);a.forEach((function(e){e.apply(void 0,n)}))}if(this.observers["*"]){var l=[].concat(this.observers["*"]);l.forEach((function(t){t.apply(t,[e].concat(n))}))}}}]),e}();function _(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function k(e){return null==e?"":""+e}function E(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}function A(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function a(){return!e||"string"==typeof e}for(var l="string"!=typeof t?[].concat(t):t.split(".");l.length>1;){if(a())return{};var d=r(l.shift());!e[d]&&n&&(e[d]=new n),e=Object.prototype.hasOwnProperty.call(e,d)?e[d]:{}}return a()?{}:{obj:e,k:r(l.shift())}}function T(e,t,n){var r=A(e,t,Object);r.obj[r.k]=n}function R(e,t){var n=A(e,t),r=n.obj,a=n.k;if(r)return r[a]}function I(e,t,n){var r=R(e,n);return void 0!==r?r:R(t,n)}function P(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):P(e[r],t[r],n):e[r]=t[r]);return e}function D(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function L(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return M[e]})):e}var F="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,q=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return d(this,t),n=y(this,w(t).call(this)),F&&S.call(Object(f.a)(n)),n.data=e||{},n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n}return j(t,e),p(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,l=[e,t];return n&&"string"!=typeof n&&(l=l.concat(n)),n&&"string"==typeof n&&(l=l.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(l=e.split(".")),R(this.data,l)}},{key:"addResource",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},l=this.options.keySeparator;void 0===l&&(l=".");var d=[e,t];n&&(d=d.concat(l?n.split(l):n)),e.indexOf(".")>-1&&(r=t,t=(d=e.split("."))[1]),this.addNamespaces(t),T(this.data,d,r),a.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var a in n)"string"!=typeof n[a]&&"[object Array]"!==Object.prototype.toString.apply(n[a])||this.addResource(e,t,a,n[a],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,a){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},h=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(h=e.split("."))[1]),this.addNamespaces(t);var p=R(this.data,h)||{};r?P(p,n,a):p=l({},p,n),T(this.data,h,p),d.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?l({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),t}(S),N={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,a){var l=this;return e.forEach((function(e){l.processors[e]&&(t=l.processors[e].process(t,n,r,a))})),t}},B={},U=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,t),n=y(this,w(t).call(this)),F&&S.call(Object(f.a)(n)),E(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,Object(f.a)(n)),n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=C.create("translator"),n}return j(t,e),p(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,a=t.ns||this.options.defaultNS;if(n&&e.indexOf(n)>-1){var l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:a};var d=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(d[0])>-1)&&(a=d.shift()),e=d.join(r)}return"string"==typeof a&&(a=[a]),{key:e,namespaces:a}}},{key:"translate",value:function(e,n,a){var d=this;if("object"!==r(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var h=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,p=this.extractFromKey(e[e.length-1],n),f=p.key,y=p.namespaces,w=y[y.length-1],x=n.lng||this.language,j=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(x&&"cimode"===x.toLowerCase()){if(j){var O=n.nsSeparator||this.options.nsSeparator;return w+O+f}return f}var C=this.resolve(e,n),S=C&&C.res,_=C&&C.usedKey||f,k=C&&C.exactUsedKey||f,E=Object.prototype.toString.apply(S),A=["[object Number]","[object Function]","[object RegExp]"],T=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,R=!this.i18nFormat||this.i18nFormat.handleAsObject,I="string"!=typeof S&&"boolean"!=typeof S&&"number"!=typeof S;if(R&&S&&I&&A.indexOf(E)<0&&("string"!=typeof T||"[object Array]"!==E)){if(!n.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(_,S,n):"key '".concat(f," (").concat(this.language,")' returned an object instead of string.");if(h){var P="[object Array]"===E,D=P?[]:{},M=P?k:_;for(var L in S)if(Object.prototype.hasOwnProperty.call(S,L)){var F="".concat(M).concat(h).concat(L);D[L]=this.translate(F,l({},n,{joinArrays:!1,ns:y})),D[L]===F&&(D[L]=S[L])}S=D}}else if(R&&"string"==typeof T&&"[object Array]"===E)(S=S.join(T))&&(S=this.extendTranslation(S,e,n,a));else{var q=!1,N=!1,B=void 0!==n.count&&"string"!=typeof n.count,U=t.hasDefaultValue(n),H=B?this.pluralResolver.getSuffix(x,n.count):"",z=n["defaultValue".concat(H)]||n.defaultValue;!this.isValidLookup(S)&&U&&(q=!0,S=z),this.isValidLookup(S)||(N=!0,S=f);var V=U&&z!==S&&this.options.updateMissing;if(N||q||V){if(this.logger.log(V?"updateKey":"missingKey",x,w,f,V?z:S),h){var W=this.resolve(f,l({},n,{keySeparator:!1}));W&&W.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var K=[],G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&G&&G[0])for(var Y=0;Y<G.length;Y++)K.push(G[Y]);else"all"===this.options.saveMissingTo?K=this.languageUtils.toResolveHierarchy(n.lng||this.language):K.push(n.lng||this.language);var X=function(e,t,r){d.options.missingKeyHandler?d.options.missingKeyHandler(e,w,t,V?r:S,V,n):d.backendConnector&&d.backendConnector.saveMissing&&d.backendConnector.saveMissing(e,w,t,V?r:S,V,n),d.emit("missingKey",e,w,t,S)};this.options.saveMissing&&(this.options.saveMissingPlurals&&B?K.forEach((function(e){d.pluralResolver.getSuffixes(e).forEach((function(t){X([e],f+t,n["defaultValue".concat(t)]||z)}))})):X(K,f,z))}S=this.extendTranslation(S,e,n,C,a),N&&S===f&&this.options.appendNamespaceToMissingKey&&(S="".concat(w,":").concat(f)),N&&this.options.parseMissingKeyHandler&&(S=this.options.parseMissingKeyHandler(S))}return S}},{key:"extendTranslation",value:function(e,t,n,r,a){var d=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(l({},n,{interpolation:l({},this.options.interpolation,n.interpolation)}));var h,p=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(p){var f=e.match(this.interpolator.nestingRegexp);h=f&&f.length}var y=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(y=l({},this.options.interpolation.defaultVariables,y)),e=this.interpolator.interpolate(e,y,n.lng||this.language,n),p){var w=e.match(this.interpolator.nestingRegexp);h<(w&&w.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];return a&&a[0]===r[0]&&!n.context?(d.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):d.translate.apply(d,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var x=n.postProcess||this.options.postProcess,j="string"==typeof x?[x]:x;return null!=e&&j&&j.length&&!1!==n.applyPostProcessor&&(e=N.handle(j,e,t,this.options&&this.options.postProcessPassResolved?l({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,a,l,d=this,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!d.isValidLookup(t)){var p=d.extractFromKey(e,h),f=p.key;n=f;var y=p.namespaces;d.options.fallbackNS&&(y=y.concat(d.options.fallbackNS));var w=void 0!==h.count&&"string"!=typeof h.count,x=void 0!==h.context&&"string"==typeof h.context&&""!==h.context,j=h.lngs?h.lngs:d.languageUtils.toResolveHierarchy(h.lng||d.language,h.fallbackLng);y.forEach((function(e){d.isValidLookup(t)||(l=e,!B["".concat(j[0],"-").concat(e)]&&d.utils&&d.utils.hasLoadedNamespace&&!d.utils.hasLoadedNamespace(l)&&(B["".concat(j[0],"-").concat(e)]=!0,d.logger.warn('key "'.concat(n,'" for languages "').concat(j.join(", "),'" won\'t get resolved as namespace "').concat(l,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),j.forEach((function(n){if(!d.isValidLookup(t)){a=n;var l,p,y=f,j=[y];if(d.i18nFormat&&d.i18nFormat.addLookupKeys)d.i18nFormat.addLookupKeys(j,f,n,e,h);else w&&(l=d.pluralResolver.getSuffix(n,h.count)),w&&x&&j.push(y+l),x&&j.push(y+="".concat(d.options.contextSeparator).concat(h.context)),w&&j.push(y+=l);for(;p=j.pop();)d.isValidLookup(t)||(r=p,t=d.getResource(n,e,p,h))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:a,usedNS:l}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,"defaultValue".length)&&void 0!==e[t])return!0;return!1}}]),t}(S);function H(e){return e.charAt(0).toUpperCase()+e.slice(1)}var z=function(){function e(t){d(this,e),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=C.create("languageUtils")}return p(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=H(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=H(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=H(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(r))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),a=[],l=function(e){e&&(n.isSupportedCode(e)?a.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&l(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&l(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&l(this.getLanguagePartFromCode(e))):"string"==typeof e&&l(this.formatLanguageCode(e)),r.forEach((function(e){a.indexOf(e)<0&&l(n.formatLanguageCode(e))})),a}}]),e}(),V=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],W={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}};function K(){var e={};return V.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:W[t.fc]}}))})),e}var G=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d(this,e),this.languageUtils=t,this.options=n,this.logger=C.create("pluralResolver"),this.rules=K()}return p(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=this.getRule(e);return t&&t.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){return this.getSuffixes(e).map((function(e){return t+e}))}},{key:"getSuffixes",value:function(e){var t=this,n=this.getRule(e);return n?n.numbers.map((function(n){return t.getSuffix(e,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=this,r=this.getRule(e);if(r){var a=r.noAbs?r.plurals(t):r.plurals(Math.abs(t)),l=r.numbers[a];this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]&&(2===l?l="plural":1===l&&(l=""));var d=function(){return n.options.prepend&&l.toString()?n.options.prepend+l.toString():l.toString()};return"v1"===this.options.compatibilityJSON?1===l?"":"number"==typeof l?"_plural_".concat(l.toString()):d():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]?d():this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString()}return this.logger.warn("no plural rule found for: ".concat(e)),""}}]),e}(),Y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this.logger=C.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return p(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:L,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?D(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?D(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?D(t.nestingPrefix):t.nestingPrefixEscaped||D("$t("),this.nestingSuffix=t.nestingSuffix?D(t.nestingSuffix):t.nestingSuffixEscaped||D(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var a,l,d,h=this,p=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function f(e){return e.replace(/\$/g,"$$$$")}var y=function(e){if(e.indexOf(h.formatSeparator)<0){var a=I(t,p,e);return h.alwaysFormat?h.format(a,void 0,n):a}var l=e.split(h.formatSeparator),d=l.shift().trim(),f=l.join(h.formatSeparator).trim();return h.format(I(t,p,d),f,n,r)};this.resetRegExp();var w=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,x=r&&r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return f(e)}},{regex:this.regexp,safeValue:function(e){return h.escapeValue?f(h.escape(e)):f(e)}}].forEach((function(t){for(d=0;a=t.regex.exec(e);){if(void 0===(l=y(a[1].trim())))if("function"==typeof w){var n=w(e,a,r);l="string"==typeof n?n:""}else{if(x){l=a[0];continue}h.logger.warn("missed to pass in variable ".concat(a[1]," for interpolating ").concat(e)),l=""}else"string"==typeof l||h.useRawValueToEscape||(l=k(l));if(e=e.replace(a[0],t.safeValue(l)),t.regex.lastIndex=0,++d>=h.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,a=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=l({},d);function p(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),a="{".concat(r[1]);e=r[0],a=(a=this.interpolate(a,h)).replace(/'/g,'"');try{h=JSON.parse(a),t&&(h=l({},t,h))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(a)}return delete h.defaultValue,e}for(h.applyPostProcessor=!1,delete h.defaultValue;n=this.nestingRegexp.exec(e);){var f=[],y=!1;if(n[0].includes(this.formatSeparator)&&!/{.*}/.test(n[1])){var w=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=w.shift(),f=w,y=!0}if((r=t(p.call(this,n[1].trim(),h),h))&&n[0]===e&&"string"!=typeof r)return r;"string"!=typeof r&&(r=k(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),y&&(r=f.reduce((function(e,t){return a.format(e,t,d.lng,d)}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();var X=function(e){function t(e,n,r){var a,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return d(this,t),a=y(this,w(t).call(this)),F&&S.call(Object(f.a)(a)),a.backend=e,a.store=n,a.services=r,a.languageUtils=r.languageUtils,a.options=l,a.logger=C.create("backendConnector"),a.state={},a.queue=[],a.backend&&a.backend.init&&a.backend.init(r,l.backend,l),a}return j(t,e),p(t,[{key:"queueLoad",value:function(e,t,n,r){var a=this,l=[],d=[],h=[],p=[];return e.forEach((function(e){var r=!0;t.forEach((function(t){var h="".concat(e,"|").concat(t);!n.reload&&a.store.hasResourceBundle(e,t)?a.state[h]=2:a.state[h]<0||(1===a.state[h]?d.indexOf(h)<0&&d.push(h):(a.state[h]=1,r=!1,d.indexOf(h)<0&&d.push(h),l.indexOf(h)<0&&l.push(h),p.indexOf(t)<0&&p.push(t)))})),r||h.push(e)})),(l.length||d.length)&&this.queue.push({pending:d,loaded:{},errors:[],callback:r}),{toLoad:l,pending:d,toLoadLanguages:h,toLoadNamespaces:p}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),a=r[0],l=r[1];t&&this.emit("failedLoading",a,l,t),n&&this.store.addResourceBundle(a,l,n),this.state[e]=t?-1:2;var d={};this.queue.forEach((function(n){var r,h,p,f,y,w;r=n.loaded,h=l,f=A(r,[a],Object),y=f.obj,w=f.k,y[w]=y[w]||[],p&&(y[w]=y[w].concat(h)),p||y[w].push(h),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(n.pending,e),t&&n.errors.push(t),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(e){d[e]||(d[e]=[]),n.loaded[e].length&&n.loaded[e].forEach((function(t){d[e].indexOf(t)<0&&d[e].push(t)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",d),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,d=arguments.length>5?arguments[5]:void 0;return e.length?this.backend[n](e,t,(function(h,p){h&&p&&a<5?setTimeout((function(){r.read.call(r,e,t,n,a+1,2*l,d)}),l):d(h,p)})):d(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var l=this.queueLoad(e,t,r,a);if(!l.toLoad.length)return l.pending.length||a(),null;l.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),a=r[0],l=r[1];this.read(a,l,"read",void 0,void 0,(function(r,d){r&&t.logger.warn("".concat(n,"loading namespace ").concat(l," for language ").concat(a," failed"),r),!r&&d&&t.logger.log("".concat(n,"loaded namespace ").concat(l," for language ").concat(a),d),t.loaded(e,r,d)}))}},{key:"saveMissing",value:function(e,t,n,r,a){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,l({},d,{isUpdate:a})),e&&e[0]&&this.store.addResource(e[0],t,n,r))}}]),t}(S);function J(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===r(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===r(e[2])||"object"===r(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function Q(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Z(){}var ee=new(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(d(this,t),e=y(this,w(t).call(this)),F&&S.call(Object(f.a)(e)),e.options=Q(n),e.services={},e.logger=C,e.modules={external:[]},r&&!e.isInitialized&&!n.isClone){if(!e.options.initImmediate)return e.init(n,r),y(e,Object(f.a)(e));setTimeout((function(){e.init(n,r)}),0)}return e}return j(t,e),p(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function r(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(n=t,t={}),t.whitelist&&!t.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),t.nonExplicitWhitelist&&!t.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=l({},J(),this.options,Q(t)),this.format=this.options.interpolation.format,n||(n=Z),!this.options.isClone){this.modules.logger?C.init(r(this.modules.logger),this.options):C.init(null,this.options);var a=new z(this.options);this.store=new q(this.options.resources,this.options);var d=this.services;d.logger=C,d.resourceStore=this.store,d.languageUtils=a,d.pluralResolver=new G(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d.interpolator=new Y(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new X(r(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(d.languageDetector=r(this.modules.languageDetector),d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=r(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new U(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&"dev"!==h[0]&&(this.options.lng=h[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var p=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];p.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));var f=["addResource","addResources","addResourceBundle","removeResourceBundle"];f.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var y=_(),w=function(){var t=function(t,r){e.isInitialized&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),y.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?w():setTimeout(w,0),y}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z,r=n,a="string"==typeof e?e:this.language;if("function"==typeof e&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(a&&"cimode"===a.toLowerCase())return r();var l=[],d=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){l.indexOf(e)<0&&l.push(e)}))};if(a)d(a);else{var h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.forEach((function(e){return d(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return d(e)})),this.services.backendConnector.load(l,this.options.ns,r)}else r(null)}},{key:"reloadResources",value:function(e,t,n){var r=_();return e||(e=this.languages),t||(t=this.options.ns),n||(n=Z),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&N.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=_();this.emit("languageChanging",e);var a=function(e){var a="string"==typeof e?e:n.services.languageUtils.getBestMatchFromCodes(e);a&&(n.language||(n.language=a,n.languages=n.services.languageUtils.toResolveHierarchy(a)),n.translator.language||n.translator.changeLanguage(a),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(a)),n.loadResources(a,(function(e){!function(e,a){a?(n.language=a,n.languages=n.services.languageUtils.toResolveHierarchy(a),n.translator.changeLanguage(a),n.isLanguageChangingTo=void 0,n.emit("languageChanged",a),n.logger.log("languageChanged",a)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,a)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t){var n=this,a=function e(t,a){var d;if("object"!==r(a)){for(var h=arguments.length,p=new Array(h>2?h-2:0),f=2;f<h;f++)p[f-2]=arguments[f];d=n.options.overloadTranslationOptionHandler([t,a].concat(p))}else d=l({},a);return d.lng=d.lng||e.lng,d.lngs=d.lngs||e.lngs,d.ns=d.ns||e.ns,n.t(t,d)};return"string"==typeof e?a.lng=e:a.lngs=e,a.ns=t,a}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.languages[0],a=!!this.options&&this.options.fallbackLng,l=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var d=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var h=n.precheck(this,d);if(void 0!==h)return h}return!!this.hasResourceBundle(r,e)||(!this.services.backendConnector.backend||!(!d(r,e)||a&&!d(l,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=_();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=_();"string"==typeof e&&(e=[e]);var r=this.options.preload||[],a=e.filter((function(e){return r.indexOf(e)<0}));return a.length?(this.options.preload=r.concat(a),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new t(e,n)}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z,a=l({},this.options,n,{isClone:!0}),d=new t(a),h=["store","services","language"];return h.forEach((function(t){d[t]=e[t]})),d.services=l({},this.services),d.services.utils={hasLoadedNamespace:d.hasLoadedNamespace.bind(d)},d.translator=new U(d.services,d.options),d.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];d.emit.apply(d,[e].concat(n))})),d.init(a,r),d.translator.options=d.options,d.translator.backendConnector.services.utils={hasLoadedNamespace:d.hasLoadedNamespace.bind(d)},d}}]),t}(S)),te=n(129),ne=window.i18n.currentLangCode;ee.use(te.e).init({lng:ne,react:{useSuspense:!1,bindI18nStore:"added"},interpolation:{prefix:"__",suffix:"__",unescapeSuffix:"HTML",skipOnVariables:!0,defaultVariables:{appName:window.ExposedSettings.appName}}});var re=n(479)("./".concat(ne,".json")).then((function(e){ee.addResourceBundle(ne,"translation",e)}));t.a=re},function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"default",(function(){return I}));n(26),n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var a=n(2),l=n(1),d=n.n(l),h=n(309),p=n(1018),f=n(1028),y=n(1024),w=n(1025),x=n(1026),j=n(1030),O=n(305),C=n(86),S=n(102),_=n(20),k=n(133),E=n(0);function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e){var t=e.show,n=e.handleHide,r=Object(k.b)().email,l=Object(h.a)().t,d=Object(S.a)().signal,T=A(Object(a.useState)(),2),R=T[0],I=T[1],P=A(Object(a.useState)(),2),D=P[0],M=P[1],L=A(Object(a.useState)(!1),2),F=L[0],q=L[1],N=A(Object(a.useState)(),2),B=N[0],U=N[1],H=Object(a.useCallback)((function(e){e.preventDefault();var t=new FormData(e.target),a={message:t.get("message"),projectUrl:t.get("projectUrl"),subject:t.get("subject"),important_message:t.get("important_message"),inbox:"support"};r&&(a.email=r),q(!0),Object(_.d)("/support",{body:a,signal:d}).then((function(){n()})).catch((function(e){q(!1),U(e)}))}),[n,d,r]);return Object(E.jsxs)(C.a,{show:t,onHide:n,children:[Object(E.jsx)(p.a.Header,{closeButton:!0,children:Object(E.jsx)(p.a.Title,{children:l("contact_us")})}),Object(E.jsxs)(p.a.Body,{className:"contact-us-modal",children:[B&&Object(E.jsx)(f.a,{bsStyle:"danger",className:"row-spaced-small",children:l("generic_something_went_wrong")}),Object(E.jsxs)(y.a,{id:"contact-us-form",name:"contact-form","aria-label":"Contact Us",onSubmit:H,children:[Object(E.jsxs)(w.a,{validationState:""===R?"error":null,children:[Object(E.jsx)(x.a,{children:l("subject")}),Object(E.jsx)(j.a,{name:"subject","aria-label":"Subject",maxLength:255,onChange:function(e){return I(e.target.value)}}),Object(E.jsx)(j.a.Feedback,{})]}),Object(E.jsxs)(w.a,{children:[Object(E.jsx)(x.a,{children:"".concat(l("project_url")," (").concat(l("optional"),")")}),Object(E.jsx)(j.a,{name:"projectUrl","aria-label":"Affected Project URL Optional",defaultValue:window.location.href})]}),Object(E.jsxs)(w.a,{validationState:""===D?"error":null,children:[Object(E.jsx)(x.a,{children:l("contact_message_label")}),Object(E.jsx)(j.a,{componentClass:"textarea","aria-label":"Message",name:"message",onChange:function(e){return M(e.target.value)}}),Object(E.jsx)(j.a.Feedback,{})]}),Object(E.jsx)(w.a,{className:"hidden",children:Object(E.jsx)(j.a,{componentClass:"textarea","aria-label":"important_message",name:"important_message"})}),Object(E.jsx)(w.a,{className:"text-center",children:Object(E.jsx)(O.a,{bsStyle:"success",bsSize:"large",form:"contact-us-form",type:"submit","aria-label":"Submit",disabled:F||!R||!D,children:l("contact_us")})})]})]})]})}R.propTypes={show:d.a.bool,handleHide:d.a.func.isRequired};var I=R,P=n(1031);function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L={import:r,path:"/overleaf/services/web/modules/support/frontend/js/components/contact-us-modal"},F=null==L?void 0:L.import.default;function q(e){var t,n=e.type,r=Object(h.a)().t,l=D(Object(a.useState)(!1),2),d=l[0],p=l[1];function y(){p(!0)}return F?(t="pdf"===n?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("p",{children:r("pdf_viewer_error")}),Object(E.jsx)("p",{children:Object(E.jsx)(P.a,{i18nKey:"try_recompile_project",components:[Object(E.jsx)("a",{href:"#",onClick:y})]})})]}):"logs"===n?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("p",{children:r("log_viewer_error")}),Object(E.jsx)("p",{children:Object(E.jsx)(P.a,{i18nKey:"try_recompile_project",components:[Object(E.jsx)("a",{href:"#",onClick:y})]})})]}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("p",{children:r("pdf_preview_error")}),Object(E.jsx)("p",{children:Object(E.jsx)(P.a,{i18nKey:"try_refresh_page",components:[Object(E.jsx)("a",{href:"#",onClick:y})]})})]}),Object(E.jsxs)("div",{className:"pdf-error-alert",children:[Object(E.jsx)(f.a,{bsStyle:"danger",children:t}),Object(E.jsx)(F,{show:d,handleHide:function(){p(!1)}})]})):Object(E.jsx)("div",{className:"pdf-error-alert",children:Object(E.jsx)(f.a,{bsStyle:"danger",children:"".concat(r("generic_something_went_wrong"),". ").concat(r("please_refresh"))})})}q.propTypes={type:d.a.oneOf(["preview","pdf","logs"]).isRequired};t.a=q},,,,,,function(e,t,n){"use strict";n(11),n(12),n(4),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(7),n(17);var r=n(2);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d,h,p=!1;function f(e){document.hasFocus()||p||(d=window.document.title,window.document.title=e,p=!0,h=setInterval((function(){window.document.title===d?window.document.title=e:window.document.title=d}),800))}function y(){p&&(clearInterval(h),window.document.title=d,d=void 0,p=!1)}function w(e){p?d=e:window.document.title=e}t.a=function(){var e=a(Object(r.useState)(document.hasFocus()),2),t=e[0],n=e[1];return Object(r.useEffect)((function(){function e(){n(!0)}function t(){n(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",t),function(){window.removeEventListener("focus",e),window.removeEventListener("blur",t)}}),[]),{hasFocus:t,flashTitle:f,stopFlashingTitle:y,setTitle:w}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(220);function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object(r.a)(e,t)}},function(e){e.exports=JSON.parse('[{"category":"Greek","command":"\\\\alpha","codepoint":"U+1D6FC","description":"Lowercase Greek letter alpha","aliases":["a","α"],"notes":""},{"category":"Greek","command":"\\\\beta","codepoint":"U+1D6FD","description":"Lowercase Greek letter beta","aliases":["b","β"],"notes":""},{"category":"Greek","command":"\\\\gamma","codepoint":"U+1D6FE","description":"Lowercase Greek letter gamma","aliases":["γ"],"notes":""},{"category":"Greek","command":"\\\\delta","codepoint":"U+1D6FF","description":"Lowercase Greek letter delta","aliases":["δ"],"notes":""},{"category":"Greek","command":"\\\\varepsilon","codepoint":"U+1D700","description":"Lowercase Greek letter epsilon, varepsilon","aliases":["ε"],"notes":""},{"category":"Greek","command":"\\\\epsilon","codepoint":"U+1D716","description":"Lowercase Greek letter epsilon lunate","aliases":["ε"],"notes":""},{"category":"Greek","command":"\\\\zeta","codepoint":"U+1D701","description":"Lowercase Greek letter zeta","aliases":["ζ"],"notes":""},{"category":"Greek","command":"\\\\eta","codepoint":"U+1D702","description":"Lowercase Greek letter eta","aliases":["η"],"notes":""},{"category":"Greek","command":"\\\\vartheta","codepoint":"U+1D717","description":"Lowercase Greek letter curly theta, vartheta","aliases":["θ"],"notes":""},{"category":"Greek","command":"\\\\theta","codepoint":"U+1D703","description":"Lowercase Greek letter theta","aliases":["θ"],"notes":""},{"category":"Greek","command":"\\\\iota","codepoint":"U+1D704","description":"Lowercase Greek letter iota","aliases":["ι"],"notes":""},{"category":"Greek","command":"\\\\kappa","codepoint":"U+1D705","description":"Lowercase Greek letter kappa","aliases":["κ"],"notes":""},{"category":"Greek","command":"\\\\lambda","codepoint":"U+1D706","description":"Lowercase Greek letter lambda","aliases":["λ"],"notes":""},{"category":"Greek","command":"\\\\mu","codepoint":"U+1D707","description":"Lowercase Greek letter mu","aliases":["μ"],"notes":""},{"category":"Greek","command":"\\\\nu","codepoint":"U+1D708","description":"Lowercase Greek letter nu","aliases":["ν"],"notes":""},{"category":"Greek","command":"\\\\xi","codepoint":"U+1D709","description":"Lowercase Greek letter xi","aliases":["ξ"],"notes":""},{"category":"Greek","command":"\\\\pi","codepoint":"U+1D70B","description":"Lowercase Greek letter pi","aliases":["π"],"notes":""},{"category":"Greek","command":"\\\\varrho","codepoint":"U+1D71A","description":"Lowercase Greek letter rho, varrho","aliases":["ρ"],"notes":""},{"category":"Greek","command":"\\\\rho","codepoint":"U+1D70C","description":"Lowercase Greek letter rho","aliases":["ρ"],"notes":""},{"category":"Greek","command":"\\\\sigma","codepoint":"U+1D70E","description":"Lowercase Greek letter sigma","aliases":["σ"],"notes":""},{"category":"Greek","command":"\\\\varsigma","codepoint":"U+1D70D","description":"Lowercase Greek letter final sigma, varsigma","aliases":["ς"],"notes":""},{"category":"Greek","command":"\\\\tau","codepoint":"U+1D70F","description":"Lowercase Greek letter tau","aliases":["τ"],"notes":""},{"category":"Greek","command":"\\\\upsilon","codepoint":"U+1D710","description":"Lowercase Greek letter upsilon","aliases":["υ"],"notes":""},{"category":"Greek","command":"\\\\phi","codepoint":"U+1D719","description":"Lowercase Greek letter phi","aliases":["φ"],"notes":""},{"category":"Greek","command":"\\\\varphi","codepoint":"U+1D711","description":"Lowercase Greek letter phi, varphi","aliases":["φ"],"notes":""},{"category":"Greek","command":"\\\\chi","codepoint":"U+1D712","description":"Lowercase Greek letter chi","aliases":["χ"],"notes":""},{"category":"Greek","command":"\\\\psi","codepoint":"U+1D713","description":"Lowercase Greek letter psi","aliases":["ψ"],"notes":""},{"category":"Greek","command":"\\\\omega","codepoint":"U+1D714","description":"Lowercase Greek letter omega","aliases":["ω"],"notes":""},{"category":"Greek","command":"\\\\Gamma","codepoint":"U+00393","description":"Uppercase Greek letter Gamma","aliases":["Γ"],"notes":""},{"category":"Greek","command":"\\\\Delta","codepoint":"U+00394","description":"Uppercase Greek letter Delta","aliases":["Δ"],"notes":""},{"category":"Greek","command":"\\\\Theta","codepoint":"U+00398","description":"Uppercase Greek letter Theta","aliases":["Θ"],"notes":""},{"category":"Greek","command":"\\\\Lambda","codepoint":"U+0039B","description":"Uppercase Greek letter Lambda","aliases":["Λ"],"notes":""},{"category":"Greek","command":"\\\\Xi","codepoint":"U+0039E","description":"Uppercase Greek letter Xi","aliases":["Ξ"],"notes":""},{"category":"Greek","command":"\\\\Pi","codepoint":"U+003A0","description":"Uppercase Greek letter Pi","aliases":["Π"],"notes":"Use \\\\prod for the product."},{"category":"Greek","command":"\\\\Sigma","codepoint":"U+003A3","description":"Uppercase Greek letter Sigma","aliases":["Σ"],"notes":"Use \\\\sum for the sum."},{"category":"Greek","command":"\\\\Upsilon","codepoint":"U+003A5","description":"Uppercase Greek letter Upsilon","aliases":["Υ"],"notes":""},{"category":"Greek","command":"\\\\Phi","codepoint":"U+003A6","description":"Uppercase Greek letter Phi","aliases":["Φ"],"notes":""},{"category":"Greek","command":"\\\\Psi","codepoint":"U+003A8","description":"Uppercase Greek letter Psi","aliases":["Ψ"],"notes":""},{"category":"Greek","command":"\\\\Omega","codepoint":"U+003A9","description":"Uppercase Greek letter Omega","aliases":["Ω"],"notes":""},{"category":"Relations","command":"\\\\neq","codepoint":"U+02260","description":"Not equal","aliases":["!="],"notes":""},{"category":"Relations","command":"\\\\leq","codepoint":"U+02264","description":"Less than or equal","aliases":["<="],"notes":""},{"category":"Relations","command":"\\\\geq","codepoint":"U+02265","description":"Greater than or equal","aliases":[">="],"notes":""},{"category":"Relations","command":"\\\\ll","codepoint":"U+0226A","description":"Much less than","aliases":["<<"],"notes":""},{"category":"Relations","command":"\\\\gg","codepoint":"U+0226B","description":"Much greater than","aliases":[">>"],"notes":""},{"category":"Relations","command":"\\\\prec","codepoint":"U+0227A","description":"Precedes","notes":""},{"category":"Relations","command":"\\\\succ","codepoint":"U+0227B","description":"Succeeds","notes":""},{"category":"Relations","command":"\\\\in","codepoint":"U+02208","description":"Set membership","notes":""},{"category":"Relations","command":"\\\\notin","codepoint":"U+02209","description":"Negated set membership","notes":""},{"category":"Relations","command":"\\\\ni","codepoint":"U+0220B","description":"Contains","notes":""},{"category":"Relations","command":"\\\\subset","codepoint":"U+02282","description":"Subset","notes":""},{"category":"Relations","command":"\\\\subseteq","codepoint":"U+02286","description":"Subset or equals","notes":""},{"category":"Relations","command":"\\\\supset","codepoint":"U+02283","description":"Superset","notes":""},{"category":"Relations","command":"\\\\simeq","codepoint":"U+02243","description":"Similar","notes":""},{"category":"Relations","command":"\\\\approx","codepoint":"U+02248","description":"Approximate","notes":""},{"category":"Relations","command":"\\\\equiv","codepoint":"U+02261","description":"Identical with","notes":""},{"category":"Relations","command":"\\\\cong","codepoint":"U+02245","description":"Congruent with","notes":""},{"category":"Relations","command":"\\\\mid","codepoint":"U+02223","description":"Mid, divides, vertical bar, modulus, absolute value","notes":"Use \\\\lvert...\\\\rvert for the absolute value."},{"category":"Relations","command":"\\\\nmid","codepoint":"U+02224","description":"Negated mid, not divides","notes":"Requires \\\\usepackage{amssymb}."},{"category":"Relations","command":"\\\\parallel","codepoint":"U+02225","description":"Parallel, double vertical bar, norm","notes":"Use \\\\lVert...\\\\rVert for the norm."},{"category":"Relations","command":"\\\\perp","codepoint":"U+027C2","description":"Perpendicular","notes":""},{"category":"Operators","command":"\\\\times","codepoint":"U+000D7","description":"Cross product, multiplication","aliases":["x"],"notes":""},{"category":"Operators","command":"\\\\div","codepoint":"U+000F7","description":"Division","notes":""},{"category":"Operators","command":"\\\\cap","codepoint":"U+02229","description":"Intersection","notes":""},{"category":"Operators","command":"\\\\cup","codepoint":"U+0222A","description":"Union","notes":""},{"category":"Operators","command":"\\\\cdot","codepoint":"U+022C5","description":"Dot product, multiplication","notes":""},{"category":"Operators","command":"\\\\cdots","codepoint":"U+022EF","description":"Centered dots","notes":""},{"category":"Operators","command":"\\\\bullet","codepoint":"U+02219","description":"Bullet","notes":""},{"category":"Operators","command":"\\\\circ","codepoint":"U+025E6","description":"Circle","notes":""},{"category":"Operators","command":"\\\\wedge","codepoint":"U+02227","description":"Wedge, logical and","notes":""},{"category":"Operators","command":"\\\\vee","codepoint":"U+02228","description":"Vee, logical or","notes":""},{"category":"Operators","command":"\\\\setminus","codepoint":"U+0005C","description":"Set minus, backslash","notes":"Use \\\\backslash for a backslash."},{"category":"Operators","command":"\\\\oplus","codepoint":"U+02295","description":"Plus sign in circle","notes":""},{"category":"Operators","command":"\\\\otimes","codepoint":"U+02297","description":"Multiply sign in circle","notes":""},{"category":"Operators","command":"\\\\sum","codepoint":"U+02211","description":"Summation operator","notes":"Use \\\\Sigma for the letter Sigma."},{"category":"Operators","command":"\\\\prod","codepoint":"U+0220F","description":"Product operator","notes":"Use \\\\Pi for the letter Pi."},{"category":"Operators","command":"\\\\bigcap","codepoint":"U+022C2","description":"Intersection operator","notes":""},{"category":"Operators","command":"\\\\bigcup","codepoint":"U+022C3","description":"Union operator","notes":""},{"category":"Operators","command":"\\\\int","codepoint":"U+0222B","description":"Integral operator","notes":""},{"category":"Operators","command":"\\\\iint","codepoint":"U+0222C","description":"Double integral operator","notes":"Requires \\\\usepackage{amsmath}."},{"category":"Operators","command":"\\\\iiint","codepoint":"U+0222D","description":"Triple integral operator","notes":"Requires \\\\usepackage{amsmath}."},{"category":"Arrows","command":"\\\\leftarrow","codepoint":"U+02190","description":"Leftward arrow","aliases":["<-"],"notes":""},{"category":"Arrows","command":"\\\\rightarrow","codepoint":"U+02192","description":"Rightward arrow","aliases":["->"],"notes":""},{"category":"Arrows","command":"\\\\leftrightarrow","codepoint":"U+02194","description":"Left and right arrow","aliases":["<->"],"notes":""},{"category":"Arrows","command":"\\\\uparrow","codepoint":"U+02191","description":"Upward arrow","notes":""},{"category":"Arrows","command":"\\\\downarrow","codepoint":"U+02193","description":"Downward arrow","notes":""},{"category":"Arrows","command":"\\\\Leftarrow","codepoint":"U+021D0","description":"Is implied by","aliases":["<="],"notes":""},{"category":"Arrows","command":"\\\\Rightarrow","codepoint":"U+021D2","description":"Implies","aliases":["=>"],"notes":""},{"category":"Arrows","command":"\\\\Leftrightarrow","codepoint":"U+021D4","description":"Left and right double arrow","aliases":["<=>"],"notes":""},{"category":"Arrows","command":"\\\\mapsto","codepoint":"U+021A6","description":"Maps to, rightward","notes":""},{"category":"Arrows","command":"\\\\nearrow","codepoint":"U+02197","description":"NE pointing arrow","notes":""},{"category":"Arrows","command":"\\\\searrow","codepoint":"U+02198","description":"SE pointing arrow","notes":""},{"category":"Arrows","command":"\\\\rightleftharpoons","codepoint":"U+021CC","description":"Right harpoon over left","notes":""},{"category":"Arrows","command":"\\\\leftharpoonup","codepoint":"U+021BC","description":"Left harpoon up","notes":""},{"category":"Arrows","command":"\\\\rightharpoonup","codepoint":"U+021C0","description":"Right harpoon up","notes":""},{"category":"Arrows","command":"\\\\leftharpoondown","codepoint":"U+021BD","description":"Left harpoon down","notes":""},{"category":"Arrows","command":"\\\\rightharpoondown","codepoint":"U+021C1","description":"Right harpoon down","notes":""},{"category":"Misc","command":"\\\\infty","codepoint":"U+0221E","description":"Infinity","notes":""},{"category":"Misc","command":"\\\\partial","codepoint":"U+1D715","description":"Partial differential","notes":""},{"category":"Misc","command":"\\\\nabla","codepoint":"U+02207","description":"Nabla, del, hamilton operator","notes":""},{"category":"Misc","command":"\\\\varnothing","codepoint":"U+02300","description":"Empty set","notes":"Requires \\\\usepackage{amssymb}."},{"category":"Misc","command":"\\\\forall","codepoint":"U+02200","description":"For all","notes":""},{"category":"Misc","command":"\\\\exists","codepoint":"U+02203","description":"There exists","notes":""},{"category":"Misc","command":"\\\\neg","codepoint":"U+000AC","description":"Not sign","notes":""},{"category":"Misc","command":"\\\\Re","codepoint":"U+0211C","description":"Real part","notes":""},{"category":"Misc","command":"\\\\Im","codepoint":"U+02111","description":"Imaginary part","notes":""},{"category":"Misc","command":"\\\\Box","codepoint":"U+025A1","description":"Square","notes":"Requires \\\\usepackage{amssymb}."},{"category":"Misc","command":"\\\\triangle","codepoint":"U+025B3","description":"Triangle","notes":""},{"category":"Misc","command":"\\\\aleph","codepoint":"U+02135","description":"Hebrew letter aleph","notes":""},{"category":"Misc","command":"\\\\wp","codepoint":"U+02118","description":"Weierstrass letter p","notes":""},{"category":"Misc","command":"\\\\#","codepoint":"U+00023","description":"Number sign, hashtag","notes":""},{"category":"Misc","command":"\\\\$","codepoint":"U+00024","description":"Dollar sign","notes":""},{"category":"Misc","command":"\\\\%","codepoint":"U+00025","description":"Percent sign","notes":""},{"category":"Misc","command":"\\\\&","codepoint":"U+00026","description":"Et sign, and, ampersand","notes":""},{"category":"Misc","command":"\\\\{","codepoint":"U+0007B","description":"Left curly brace","notes":""},{"category":"Misc","command":"\\\\}","codepoint":"U+0007D","description":"Right curly brace","notes":""},{"category":"Misc","command":"\\\\langle","codepoint":"U+027E8","description":"Left angle bracket, bra","notes":""},{"category":"Misc","command":"\\\\rangle","codepoint":"U+027E9","description":"Right angle bracket, ket","notes":""}]')},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function a(e,t){Object(r.useEffect)((function(){return window.addEventListener(e,t),function(){window.removeEventListener(e,t)}}),[e,t])}},,function(e,t,n){var r=n(252);function a(){return e.exports=a=r||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,a.apply(this,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},,,,,,,,,,,,,,,,,function(e,t){var n=angular.module("autocomplete",[]);n.directive("autocomplete",(function(){var e=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect"},controller:["$scope",function(e){e.selectedIndex=-1,e.setIndex=function(t){e.selectedIndex=parseInt(t)},this.setIndex=function(t){e.setIndex(t),e.$apply()},e.getIndex=function(t){return e.selectedIndex};var t=!0;e.completing=!1,e.$watch("searchParam",(function(n,r){r!==n&&(t&&e.searchParam&&(e.completing=!0,e.searchFilter=e.searchParam,e.selectedIndex=-1),e.onType&&e.onType(e.searchParam))})),this.preSelect=function(n){t=!1,e.$apply(),t=!0},e.preSelect=this.preSelect,this.preSelectOff=function(){t=!0},e.preSelectOff=this.preSelectOff,e.select=function(n){n&&(e.searchParam=n,e.searchFilter=n,e.onSelect&&e.onSelect(n)),t=!1,e.completing=!1,setTimeout((function(){t=!0}),1e3),e.setIndex(-1)}}],link:function(t,n,r){var a="";for(var l in t.attrs={placeholder:"start typing...",class:"",id:"",inputclass:"",inputid:""},r)a=l.replace("attr","").toLowerCase(),0===l.indexOf("attr")&&(t.attrs[a]=r[l]);r.clickActivation&&(n[0].onclick=function(e){t.searchParam||(t.completing=!0,t.$apply())});var d=37,h=38,p=39,f=40,y=13,w=27;document.addEventListener("keydown",(function(e){switch(e.keyCode||e.which){case w:t.select(),t.setIndex(-1),t.$apply(),e.preventDefault()}}),!0),document.addEventListener("blur",(function(e){setTimeout((function(){t.select(),t.setIndex(-1),t.$apply()}),200)}),!0),n[0].addEventListener("keydown",(function(n){var r=n.keyCode||n.which,a=angular.element(this).find("li").length;switch(r){case h:if((e=t.getIndex()-1)<-1)e=a-1;else if(e>=a){e=-1,t.setIndex(e),t.preSelectOff();break}t.setIndex(e),-1!==e&&t.preSelect(angular.element(angular.element(this).find("li")[e]).text()),t.$apply();break;case f:if((e=t.getIndex()+1)<-1)e=a-1;else if(e>=a){e=-1,t.setIndex(e),t.preSelectOff(),t.$apply();break}t.setIndex(e),-1!==e&&t.preSelect(angular.element(angular.element(this).find("li")[e]).text());break;case d:break;case p:case y:-1!==(e=t.getIndex())&&t.select(angular.element(angular.element(this).find("li")[e]).text()),t.setIndex(-1),t.$apply();break;case w:t.select(),t.setIndex(-1),t.$apply(),n.preventDefault();break;default:return}-1===t.getIndex()&&r!=y||n.preventDefault()}))},templateUrl:"js/libs/angular-autocomplete/ac_template.html"}})),n.filter("highlight",["$sce",function(e){return function(t,n){if("function"==typeof t)return"";if(n){var r="("+n.split(/\ /).join(" |")+"|"+n.split(/\ /).join("|")+")",a=new RegExp(r,"gi");r.length&&(t=t.replace(a,'<span class="highlight">$1</span>'))}return e.trustAsHtml(t)}}]),n.directive("suggestion",(function(){return{restrict:"A",require:"^autocomplete",link:function(e,t,n,r){t.bind("mouseenter",(function(){r.preSelect(n.val),r.setIndex(n.index)})),t.bind("mouseleave",(function(){r.preSelectOff()}))}}}))},function(e,t){angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.transition","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-popup.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/tooltip/tooltip-template-popup.html","template/popover/popover-template.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.collapse",[]).directive("collapse",["$animate",function(e){return{link:function(t,n,r){function a(){n.removeClass("collapse").addClass("collapsing"),e.addClass(n,"in",{to:{height:n[0].scrollHeight+"px"}}).then(l)}function l(){n.removeClass("collapsing"),n.css({height:"auto"})}function d(){n.css({height:n[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing"),e.removeClass(n,"in",{to:{height:"0"}}).then(h)}function h(){n.css({height:"0"}),n.removeClass("collapsing"),n.addClass("collapse")}t.$watch(r.collapse,(function(e){e?d():a()}))}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(r){(angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers)&&angular.forEach(this.groups,(function(e){e!==r&&(e.isOpen=!1)}))},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",(function(){t.removeGroup(e)}))},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("accordion",(function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}})).directive("accordionGroup",(function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,r){r.addGroup(e),e.$watch("isOpen",(function(t){t&&r.closeOthers(e)})),e.toggleOpen=function(){e.isDisabled||(e.isOpen=!e.isOpen)}}}})).directive("accordionHeading",(function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(e,t,n,r,a){r.setHeading(a(e,angular.noop))}}})).directive("accordionTransclude",(function(){return{require:"^accordionGroup",link:function(e,t,n,r){e.$watch((function(){return r[n.accordionTransclude]}),(function(e){e&&(t.html(""),t.append(e))}))}}})),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(e,t){e.closeable="close"in t,this.close=e.close}]).directive("alert",(function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}})).directive("dismissOnTimeout",["$timeout",function(e){return{require:"alert",link:function(t,n,r,a){e((function(){a.close()}),parseInt(r.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",(function(){return function(e,t,n){t.addClass("ng-binding").data("$binding",n.bindHtmlUnsafe),e.$watch(n.bindHtmlUnsafe,(function(e){t.html(e||"")}))}})),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",(function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,t,n,r){var a=r[0],l=r[1];l.$render=function(){t.toggleClass(a.activeClass,angular.equals(l.$modelValue,e.$eval(n.btnRadio)))},t.bind(a.toggleEvent,(function(){var r=t.hasClass(a.activeClass);(!r||angular.isDefined(n.uncheckable))&&e.$apply((function(){l.$setViewValue(r?null:e.$eval(n.btnRadio)),l.$render()}))}))}}})).directive("btnCheckbox",(function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,t,n,r){function a(){return l(n.btnCheckboxTrue,!0)}function l(t,n){var r=e.$eval(t);return angular.isDefined(r)?r:n}var d=r[0],h=r[1];h.$render=function(){t.toggleClass(d.activeClass,angular.equals(h.$modelValue,a()))},t.bind(d.toggleEvent,(function(){e.$apply((function(){h.$setViewValue(t.hasClass(d.activeClass)?l(n.btnCheckboxFalse,!1):a()),h.$render()}))}))}}})),angular.module("ui.bootstrap.carousel",[]).controller("CarouselController",["$scope","$interval","$animate",function(e,t,n){function r(e){if(angular.isUndefined(y[e].index))return y[e];var t;for(y.length,t=0;t<y.length;++t)if(y[t].index==e)return y[t]}function a(){l();var n=+e.interval;!isNaN(n)&&n>0&&(h=t(d,n))}function l(){h&&(t.cancel(h),h=null)}function d(){var t=+e.interval;p&&!isNaN(t)&&t>0?e.next():e.pause()}var h,p,f=this,y=f.slides=e.slides=[],w=-1;f.currentSlide=null;var x=!1;f.select=e.select=function(t,r){var l=f.indexOfSlide(t);void 0===r&&(r=l>f.getCurrentIndex()?"next":"prev"),t&&t!==f.currentSlide&&(x||(angular.extend(t,{direction:r,active:!0}),angular.extend(f.currentSlide||{},{direction:r,active:!1}),n.enabled()&&!e.noTransition&&t.$element&&(e.$currentTransition=!0,t.$element.one("$animate:close",(function(){e.$currentTransition=null}))),f.currentSlide=t,w=l,a()))},e.$on("$destroy",(function(){x=!0})),f.getCurrentIndex=function(){return f.currentSlide&&angular.isDefined(f.currentSlide.index)?+f.currentSlide.index:w},f.indexOfSlide=function(e){return angular.isDefined(e.index)?+e.index:y.indexOf(e)},e.next=function(){var t=(f.getCurrentIndex()+1)%y.length;return e.$currentTransition?void 0:f.select(r(t),"next")},e.prev=function(){var t=f.getCurrentIndex()-1<0?y.length-1:f.getCurrentIndex()-1;return e.$currentTransition?void 0:f.select(r(t),"prev")},e.isActive=function(e){return f.currentSlide===e},e.$watch("interval",a),e.$on("$destroy",l),e.play=function(){p||(p=!0,a())},e.pause=function(){e.noPause||(p=!1,l())},f.addSlide=function(t,n){t.$element=n,y.push(t),1===y.length||t.active?(f.select(y[y.length-1]),1==y.length&&e.play()):t.active=!1},f.removeSlide=function(e){angular.isDefined(e.index)&&y.sort((function(e,t){return+e.index>+t.index}));var t=y.indexOf(e);y.splice(t,1),y.length>0&&e.active?f.select(t>=y.length?y[t-1]:y[t]):w>t&&w--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",(function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?",index:"=?"},link:function(e,t,n,r){r.addSlide(e,t),e.$on("$destroy",(function(){r.removeSlide(e)})),e.$watch("active",(function(t){t&&r.select(e)}))}}})).animation(".item",["$animate",function(e){return{beforeAddClass:function(t,n,r){if("active"==n&&t.parent()&&!t.parent().scope().noTransition){var a=!1,l=t.isolateScope().direction,d="next"==l?"left":"right";return t.addClass(l),e.addClass(t,d).then((function(){a||t.removeClass(d+" "+l),r()})),function(){a=!0}}r()},beforeRemoveClass:function(t,n,r){if("active"==n&&t.parent()&&!t.parent().scope().noTransition){var a=!1,l="next"==t.isolateScope().direction?"left":"right";return e.addClass(t,l).then((function(){a||t.removeClass(l),r()})),function(){a=!0}}r()}}}]),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],r=e.split("");return angular.forEach(a,(function(t,a){var l=e.indexOf(a);if(l>-1){e=e.split(""),r[l]="("+t.regex+")",e[l]="$";for(var d=l+1,h=l+a.length;h>d;d++)r[d]="",e[d]="$";e=e.join(""),n.push({index:l,apply:t.apply})}})),{regex:new RegExp("^"+r.join("")+"$"),map:t(n,"index")}}var r=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;this.parsers={};var a={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")},HH:{regex:"(?:0|1)[0-9]|2[0-3]",apply:function(e){this.hours=+e}},H:{regex:"1?[0-9]|2[0-3]",apply:function(e){this.hours=+e}},mm:{regex:"[0-5][0-9]",apply:function(e){this.minutes=+e}},m:{regex:"[0-9]|[1-5][0-9]",apply:function(e){this.minutes=+e}},sss:{regex:"[0-9][0-9][0-9]",apply:function(e){this.milliseconds=+e}},ss:{regex:"[0-5][0-9]",apply:function(e){this.seconds=+e}},s:{regex:"[0-9]|[1-5][0-9]",apply:function(e){this.seconds=+e}}};this.parse=function(t,a,l){if(!angular.isString(t)||!a)return t;a=(a=e.DATETIME_FORMATS[a]||a).replace(r,"\\$&"),this.parsers[a]||(this.parsers[a]=n(a));var d=this.parsers[a],h=d.regex,p=d.map,f=t.match(h);if(f&&f.length){var y,w;y=l?{year:l.getFullYear(),month:l.getMonth(),date:l.getDate(),hours:l.getHours(),minutes:l.getMinutes(),seconds:l.getSeconds(),milliseconds:l.getMilliseconds()}:{year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0};for(var x=1,j=f.length;j>x;x++){var O=p[x-1];O.apply&&O.apply.call(y,f[x])}return function(e,t,n){return!(1>n)&&(1===t&&n>28?29===n&&(e%4==0&&e%100!=0||e%400==0):3!==t&&5!==t&&8!==t&&10!==t||31>n)}(y.year,y.month,y.date)&&(w=new Date(y.year,y.month,y.date,y.hours,y.minutes,y.seconds,y.milliseconds||0)),w}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(e,t){function n(e){return"static"===(function(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}(e,"position")||"static")}var r=function(t){for(var r=e[0],a=t.offsetParent||r;a&&a!==r&&n(a);)a=a.offsetParent;return a||r};return{position:function(t){var n=this.offset(t),a={top:0,left:0},l=r(t[0]);l!=e[0]&&((a=this.offset(angular.element(l))).top+=l.clientTop-l.scrollTop,a.left+=l.clientLeft-l.scrollLeft);var d=t[0].getBoundingClientRect();return{width:d.width||t.prop("offsetWidth"),height:d.height||t.prop("offsetHeight"),top:n.top-a.top,left:n.left-a.left}},offset:function(n){var r=n[0].getBoundingClientRect();return{width:r.width||n.prop("offsetWidth"),height:r.height||n.prop("offsetHeight"),top:r.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:r.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,r){var a,l,d,h,p=n.split("-"),f=p[0],y=p[1]||"center";a=r?this.offset(e):this.position(e),l=t.prop("offsetWidth"),d=t.prop("offsetHeight");var w={center:function(){return a.left+a.width/2-l/2},left:function(){return a.left},right:function(){return a.left+a.width}},x={center:function(){return a.top+a.height/2-d/2},top:function(){return a.top},bottom:function(){return a.top+a.height}};switch(f){case"right":h={top:x[y](),left:w[f]()};break;case"left":h={top:x[y](),left:a.left-l};break;case"bottom":h={top:x[f](),left:w[y]()};break;default:h={top:a.top-d,left:w[y]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null,shortcutPropagation:!1}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(e,t,n,r,a,l,d,h){var p=this,f={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange","shortcutPropagation"],(function(n,a){p[n]=angular.isDefined(t[n])?8>a?r(t[n])(e.$parent):e.$parent.$eval(t[n]):h[n]})),angular.forEach(["minDate","maxDate"],(function(r){t[r]?e.$parent.$watch(n(t[r]),(function(e){p[r]=e?new Date(e):null,p.refreshView()})):p[r]=h[r]?new Date(h[r]):null})),e.datepickerMode=e.datepickerMode||h.datepickerMode,e.maxMode=p.maxMode,e.uniqueId="datepicker-"+e.$id+"-"+Math.floor(1e4*Math.random()),angular.isDefined(t.initDate)?(this.activeDate=e.$parent.$eval(t.initDate)||new Date,e.$parent.$watch(t.initDate,(function(e){e&&(f.$isEmpty(f.$modelValue)||f.$invalid)&&(p.activeDate=e,p.refreshView())}))):this.activeDate=new Date,e.isActive=function(t){return 0===p.compare(t.date,p.activeDate)&&(e.activeDateId=t.uid,!0)},this.init=function(e){(f=e).$render=function(){p.render()}},this.render=function(){if(f.$viewValue){var e=new Date(f.$viewValue),t=!isNaN(e);t?this.activeDate=e:l.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),f.$setValidity("date",t)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var e=f.$viewValue?new Date(f.$viewValue):null;f.$setValidity("date-disabled",!e||this.element&&!this.isDisabled(e))}},this.createDateObject=function(e,t){var n=f.$viewValue?new Date(f.$viewValue):null;return{date:e,label:d(e,t),selected:n&&0===this.compare(e,n),disabled:this.isDisabled(e),current:0===this.compare(e,new Date),customClass:this.customClass(e)}},this.isDisabled=function(n){return this.minDate&&this.compare(n,this.minDate)<0||this.maxDate&&this.compare(n,this.maxDate)>0||t.dateDisabled&&e.dateDisabled({date:n,mode:e.datepickerMode})},this.customClass=function(t){return e.customClass({date:t,mode:e.datepickerMode})},this.split=function(e,t){for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.select=function(t){if(e.datepickerMode===p.minMode){var n=f.$viewValue?new Date(f.$viewValue):new Date(0,0,0,0,0,0,0);n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),f.$setViewValue(n),f.$render()}else p.activeDate=t,e.datepickerMode=p.modes[p.modes.indexOf(e.datepickerMode)-1]},e.move=function(e){var t=p.activeDate.getFullYear()+e*(p.step.years||0),n=p.activeDate.getMonth()+e*(p.step.months||0);p.activeDate.setFullYear(t,n,1),p.refreshView()},e.toggleMode=function(t){t=t||1,e.datepickerMode===p.maxMode&&1===t||e.datepickerMode===p.minMode&&-1===t||(e.datepickerMode=p.modes[p.modes.indexOf(e.datepickerMode)+t])},e.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var y=function(){a((function(){p.element[0].focus()}),0,!1)};e.$on("datepicker.focus",y),e.keydown=function(t){var n=e.keys[t.which];if(n&&!t.shiftKey&&!t.altKey)if(t.preventDefault(),p.shortcutPropagation||t.stopPropagation(),"enter"===n||"space"===n){if(p.isDisabled(p.activeDate))return;e.select(p.activeDate),y()}else!t.ctrlKey||"up"!==n&&"down"!==n?(p.handleKeyDown(n,t),p.refreshView()):(e.toggleMode("up"===n?1:-1),y())}}]).directive("datepicker",(function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&",customClass:"&",shortcutPropagation:"&?"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(e,t,n,r){var a=r[0],l=r[1];l&&a.init(l)}}})).directive("daypicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(t,n,r,a){function l(e,t){return 1!==t||e%4!=0||e%100==0&&e%400!=0?h[t]:29}function d(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}t.showWeeks=a.showWeeks,a.step={months:1},a.element=n;var h=[31,28,31,30,31,30,31,31,30,31,30,31];a._refreshView=function(){var n=a.activeDate.getFullYear(),r=a.activeDate.getMonth(),l=new Date(n,r,1),h=a.startingDay-l.getDay(),p=h>0?7-h:-h,f=new Date(l);p>0&&f.setDate(1-p);for(var y=function(e,t){var n=new Array(t),r=new Date(e),a=0;for(r.setHours(12);t>a;)n[a++]=new Date(r),r.setDate(r.getDate()+1);return n}(f,42),w=0;42>w;w++)y[w]=angular.extend(a.createDateObject(y[w],a.formatDay),{secondary:y[w].getMonth()!==r,uid:t.uniqueId+"-"+w});t.labels=new Array(7);for(var x=0;7>x;x++)t.labels[x]={abbr:e(y[x].date,a.formatDayHeader),full:e(y[x].date,"EEEE")};if(t.title=e(a.activeDate,a.formatDayTitle),t.rows=a.split(y,7),t.showWeeks){t.weekNumbers=[];for(var j=(11-a.startingDay)%7,O=t.rows.length,C=0;O>C;C++)t.weekNumbers.push(d(t.rows[C][j].date))}},a.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},a.handleKeyDown=function(e){var t=a.activeDate.getDate();if("left"===e)t-=1;else if("up"===e)t-=7;else if("right"===e)t+=1;else if("down"===e)t+=7;else if("pageup"===e||"pagedown"===e){var n=a.activeDate.getMonth()+("pageup"===e?-1:1);a.activeDate.setMonth(n,1),t=Math.min(l(a.activeDate.getFullYear(),a.activeDate.getMonth()),t)}else"home"===e?t=1:"end"===e&&(t=l(a.activeDate.getFullYear(),a.activeDate.getMonth()));a.activeDate.setDate(t)},a.refreshView()}}}]).directive("monthpicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(t,n,r,a){a.step={years:1},a.element=n,a._refreshView=function(){for(var n=new Array(12),r=a.activeDate.getFullYear(),l=0;12>l;l++)n[l]=angular.extend(a.createDateObject(new Date(r,l,1),a.formatMonth),{uid:t.uniqueId+"-"+l});t.title=e(a.activeDate,a.formatMonthTitle),t.rows=a.split(n,3)},a.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth())-new Date(t.getFullYear(),t.getMonth())},a.handleKeyDown=function(e){var t=a.activeDate.getMonth();if("left"===e)t-=1;else if("up"===e)t-=3;else if("right"===e)t+=1;else if("down"===e)t+=3;else if("pageup"===e||"pagedown"===e){var n=a.activeDate.getFullYear()+("pageup"===e?-1:1);a.activeDate.setFullYear(n)}else"home"===e?t=0:"end"===e&&(t=11);a.activeDate.setMonth(t)},a.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(e,t,n,r){function a(e){return parseInt((e-1)/l,10)*l+1}var l=r.yearRange;r.step={years:l},r.element=t,r._refreshView=function(){for(var t=new Array(l),n=0,d=a(r.activeDate.getFullYear());l>n;n++)t[n]=angular.extend(r.createDateObject(new Date(d+n,0,1),r.formatYear),{uid:e.uniqueId+"-"+n});e.title=[t[0].label,t[l-1].label].join(" - "),e.rows=r.split(t,5)},r.compare=function(e,t){return e.getFullYear()-t.getFullYear()},r.handleKeyDown=function(e){var t=r.activeDate.getFullYear();"left"===e?t-=1:"up"===e?t-=5:"right"===e?t+=1:"down"===e?t+=5:"pageup"===e||"pagedown"===e?t+=("pageup"===e?-1:1)*r.step.years:"home"===e?t=a(r.activeDate.getFullYear()):"end"===e&&(t=a(r.activeDate.getFullYear())+l-1),r.activeDate.setFullYear(t)},r.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(e,t,n,r,a,l,d){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&",customClass:"&"},link:function(h,p,f,y){function w(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}var x,j=angular.isDefined(f.closeOnDateSelection)?h.$parent.$eval(f.closeOnDateSelection):d.closeOnDateSelection,O=angular.isDefined(f.datepickerAppendToBody)?h.$parent.$eval(f.datepickerAppendToBody):d.appendToBody;h.showButtonBar=angular.isDefined(f.showButtonBar)?h.$parent.$eval(f.showButtonBar):d.showButtonBar,h.getText=function(e){return h[e+"Text"]||d[e+"Text"]};var C=!1;if(d.html5Types[f.type]?(x=d.html5Types[f.type],C=!0):(x=f.datepickerPopup||d.datepickerPopup,f.$observe("datepickerPopup",(function(e){var t=e||d.datepickerPopup;if(t!==x&&(x=t,y.$modelValue=null,!x))throw new Error("datepickerPopup must have a date format specified.")}))),!x)throw new Error("datepickerPopup must have a date format specified.");if(C&&f.datepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");var S=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");S.attr({"ng-model":"date","ng-change":"dateSelection()"});var _=angular.element(S.children()[0]);if(C&&"month"==f.type&&(_.attr("datepicker-mode",'"month"'),_.attr("min-mode","month")),f.datepickerOptions){var k=h.$parent.$eval(f.datepickerOptions);k.initDate&&(h.initDate=k.initDate,_.attr("init-date","initDate"),delete k.initDate),angular.forEach(k,(function(e,t){_.attr(w(t),e)}))}h.watchData={},angular.forEach(["minDate","maxDate","datepickerMode","initDate","shortcutPropagation"],(function(e){if(f[e]){var n=t(f[e]);if(h.$parent.$watch(n,(function(t){h.watchData[e]=t})),_.attr(w(e),"watchData."+e),"datepickerMode"===e){var r=n.assign;h.$watch("watchData."+e,(function(e,t){e!==t&&r(h.$parent,e)}))}}})),f.dateDisabled&&_.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),f.showWeeks&&_.attr("show-weeks",f.showWeeks),f.customClass&&_.attr("custom-class","customClass({ date: date, mode: mode })"),C?y.$formatters.push((function(e){return h.date=e,e})):(y.$$parserName="date",y.$validators.date=function(e,t){var n=e||t;if(angular.isNumber(n)&&(n=new Date(n)),n){if(angular.isDate(n)&&!isNaN(n))return!0;if(angular.isString(n)){var r=l.parse(n,x)||new Date(n);return!isNaN(r)}return!1}return!0},y.$parsers.unshift((function(e){if(angular.isNumber(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=l.parse(e,x,h.date)||new Date(e);return isNaN(t)?void 0:t}})),y.$formatters.push((function(e){return h.date=e,y.$isEmpty(e)?e:a(e,x)}))),h.dateSelection=function(e){angular.isDefined(e)&&(h.date=e);var t=h.date?a(h.date,x):"";p.val(t),y.$setViewValue(t),j&&(h.isOpen=!1,p[0].focus())},y.$viewChangeListeners.push((function(){h.date=l.parse(y.$viewValue,x,h.date)||new Date(y.$viewValue)}));var E=function(e){h.isOpen&&e.target!==p[0]&&h.$apply((function(){h.isOpen=!1}))},A=function(e){h.keydown(e)};p.bind("keydown",A),h.keydown=function(e){27===e.which?(e.preventDefault(),h.isOpen&&e.stopPropagation(),h.close()):40!==e.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",(function(e){e?(h.$broadcast("datepicker.focus"),h.position=O?r.offset(p):r.position(p),h.position.top=h.position.top+p.prop("offsetHeight"),n.bind("click",E)):n.unbind("click",E)})),h.select=function(e){if("today"===e){var t=new Date;angular.isDate(h.date)?(e=new Date(h.date)).setFullYear(t.getFullYear(),t.getMonth(),t.getDate()):e=new Date(t.setHours(0,0,0,0))}h.dateSelection(e)},h.close=function(){h.isOpen=!1,p[0].focus()};var T=e(S)(h);S.remove(),O?n.find("body").append(T):p.after(T),h.$on("$destroy",(function(){T.remove(),p.unbind("keydown",A),n.unbind("click",E)}))}}}]).directive("datepickerPopupWrap",(function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(e,t){t.bind("click",(function(e){e.preventDefault(),e.stopPropagation()}))}}})),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.position"]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document","$rootScope",function(e,t){var n=null;this.open=function(t){n||(e.bind("click",r),e.bind("keydown",a)),n&&n!==t&&(n.isOpen=!1),n=t},this.close=function(t){n===t&&(n=null,e.unbind("click",r),e.unbind("keydown",a))};var r=function(e){if(n&&(!e||"disabled"!==n.getAutoClose())){var r=n.getToggleElement();if(!(e&&r&&r[0].contains(e.target))){var a=n.getElement();e&&"outsideClick"===n.getAutoClose()&&a&&a[0].contains(e.target)||(n.isOpen=!1,t.$$phase||n.$apply())}}},a=function(e){27===e.which&&(n.focusToggleElement(),r())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate","$position","$document",function(e,t,n,r,a,l,d,h){var p,f=this,y=e.$new(),w=r.openClass,x=angular.noop,j=t.onToggle?n(t.onToggle):angular.noop,O=!1;this.init=function(r){f.$element=r,t.isOpen&&(p=n(t.isOpen),x=p.assign,e.$watch(p,(function(e){y.isOpen=!!e}))),(O=angular.isDefined(t.dropdownAppendToBody))&&f.dropdownMenu&&(h.find("body").append(f.dropdownMenu),r.on("$destroy",(function(){f.dropdownMenu.remove()})))},this.toggle=function(e){return y.isOpen=arguments.length?!!e:!y.isOpen},this.isOpen=function(){return y.isOpen},y.getToggleElement=function(){return f.toggleElement},y.getAutoClose=function(){return t.autoClose||"always"},y.getElement=function(){return f.$element},y.focusToggleElement=function(){f.toggleElement&&f.toggleElement[0].focus()},y.$watch("isOpen",(function(t,n){if(O&&f.dropdownMenu){var r=d.positionElements(f.$element,f.dropdownMenu,"bottom-left",!0);f.dropdownMenu.css({top:r.top+"px",left:r.left+"px",display:t?"block":"none"})}l[t?"addClass":"removeClass"](f.$element,w),t?(y.focusToggleElement(),a.open(y)):a.close(y),x(e,t),angular.isDefined(t)&&t!==n&&j(e,{open:!!t})})),e.$on("$locationChangeSuccess",(function(){y.isOpen=!1})),e.$on("$destroy",(function(){y.$destroy()}))}]).directive("dropdown",(function(){return{controller:"DropdownController",link:function(e,t,n,r){r.init(t)}}})).directive("dropdownMenu",(function(){return{restrict:"AC",require:"?^dropdown",link:function(e,t,n,r){r&&(r.dropdownMenu=t)}}})).directive("dropdownToggle",(function(){return{require:"?^dropdown",link:function(e,t,n,r){if(r){r.toggleElement=t;var a=function(a){a.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply((function(){r.toggle()}))};t.bind("click",a),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(r.isOpen,(function(e){t.attr("aria-expanded",!!e)})),e.$on("$destroy",(function(){t.unbind("click",a)}))}}}})),angular.module("ui.bootstrap.modal",[]).factory("$$stackedMap",(function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,r=0;r<e.length;r++)if(t==e[r].key){n=r;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}})).directive("modalBackdrop",["$timeout",function(e){function t(t){t.animate=!1,e((function(){t.animate=!0}))}return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",compile:function(e,n){return e.addClass(n.backdropClass),t}}}]).directive("modalWindow",["$modalStack","$q",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"template/modal/window.html"},link:function(n,r,a){r.addClass(a.windowClass||""),n.size=a.size,n.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!=n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))},n.$isRendered=!0;var l=t.defer();a.$observe("modalRender",(function(e){"true"==e&&l.resolve()})),l.promise.then((function(){n.animate=!0;var t=r[0].querySelectorAll("[autofocus]");t.length?t[0].focus():r[0].focus();var a=e.getTop();a&&e.modalRendered(a.key)}))}}}]).directive("modalAnimationClass",[function(){return{compile:function(e,t){t.modalAnimation&&e.addClass(t.modalAnimationClass)}}}]).directive("modalTransclude",(function(){return{link:function(e,t,n,r,a){a(e.$parent,(function(e){t.empty(),t.append(e)}))}}})).factory("$modalStack",["$animate","$timeout","$document","$compile","$rootScope","$$stackedMap",function(e,t,n,r,a,l){function d(){for(var e=-1,t=j.keys(),n=0;n<t.length;n++)j.get(t[n]).value.backdrop&&(e=n);return e}function h(e){var t=n.find("body").eq(0),r=j.get(e).value;j.remove(e),p(r.modalDomEl,r.modalScope,(function(){t.toggleClass(x,j.length()>0),function(){if(y&&-1==d()){p(y,w,(function(){null})),y=void 0,w=void 0}}()}))}function p(n,r,l){function d(){d.done||(d.done=!0,n.remove(),r.$destroy(),l&&l())}r.animate=!1,n.attr("modal-animation")&&e.enabled()?n.one("$animate:close",(function(){a.$evalAsync(d)})):t(d)}function f(e,t,n){return!e.value.modalScope.$broadcast("modal.closing",t,n).defaultPrevented}var y,w,x="modal-open",j=l.createNew(),O={};return a.$watch(d,(function(e){w&&(w.index=e)})),n.bind("keydown",(function(e){var t;27===e.which&&((t=j.top())&&t.value.keyboard&&(e.preventDefault(),a.$apply((function(){O.dismiss(t.key,"escape key press")}))))})),O.open=function(e,t){var l=n[0].activeElement;j.add(e,{deferred:t.deferred,renderDeferred:t.renderDeferred,modalScope:t.scope,backdrop:t.backdrop,keyboard:t.keyboard});var h=n.find("body").eq(0),p=d();if(p>=0&&!y){(w=a.$new(!0)).index=p;var f=angular.element('<div modal-backdrop="modal-backdrop"></div>');f.attr("backdrop-class",t.backdropClass),t.animation&&f.attr("modal-animation","true"),y=r(f)(w),h.append(y)}var O=angular.element('<div modal-window="modal-window"></div>');O.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:j.length()-1,animate:"animate"}).html(t.content),t.animation&&O.attr("modal-animation","true");var C=r(O)(t.scope);j.top().value.modalDomEl=C,j.top().value.modalOpener=l,h.append(C),h.addClass(x)},O.close=function(e,t){var n=j.get(e);return n&&f(n,t,!0)?(n.value.deferred.resolve(t),h(e),n.value.modalOpener.focus(),!0):!n},O.dismiss=function(e,t){var n=j.get(e);return n&&f(n,t,!1)?(n.value.deferred.reject(t),h(e),n.value.modalOpener.focus(),!0):!n},O.dismissAll=function(e){for(var t=this.getTop();t&&this.dismiss(t.key,e);)t=this.getTop()},O.getTop=function(){return j.top()},O.modalRendered=function(e){var t=j.get(e);t&&t.value.renderDeferred.resolve()},O}]).provider("$modal",(function(){var e={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$templateRequest","$controller","$modalStack",function(t,n,r,a,l,d){function h(e){return e.template?r.when(e.template):a(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl)}function p(e){var n=[];return angular.forEach(e,(function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(r.when(t.invoke(e)))})),n}var f={open:function(t){var a=r.defer(),f=r.defer(),y=r.defer(),w={result:a.promise,opened:f.promise,rendered:y.promise,close:function(e){return d.close(w,e)},dismiss:function(e){return d.dismiss(w,e)}};if((t=angular.extend({},e.options,t)).resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var x=r.all([h(t)].concat(p(t.resolve)));return x.then((function(e){var r=(t.scope||n).$new();r.$close=w.close,r.$dismiss=w.dismiss;var h,p={},f=1;t.controller&&(p.$scope=r,p.$modalInstance=w,angular.forEach(t.resolve,(function(t,n){p[n]=e[f++]})),h=l(t.controller,p),t.controllerAs&&(r[t.controllerAs]=h)),d.open(w,{scope:r,deferred:a,renderDeferred:y,content:e[0],animation:t.animation,backdrop:t.backdrop,keyboard:t.keyboard,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,size:t.size})}),(function(e){a.reject(e)})),x.then((function(){f.resolve(!0)}),(function(e){f.reject(e)})),w}};return f}]};return e})),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(e,t,n){var r=this,a={$setViewValue:angular.noop},l=t.numPages?n(t.numPages).assign:angular.noop;this.init=function(d,h){a=d,this.config=h,a.$render=function(){r.render()},t.itemsPerPage?e.$parent.$watch(n(t.itemsPerPage),(function(t){r.itemsPerPage=parseInt(t,10),e.totalPages=r.calculateTotalPages()})):this.itemsPerPage=h.itemsPerPage,e.$watch("totalItems",(function(){e.totalPages=r.calculateTotalPages()})),e.$watch("totalPages",(function(t){l(e.$parent,t),e.page>t?e.selectPage(t):a.$render()}))},this.calculateTotalPages=function(){var t=this.itemsPerPage<1?1:Math.ceil(e.totalItems/this.itemsPerPage);return Math.max(t||0,1)},this.render=function(){e.page=parseInt(a.$viewValue,10)||1},e.selectPage=function(t,n){e.page!==t&&t>0&&t<=e.totalPages&&(n&&n.target&&n.target.blur(),a.$setViewValue(t),a.$render())},e.getText=function(t){return e[t+"Text"]||r.config[t+"Text"]},e.noPrevious=function(){return 1===e.page},e.noNext=function(){return e.page===e.totalPages}}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(e,t){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(n,r,a,l){function d(e,t,n){return{number:e,text:t,active:n}}var h=l[0],p=l[1];if(p){var f=angular.isDefined(a.maxSize)?n.$parent.$eval(a.maxSize):t.maxSize,y=angular.isDefined(a.rotate)?n.$parent.$eval(a.rotate):t.rotate;n.boundaryLinks=angular.isDefined(a.boundaryLinks)?n.$parent.$eval(a.boundaryLinks):t.boundaryLinks,n.directionLinks=angular.isDefined(a.directionLinks)?n.$parent.$eval(a.directionLinks):t.directionLinks,h.init(p,t),a.maxSize&&n.$parent.$watch(e(a.maxSize),(function(e){f=parseInt(e,10),h.render()}));var w=h.render;h.render=function(){w(),n.page>0&&n.page<=n.totalPages&&(n.pages=function(e,t){var n=[],r=1,a=t,l=angular.isDefined(f)&&t>f;l&&(y?(a=(r=Math.max(e-Math.floor(f/2),1))+f-1)>t&&(r=(a=t)-f+1):(r=(Math.ceil(e/f)-1)*f+1,a=Math.min(r+f-1,t)));for(var h=r;a>=h;h++){var p=d(h,h,h===e);n.push(p)}if(l&&!y){if(r>1){var w=d(r-1,"...",!1);n.unshift(w)}if(t>a){var x=d(a+1,"...",!1);n.push(x)}}return n}(n.page,n.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(e){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(t,n,r,a){var l=a[0],d=a[1];d&&(t.align=angular.isDefined(r.align)?t.$parent.$eval(r.align):e.align,l.init(d,e))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",(function(){var e={placement:"top",animation:!0,popupDelay:0,useContentExp:!1},t={mouseenter:"mouseleave",click:"click",focus:"blur"},n={};this.options=function(e){angular.extend(n,e)},this.setTriggers=function(e){angular.extend(t,e)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function(r,a,l,d,h,p){return function(r,f,y,w){function x(e){var n=e||w.trigger||y;return{show:n,hide:t[n]||n}}w=angular.extend({},e,n,w);var j=function(e){return e.replace(/[A-Z]/g,(function(e,t){return(t?"-":"")+e.toLowerCase()}))}(r),O=p.startSymbol(),C=p.endSymbol(),S="<div "+j+'-popup title="'+O+"title"+C+'" '+(w.useContentExp?'content-exp="contentExp()" ':'content="'+O+"content"+C+'" ')+'placement="'+O+"placement"+C+'" popup-class="'+O+"popupClass"+C+'" animation="animation" is-open="isOpen"origin-scope="origScope" ></div>';return{restrict:"EA",compile:function(){var e=a(S);return function(t,n,a){function p(){P.isOpen?j():y()}function y(){(!I||t.$eval(a[f+"Enable"]))&&(P.popupClass=a[f+"Class"],function(){var e=a[f+"Placement"];P.placement=angular.isDefined(e)?e:w.placement}(),function(){var e=a[f+"PopupDelay"],t=parseInt(e,10);P.popupDelay=isNaN(t)?w.popupDelay:t}(),P.popupDelay?A||(A=l(O,P.popupDelay,!1)).then((function(e){e()})):O()())}function j(){t.$apply((function(){C()}))}function O(){return A=null,E&&(l.cancel(E),E=null),(w.useContentExp?P.contentExp():P.content)?(_&&S(),k=P.$new(),_=e(k,(function(e){T?d.find("body").append(e):n.after(e)})),k.$watch((function(){l(D,0,!1)})),w.useContentExp&&k.$watch("contentExp()",(function(e){!e&&P.isOpen&&C()})),_.css({top:0,left:0,display:"block"}),P.$digest(),D(),P.isOpen=!0,P.$apply(),D):angular.noop}function C(){P.isOpen=!1,l.cancel(A),A=null,P.animation?E||(E=l(S,500)):S()}function S(){E=null,_&&(_.remove(),_=null),k&&(k.$destroy(),k=null)}var _,k,E,A,T=!!angular.isDefined(w.appendToBody)&&w.appendToBody,R=x(void 0),I=angular.isDefined(a[f+"Enable"]),P=t.$new(!0),D=function(){if(_){var e=h.positionElements(n,_,P.placement,T);e.top+="px",e.left+="px",_.css(e)}};P.origScope=t,P.isOpen=!1,P.contentExp=function(){return t.$eval(a[r])},w.useContentExp||a.$observe(r,(function(e){P.content=e,!e&&P.isOpen&&C()})),a.$observe("disabled",(function(e){e&&P.isOpen&&C()})),a.$observe(f+"Title",(function(e){P.title=e}));var M=function(){n.unbind(R.show,y),n.unbind(R.hide,j)};!function(){var e=a[f+"Trigger"];M(),(R=x(e)).show===R.hide?n.bind(R.show,p):(n.bind(R.show,y),n.bind(R.hide,j))}();var L=t.$eval(a[f+"Animation"]);P.animation=angular.isDefined(L)?!!L:w.animation;var F=t.$eval(a[f+"AppendToBody"]);(T=angular.isDefined(F)?F:T)&&t.$on("$locationChangeSuccess",(function(){P.isOpen&&C()})),t.$on("$destroy",(function(){l.cancel(E),l.cancel(A),M(),S(),P=null}))}}}}}]})).directive("tooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(e,t,n,r){return{link:function(a,l,d){var h,p,f,y=a.$eval(d.tooltipTemplateTranscludeScope),w=0,x=function(){p&&(p.remove(),p=null),h&&(h.$destroy(),h=null),f&&(e.leave(f).then((function(){p=null})),p=f,f=null)};a.$watch(t.parseAsResourceUrl(d.tooltipTemplateTransclude),(function(t){var d=++w;t?(r(t,!0).then((function(r){if(d===w){var a=y.$new(),p=n(r)(a,(function(t){x(),e.enter(t,l)}));f=p,(h=a).$emit("$includeContentLoaded",t)}}),(function(){d===w&&(x(),a.$emit("$includeContentError",t))})),a.$emit("$includeContentRequested",t)):x()})),a.$on("$destroy",x)}}}]).directive("tooltipClasses",(function(){return{restrict:"A",link:function(e,t,n){e.placement&&t.addClass(e.placement),e.popupClass&&t.addClass(e.popupClass),e.animation()&&t.addClass(n.tooltipAnimationClass)}}})).directive("tooltipPopup",(function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}})).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipTemplatePopup",(function(){return{restrict:"EA",replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/tooltip/tooltip-template-popup.html"}})).directive("tooltipTemplate",["$tooltip",function(e){return e("tooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("tooltipHtmlPopup",(function(){return{restrict:"EA",replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-popup.html"}})).directive("tooltipHtml",["$tooltip",function(e){return e("tooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]).directive("tooltipHtmlUnsafePopup",(function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}})).value("tooltipHtmlUnsafeSuppressDeprecated",!1).directive("tooltipHtmlUnsafe",["$tooltip","tooltipHtmlUnsafeSuppressDeprecated","$log",function(e,t,n){return t||n.warn("tooltip-html-unsafe is now deprecated. Use tooltip-html or tooltip-template instead."),e("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverTemplatePopup",(function(){return{restrict:"EA",replace:!0,scope:{title:"@",contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/popover/popover-template.html"}})).directive("popoverTemplate",["$tooltip",function(e){return e("popoverTemplate","popover","click",{useContentExp:!0})}]).directive("popoverPopup",(function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}})).directive("popover",["$tooltip",function(e){return e("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(e,t,n){var r=this,a=angular.isDefined(t.animate)?e.$parent.$eval(t.animate):n.animate;this.bars=[],e.max=angular.isDefined(e.max)?e.max:n.max,this.addBar=function(t,n){a||n.css({transition:"none"}),this.bars.push(t),t.$watch("value",(function(n){t.percent=+(100*n/e.max).toFixed(2)})),t.$on("$destroy",(function(){n=null,r.removeBar(t)}))},this.removeBar=function(e){this.bars.splice(this.bars.indexOf(e),1)}}]).directive("progress",(function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}})).directive("bar",(function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",max:"=?",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(e,t,n,r){r.addBar(e,t)}}})).directive("progressbar",(function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",max:"=?",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(e,t,n,r){r.addBar(e,angular.element(t.children()[0]))}}})),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(e,t,n){var r={$setViewValue:angular.noop};this.init=function(a){(r=a).$render=this.render,r.$formatters.push((function(e){return angular.isNumber(e)&&e<<0!==e&&(e=Math.round(e)),e})),this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff;var l=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(l)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;n>t;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff},e[t]);return e},e.rate=function(t){!e.readonly&&t>=0&&t<=e.range.length&&(r.$setViewValue(t),r.$render())},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=r.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=r.$viewValue}}]).directive("rating",(function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(e,t,n,r){var a=r[0],l=r[1];a.init(l)}}})),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(e){var t,n=this,r=n.tabs=e.tabs=[];n.select=function(e){angular.forEach(r,(function(t){t.active&&t!==e&&(t.active=!1,t.onDeselect())})),e.active=!0,e.onSelect()},n.addTab=function(e){r.push(e),1===r.length&&!1!==e.active?e.active=!0:e.active?n.select(e):e.active=!1},n.removeTab=function(e){var a=r.indexOf(e);if(e.active&&r.length>1&&!t){var l=a==r.length-1?a-1:a+1;n.select(r[l])}r.splice(a,1)},e.$on("$destroy",(function(){t=!0}))}]).directive("tabset",(function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(e,t,n){e.vertical=!!angular.isDefined(n.vertical)&&e.$parent.$eval(n.vertical),e.justified=!!angular.isDefined(n.justified)&&e.$parent.$eval(n.justified)}}})).directive("tab",["$parse","$log",function(e,t){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(n,r,a){return function(n,r,l,d){n.$watch("active",(function(e){e&&d.select(n)})),n.disabled=!1,l.disable&&n.$parent.$watch(e(l.disable),(function(e){n.disabled=!!e})),l.disabled&&(t.warn('Use of "disabled" attribute has been deprecated, please use "disable"'),n.$parent.$watch(e(l.disabled),(function(e){n.disabled=!!e}))),n.select=function(){n.disabled||(n.active=!0)},d.addTab(n),n.$on("$destroy",(function(){d.removeTab(n)})),n.$transcludeFn=a}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(e,t){e.$watch("headingElement",(function(e){e&&(t.html(""),t.append(e))}))}}}]).directive("tabContentTransclude",(function(){return{restrict:"A",require:"^tabset",link:function(e,t,n){var r=e.$eval(n.tabContentTransclude);r.$transcludeFn(r.$parent,(function(e){angular.forEach(e,(function(e){!function(e){return e.tagName&&(e.hasAttribute("tab-heading")||e.hasAttribute("data-tab-heading")||"tab-heading"===e.tagName.toLowerCase()||"data-tab-heading"===e.tagName.toLowerCase())}(e)?t.append(e):r.headingElement=e}))}))}}})),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(e,t,n,r,a,l){function d(){var t=parseInt(e.hours,10);return(e.showMeridian?t>0&&13>t:t>=0&&24>t)?(e.showMeridian&&(12===t&&(t=0),e.meridian===C[1]&&(t+=12)),t):void 0}function h(){var t=parseInt(e.minutes,10);return t>=0&&60>t?t:void 0}function p(e){return angular.isDefined(e)&&e.toString().length<2?"0"+e:e.toString()}function f(e){y(),O.$setViewValue(new Date(j)),w(e)}function y(){O.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1}function w(t){var n=j.getHours(),r=j.getMinutes();e.showMeridian&&(n=0===n||12===n?12:n%12),e.hours="h"===t?n:p(n),"m"!==t&&(e.minutes=p(r)),e.meridian=j.getHours()<12?C[0]:C[1]}function x(e){var t=new Date(j.getTime()+6e4*e);j.setHours(t.getHours(),t.getMinutes()),f()}var j=new Date,O={$setViewValue:angular.noop},C=angular.isDefined(t.meridians)?e.$parent.$eval(t.meridians):l.meridians||a.DATETIME_FORMATS.AMPMS;this.init=function(n,r){(O=n).$render=this.render,O.$formatters.unshift((function(e){return e?new Date(e):null}));var a=r.eq(0),d=r.eq(1);(angular.isDefined(t.mousewheel)?e.$parent.$eval(t.mousewheel):l.mousewheel)&&this.setupMousewheelEvents(a,d),(angular.isDefined(t.arrowkeys)?e.$parent.$eval(t.arrowkeys):l.arrowkeys)&&this.setupArrowkeyEvents(a,d),e.readonlyInput=angular.isDefined(t.readonlyInput)?e.$parent.$eval(t.readonlyInput):l.readonlyInput,this.setupInputEvents(a,d)};var S=l.hourStep;t.hourStep&&e.$parent.$watch(n(t.hourStep),(function(e){S=parseInt(e,10)}));var _=l.minuteStep;t.minuteStep&&e.$parent.$watch(n(t.minuteStep),(function(e){_=parseInt(e,10)})),e.showMeridian=l.showMeridian,t.showMeridian&&e.$parent.$watch(n(t.showMeridian),(function(t){if(e.showMeridian=!!t,O.$error.time){var n=d(),r=h();angular.isDefined(n)&&angular.isDefined(r)&&(j.setHours(n),f())}else w()})),this.setupMousewheelEvents=function(t,n){var r=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};t.bind("mousewheel wheel",(function(t){e.$apply(r(t)?e.incrementHours():e.decrementHours()),t.preventDefault()})),n.bind("mousewheel wheel",(function(t){e.$apply(r(t)?e.incrementMinutes():e.decrementMinutes()),t.preventDefault()}))},this.setupArrowkeyEvents=function(t,n){t.bind("keydown",(function(t){38===t.which?(t.preventDefault(),e.incrementHours(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementHours(),e.$apply())})),n.bind("keydown",(function(t){38===t.which?(t.preventDefault(),e.incrementMinutes(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementMinutes(),e.$apply())}))},this.setupInputEvents=function(t,n){if(e.readonlyInput)return e.updateHours=angular.noop,void(e.updateMinutes=angular.noop);var r=function(t,n){O.$setViewValue(null),O.$setValidity("time",!1),angular.isDefined(t)&&(e.invalidHours=t),angular.isDefined(n)&&(e.invalidMinutes=n)};e.updateHours=function(){var e=d();angular.isDefined(e)?(j.setHours(e),f("h")):r(!0)},t.bind("blur",(function(){!e.invalidHours&&e.hours<10&&e.$apply((function(){e.hours=p(e.hours)}))})),e.updateMinutes=function(){var e=h();angular.isDefined(e)?(j.setMinutes(e),f("m")):r(void 0,!0)},n.bind("blur",(function(){!e.invalidMinutes&&e.minutes<10&&e.$apply((function(){e.minutes=p(e.minutes)}))}))},this.render=function(){var e=O.$viewValue;isNaN(e)?(O.$setValidity("time",!1),r.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(e&&(j=e),y(),w())},e.incrementHours=function(){x(60*S)},e.decrementHours=function(){x(60*-S)},e.incrementMinutes=function(){x(_)},e.decrementMinutes=function(){x(-_)},e.toggleMeridian=function(){x(720*(j.getHours()<12?1:-1))}}]).directive("timepicker",(function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(e,t,n,r){var a=r[0],l=r[1];l&&a.init(l,t.find("input"))}}})),angular.module("ui.bootstrap.transition",[]).value("$transitionSuppressDeprecated",!1).factory("$transition",["$q","$timeout","$rootScope","$log","$transitionSuppressDeprecated",function(e,t,n,r,a){function l(e){for(var t in e)if(void 0!==h.style[t])return e[t]}a||r.warn("$transition is now deprecated. Use $animate from ngAnimate instead.");var d=function(r,a,l){l=l||{};var h=e.defer(),p=d[l.animation?"animationEndEventName":"transitionEndEventName"],f=function(){n.$apply((function(){r.unbind(p,f),h.resolve(r)}))};return p&&r.bind(p,f),t((function(){angular.isString(a)?r.addClass(a):angular.isFunction(a)?a(r):angular.isObject(a)&&r.css(a),p||h.resolve(r)})),h.promise.cancel=function(){p&&r.unbind(p,f),h.reject("Transition cancelled")},h.promise},h=document.createElement("trans");return d.transitionEndEventName=l({WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}),d.animationEndEventName=l({WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"}),d}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var r=n.match(t);if(!r)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:r[3],source:e(r[4]),viewMapper:e(r[2]||r[1]),modelMapper:e(r[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(e,t,n,r,a,l,d){var h=[9,13,27,38,40];return{require:"ngModel",link:function(p,f,y,w){var x,j=p.$eval(y.typeaheadMinLength)||1,O=p.$eval(y.typeaheadWaitMs)||0,C=!1!==p.$eval(y.typeaheadEditable),S=t(y.typeaheadLoading).assign||angular.noop,_=t(y.typeaheadOnSelect),k=y.typeaheadInputFormatter?t(y.typeaheadInputFormatter):void 0,E=!!y.typeaheadAppendToBody&&p.$eval(y.typeaheadAppendToBody),A=!1!==p.$eval(y.typeaheadFocusFirst),T=t(y.ngModel).assign,R=d.parse(y.typeahead),I=p.$new();p.$on("$destroy",(function(){I.$destroy()}));var P="typeahead-"+I.$id+"-"+Math.floor(1e4*Math.random());f.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":P});var D=angular.element("<div typeahead-popup></div>");D.attr({id:P,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(y.typeaheadTemplateUrl)&&D.attr("template-url",y.typeaheadTemplateUrl);var M=function(){I.matches=[],I.activeIdx=-1,f.attr("aria-expanded",!1)},L=function(e){return P+"-option-"+e};I.$watch("activeIdx",(function(e){0>e?f.removeAttr("aria-activedescendant"):f.attr("aria-activedescendant",L(e))}));var F=function(e){var t={$viewValue:e};S(p,!0),n.when(R.source(p,t)).then((function(n){var r=e===w.$viewValue;if(r&&x)if(n&&n.length>0){I.activeIdx=A?0:-1,I.matches.length=0;for(var a=0;a<n.length;a++)t[R.itemName]=n[a],I.matches.push({id:L(a),label:R.viewMapper(I,t),model:n[a]});I.query=e,I.position=E?l.offset(f):l.position(f),I.position.top=I.position.top+f.prop("offsetHeight"),f.attr("aria-expanded",!0)}else M();r&&S(p,!1)}),(function(){M(),S(p,!1)}))};M(),I.query=void 0;var q,N=function(){q&&r.cancel(q)};w.$parsers.unshift((function(e){return x=!0,e&&e.length>=j?O>0?(N(),function(e){q=r((function(){F(e)}),O)}(e)):F(e):(S(p,!1),N(),M()),C?e:e?void w.$setValidity("editable",!1):(w.$setValidity("editable",!0),e)})),w.$formatters.push((function(e){var t,n={};return C||w.$setValidity("editable",!0),k?(n.$model=e,k(p,n)):(n[R.itemName]=e,t=R.viewMapper(p,n),n[R.itemName]=void 0,t!==R.viewMapper(p,n)?t:e)})),I.select=function(e){var t,n,a={};a[R.itemName]=n=I.matches[e].model,t=R.modelMapper(p,a),T(p,t),w.$setValidity("editable",!0),w.$setValidity("parse",!0),_(p,{$item:n,$model:t,$label:R.viewMapper(p,a)}),M(),r((function(){f[0].focus()}),0,!1)},f.bind("keydown",(function(e){0!==I.matches.length&&-1!==h.indexOf(e.which)&&(-1!=I.activeIdx||13!==e.which&&9!==e.which)&&(e.preventDefault(),40===e.which?(I.activeIdx=(I.activeIdx+1)%I.matches.length,I.$digest()):38===e.which?(I.activeIdx=(I.activeIdx>0?I.activeIdx:I.matches.length)-1,I.$digest()):13===e.which||9===e.which?I.$apply((function(){I.select(I.activeIdx)})):27===e.which&&(e.stopPropagation(),M(),I.$digest()))})),f.bind("blur",(function(){x=!1}));var B=function(e){f[0]!==e.target&&(M(),I.$digest())};a.bind("click",B),p.$on("$destroy",(function(){a.unbind("click",B),E&&U.remove(),D.remove()}));var U=e(D)(I);E?a.find("body").append(U):f.after(U)}}}]).directive("typeaheadPopup",(function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(e,t,n){e.templateUrl=n.templateUrl,e.isOpen=function(){return e.matches.length>0},e.isActive=function(t){return e.active==t},e.selectActive=function(t){e.active=t},e.selectMatch=function(t){e.select({activeIdx:t})}}}})).directive("typeaheadMatch",["$templateRequest","$compile","$parse",function(e,t,n){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(r,a,l){var d=n(l.templateUrl)(r.$parent)||"template/typeahead/typeahead-match.html";e(d).then((function(e){t(e.trim())(r,(function(e){a.replaceWith(e)}))}))}}}]).filter("typeaheadHighlight",(function(){return function(e,t){return t?(""+e).replace(new RegExp(function(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}(t),"gi"),"<strong>$&</strong>"):e}})),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(e){e.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a href="javascript:void(0)" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse collapse" collapse="!isOpen">\n\t  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(e){e.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(e){e.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(e){e.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides | orderBy:\'index\' track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(e){e.put("template/carousel/slide.html",'<div ng-class="{\n    \'active\': active\n  }" class="item text-center" ng-transclude></div>\n')}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}" ng-class="dt.customClass">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n\t<li ng-transclude></li>\n\t<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n\t\t<span class="btn-group pull-left">\n\t\t\t<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n\t\t\t<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n\t\t</span>\n\t\t<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n\t</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(e){e.put("template/modal/backdrop.html",'<div class="modal-backdrop"\n     modal-animation-class="fade"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(e){e.put("template/modal/window.html",'<div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal"\n    modal-animation-class="fade"\n\tng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="size ? \'modal-\' + size : \'\'"><div class="modal-content" modal-transclude></div></div>\n</div>\n')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(e){e.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1, $event)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1, $event)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(e){e.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1, $event)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1, $event)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number, $event)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1, $event)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages, $event)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-html-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html="contentExp()"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-template-popup.html",'<div class="tooltip"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner"\n    tooltip-template-transclude="contentExp()"\n    tooltip-template-transclude-scope="originScope()"></div>\n</div>\n')}]),angular.module("template/popover/popover-template.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover-template.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content"\n        tooltip-template-transclude="contentExp()"\n        tooltip-template-transclude-scope="originScope()"></div>\n  </div>\n</div>\n')}]),angular.module("template/popover/popover-window.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover-window.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen, fade: animation }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" tooltip-template-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover.html",'<div class="popover"\n  tooltip-animation-class="fade"\n  tooltip-classes\n  ng-class="{ in: isOpen() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-if="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>\n')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(e){e.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(e){e.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(e){e.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(e){e.put("template/timepicker/timepicker.html",'<table>\n\t<tbody>\n\t\t<tr class="text-center">\n\t\t\t<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n\t\t\t<td>&nbsp;</td>\n\t\t\t<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n\t\t\t<td ng-show="showMeridian"></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td class="form-group" ng-class="{\'has-error\': invalidHours}">\n\t\t\t\t<input style="width:50px;" type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n\t\t\t</td>\n\t\t\t<td>:</td>\n\t\t\t<td class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n\t\t\t\t<input style="width:50px;" type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n\t\t\t</td>\n\t\t\t<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n\t\t</tr>\n\t\t<tr class="text-center">\n\t\t\t<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n\t\t\t<td>&nbsp;</td>\n\t\t\t<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n\t\t\t<td ng-show="showMeridian"></td>\n\t\t</tr>\n\t</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(e){e.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(e){e.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}</style>')},function(e,t){angular.module("ng-context-menu",[]).factory("ContextMenuService",(function(){return{element:null,menuElement:null,container:null}})).directive("contextMenu",["$document","ContextMenuService",function(e,t){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled"},link:function(n,r,a){var l=!1;function d(e){e.removeClass("open"),l=!1}function h(e){!n.disabled()&&l&&27===e.keyCode&&n.$apply((function(){d(t.menuElement)}))}function p(e){n.disabled()||!l||2===e.button&&e.target===t.element||n.$apply((function(){d(t.menuElement)}))}r.bind("contextmenu",(function(r){n.disabled()||(null!==t.menuElement&&d(t.menuElement),t.menuElement=angular.element(document.getElementById(a.target)),void 0!==a.contextMenuContainer&&(t.container=angular.element(a.contextMenuContainer)),t.element=r.target,r.preventDefault(),r.stopPropagation(),n.$apply((function(){n.callback({$event:r}),function(t,n,r){n.addClass("open"),r&&r.append(n);var a=e[0].documentElement,d=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),h=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),p=n[0].scrollHeight,f=a.clientHeight+h,y=p+t.pageY,w=Math.max(t.pageY-h,0);y>f&&(w-=y-f),n.css("top",w+"px"),n.css("left",Math.max(t.pageX-d,0)+"px"),l=!0}(r,t.menuElement,t.container)})))})),e.bind("keyup",h),e.bind("click",p),e.bind("contextmenu",p),n.$on("$destroy",(function(){e.unbind("keyup",h),e.unbind("click",p),e.unbind("contextmenu",p)}))}}}])},function(e,t){!function(e,t,n){"use strict";e.map(["localStorage","sessionStorage"],(function(r){var a={cookiePrefix:"fallback:"+r+":",cookieOptions:{path:"/",domain:n.domain,expires:"localStorage"===r?{expires:365}:void 0}};try{e.support[r]=r in t&&null!==t[r]}catch(t){e.support[r]=!1}e[r]=function(l,d){var h=e.extend({},a,e[r].options);return this.getItem=function(n){var a=function(n){return JSON.parse(e.support[r]?t[r].getItem(n):e.cookie(h.cookiePrefix+n))};if("string"==typeof n)return a(n);for(var l=[],d=n.length;d--;)l[d]=a(n[d]);return l},this.setItem=function(n,a){return a=JSON.stringify(a),e.support[r]?t[r].setItem(n,a):e.cookie(h.cookiePrefix+n,a,h.cookieOptions)},this.removeItem=function(n){return e.support[r]?t[r].removeItem(n):e.cookie(h.cookiePrefix+n,null,e.extend(h.cookieOptions,{expires:-1}))},this.clear=function(){if(e.support[r])return t[r].clear();var a=new RegExp("^"+h.cookiePrefix,""),l=e.extend(h.cookieOptions,{expires:-1});n.cookie&&""!==n.cookie&&e.map(n.cookie.split(";"),(function(t){a.test(t=e.trim(t))&&e.cookie(t.substr(0,t.indexOf("=")),null,l)}))},void 0!==l?void 0!==d?null===d?this.removeItem(l):this.setItem(l,d):this.getItem(l):this},e[r].options=a}))}(jQuery,window,document)},function(e,t){angular.module("ivpusic.cookie",["ipCookie"]),angular.module("ipCookie",["ng"]).factory("ipCookie",["$document",function(e){"use strict";return function(){function t(t,n,r){var a,l,d,h,p,f,y,w,x;if(r=r||{},void 0!==n)return n="object"==typeof n?JSON.stringify(n):String(n),"number"==typeof r.expires&&(x=r.expires,r.expires=new Date,-1===x?r.expires=new Date("Thu, 01 Jan 1970 00:00:00 GMT"):void 0!==r.expirationUnit?"hours"===r.expirationUnit?r.expires.setHours(r.expires.getHours()+x):"minutes"===r.expirationUnit?r.expires.setMinutes(r.expires.getMinutes()+x):"seconds"===r.expirationUnit?r.expires.setSeconds(r.expires.getSeconds()+x):r.expires.setDate(r.expires.getDate()+x):r.expires.setDate(r.expires.getDate()+x)),e[0].cookie=[encodeURIComponent(t),"=",encodeURIComponent(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("");for(l=[],(w=e[0].cookie)&&(l=w.split("; ")),a={},y=!1,d=0;d<l.length;++d)if(l[d]&&(p=(h=l[d]).indexOf("="),f=h.substring(0,p),n=decodeURIComponent(h.substring(p+1)),void 0===t||t===f)){try{a[f]=JSON.parse(n)}catch(e){a[f]=n}if(t===f)return a[f];y=!0}return y&&void 0===t?a:void 0}return t.remove=function(e,n){var r=void 0!==t(e);return r&&(n||(n={}),n.expires=-1,t(e,"",n)),r},t}()}])},function(e,t){!function(){"use strict";var e={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(t){switch(t.which){case e.COMMAND:case e.SHIFT:case e.CTRL:case e.ALT:return!0}return!!(t.metaKey||t.ctrlKey||t.altKey)},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123},isVerticalMovement:function(t){return~[e.UP,e.DOWN].indexOf(t)},isHorizontalMovement:function(t){return~[e.LEFT,e.RIGHT,e.BACKSPACE,e.DELETE].indexOf(t)},toSeparator:function(t){var n={ENTER:"\n",TAB:"\t",SPACE:" "}[t];return n||(e[t]?void 0:t)}};function t(e){return angular.isUndefined(e)||null===e}void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(e){return angular.element(this[0].querySelectorAll(e))}),void 0===angular.element.prototype.closest&&(angular.element.prototype.closest=function(e){for(var t=this[0],n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t;){if(n.bind(t)(e))return t;t=t.parentElement}return!1});var n=0,r=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,sortable:!1,placeholder:"",refreshDelay:1e3,closeOnSelect:!0,skipFocusser:!1,dropdownPosition:"auto",removeSelected:!0,resetSearchInput:!0,generateId:function(){return n++},appendToBody:!1,spinnerEnabled:!1,spinnerClass:"glyphicon glyphicon-refresh ui-select-spin",backspaceReset:!0}).service("uiSelectMinErr",(function(){var e=angular.$$minErr("ui.select");return function(){var t=e.apply(this,arguments),n=t.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(n)}})).directive("uisTranscludeAppend",(function(){return{link:function(e,t,n,r,a){a(e,(function(e){t.append(e)}))}}})).filter("highlight",(function(){return function(e,t){return t&&e?(""+e).replace(new RegExp((""+t).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),'<span class="ui-select-highlight">$&</span>'):e}})).factory("uisOffset",["$document","$window",function(e,t){return function(n){var r=n[0].getBoundingClientRect();return{width:r.width||n.prop("offsetWidth"),height:r.height||n.prop("offsetHeight"),top:r.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:r.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}}}]);r.factory("$$uisDebounce",["$timeout",function(e){return function(t,n){var r;return function(){var a=this,l=Array.prototype.slice.call(arguments);r&&e.cancel(r),r=e((function(){t.apply(a,l)}),n)}}}]),r.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile","$window",function(e,t,n,r,a){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){return t.addClass("ui-select-choices"),(t.parent().attr("theme")||e.theme)+"/choices.tpl.html"},compile:function(r,l){if(!l.repeat)throw n("repeat","Expected 'repeat' expression.");var d=l.groupBy,h=l.groupFilter;if(d){var p=r.querySelectorAll(".ui-select-choices-group");if(1!==p.length)throw n("rows","Expected 1 .ui-select-choices-group but got '{0}'.",p.length);p.attr("ng-repeat",t.getGroupNgRepeatExpression())}var f=t.parse(l.repeat),y=r.querySelectorAll(".ui-select-choices-row");if(1!==y.length)throw n("rows","Expected 1 .ui-select-choices-row but got '{0}'.",y.length);y.attr("ng-repeat",f.repeatExpression(d)).attr("ng-if","$select.open");var w=r.querySelectorAll(".ui-select-choices-row-inner");if(1!==w.length)throw n("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",w.length);return w.attr("uis-transclude-append",""),(a.document.addEventListener?y:w).attr("ng-click","$select.select("+f.itemName+",$select.skipFocusser,$event)"),function(t,n,a,l){l.parseRepeatAttr(a.repeat,d,h),l.disableChoiceExpression=a.uiDisableChoice,l.onHighlightCallback=a.onHighlight,l.minimumInputLength=parseInt(a.minimumInputLength)||0,l.dropdownPosition=a.position?a.position.toLowerCase():e.dropdownPosition,t.$watch("$select.search",(function(e){e&&!l.open&&l.multiple&&l.activate(!1,!0),l.activeIndex=l.tagging.isActivated?-1:0,!a.minimumInputLength||l.search.length>=a.minimumInputLength?l.refresh(a.refresh):l.items=[]})),a.$observe("refreshDelay",(function(){var n=t.$eval(a.refreshDelay);l.refreshDelay=void 0!==n?n:e.refreshDelay})),t.$watch("$select.open",(function(e){e?(r.attr("role","listbox"),l.refresh(a.refresh)):n.removeAttr("role")}))}}}}]),r.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","$$uisDebounce","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse","$injector","$window",function(n,r,a,l,d,h,p,f,y,w,x){var j,O=this;if(O.placeholder=f.placeholder,O.searchEnabled=f.searchEnabled,O.sortable=f.sortable,O.refreshDelay=f.refreshDelay,O.paste=f.paste,O.resetSearchInput=f.resetSearchInput,O.refreshing=!1,O.spinnerEnabled=f.spinnerEnabled,O.spinnerClass=f.spinnerClass,O.removeSelected=f.removeSelected,O.closeOnSelect=!0,O.skipFocusser=!1,O.search="",O.activeIndex=0,O.items=[],O.open=!1,O.focus=!1,O.disabled=!1,O.selected=void 0,O.dropdownPosition="auto",O.focusser=void 0,O.multiple=void 0,O.disableChoiceExpression=void 0,O.tagging={isActivated:!1,fct:void 0},O.taggingTokens={isActivated:!1,tokens:void 0},O.lockChoiceExpression=void 0,O.clickTriggeredSelect=!1,O.$filter=l,O.$element=r,O.$animate=function(){try{return w.get("$animate")}catch(e){return null}}(),O.searchInput=r.querySelectorAll("input.ui-select-search"),1!==O.searchInput.length)throw p("searchInput","Expected 1 input.ui-select-search but got '{0}'.",O.searchInput.length);function C(){O.resetSearchInput&&(O.search="",O.selected&&O.items.length&&!O.multiple&&(O.activeIndex=function(e,t,n){if(e.findIndex)return e.findIndex(t,n);for(var r,a=Object(e),l=a.length>>>0,d=0;d<l;d++)if(r=a[d],t.call(n,r,d,a))return d;return-1}(O.items,(function(e){return angular.equals(this,e)}),O.selected)))}O.isEmpty=function(){return t(O.selected)||""===O.selected||O.multiple&&0===O.selected.length},O.activate=function(e,t){if(O.disabled||O.open)O.open&&!O.searchEnabled&&O.close();else{t||C(),n.$broadcast("uis:activate"),O.open=!0,O.activeIndex=O.activeIndex>=O.items.length?0:O.activeIndex,-1===O.activeIndex&&!1!==O.taggingLabel&&(O.activeIndex=0);var l=r.querySelectorAll(".ui-select-choices-content"),d=r.querySelectorAll(".ui-select-search");if(O.$animate&&O.$animate.on&&O.$animate.enabled(l[0])){var h=function(t,n){"start"===n&&0===O.items.length?(O.$animate.off("removeClass",d[0],h),a((function(){O.focusSearchInput(e)}))):"close"===n&&(O.$animate.off("enter",l[0],h),a((function(){O.focusSearchInput(e)})))};O.items.length>0?O.$animate.on("enter",l[0],h):O.$animate.on("removeClass",d[0],h)}else a((function(){O.focusSearchInput(e),!O.tagging.isActivated&&O.items.length>1&&T()}))}},O.focusSearchInput=function(e){O.search=e||O.search,O.searchInput[0].focus()},O.findGroupByName=function(e){return O.groups&&O.groups.filter((function(t){return t.name===e}))[0]},O.parseRepeatAttr=function(e,t,r){O.setItemsFn=t?function(e){var a=n.$eval(t);if(O.groups=[],angular.forEach(e,(function(e){var t=angular.isFunction(a)?a(e):e[a],n=O.findGroupByName(t);n?n.items.push(e):O.groups.push({name:t,items:[e]})})),r){var l=n.$eval(r);angular.isFunction(l)?O.groups=l(O.groups):angular.isArray(l)&&(O.groups=function(e,t){var n,r,a=[];for(n=0;n<t.length;n++)for(r=0;r<e.length;r++)e[r].name==[t[n]]&&a.push(e[r]);return a}(O.groups,l))}O.items=[],O.groups.forEach((function(e){O.items=O.items.concat(e.items)}))}:function(e){O.items=e||[]},O.parserResult=h.parse(e),O.isGrouped=!!t,O.itemProperty=O.parserResult.itemName;var a=O.parserResult.source,l=function(){var e=a(n);n.$uisSource=Object.keys(e).map((function(t){var n={};return n[O.parserResult.keyName]=t,n.value=e[t],n}))};O.parserResult.keyName&&(l(),O.parserResult.source=y("$uisSource"+O.parserResult.filters),n.$watch(a,(function(e,t){e!==t&&l()}),!0)),O.refreshItems=function(e){e=e||O.parserResult.source(n);var t=O.selected;if(O.isEmpty()||angular.isArray(t)&&!t.length||!O.multiple||!O.removeSelected)O.setItemsFn(e);else if(null!=e){var r=e.filter((function(e){return angular.isArray(t)?t.every((function(t){return!angular.equals(e,t)})):!angular.equals(e,t)}));O.setItemsFn(r)}"auto"!==O.dropdownPosition&&"up"!==O.dropdownPosition||n.calculateDropdownPos(),n.$broadcast("uis:refresh")},n.$watchCollection(O.parserResult.source,(function(e){if(null==e)O.items=[];else{if(!angular.isArray(e))throw p("items","Expected an array but got '{0}'.",e);O.refreshItems(e),angular.isDefined(O.ngModel.$modelValue)&&(O.ngModel.$modelValue=null)}}))},O.refresh=function(e){void 0!==e&&(j&&a.cancel(j),j=a((function(){if(n.$select.search.length>=n.$select.minimumInputLength){var t=n.$eval(e);t&&angular.isFunction(t.then)&&!O.refreshing&&(O.refreshing=!0,t.finally((function(){O.refreshing=!1})))}}),O.refreshDelay))},O.isActive=function(e){if(!O.open)return!1;var t=O.items.indexOf(e[O.itemProperty]),n=t==O.activeIndex;return!(!n||t<0)&&(n&&!angular.isUndefined(O.onHighlightCallback)&&e.$eval(O.onHighlightCallback),n)};var S=function(e){return O.selected&&angular.isArray(O.selected)&&O.selected.filter((function(t){return angular.equals(t,e)})).length>0},_=[];function k(e){return _.indexOf(e)>-1}O.isDisabled=function(e){if(O.open){var t=e[O.itemProperty],n=!1;if(O.items.indexOf(t)>=0&&(angular.isDefined(O.disableChoiceExpression)||O.multiple)){if(t.isTag)return!1;O.multiple&&(n=S(t)),!n&&angular.isDefined(O.disableChoiceExpression)&&(n=!!e.$eval(O.disableChoiceExpression)),function(e,t){var n=_.indexOf(e);t&&-1===n&&_.push(e),!t&&n>-1&&_.splice(n,1)}(t,n)}return n}},O.select=function(e,r,a){if(t(e)||!k(e)){if(!O.items&&!O.search&&!O.tagging.isActivated)return;if(!e||!k(e)){if(O.clickTriggeredSelect=!1,a&&("click"===a.type||"touchend"===a.type)&&e&&(O.clickTriggeredSelect=!0),O.tagging.isActivated&&!1===O.clickTriggeredSelect){if(!1===O.taggingLabel)if(O.activeIndex<0){if(void 0===e&&(e=void 0!==O.tagging.fct?O.tagging.fct(O.search):O.search),!e||angular.equals(O.items[0],e))return}else e=O.items[O.activeIndex];else if(0===O.activeIndex){if(void 0===e)return;if(void 0!==O.tagging.fct&&"string"==typeof e){if(!(e=O.tagging.fct(e)))return}else"string"==typeof e&&(e=e.replace(O.taggingLabel,"").trim())}if(S(e))return void O.close(r)}C(),n.$broadcast("uis:select",e),O.closeOnSelect&&O.close(r)}}},O.close=function(e){O.open&&(O.ngModel&&O.ngModel.$setTouched&&O.ngModel.$setTouched(),O.open=!1,C(),n.$broadcast("uis:close",e))},O.setFocus=function(){O.focus||O.focusInput[0].focus()},O.clear=function(e){O.select(null),e.stopPropagation(),a((function(){O.focusser[0].focus()}),0,!1)},O.toggle=function(e){O.open?(O.close(),e.preventDefault(),e.stopPropagation()):O.activate()},O.isLocked=function(){return!1},n.$watch((function(){return angular.isDefined(O.lockChoiceExpression)&&""!==O.lockChoiceExpression}),(function(e){if(!e)return;var t=[];O.isLocked=function(e,n){var r=!1,a=O.selected[n];return a&&(e?function(e,n){var r=t.indexOf(e);n&&-1===r&&t.push(e),!n&&r>-1&&t.splice(r,1)}(a,r=!!e.$eval(O.lockChoiceExpression)):r=function(e){return t.indexOf(e)>-1}(a)),r}}));var E=null,A=!1;function T(){var e=r.querySelectorAll(".ui-select-choices-content"),t=e.querySelectorAll(".ui-select-choices-row");if(t.length<1)throw p("choices","Expected multiple .ui-select-choices-row but got '{0}'.",t.length);if(!(O.activeIndex<0)){var n=t[O.activeIndex],a=n.offsetTop+n.clientHeight-e[0].scrollTop,l=e[0].offsetHeight;a>l?e[0].scrollTop+=a-l:a<n.clientHeight&&(O.isGrouped&&0===O.activeIndex?e[0].scrollTop=0:e[0].scrollTop-=n.clientHeight-a)}}O.sizeSearchInput=function(){var e=O.searchInput[0],t=O.$element[0],r=function(){return t.clientWidth*!!e.offsetParent},l=function(t){if(0===t)return!1;var n=t-e.offsetLeft;return n<50&&(n=t),O.searchInput.css("width",n+"px"),!0};O.searchInput.css("width","10px"),a((function(){null!==E||l(r())||(E=n.$watch((function(){A||(A=!0,n.$$postDigest((function(){A=!1,l(r())&&(E(),E=null)})))}),angular.noop))}))},O.searchInput.on("keydown",(function(t){var r=t.which;~[e.ENTER,e.ESC].indexOf(r)&&(t.preventDefault(),t.stopPropagation()),n.$apply((function(){var n=!1;if((O.items.length>0||O.tagging.isActivated)&&(function(t){var n=!0;switch(t){case e.DOWN:if(!O.open&&O.multiple)O.activate(!1,!0);else if(O.activeIndex<O.items.length-1)for(var r=++O.activeIndex;k(O.items[r])&&r<O.items.length;)O.activeIndex=++r;break;case e.UP:var a=0===O.search.length&&O.tagging.isActivated?-1:0;if(!O.open&&O.multiple)O.activate(!1,!0);else if(O.activeIndex>a)for(var l=--O.activeIndex;k(O.items[l])&&l>a;)O.activeIndex=--l;break;case e.TAB:O.multiple&&!O.open||O.select(O.items[O.activeIndex],!0);break;case e.ENTER:O.open&&(O.tagging.isActivated||O.activeIndex>=0)?O.select(O.items[O.activeIndex],O.skipFocusser):O.activate(!1,!0);break;case e.ESC:O.close();break;default:n=!1}return n}(r)||O.searchEnabled||(t.preventDefault(),t.stopPropagation()),O.taggingTokens.isActivated)){for(var l=0;l<O.taggingTokens.tokens.length;l++)O.taggingTokens.tokens[l]===e.MAP[t.keyCode]&&O.search.length>0&&(n=!0);n&&a((function(){O.searchInput.triggerHandler("tagged");var n=O.search.replace(e.MAP[t.keyCode],"").trim();O.tagging.fct&&(n=O.tagging.fct(n)),n&&O.select(n,!0)}))}})),e.isVerticalMovement(r)&&O.items.length>0&&T(),r!==e.ENTER&&r!==e.ESC||(t.preventDefault(),t.stopPropagation())})),O.searchInput.on("paste",(function(t){var n;if(n=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):(t.originalEvent||t).clipboardData.getData("text/plain"),(n=O.search+n)&&n.length>0)if(O.taggingTokens.isActivated){for(var r=[],a=0;a<O.taggingTokens.tokens.length;a++){var l=e.toSeparator(O.taggingTokens.tokens[a])||O.taggingTokens.tokens[a];if(n.indexOf(l)>-1){r=n.split(l);break}}0===r.length&&(r=[n]);var d=O.search;angular.forEach(r,(function(e){var t=O.tagging.fct?O.tagging.fct(e):e;t&&O.select(t,!0)})),O.search=d||"",t.preventDefault(),t.stopPropagation()}else O.paste&&(O.paste(n),O.search="",t.preventDefault(),t.stopPropagation())})),O.searchInput.on("tagged",(function(){a((function(){C()}))}));var R=d((function(){O.sizeSearchInput()}),50);angular.element(x).bind("resize",R),n.$on("$destroy",(function(){O.searchInput.off("keyup keydown tagged blur paste"),angular.element(x).off("resize",R)})),n.$watch("$select.activeIndex",(function(e){e&&r.find("input").attr("aria-activedescendant","ui-select-choices-row-"+O.generatedId+"-"+e)})),n.$watch("$select.open",(function(e){e||r.find("input").removeAttr("aria-activedescendant")}))}]),r.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function(e,t,n,r,a,l,d){return{restrict:"EA",templateUrl:function(e,n){return(n.theme||t.theme)+(angular.isDefined(n.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","^ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(a,h){var p=/{(.*)}\s*{(.*)}/.exec(h.ngClass);if(p){var f="{"+p[1]+", "+p[2]+"}";h.ngClass=f,a.attr("ng-class",f)}return angular.isDefined(h.multiple)?a.append("<ui-select-multiple/>").removeAttr("multiple"):a.append("<ui-select-single/>"),h.inputId&&(a.querySelectorAll("input.ui-select-search")[0].id=h.inputId),function(a,h,p,f,y){var w=f[0],x=f[1];function j(e){if(w.open){if(!(window.jQuery?window.jQuery.contains(h[0],e.target):h[0].contains(e.target))&&!w.clickTriggeredSelect){var t;if(w.skipFocusser)t=!0;else{var n=angular.element(e.target).controller("uiSelect");(t=n&&n!==w)||(t=~["input","button","textarea","select"].indexOf(e.target.tagName.toLowerCase()))}w.close(t),a.$digest()}w.clickTriggeredSelect=!1}}w.generatedId=t.generateId(),w.baseTitle=p.title||"Select box",w.focusserTitle=w.baseTitle+" focus",w.focusserId="focusser-"+w.generatedId,w.closeOnSelect=angular.isDefined(p.closeOnSelect)?l(p.closeOnSelect)():t.closeOnSelect,a.$watch("skipFocusser",(function(){var e=a.$eval(p.skipFocusser);w.skipFocusser=void 0!==e?e:t.skipFocusser})),w.onSelectCallback=l(p.onSelect),w.onRemoveCallback=l(p.onRemove),w.ngModel=x,w.choiceGrouped=function(e){return w.isGrouped&&e&&e.name},p.tabindex&&p.$observe("tabindex",(function(e){w.focusInput.attr("tabindex",e),h.removeAttr("tabindex")})),a.$watch((function(){return a.$eval(p.searchEnabled)}),(function(e){w.searchEnabled=void 0!==e?e:t.searchEnabled})),a.$watch("sortable",(function(){var e=a.$eval(p.sortable);w.sortable=void 0!==e?e:t.sortable})),p.$observe("backspaceReset",(function(){var e=a.$eval(p.backspaceReset);w.backspaceReset=void 0===e||e})),p.$observe("limit",(function(){w.limit=angular.isDefined(p.limit)?parseInt(p.limit,10):void 0})),a.$watch("removeSelected",(function(){var e=a.$eval(p.removeSelected);w.removeSelected=void 0!==e?e:t.removeSelected})),p.$observe("disabled",(function(){w.disabled=void 0!==p.disabled&&p.disabled})),p.$observe("resetSearchInput",(function(){var e=a.$eval(p.resetSearchInput);w.resetSearchInput=void 0===e||e})),p.$observe("paste",(function(){w.paste=a.$eval(p.paste)})),p.$observe("tagging",(function(){if(void 0!==p.tagging){var e=a.$eval(p.tagging);w.tagging={isActivated:!0,fct:!0!==e?e:void 0}}else w.tagging={isActivated:!1,fct:void 0}})),p.$observe("taggingLabel",(function(){void 0!==p.tagging&&("false"===p.taggingLabel?w.taggingLabel=!1:w.taggingLabel=void 0!==p.taggingLabel?p.taggingLabel:"(new)")})),p.$observe("taggingTokens",(function(){if(void 0!==p.tagging){var e=void 0!==p.taggingTokens?p.taggingTokens.split("|"):[",","ENTER"];w.taggingTokens={isActivated:!0,tokens:e}}})),p.$observe("spinnerEnabled",(function(){var e=a.$eval(p.spinnerEnabled);w.spinnerEnabled=void 0!==e?e:t.spinnerEnabled})),p.$observe("spinnerClass",(function(){var e=p.spinnerClass;w.spinnerClass=void 0!==e?p.spinnerClass:t.spinnerClass})),angular.isDefined(p.autofocus)&&d((function(){w.setFocus()})),angular.isDefined(p.focusOn)&&a.$on(p.focusOn,(function(){d((function(){w.setFocus()}))})),e.on("click",j),a.$on("$destroy",(function(){e.off("click",j)})),y(a,(function(e){var t=angular.element("<div>").append(e),r=t.querySelectorAll(".ui-select-match");if(r.removeAttr("ui-select-match"),r.removeAttr("data-ui-select-match"),1!==r.length)throw n("transcluded","Expected 1 .ui-select-match but got '{0}'.",r.length);h.querySelectorAll(".ui-select-match").replaceWith(r);var a=t.querySelectorAll(".ui-select-choices");if(a.removeAttr("ui-select-choices"),a.removeAttr("data-ui-select-choices"),1!==a.length)throw n("transcluded","Expected 1 .ui-select-choices but got '{0}'.",a.length);h.querySelectorAll(".ui-select-choices").replaceWith(a);var l=t.querySelectorAll(".ui-select-no-choice");l.removeAttr("ui-select-no-choice"),l.removeAttr("data-ui-select-no-choice"),1==l.length&&h.querySelectorAll(".ui-select-no-choice").replaceWith(l)}));var O=a.$eval(p.appendToBody);(void 0!==O?O:t.appendToBody)&&(a.$watch("$select.open",(function(t){var n;t?(n=r(h),(C=angular.element('<div class="ui-select-placeholder"></div>'))[0].style.width=n.width+"px",C[0].style.height=n.height+"px",h.after(C),S=h[0].style.width,e.find("body").append(h),h[0].style.position="absolute",h[0].style.left=n.left+"px",h[0].style.top=n.top+"px",h[0].style.width=n.width+"px"):_()})),a.$on("$destroy",(function(){_()})));var C=null,S="";function _(){null!==C&&(C.replaceWith(h),C=null,h[0].style.position="",h[0].style.left="",h[0].style.top="",h[0].style.width=S,w.setFocus())}var k=null;a.$watch("$select.open",(function(){"auto"!==w.dropdownPosition&&"up"!==w.dropdownPosition||a.calculateDropdownPos()}));var E=function(e,t){e=e||r(h),t=t||r(k),k[0].style.position="absolute",k[0].style.top=-1*t.height+"px",h.addClass("direction-up")},A=function(){d((function(){if("up"===w.dropdownPosition)E();else{h.removeClass("direction-up");var t=r(h),n=r(k),a=e[0].documentElement.scrollTop||e[0].body.scrollTop;t.top+t.height+n.height>a+e[0].documentElement.clientHeight?E(t,n):function(e,t){h.removeClass("direction-up"),e=e||r(h),t=t||r(k),k[0].style.position="",k[0].style.top=""}(t,n)}k[0].style.opacity=1}))},T=!1;a.calculateDropdownPos=function(){if(w.open){if(0===(k=angular.element(h).querySelectorAll(".ui-select-dropdown")).length)return;if(""!==w.search||T||(k[0].style.opacity=0,T=!0),!r(k).height&&w.$animate&&w.$animate.on&&w.$animate.enabled(k)){var e=!0;w.$animate.on("enter",k,(function(t,n){"close"===n&&e&&(A(),e=!1)}))}else A()}else{if(null===k||0===k.length)return;k[0].style.opacity=0,k[0].style.position="",k[0].style.top="",h.removeClass("direction-up")}}}}}}]),r.directive("uiSelectMatch",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(n){n.addClass("ui-select-match");var r=n.parent();return(t(r,"theme")||e.theme)+(angular.isDefined(t(r,"multiple"))?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(t,n,r,a){function l(e){a.allowClear=!!angular.isDefined(e)&&(""===e||"true"===e.toLowerCase())}a.lockChoiceExpression=r.uiLockChoice,r.$observe("placeholder",(function(t){a.placeholder=void 0!==t?t:e.placeholder})),r.$observe("allowClear",l),l(r.allowClear),a.multiple&&a.sizeSearchInput()}};function t(e,t){return e[0].hasAttribute(t)?e.attr(t):e[0].hasAttribute("data-"+t)?e.attr("data-"+t):e[0].hasAttribute("x-"+t)?e.attr("x-"+t):void 0}}]),r.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(n,r){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function(e,t){var n,r=this,a=e.$select;angular.isUndefined(a.selected)&&(a.selected=[]),e.$evalAsync((function(){n=e.ngModel})),r.activeMatchIndex=-1,r.updateModel=function(){n.$setViewValue(Date.now()),r.refreshComponent()},r.refreshComponent=function(){a.refreshItems&&a.refreshItems(),a.sizeSearchInput&&a.sizeSearchInput()},r.removeChoice=function(n){if(a.isLocked(null,n))return!1;var l=a.selected[n],d={};return d[a.parserResult.itemName]=l,a.selected.splice(n,1),r.activeMatchIndex=-1,a.sizeSearchInput(),t((function(){a.onRemoveCallback(e,{$item:l,$model:a.parserResult.modelMapper(e,d)})})),r.updateModel(),!0},r.getPlaceholder=function(){if(!a.selected||!a.selected.length)return a.placeholder}}],controllerAs:"$selectMultiple",link:function(a,l,d,h){var p=h[0],f=a.ngModel=h[1],y=a.$selectMultiple;function w(e){return void 0!==e&&void 0!==p.search&&e.filter((function(e){return void 0!==p.search.toUpperCase()&&void 0!==e&&e.toUpperCase()===p.search.toUpperCase()})).length>0}function x(e,t){var n=-1;if(angular.isArray(e))for(var r=angular.copy(e),a=0;a<r.length;a++)if(void 0===p.tagging.fct)r[a]+" "+p.taggingLabel===t&&(n=a);else{var l=r[a];angular.isObject(l)&&(l.isTag=!0),angular.equals(l,t)&&(n=a)}return n}p.multiple=!0,p.focusInput=p.searchInput,f.$isEmpty=function(e){return!e||0===e.length},f.$parsers.unshift((function(){for(var e,t={},n=[],r=p.selected.length-1;r>=0;r--)(t={})[p.parserResult.itemName]=p.selected[r],e=p.parserResult.modelMapper(a,t),n.unshift(e);return n})),f.$formatters.unshift((function(e){var t,n=p.parserResult&&p.parserResult.source(a,{$select:{search:""}}),r={};if(!n)return e;var l=[],d=function(e,n){if(e&&e.length){for(var d=e.length-1;d>=0;d--){if(r[p.parserResult.itemName]=e[d],t=p.parserResult.modelMapper(a,r),p.parserResult.trackByExp){var h=/(\w*)\./.exec(p.parserResult.trackByExp),f=/\.([^\s]+)/.exec(p.parserResult.trackByExp);if(h&&h.length>0&&h[1]==p.parserResult.itemName&&f&&f.length>0&&t[f[1]]==n[f[1]])return l.unshift(e[d]),!0}if(angular.equals(t,n))return l.unshift(e[d]),!0}return!1}};if(!e)return l;for(var h=e.length-1;h>=0;h--)d(p.selected,e[h])||d(n,e[h])||l.unshift(e[h]);return l})),a.$watchCollection((function(){return f.$modelValue}),(function(e,t){t!=e&&(angular.isDefined(f.$modelValue)&&(f.$modelValue=null),y.refreshComponent())})),f.$render=function(){if(!angular.isArray(f.$viewValue)){if(!t(f.$viewValue))throw n("multiarr","Expected model value to be array but got '{0}'",f.$viewValue);f.$viewValue=[]}p.selected=f.$viewValue,y.refreshComponent(),a.$evalAsync()},a.$on("uis:select",(function(e,t){if(!(p.selected.length>=p.limit)){p.selected.push(t);var n={};n[p.parserResult.itemName]=t,r((function(){p.onSelectCallback(a,{$item:t,$model:p.parserResult.modelMapper(a,n)})})),y.updateModel()}})),a.$on("uis:activate",(function(){y.activeMatchIndex=-1})),a.$watch("$select.disabled",(function(e,t){t&&!e&&p.sizeSearchInput()})),p.searchInput.on("keydown",(function(t){var n=t.which;a.$apply((function(){var r=!1;e.isHorizontalMovement(n)&&(r=function(t){var n,r=(w=p.searchInput[0],angular.isNumber(w.selectionStart)?w.selectionStart:w.value.length),a=p.selected.length,l=a-1,d=y.activeMatchIndex,h=y.activeMatchIndex+1,f=y.activeMatchIndex-1;var w;if(r>0||p.search.length&&t==e.RIGHT)return!1;function x(){switch(t){case e.LEFT:return~y.activeMatchIndex?f:l;case e.RIGHT:return~y.activeMatchIndex&&d!==l?h:(p.activate(),!1);case e.BACKSPACE:return~y.activeMatchIndex?y.removeChoice(d)?f:d:l;case e.DELETE:return!!~y.activeMatchIndex&&(y.removeChoice(y.activeMatchIndex),d)}}p.close(),n=x(),p.selected.length&&!1!==n?y.activeMatchIndex=Math.min(l,Math.max(0,n)):y.activeMatchIndex=-1;return!0}(n)),r&&n!=e.TAB&&(t.preventDefault(),t.stopPropagation())}))})),p.searchInput.on("keyup",(function(t){if(e.isVerticalMovement(t.which)||a.$evalAsync((function(){p.activeIndex=!1===p.taggingLabel?-1:0})),p.tagging.isActivated&&p.search.length>0){if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||e.isVerticalMovement(t.which))return;if(p.activeIndex=!1===p.taggingLabel?-1:0,!1===p.taggingLabel)return;var n,r,l,d=angular.copy(p.items),h=angular.copy(p.items),f=!1,y=-1;if(void 0!==p.tagging.fct){if((r=p.$filter("filter")(d,{isTag:!0})).length>0&&(l=r[0]),d.length>0&&l&&(f=!0,d=d.slice(1,d.length),h=h.slice(1,h.length)),n=p.tagging.fct(p.search),h.some((function(e){return angular.equals(e,n)}))||p.selected.some((function(e){return angular.equals(e,n)})))return void a.$evalAsync((function(){p.activeIndex=0,p.items=d}));n&&(n.isTag=!0)}else{if((r=p.$filter("filter")(d,(function(e){return e.match(p.taggingLabel)}))).length>0&&(l=r[0]),void 0!==d[0]&&d.length>0&&l&&(f=!0,d=d.slice(1,d.length),h=h.slice(1,h.length)),n=p.search+" "+p.taggingLabel,x(p.selected,p.search)>-1)return;if(w(h.concat(p.selected)))return void(f&&(d=h,a.$evalAsync((function(){p.activeIndex=0,p.items=d}))));if(w(h))return void(f&&(p.items=h.slice(1,h.length)))}f&&(y=x(p.selected,n)),y>-1?d=d.slice(y+1,d.length-1):(d=[],n&&d.push(n),d=d.concat(h)),a.$evalAsync((function(){if(p.activeIndex=0,p.items=d,p.isGrouped){var e=n?d.slice(1):d;p.setItemsFn(e),n&&(p.items.unshift(n),p.groups.unshift({name:"",items:[n],tagging:!0}))}}))}})),p.searchInput.on("blur",(function(){r((function(){y.activeMatchIndex=-1}))}))}}}]),r.directive("uiSelectNoChoice",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){return t.addClass("ui-select-no-choice"),(t.parent().attr("theme")||e.theme)+"/no-choice.tpl.html"}}}]),r.directive("uiSelectSingle",["$timeout","$compile",function(n,r){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(a,l,d,h){var p=h[0],f=h[1];f.$parsers.unshift((function(e){if(t(e))return e;var n={};return n[p.parserResult.itemName]=e,p.parserResult.modelMapper(a,n)})),f.$formatters.unshift((function(e){if(t(e))return e;var n=p.parserResult&&p.parserResult.source(a,{$select:{search:""}}),r={};if(n){var l=function(t){return r[p.parserResult.itemName]=t,p.parserResult.modelMapper(a,r)===e};if(p.selected&&l(p.selected))return p.selected;for(var d=n.length-1;d>=0;d--)if(l(n[d]))return n[d]}return e})),a.$watch("$select.selected",(function(e){f.$viewValue!==e&&f.$setViewValue(e)})),f.$render=function(){p.selected=f.$viewValue},a.$on("uis:select",(function(e,r){p.selected=r;var l={};l[p.parserResult.itemName]=r,n((function(){p.onSelectCallback(a,{$item:r,$model:t(r)?r:p.parserResult.modelMapper(a,l)})}))})),a.$on("uis:close",(function(e,t){n((function(){p.focusser.prop("disabled",!1),t||p.focusser[0].focus()}),0,!1)})),a.$on("uis:activate",(function(){y.prop("disabled",!0)}));var y=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");r(y)(a),p.focusser=y,p.focusInput=y,l.parent().append(y),y.bind("focus",(function(){a.$evalAsync((function(){p.focus=!0}))})),y.bind("blur",(function(){a.$evalAsync((function(){p.focus=!1}))})),y.bind("keydown",(function(t){if(t.which===e.BACKSPACE&&!1!==p.backspaceReset)return t.preventDefault(),t.stopPropagation(),p.select(void 0),void a.$apply();t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||(t.which!=e.DOWN&&t.which!=e.UP&&t.which!=e.ENTER&&t.which!=e.SPACE||(t.preventDefault(),t.stopPropagation(),p.activate()),a.$digest())})),y.bind("keyup input",(function(t){t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||t.which==e.ENTER||t.which===e.BACKSPACE||(p.activate(y.val()),y.val(""),a.$digest())}))}}}]),r.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function(e,t,n){return{require:["^^uiSelect","^ngModel"],link:function(t,r,a,l){if(null===t[a.uiSelectSort])throw n("sort","Expected a list to sort");var d=l[0],h=l[1],p=angular.extend({axis:"horizontal"},t.$eval(a.uiSelectSortOptions)).axis;t.$watch((function(){return d.sortable}),(function(e){e?r.attr("draggable",!0):r.removeAttr("draggable")})),r.on("dragstart",(function(e){r.addClass("dragging"),(e.dataTransfer||e.originalEvent.dataTransfer).setData("text",t.$index.toString())})),r.on("dragend",(function(){w("dragging")}));var f,y=function(e,t){this.splice(t,0,this.splice(e,1)[0])},w=function(e){angular.forEach(d.$element.querySelectorAll("."+e),(function(t){angular.element(t).removeClass(e)}))},x=function(e){e.preventDefault(),("vertical"===p?e.offsetY||e.layerY||(e.originalEvent?e.originalEvent.offsetY:0):e.offsetX||e.layerX||(e.originalEvent?e.originalEvent.offsetX:0))<this["vertical"===p?"offsetHeight":"offsetWidth"]/2?(w("dropping-after"),r.addClass("dropping-before")):(w("dropping-before"),r.addClass("dropping-after"))},j=function(t){t.preventDefault();var n=parseInt((t.dataTransfer||t.originalEvent.dataTransfer).getData("text"),10);e.cancel(f),f=e((function(){O(n)}),20)},O=function(e){var n=t.$eval(a.uiSelectSort),l=n[e],d=null;d=r.hasClass("dropping-before")?e<t.$index?t.$index-1:t.$index:e<t.$index?t.$index:t.$index+1,y.apply(n,[e,d]),h.$setViewValue(Date.now()),t.$apply((function(){t.$emit("uiSelectSort:change",{array:n,item:l,from:e,to:d})})),w("dropping"),w("dropping-before"),w("dropping-after"),r.off("drop",j)};r.on("dragenter",(function(){r.hasClass("dragging")||(r.addClass("dropping"),r.on("dragover",x),r.on("drop",j))})),r.on("dragleave",(function(e){e.target==r&&(w("dropping"),w("dropping-before"),w("dropping-after"),r.off("dragover",x),r.off("drop",j))}))}}}]),r.directive("uisOpenClose",["$parse","$timeout",function(e,t){return{restrict:"A",require:"uiSelect",link:function(n,r,a,l){l.onOpenCloseCallback=e(a.uisOpenClose),n.$watch("$select.open",(function(e,r){e!==r&&t((function(){l.onOpenCloseCallback(n,{isOpen:e})}))}))}}}]),r.service("uisRepeatParser",["uiSelectMinErr","$parse",function(e,t){this.parse=function(n){var r;if(!(r=n.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/)))throw e("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",n);var a=r[5],l="";if(r[3]){a=r[5].replace(/(^\()|(\)$)/g,"");var d=r[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);d&&d[1].trim()&&(l=d[1],a=a.replace(l,""))}return{itemName:r[4]||r[2],keyName:r[3],source:t(a),filters:l,trackByExp:r[6],modelMapper:t(r[1]||r[4]||r[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}},this.getGroupNgRepeatExpression=function(){return"$group in $select.groups track by $group.name"}}])}(),angular.module("ui.select").run(["$templateCache",function(e){e.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" ng-show="$select.open && $select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><span class="ui-select-choices-row-inner"></span></div></li></ul>'),e.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected track by $index"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></span></span></span>'),e.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></a></span></div>'),e.put("bootstrap/no-choice.tpl.html",'<ul class="ui-select-no-choice dropdown-menu" ng-show="$select.items.length == 0"><li ng-transclude=""></li></ul>'),e.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-expanded="{{$select.open}}" aria-label="{{$select.baseTitle}}" ng-class="{\'spinner\': $select.refreshing}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><span ng-show="$select.open && $select.refreshing && $select.spinnerEnabled" class="ui-select-refreshing {{$select.spinnerClass}}"></span> <input type="search" autocomplete="off" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" class="form-control ui-select-search" ng-class="{ \'ui-select-search-hidden\' : !$select.searchEnabled }" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.open"><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("select2/choices.tpl.html",'<ul tabindex="-1" class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.choiceGrouped($group) }"><div ng-show="$select.choiceGrouped($group)" class="ui-select-choices-group-label select2-result-label" ng-bind="$group.name"></div><ul id="ui-select-choices-{{ $select.generatedId }}" ng-class="{\'select2-result-sub\': $select.choiceGrouped($group), \'select2-result-single\': !$select.choiceGrouped($group) }"><li role="option" ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this), \'select2-disabled\': $select.isDisabled(this)}"><div class="select2-result-label ui-select-choices-row-inner"></div></li></ul></li></ul>'),e.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected track by $index" ng-class="{\'select2-search-choice-focus\':$selectMultiple.activeMatchIndex === $index, \'select2-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span uis-transclude-append=""></span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$selectMultiple.removeChoice($index)" tabindex="-1"></a></li></span>'),e.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.toggle($event)" aria-label="{{ $select.baseTitle }} select"><span ng-show="$select.isEmpty()" class="select2-chosen">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""></span> <abbr ng-if="$select.allowClear && !$select.isEmpty()" class="select2-search-choice-close" ng-click="$select.clear($event)"></abbr> <span class="select2-arrow ui-select-toggle"><b></b></span></a>'),e.put("select2/no-choice.tpl.html",'<div class="ui-select-no-choice dropdown" ng-show="$select.items.length == 0"><div class="dropdown-content"><div data-selectable="" ng-transclude=""></div></div></div>'),e.put("select2/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"></span><li class="select2-search-field"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="select2-input ui-select-search" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;" ondrop="return false;"></li></ul><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open || $select.items.length === 0}"><div class="ui-select-choices"></div></div></div>'),e.put("select2/select.tpl.html",'<div class="ui-select-container select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled, \'select2-container-active\': $select.focus, \'select2-allowclear\': $select.allowClear && !$select.isEmpty()}"><div class="ui-select-match"></div><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="search-container" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled, \'select2-search\':$select.searchEnabled}"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" ng-class="{\'select2-active\': $select.refreshing}" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" class="ui-select-search select2-input" ng-model="$select.search"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div></div>'),e.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown" ng-class="{\'single\': !$select.multiple, \'multi\': $select.multiple}"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"></div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>'),e.put("selectize/match-multiple.tpl.html",'<div class="ui-select-match" data-value="" ng-repeat="$item in $select.selected track by $index" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'active\':$selectMultiple.activeMatchIndex === $index}" ui-select-sort="$select.selected"><span class="ui-select-match-item" ng-class="{\'select-locked\':$select.isLocked(this, $index)}"><span uis-transclude-append=""></span> <span class="remove ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&times;</span></span></div>'),e.put("selectize/match.tpl.html",'<div ng-hide="$select.searchEnabled && ($select.open || $select.isEmpty())" class="ui-select-match"><span ng-show="!$select.searchEnabled && ($select.isEmpty() || $select.open)" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty() || $select.open" ng-transclude=""></span></div>'),e.put("selectize/no-choice.tpl.html",'<div class="ui-select-no-choice selectize-dropdown" ng-show="$select.items.length == 0"><div class="selectize-dropdown-content"><div data-selectable="" ng-transclude=""></div></div></div>'),e.put("selectize/select-multiple.tpl.html",'<div class="ui-select-container selectize-control multi plugin-remove_button" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-model="$select.search" ng-disabled="$select.disabled" aria-expanded="{{$select.open}}" aria-label="{{ $select.baseTitle }}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search ui-select-toggle" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.isEmpty() && !$select.open" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>')}])},,,,function(e,t){angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(t,n){angular.isFunction(n)&&(n={post:n});var r,a=t.contents().remove();return{pre:n&&n.pre?n.pre:null,post:function(t,l){r||(r=e(a)),r(t,(function(e){l.append(e)})),n&&n.post&&n.post.apply(null,arguments)}}}}}])},function(e,t,n){"use strict";var r=n(3),a=n(140);r.a.controller("FreeTrialModalController",["$scope",function(e){e.buttonClass="btn-primary",e.startFreeTrial=function(t,n){return Object(a.b)(t,n,e)},e.paywallPrompt=function(e){return Object(a.a)(e)}}]),r.a.controller("UpgradeModalController",["$scope",function(e){e.buttonClass="btn-primary",e.upgradePlan=function(t){return Object(a.c)(t,e)}}])},function(e,t,n){"use strict";var r=n(36),a=n.n(r),l=n(3),d=(n(276),n(22)),h=0,p=new Date;l.a.factory("eventTracking",["$http","localStorage",function(e,t){var n=function(){var e=t("mbEvents");return null==e&&t("mbEvents",e={}),e},r=function(e){return n()[e]||!1},l=function(e){var r=n();return r[e]=!0,t("mbEvents",r)};return{send:function(e,t,n,r){return ga("send","event",e,t,n,r)},sendGAOnce:function(e,t,n,a){if(!r(t))return l(t),this.send(e,t,n,a)},editingSessionHeartbeat:function(t){if(sl_console.log("[Event] heartbeat trigger",t),p<=new Date){sl_console.log("[Event] send heartbeat request",t),function(t){e({url:"/editingSession/".concat(window.project_id),method:"PUT",data:{segmentation:t},headers:{"X-CSRF-Token":window.csrfToken}})}(t);var n=++h<=2?30:h<=6?60*(h-2):300;return p=a()().add(n,"seconds").toDate()}},sendMB:d.b,sendMBSampled:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;Math.random()<n&&this.sendMB(e,t)},sendMBOnce:function(e,t){r(e)||(l(e),this.sendMB(e,t))},eventInCache:function(e){return r(e)}}}]);$(".navbar a").on("click",(function(e){var t=$(e.target).attr("href");if(null!=t)return ga("send","event","navigation","top menu bar",t)}))},function(e,t,n){"use strict";n(45),n(81);var r=n(3);r.a.controller("SystemMessagesController",["$http","$scope",function(e,t){function n(){!document.hidden&&navigator.onLine&&e.get("/system/messages").then((function(e){e.headers("content-type").includes("json")&&(t.messages=e.data)})).catch((function(){}))}t.messages=[],n(),setInterval(n,9e5)}]);r.a.controller("SystemMessageController",["$scope","$sce",function(e,t){return e.hidden=$.localStorage("systemMessage.hide.".concat(e.message._id)),e.protected="protected"===e.message._id,e.htmlContent=e.message.content,e.hide=function(){if(!e.protected)return e.hidden=!0,$.localStorage("systemMessage.hide.".concat(e.message._id),!0)}}])},,,function(e,t,n){"use strict";var r=n(3);r.a.directive("stopPropagation",["$http",function(e){return{restrict:"A",link:function(e,t,n){return t.bind(n.stopPropagation,(function(e){return e.stopPropagation()}))}}}]);r.a.directive("preventDefault",["$http",function(e){return{restrict:"A",link:function(e,t,n){return t.bind(n.preventDefault,(function(e){return e.preventDefault()}))}}}])},function(e,t,n){"use strict";var r=n(3);function a(e){e.focus();var t=e.val();if(null!=e[0].setSelectionRange){var n=t.lastIndexOf(".");return-1===n&&(n=t.length),e[0].setSelectionRange(0,n)}}r.a.directive("focusWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch(r.focusWhen,(function(t){if(t)return e((function(){return n.focus()}))}))}}}]),r.a.directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){return e.$on(n.focusOn,(function(){return t.focus()}))}}}]),r.a.directive("selectWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch(r.selectWhen,(function(t){if(t)return e((function(){return n.select()}))}))}}}]),r.a.directive("selectOn",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){return e.$on(n.selectOn,(function(){return t.select()}))}}}]),r.a.directive("selectNameWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch(r.selectNameWhen,(function(t){if(t)return e((function(){return a(n)}))}))}}}]),r.a.directive("selectNameOn",(function(){return{restrict:"A",link:function(e,t,n){return e.$on(n.selectNameOn,(function(){return a(t)}))}}})),r.a.directive("focus",["$timeout",function(e){return{scope:{trigger:"@focus"},link:function(t,n){return t.$watch("trigger",(function(t){if("true"===t)return e((function(){return n[0].focus()}))}))}}}])},function(e,t,n){"use strict";var r=n(3),a=n(298),l=n.n(a);r.a.directive("fineUpload",["$timeout",function(e){return{scope:{multiple:"=",endpoint:"@",templateId:"@",sizeLimit:"@",allowedExtensions:"=",onCompleteCallback:"=",onUploadCallback:"=",onValidateBatch:"=",onErrorCallback:"=",onSubmitCallback:"=",onCancelCallback:"=",autoUpload:"=",params:"=",control:"="},link:function(e,t,n){var r,a,d=e.multiple||!1,h=e.endpoint,p=e.templateId;a=null!=e.allowedExtensions?{allowedExtensions:e.allowedExtensions}:{},e.sizeLimit&&(a.sizeLimit=e.sizeLimit);var f=e.maxConnections||1,y=e.onCompleteCallback||function(){},w=e.onUploadCallback||function(){},x=e.onErrorCallback||function(){},j=e.onValidateBatch||function(){},O=e.onSubmitCallback||function(){},C=e.onCancelCallback||function(){};r=null==e.autoUpload||e.autoUpload;var S=e.params||{};S._csrf=window.csrfToken;var _=new l.a.FineUploader({element:t[0],multiple:d,autoUpload:r,disabledCancelForFormUploads:!0,validation:a,maxConnections:f,request:{endpoint:h,forceMultipart:!0,params:S,paramsInBody:!1},callbacks:{onComplete:y,onUpload:w,onValidateBatch:j,onError:x,onSubmit:O,onCancel:C},template:p,failedUploadTextDisplay:{mode:"custom",responseProperty:"error"}});return window.q=_,null!=e.control&&(e.control.q=_),_}}}])},function(e,t,n){"use strict";n(3).a.directive("onEnter",(function(){return function(e,t,n){return t.bind("keydown keypress",(function(t){if(13===t.which)return e.$apply((function(){return e.$eval(n.onEnter,{event:t})})),t.preventDefault()}))}}))},function(e,t,n){"use strict";n(16),n(4),n(10),n(13),n(8),n(7),n(17),n(11),n(12),n(14),n(6),n(9);function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,h=!0,p=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return h=e.done,e},e:function(e){p=!0,d=e},f:function(){try{h||null==n.return||n.return()}finally{if(p)throw d}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(3).a.factory("validateCaptcha",(function(){var e=[],t=function(t){var n,a=r(e);try{for(a.s();!(n=a.n()).done;){(0,n.value)(t)}}catch(e){a.e(e)}finally{a.f()}e=[]},n=null;return function(r,a){if(null==r&&(r=function(){}),"undefined"==typeof grecaptcha||null===grecaptcha||a)return r();if(e.push(r),e.push((function(){return grecaptcha.reset()})),null==n){var l=$("#recaptcha")[0];n=grecaptcha.render(l,{callback:t})}return grecaptcha.execute(n)}}))},function(e,t,n){"use strict";n(3).a.factory("validateCaptchaV3",(function(){var e=window.grecaptcha,t=window.ExposedSettings;return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&t&&t.recaptchaSiteKeyV3&&e.ready((function(){e.execute(t.recaptchaSiteKeyV3,{action:n}).then(r)}))}}))},function(e,t,n){"use strict";n(30),n(4);var r=n(3),a=n(36),l=n.n(a);l.a.updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}}),r.a.filter("formatDate",(function(){return function(e,t){return e?(null==t&&(t="Do MMM YYYY, h:mm a"),l()(e).format(t)):"N/A"}})),r.a.filter("utcDate",(function(){return function(e,t){return e?(null==t&&(t="D MMM YYYY, HH:mm:ss"),l()(e).utc().format(t)+" UTC"):"N/A"}})),r.a.filter("relativeDate",(function(){return function(e){return l()(e).calendar()}})),r.a.filter("fromNowDate",(function(){return function(e){return l()(e).fromNow()}}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n(7),n(53),n(26),n(16),n(4),n(10),n(13),n(8),n(17),n(11),n(12),n(14),n(6),n(9);var r=n(3);n(332);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,h=!0,p=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return h=e.done,e},e:function(e){p=!0,d=e},f:function(){try{h||null==n.return||n.return()}finally{if(p)throw d}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}r.a.controller("ContactModal",["$scope","$modal","sessionStorage",function(e,t,n){n("contact-form.user-input",null),e.contactUsModal=function(){t.open({templateUrl:"contactModalTemplate",controller:"ContactModalController",scope:e})}}]),r.a.controller("ContactGeneralModal",["$scope","$modal","sessionStorage",function(e,t,n){n("contact-form.user-input",null),e.openModal=function(){t.open({templateUrl:"contactGeneralModalTemplate",controller:"ContactGeneralModalController"})}}]),r.a.controller("ContactModalController",["$scope","$modalInstance",function(e,t){return e.close=function(){return t.close()}}]),r.a.controller("ContactGeneralModalController",["$scope","$modalInstance",function(e,t){return e.close=function(){return t.close()}}]),t.default=r.a.controller("ContactFormController",["$scope","algoliaSearch","eventTracking","$http","sessionStorage",function(e,t,n,r,l){var d=l("contact-form.user-input");d?e.form=d:(e.form={email:""},window.project_id&&(e.form.project_url=window.location.href)),e.sent=!1,e.sending=!1,e.suggestions=[],e.form.important_message="",e.$on("modal.closing",(function(){e.sent?l("contact-form.user-input",null):l("contact-form.user-input",{subject:e.form.subject,message:e.form.message,project_url:e.form.project_url})}));var h=function(t,r){var l=function(){var e,t=[],n=a(r.hits);try{for(n.s();!(e=n.n()).done;){var l=e.value,d=l&&l.pageName?l.pageName.replace(/\s/g,"_"):void 0,h=encodeURIComponent(d),p=l.kb?"how-to":"latex",f=l.sectionName&&""!==l.sectionName,y=f?"#".concat(l.sectionName.replace(/\s/g,"_")):"",w=l._highlightResult.pageName.value;f&&(w+=" - "+l.sectionName),t.push({url:"/learn/".concat(p,"/").concat(h).concat(y),name:w})}}catch(e){n.e(e)}finally{n.f()}return t}();r.hits.length&&n.sendMB("contact-form-suggestions-shown"),e.$applyAsync((function(){return e.suggestions=l}))};e.contactUs=function(){if(e.form.email){e.sending=!0;var t={_csrf:window.csrfToken,email:e.form.email,message:e.form.message,projectUrl:e.form.project_url,subject:e.form.subject,inbox:e.inbox||"support",important_message:e.form.important_message},n=r.post("/support",t);n.then((function(t){return e.sent=!0})),n.catch((function(){e.error=!0,e.sending=!1,console.log("the request failed")}))}else console.log("email not set")},e.$watch("inbox",(function(t){return e.inbox}))();var p=e.$watch("showContactFormSuggestions",(function(e){null!=e&&(!0===e&&f(),p())})),f=function(){return e.$watch("form.subject",(function(n,r){n&&n!==r&&n.length>3?t.searchWiki(n,{hitsPerPage:3,typoTolerance:"strict"},h):e.suggestions=[]}))};e.clickSuggestionLink=function(e){n.sendMB("contact-form-suggestions-clicked",{url:e})}}])},function(e,t){e.exports={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(472);class a extends r.EventTarget{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const e=l.get(this);if("boolean"!=typeof e)throw new TypeError("Expected 'this' to be an 'AbortSignal' object, but got "+(null===this?"null":typeof this));return e}}r.defineEventAttribute(a.prototype,"abort");const l=new WeakMap;Object.defineProperties(a.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(a.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class d{constructor(){h.set(this,function(){const e=Object.create(a.prototype);return r.EventTarget.call(e),l.set(e,!1),e}())}get signal(){return p(this)}abort(){var e;e=p(this),!1===l.get(e)&&(l.set(e,!0),e.dispatchEvent({type:"abort"}))}}const h=new WeakMap;function p(e){const t=h.get(e);if(null==t)throw new TypeError("Expected 'this' to be an 'AbortController' object, but got "+(null===e?"null":typeof e));return t}Object.defineProperties(d.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(d.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),t.AbortController=d,t.AbortSignal=a,t.default=d,e.exports=d,e.exports.AbortController=e.exports.default=d,e.exports.AbortSignal=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=new WeakMap,a=new WeakMap;function l(e){const t=r.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function d(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function h(e,t){r.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(t);for(let e=0;e<n.length;++e){const t=n[e];t in this||Object.defineProperty(this,t,p(t))}}function p(e){return{get(){return l(this).event[e]},set(t){l(this).event[e]=t},configurable:!0,enumerable:!0}}function f(e){return{value(){const t=l(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function y(e){if(null==e||e===Object.prototype)return h;let t=a.get(e);return null==t&&(t=function(e,t){const n=Object.keys(t);if(0===n.length)return e;function r(t,n){e.call(this,t,n)}r.prototype=Object.create(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let a=0;a<n.length;++a){const l=n[a];if(!(l in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,l).value;Object.defineProperty(r.prototype,l,e?f(l):p(l))}}return r}(y(Object.getPrototypeOf(e)),e),a.set(e,t)),t}function w(e){return l(e).immediateStopped}function x(e,t){l(e).passiveListener=t}h.prototype={get type(){return l(this).event.type},get target(){return l(this).eventTarget},get currentTarget(){return l(this).currentTarget},composedPath(){const e=l(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return l(this).eventPhase},stopPropagation(){const e=l(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=l(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(l(this).event.bubbles)},get cancelable(){return Boolean(l(this).event.cancelable)},preventDefault(){d(l(this))},get defaultPrevented(){return l(this).canceled},get composed(){return Boolean(l(this).event.composed)},get timeStamp(){return l(this).timeStamp},get srcElement(){return l(this).eventTarget},get cancelBubble(){return l(this).stopped},set cancelBubble(e){if(!e)return;const t=l(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!l(this).canceled},set returnValue(e){e||d(l(this))},initEvent(){}},Object.defineProperty(h.prototype,"constructor",{value:h,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(h.prototype,window.Event.prototype),a.set(window.Event.prototype,h));const j=new WeakMap;function O(e){return null!==e&&"object"==typeof e}function C(e){const t=j.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function S(e,t){Object.defineProperty(e,"on"+t,function(e){return{get(){let t=C(this).get(e);for(;null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set(t){"function"==typeof t||O(t)||(t=null);const n=C(this);let r=null,a=n.get(e);for(;null!=a;)3===a.listenerType?null!==r?r.next=a.next:null!==a.next?n.set(e,a.next):n.delete(e):r=a,a=a.next;if(null!==t){const a={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(e,a):r.next=a}},configurable:!0,enumerable:!0}}(t))}function _(e){function t(){k.call(this)}t.prototype=Object.create(k.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let n=0;n<e.length;++n)S(t.prototype,e[n]);return t}function k(){if(!(this instanceof k)){if(1===arguments.length&&Array.isArray(arguments[0]))return _(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return _(e)}throw new TypeError("Cannot call a class as a function")}j.set(this,new Map)}k.prototype={addEventListener(e,t,n){if(null==t)return;if("function"!=typeof t&&!O(t))throw new TypeError("'listener' should be a function or an object.");const r=C(this),a=O(n),l=(a?Boolean(n.capture):Boolean(n))?1:2,d={listener:t,listenerType:l,passive:a&&Boolean(n.passive),once:a&&Boolean(n.once),next:null};let h=r.get(e);if(void 0===h)return void r.set(e,d);let p=null;for(;null!=h;){if(h.listener===t&&h.listenerType===l)return;p=h,h=h.next}p.next=d},removeEventListener(e,t,n){if(null==t)return;const r=C(this),a=(O(n)?Boolean(n.capture):Boolean(n))?1:2;let l=null,d=r.get(e);for(;null!=d;){if(d.listener===t&&d.listenerType===a)return void(null!==l?l.next=d.next:null!==d.next?r.set(e,d.next):r.delete(e));l=d,d=d.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=C(this),n=e.type;let r=t.get(n);if(null==r)return!0;const a=function(e,t){return new(y(Object.getPrototypeOf(t)))(e,t)}(this,e);let d=null;for(;null!=r;){if(r.once?null!==d?d.next=r.next:null!==r.next?t.set(n,r.next):t.delete(n):d=r,x(a,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,a)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(a);if(w(a))break;r=r.next}return x(a,null),function(e,t){l(e).eventPhase=t}(a,0),function(e,t){l(e).currentTarget=t}(a,null),!a.defaultPrevented}},Object.defineProperty(k.prototype,"constructor",{value:k,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(k.prototype,window.EventTarget.prototype),t.defineEventAttribute=S,t.EventTarget=k,t.default=k,e.exports=k,e.exports.EventTarget=e.exports.default=k,e.exports.defineEventAttribute=S},function(e,t,n){var r=n(849),a=n(564),l=n(850),d=0,h=Math.pow(36,4);function p(){return a((l()*h<<0).toString(36),4)}function f(){return d=d<h?d:0,++d-1}function y(){return"c"+(new Date).getTime().toString(36)+a(f().toString(36),4)+r()+(p()+p())}y.slug=function(){var e=(new Date).getTime().toString(36),t=f().toString(36).slice(-4),n=r().slice(0,1)+r().slice(-1),a=p().slice(-2);return e.slice(-2)+t+n+a},y.isCuid=function(e){return"string"==typeof e&&!!e.startsWith("c")},y.isSlug=function(e){if("string"!=typeof e)return!1;var t=e.length;return t>=7&&t<=10},y.fingerprint=r,e.exports=y},function(e,t,n){(function(t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,h="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")(),y=Object.prototype.toString,w=Math.max,x=Math.min,j=function(){return f.Date.now()};function O(e,t,n){var r,a,l,d,h,p,f=0,y=!1,O=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function k(t){var n=r,l=a;return r=a=void 0,f=t,d=e.apply(l,n)}function E(e){return f=e,h=setTimeout(T,t),y?k(e):d}function A(e){var n=e-p;return void 0===p||n>=t||n<0||O&&e-f>=l}function T(){var e=j();if(A(e))return R(e);h=setTimeout(T,function(e){var n=t-(e-p);return O?x(n,l-(e-f)):n}(e))}function R(e){return h=void 0,_&&r?k(e):(r=a=void 0,d)}function I(){var e=j(),n=A(e);if(r=arguments,a=this,p=e,n){if(void 0===h)return E(p);if(O)return h=setTimeout(T,t),k(p)}return void 0===h&&(h=setTimeout(T,t)),d}return t=S(t)||0,C(n)&&(y=!!n.leading,l=(O="maxWait"in n)?w(S(n.maxWait)||0,t):l,_="trailing"in n?!!n.trailing:_),I.cancel=function(){void 0!==h&&clearTimeout(h),f=0,r=p=a=h=void 0},I.flush=function(){return void 0===h?d:R(j())},I}function C(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function S(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==y.call(e)}(e))return NaN;if(C(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=C(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var h=a.test(e);return h||l.test(e)?d(e.slice(2),h?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return C(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),O(e,t,{leading:r,maxWait:t,trailing:a})}}).call(this,n(84))},function(e,t){e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);var t=e<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";var r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),n.length-1);e=Number(e/Math.pow(1024,r));var a=n[r];return e>=10||e%1==0?(t?"-":"")+e.toFixed(0)+" "+a:(t?"-":"")+e.toFixed(1)+" "+a}},function(e,t,n){"use strict";var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=n(863),p=n(864);e.exports=(a=r=function(){function e(e,t){this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1}var t,n,r,a=e.prototype;return a.headers=function(){var e=this.opts.companionHeaders||this.opts.serverHeaders||{};return Promise.resolve(l({},this.defaultHeaders,e))},a._getPostResponseFunc=function(e){var t=this;return function(n){return e?n:t.onReceiveResponse(n)}},a.onReceiveResponse=function(e){var t,n=this.uppy.getState().companion||{},r=this.opts.companionUrl,a=e.headers;a.has("i-am")&&a.get("i-am")!==n[r]&&this.uppy.setState({companion:l({},n,(t={},t[r]=a.get("i-am"),t))});return e},a._getUrl=function(e){return/^(https?:|)\/\//.test(e)?e:this.hostname+"/"+e},a._json=function(e){if(401===e.status)throw new h;if(e.status<200||e.status>300){var t="Failed request with status: "+e.status+". "+e.statusText;return e.json().then((function(e){throw t=e.message?t+" message: "+e.message:t,t=e.requestId?t+" request-Id: "+e.requestId:t,new Error(t)})).catch((function(){throw new Error(t)}))}return e.json()},a.preflight=function(e){var t=this;return this.preflightDone?Promise.resolve(this.allowedHeaders.slice()):fetch(this._getUrl(e),{method:"OPTIONS"}).then((function(e){return e.headers.has("access-control-allow-headers")&&(t.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map((function(e){return e.trim().toLowerCase()}))),t.preflightDone=!0,t.allowedHeaders.slice()})).catch((function(e){return t.uppy.log("[CompanionClient] unable to make preflight request "+e,"warning"),t.preflightDone=!0,t.allowedHeaders.slice()}))},a.preflightAndHeaders=function(e){var t=this;return Promise.all([this.preflight(e),this.headers()]).then((function(e){var n=e[0],r=e[1];return Object.keys(r).forEach((function(e){-1===n.indexOf(e.toLowerCase())&&(t.uppy.log("[CompanionClient] excluding unallowed header "+e),delete r[e])})),r}))},a.get=function(e,t){var n=this;return this.preflightAndHeaders(e).then((function(t){return p(n._getUrl(e),{method:"get",headers:t,credentials:n.opts.companionCookiesRule||"same-origin"})})).then(this._getPostResponseFunc(t)).then((function(e){return n._json(e)})).catch((function(t){return t.isAuthError||(t.message="Could not get "+n._getUrl(e)+". "+t.message),Promise.reject(t)}))},a.post=function(e,t,n){var r=this;return this.preflightAndHeaders(e).then((function(n){return p(r._getUrl(e),{method:"post",headers:n,credentials:r.opts.companionCookiesRule||"same-origin",body:JSON.stringify(t)})})).then(this._getPostResponseFunc(n)).then((function(e){return r._json(e)})).catch((function(t){return t.isAuthError||(t.message="Could not post "+r._getUrl(e)+". "+t.message),Promise.reject(t)}))},a.delete=function(e,t,n){var r=this;return this.preflightAndHeaders(e).then((function(n){return p(r.hostname+"/"+e,{method:"delete",headers:n,credentials:r.opts.companionCookiesRule||"same-origin",body:t?JSON.stringify(t):null})})).then(this._getPostResponseFunc(n)).then((function(e){return r._json(e)})).catch((function(t){return t.isAuthError||(t.message="Could not delete "+r._getUrl(e)+". "+t.message),Promise.reject(t)}))},t=e,(n=[{key:"hostname",get:function(){var e=this.uppy.getState().companion,t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client="+e.VERSION}}}])&&d(t.prototype,n),r&&d(t,r),e}(),r.VERSION="1.10.2",a)},function(e,t,n){var r=n(89).h;e.exports=function(e){var t={color:"#838999",icon:r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},r("g",{fill:"#A7AFB7",fillRule:"nonzero"},r("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),r("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})))};if(!e)return t;var n=e.split("/")[0],a=e.split("/")[1];if("text"===n)return{color:"#5a5e69",icon:r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},r("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"}))};if("image"===n)return{color:"#686de0",icon:r("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},r("g",{fill:"#686DE0",fillRule:"evenodd"},r("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),r("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),r("circle",{cx:"7.5",cy:"9.5",r:"1.5"})))};if("audio"===n)return{color:"#068dbb",icon:r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},r("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"}))};if("video"===n)return{color:"#19af67",icon:r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},r("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"}))};if("application"===n&&"pdf"===a)return{color:"#e25149",icon:r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},r("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"}))};return"application"===n&&-1!==["zip","x-7z-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(a)?{color:"#00C469",icon:r("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},r("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"}))}:t}},function(e,t){e.exports=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])']},function(e,t,n){var r={"./cs.json":[636,44],"./da.json":[637,45],"./de.json":[638,46],"./en.json":[639,47],"./es.json":[640,48],"./fi.json":[641,49],"./fr.json":[642,50],"./it.json":[643,53],"./ja.json":[644,54],"./ko.json":[645,55],"./nl.json":[646,68],"./no.json":[647,69],"./pl.json":[648,73],"./pt.json":[649,74],"./ru.json":[650,76],"./sv.json":[651,79],"./tr.json":[652,80],"./zh-CN.json":[653,84]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n.t(a,3)}))}a.keys=function(){return Object.keys(r)},a.id=479,e.exports=a},,,,,,,function(e,t,n){var r,a,l,d,h,p,f,y;e.exports=(y=n(530),a=(r=y).lib,l=a.WordArray,d=a.Hasher,h=r.algo,p=[],f=h.SHA1=d.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],l=n[2],d=n[3],h=n[4],f=0;f<80;f++){if(f<16)p[f]=0|e[t+f];else{var y=p[f-3]^p[f-8]^p[f-14]^p[f-16];p[f]=y<<1|y>>>31}var w=(r<<5|r>>>27)+h+p[f];w+=f<20?1518500249+(a&l|~a&d):f<40?1859775393+(a^l^d):f<60?(a&l|a&d|l&d)-1894007588:(a^l^d)-899497514,h=d,d=l,l=a<<30|a>>>2,a=r,r=w}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+l|0,n[3]=n[3]+d|0,n[4]=n[4]+h|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=d.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=d._createHelper(f),r.HmacSHA1=d._createHmacHelper(f),y.SHA1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return j}));n(60),n(43),n(98),n(7),n(99),n(55),n(26),n(46),n(4),n(18),n(65),n(52),n(30),n(11),n(12),n(14),n(6),n(8),n(9),n(16),n(10),n(13),n(17);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={book:10,part:20,addpart:20,chapter:30,addchap:30,section:40,addsec:40,subsection:50,subsubsection:60,paragraph:70,subparagraph:80},d="(".concat(Object.keys(l).join("|"),")"),h=new RegExp("".concat("^\\s*\\\\").concat(d).concat("\\s?\\*?\\s?").concat("(\\[([^\\]]+)\\])?").concat("\\s?\\*?\\s?").concat("{(.*)}"));function p(e){return f(e.split("\n"))}function f(e){var t=[];return e.forEach((function(e,n){var a=e.match(h);if(a){var d=r(a,5),p=d[1],f=d[3],y=d[4];t.push({line:n+1,title:x(f||y),level:l[p]})}})),t}var y=/([^\\]*)\\([^{]+){([^}]+)}(.*)/,w=/^([^{}]*?({[^{}]*?}[^{}]*?)*)}/;function x(e){var t=e.indexOf("}");if(t<0)return e;var n=e.match(w);n&&(e=n[1]);var a=e.match(y);if(!a)return e.substring(0,t);var l=r(a,5),d=l[1],h=l[2],p=l[3],f=l[4];return e="label"===h?"".concat(d).concat(f):"".concat(d).concat(p).concat(f)}function j(e){var t={},n=[];return e.forEach((function(e){var r=Object.keys(t),a=r.reverse().find((function(t){return t<e.level})),l=t[a];l?l.children?l.children.push(e):l.children=[e]:n.push(e),t[e.level]=e,r.filter((function(t){return t>e.level})).forEach((function(e){return delete t[e]}))})),n}},,,,,function(e,t,n){"use strict";(function(e){function r(e){l.length||(a(),!0),l[l.length]=e}n.d(t,"a",(function(){return r}));var a,l=[],d=0;function h(){for(;d<l.length;){var e=d;if(d+=1,l[e].call(),d>1024){for(var t=0,n=l.length-d;t<n;t++)l[t]=l[t+d];l.length-=d,d=0}}l.length=0,d=0,!1}var p,f,y,w=void 0!==e?e:self,x=w.MutationObserver||w.WebKitMutationObserver;function j(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof x?(p=1,f=new x(h),y=document.createTextNode(""),f.observe(y,{characterData:!0}),a=function(){p=-p,y.data=p}):a=j(h),r.requestFlush=a,r.makeRequestCallFromTimer=j}).call(this,n(84))},function(e,t,n){var r=n(831);e.exports=function(e,t){if(null==e)return{};var n,a,l=r(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(a=0;a<d.length;a++)n=d[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";e.exports=n(949)},function(e,t,n){var r=n(249);e.exports=function(e,t){if(null==e)return{};var n,a,l={},d=r(e);for(a=0;a<d.length;a++)n=d[a],t.indexOf(n)>=0||(l[n]=e[n]);return l},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(250),a=n(846);e.exports=function(e,t){e.prototype=r(t.prototype),e.prototype.constructor=e,a(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},,,,function(e,t,n){"use strict";var r=n(311);t.__esModule=!0,t.prefix=f,t.getClassSet=function(e){var t,n=((t={})[f(e)]=!0,t);if(e.bsSize){var r=h.SIZE_MAP[e.bsSize]||e.bsSize;n[f(e,r)]=!0}e.bsStyle&&(n[f(e,e.bsStyle)]=!0);return n},t.splitBsProps=function(e){var t={};return(0,a.default)(e).forEach((function(e){var n=e[0],r=e[1];O(n)||(t[n]=r)})),[j(e),t]},t.splitBsPropsAndOmit=function(e,t){var n={};t.forEach((function(e){n[e]=!0}));var r={};return(0,a.default)(e).forEach((function(e){var t=e[0],a=e[1];O(t)||n[t]||(r[t]=a)})),[j(e),r]},t.addStyle=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];w(n)(e)},t._curry=t.bsSizes=t.bsStyles=t.bsClass=void 0;var a=r(n(165)),l=r(n(367)),d=(r(n(179)),r(n(1))),h=n(501);function p(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[n.length-1];return"function"==typeof a?e.apply(void 0,n):function(t){return e.apply(void 0,n.concat([t]))}}}function f(e,t){var n=(e.bsClass||"").trim();return null==n&&invariant(!1),n+(t?"-"+t:"")}var y=p((function(e,t){var n=t.propTypes||(t.propTypes={}),r=t.defaultProps||(t.defaultProps={});return n.bsClass=d.default.string,r.bsClass=e,t}));t.bsClass=y;var w=p((function(e,t,n){"string"!=typeof t&&(n=t,t=void 0);var r=n.STYLES||[],a=n.propTypes||{};e.forEach((function(e){-1===r.indexOf(e)&&r.push(e)}));var h=d.default.oneOf(r);(n.STYLES=r,h._values=r,n.propTypes=(0,l.default)({},a,{bsStyle:h}),void 0!==t)&&((n.defaultProps||(n.defaultProps={})).bsStyle=t);return n}));t.bsStyles=w;var x=p((function(e,t,n){"string"!=typeof t&&(n=t,t=void 0);var r=n.SIZES||[],a=n.propTypes||{};e.forEach((function(e){-1===r.indexOf(e)&&r.push(e)}));var p=[];r.forEach((function(e){var t=h.SIZE_MAP[e];t&&t!==e&&p.push(t),p.push(e)}));var f=d.default.oneOf(p);return f._values=p,n.SIZES=r,n.propTypes=(0,l.default)({},a,{bsSize:f}),void 0!==t&&(n.defaultProps||(n.defaultProps={}),n.defaultProps.bsSize=t),n}));function j(e){return{bsClass:e.bsClass,bsSize:e.bsSize,bsStyle:e.bsStyle,bsRole:e.bsRole}}function O(e){return"bsClass"===e||"bsSize"===e||"bsStyle"===e||"bsRole"===e}t.bsSizes=x;var C=p;t._curry=C},function(e,t,n){"use strict";t.__esModule=!0,t.Style=t.State=t.DEVICE_SIZES=t.SIZE_MAP=t.Size=void 0;t.Size={LARGE:"large",SMALL:"small",XSMALL:"xsmall"};t.SIZE_MAP={large:"lg",medium:"md",small:"sm",xsmall:"xs",lg:"lg",md:"md",sm:"sm",xs:"xs"};t.DEVICE_SIZES=["lg","md","sm","xs"];t.State={SUCCESS:"success",WARNING:"warning",DANGER:"danger",INFO:"info"};t.Style={DEFAULT:"default",PRIMARY:"primary",LINK:"link",INVERSE:"inverse"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(210).f,a=n(173),l=n(213)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,l)&&r(e,l,{configurable:!0,value:t})}},function(e,t){e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,n,r,a,l,d,h){var p=function(e){var n=t[e]?t[e]:[],r=e.indexOf(":"),a=-1===r?[e]:[e.substring(0,r),e.substring(r+1)],l=Object.keys(t),d=0,h=l.length;for(;d<h;d++){var p=l[d];if("*"===p&&(n=n.concat(t[p])),2===a.length&&a[0]===p){n=n.concat(t[p]);break}}return n}(e);p.length&&function(e,t,n){var r=0,a=t.length;for(;r<a&&t[r];r++)t[r].event=e,t[r].apply(t[r],n)}(e,p,[n,r,a,l,d,h])},e.on=function(e,n){t[e]||(t[e]=[]),t[e].push(n)},e.once=function(t,n){this.on(t,(function r(){n.apply(this,arguments),e.off(t,r)}))},e.off=function(e,t){var n=[];if(e&&t)for(var r=this._fns[e],a=0,l=r?r.length:0;a<l;a++)r[a]!==t&&n.push(r[a]);n.length?this._fns[e]=n:delete this._fns[e]},e}},function(e,t){e.exports=function(e,t){var n="000000000"+e;return n.substr(n.length-t)}},function(e,t){e.exports=function(e){var t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}},function(e,t){e.exports=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&e.nodeType===Node.ELEMENT_NODE}},function(e,t){function n(e){var t="function"==typeof Map?new Map:void 0;return(n=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return r(e,arguments,d(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),l(a,e)})(e)}function r(e,t,n){return(r=a()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&l(a,n.prototype),a}).apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){var t,n;function NetworkError(t,n){var r;return void 0===n&&(n=null),(r=e.call(this,"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\n\nSource error: ["+t+"]")||this).isNetworkError=!0,r.request=n,r}return n=e,(t=NetworkError).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),NetworkError}(n(Error));e.exports=h},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),d=n(570),h=n(248).dashboard,p=n(295),f=l.createElement,y=function(e){var t,n;function l(t){var n;return(n=e.call(this,t)||this).validProps=p(t),n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var h=l.prototype;return h.componentDidMount=function(){this.installPlugin()},h.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin())},h.componentWillUnmount=function(){this.uninstallPlugin()},h.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:Dashboard"},this.props,{target:this.container});delete t.uppy,e.use(d,t),this.plugin=e.getPlugin(t.id)},h.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},h.render=function(){var e=this;return f("div",r({ref:function(t){e.container=t}},this.validProps))},l}(l.Component);y.propTypes=h,y.defaultProps={inline:!0},e.exports=y},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=n(89).h,f=n(145).Plugin,y=n(214),w=n(880),x=n(575),j=n(902),O=n(903),C=n(912),S=n(247),_=n(578),k=n(577),E=n(917),A=n(473),T=n(580).default||n(580),R=n(918),I=n(581).default||n(581),P=n(478);function D(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}function M(){return p("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30"},p("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))}e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).setOptions=function(t){e.prototype.setOptions.call(d(r),t),r.i18nInit()},r.i18nInit=function(){r.translator=new y([r.defaultLocale,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.setPluginState()},r.removeTarget=function(e){var t=r.getPluginState().targets.filter((function(t){return t.id!==e.id}));r.setPluginState({targets:t})},r.addTarget=function(e){var t=e.id||e.constructor.name,n=e.title||t,a=e.type;if("acquirer"===a||"progressindicator"===a||"editor"===a){var l={id:t,name:n,type:a},d=r.getPluginState().targets.slice();return d.push(l),r.setPluginState({targets:d}),r.el}r.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error")},r.hideAllPanels=function(){var e={activePickerPanel:!1,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1},t=r.getPluginState();t.activePickerPanel===e.activePickerPanel&&t.showAddFilesPanel===e.showAddFilesPanel&&t.showFileEditor===e.showFileEditor&&t.activeOverlayType===e.activeOverlayType||r.setPluginState(e)},r.showPanel=function(e){var t=r.getPluginState().targets.filter((function(t){return"acquirer"===t.type&&t.id===e}))[0];r.setPluginState({activePickerPanel:t,activeOverlayType:"PickerPanel"})},r.canEditFile=function(e){var t=r.getPluginState().targets;return r._getEditors(t).some((function(t){return r.uppy.getPlugin(t.id).canEditFile(e)}))},r.openFileEditor=function(e){var t=r.getPluginState().targets,n=r._getEditors(t);r.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),n.forEach((function(t){r.uppy.getPlugin(t.id).selectFile(e)}))},r.saveFileEditor=function(){var e=r.getPluginState().targets;r._getEditors(e).forEach((function(e){r.uppy.getPlugin(e.id).save()})),r.hideAllPanels()},r.openModal=function(){var e=D(),t=e.promise,n=e.resolve;if(r.savedScrollPosition=window.pageYOffset,r.savedActiveElement=document.activeElement,r.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),r.opts.animateOpenClose&&r.getPluginState().isClosing){r.el.addEventListener("animationend",(function e(){r.setPluginState({isHidden:!1}),r.el.removeEventListener("animationend",e,!1),n()}),!1)}else r.setPluginState({isHidden:!1}),n();return r.opts.browserBackButtonClose&&r.updateBrowserHistory(),document.addEventListener("keydown",r.handleKeyDownInModal),r.uppy.emit("dashboard:modal-open"),t},r.closeModal=function(e){void 0===e&&(e={});var t=e.manualClose,n=void 0===t||t,a=r.getPluginState(),l=a.isHidden,d=a.isClosing;if(!l&&!d){var h=D(),p=h.promise,f=h.resolve;if(r.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),r.opts.animateOpenClose){r.setPluginState({isClosing:!0});r.el.addEventListener("animationend",(function e(){r.setPluginState({isHidden:!0,isClosing:!1}),r.superFocus.cancel(),r.savedActiveElement.focus(),r.el.removeEventListener("animationend",e,!1),f()}),!1)}else r.setPluginState({isHidden:!0}),r.superFocus.cancel(),r.savedActiveElement.focus(),f();return document.removeEventListener("keydown",r.handleKeyDownInModal),n&&r.opts.browserBackButtonClose&&history.state&&history.state[r.modalName]&&history.go(-1),r.uppy.emit("dashboard:modal-closed"),p}},r.isModalOpen=function(){return!r.getPluginState().isHidden||!1},r.requestCloseModal=function(){return r.opts.onRequestCloseModal?r.opts.onRequestCloseModal():r.closeModal()},r.setDarkModeCapability=function(e){var t=r.uppy.getState().capabilities;r.uppy.setState({capabilities:l({},t,{darkMode:e})})},r.handleSystemDarkModeChange=function(e){var t=e.matches;r.uppy.log("[Dashboard] Dark mode is "+(t?"on":"off")),r.setDarkModeCapability(t)},r.toggleFileCard=function(e,t){var n=r.uppy.getFile(t);e?r.uppy.emit("dashboard:file-edit-start",n):r.uppy.emit("dashboard:file-edit-complete",n),r.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})},r.toggleAddFilesPanel=function(e){r.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})},r.addFiles=function(e){var t=e.map((function(e){return{source:r.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}}));try{r.uppy.addFiles(t)}catch(e){r.uppy.log(e)}},r.startListeningToResize=function(){r.resizeObserver=new T((function(e,t){var n=e[0].contentRect,a=n.width,l=n.height;r.uppy.log("[Dashboard] resized: "+a+" / "+l,"debug"),r.setPluginState({containerWidth:a,containerHeight:l,areInsidesReadyToBeVisible:!0})})),r.resizeObserver.observe(r.el.querySelector(".uppy-Dashboard-inner")),r.makeDashboardInsidesVisibleAnywayTimeout=setTimeout((function(){var e=r.getPluginState(),t=!r.opts.inline&&e.isHidden;e.areInsidesReadyToBeVisible||t||(r.uppy.log("[Dashboard] resize event didn't fire on time: defaulted to mobile layout","debug"),r.setPluginState({areInsidesReadyToBeVisible:!0}))}),1e3)},r.stopListeningToResize=function(){r.resizeObserver.disconnect(),clearTimeout(r.makeDashboardInsidesVisibleAnywayTimeout)},r.recordIfFocusedOnUppyRecently=function(e){r.el.contains(e.target)?r.ifFocusedOnUppyRecently=!0:(r.ifFocusedOnUppyRecently=!1,r.superFocus.cancel())},r.disableAllFocusableElements=function(e){var t=S(r.el.querySelectorAll(P));e?t.forEach((function(e){var t=e.getAttribute("tabindex");t&&(e.dataset.inertTabindex=t),e.setAttribute("tabindex","-1")})):t.forEach((function(e){"inertTabindex"in e.dataset?e.setAttribute("tabindex",e.dataset.inertTabindex):e.removeAttribute("tabindex")})),r.dashboardIsDisabled=e},r.updateBrowserHistory=function(){var e;history.state&&history.state[r.modalName]||history.pushState(l({},history.state,((e={})[r.modalName]=!0,e)),"");window.addEventListener("popstate",r.handlePopState,!1)},r.handlePopState=function(e){!r.isModalOpen()||e.state&&e.state[r.modalName]||r.closeModal({manualClose:!1}),!r.isModalOpen()&&e.state&&e.state[r.modalName]&&history.go(-1)},r.handleKeyDownInModal=function(e){27===e.keyCode&&r.requestCloseModal(e),9===e.keyCode&&E.forModal(e,r.getPluginState().activeOverlayType,r.el)},r.handleClickOutside=function(){r.opts.closeModalOnClickOutside&&r.requestCloseModal()},r.handlePaste=function(e){r.uppy.iteratePlugins((function(t){"acquirer"===t.type&&t.handleRootPaste&&t.handleRootPaste(e)}));var t=S(e.clipboardData.files);r.addFiles(t)},r.handleInputChange=function(e){e.preventDefault();var t=S(e.target.files);r.addFiles(t)},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation(),r.opts.disabled||r.opts.disableLocalFiles||(e.dataTransfer.dropEffect="copy",clearTimeout(r.removeDragOverClassTimeout),r.setPluginState({isDraggingOver:!0}))},r.handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),r.opts.disabled||r.opts.disableLocalFiles||(clearTimeout(r.removeDragOverClassTimeout),r.removeDragOverClassTimeout=setTimeout((function(){r.setPluginState({isDraggingOver:!1})}),50))},r.handleDrop=function(e,t){if(e.preventDefault(),e.stopPropagation(),!r.opts.disabled&&!r.opts.disableLocalFiles){clearTimeout(r.removeDragOverClassTimeout),r.setPluginState({isDraggingOver:!1}),r.uppy.iteratePlugins((function(t){"acquirer"===t.type&&t.handleRootDrop&&t.handleRootDrop(e)}));var n=!1;_(e.dataTransfer,{logDropError:function logDropError(e){r.uppy.log(e,"error"),n||(r.uppy.info(e.message,"error"),n=!0)}}).then((function(e){e.length>0&&(r.uppy.log("[Dashboard] Files were dropped"),r.addFiles(e))}))}},r.handleRequestThumbnail=function(e){r.opts.waitForThumbnailsBeforeUpload||r.uppy.emit("thumbnail:request",e)},r.handleCancelThumbnail=function(e){r.opts.waitForThumbnailsBeforeUpload||r.uppy.emit("thumbnail:cancel",e)},r.handleKeyDownInInline=function(e){9===e.keyCode&&E.forInline(e,r.getPluginState().activeOverlayType,r.el)},r.handlePasteOnBody=function(e){r.el.contains(document.activeElement)&&r.handlePaste(e)},r.handleComplete=function(e){var t=e.failed;r.opts.closeAfterFinish&&0===t.length&&r.requestCloseModal()},r.handleCancelRestore=function(){r.uppy.emit("restore-canceled")},r._openFileEditorWhenFilesAdded=function(e){var t=e[0];r.canEditFile(t)&&r.openFileEditor(t)},r.initEvents=function(){if(r.opts.trigger&&!r.opts.inline){var e=C(r.opts.trigger);e?e.forEach((function(e){return e.addEventListener("click",r.openModal)})):r.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}r.startListeningToResize(),document.addEventListener("paste",r.handlePasteOnBody),r.uppy.on("plugin-remove",r.removeTarget),r.uppy.on("file-added",r.hideAllPanels),r.uppy.on("dashboard:modal-closed",r.hideAllPanels),r.uppy.on("file-editor:complete",r.hideAllPanels),r.uppy.on("complete",r.handleComplete),document.addEventListener("focus",r.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",r.recordIfFocusedOnUppyRecently,!0),r.opts.inline&&r.el.addEventListener("keydown",r.handleKeyDownInInline),r.opts.autoOpenFileEditor&&r.uppy.on("files-added",r._openFileEditorWhenFilesAdded)},r.removeEvents=function(){var e=C(r.opts.trigger);!r.opts.inline&&e&&e.forEach((function(e){return e.removeEventListener("click",r.openModal)})),r.stopListeningToResize(),document.removeEventListener("paste",r.handlePasteOnBody),window.removeEventListener("popstate",r.handlePopState,!1),r.uppy.off("plugin-remove",r.removeTarget),r.uppy.off("file-added",r.hideAllPanels),r.uppy.off("dashboard:modal-closed",r.hideAllPanels),r.uppy.off("file-editor:complete",r.hideAllPanels),r.uppy.off("complete",r.handleComplete),document.removeEventListener("focus",r.recordIfFocusedOnUppyRecently),document.removeEventListener("click",r.recordIfFocusedOnUppyRecently),r.opts.inline&&r.el.removeEventListener("keydown",r.handleKeyDownInInline),r.opts.autoOpenFileEditor&&r.uppy.off("files-added",r._openFileEditorWhenFilesAdded)},r.superFocusOnEachUpdate=function(){var e=r.el.contains(document.activeElement),t=document.activeElement===document.body||null===document.activeElement,n=r.uppy.getState().info.isHidden,a=!r.opts.inline;n&&(a||e||t&&r.ifFocusedOnUppyRecently)?r.superFocus(r.el,r.getPluginState().activeOverlayType):r.superFocus.cancel()},r.afterUpdate=function(){!r.opts.disabled||r.dashboardIsDisabled?(!r.opts.disabled&&r.dashboardIsDisabled&&r.disableAllFocusableElements(!1),r.superFocusOnEachUpdate()):r.disableAllFocusableElements(!0)},r.cancelUpload=function(e){r.uppy.removeFile(e)},r.saveFileCard=function(e,t){r.uppy.setFileMeta(t,e),r.toggleFileCard(!1,t)},r._attachRenderFunctionToTarget=function(e){var t=r.uppy.getPlugin(e.id);return l({},e,{icon:t.icon||r.opts.defaultPickerIcon,render:t.render})},r._isTargetSupported=function(e){var t=r.uppy.getPlugin(e.id);return"function"!=typeof t.isSupported||t.isSupported()},r._getAcquirers=I((function(e){return e.filter((function(e){return"acquirer"===e.type&&r._isTargetSupported(e)})).map(r._attachRenderFunctionToTarget)})),r._getProgressIndicators=I((function(e){return e.filter((function(e){return"progressindicator"===e.type})).map(r._attachRenderFunctionToTarget)})),r._getEditors=I((function(e){return e.filter((function(e){return"editor"===e.type})).map(r._attachRenderFunctionToTarget)})),r.render=function(e){var t,n=r.getPluginState(),a=e.files,l=e.capabilities,d=e.allowNewUpload,h=Object.keys(a).filter((function(e){return!a[e].progress.uploadStarted})),p=Object.keys(a).filter((function(e){return a[e].progress.uploadStarted})),f=Object.keys(a).filter((function(e){return a[e].isPaused})),y=Object.keys(a).filter((function(e){return a[e].progress.uploadComplete})),x=Object.keys(a).filter((function(e){return a[e].error})),j=Object.keys(a).filter((function(e){return!a[e].progress.uploadComplete&&a[e].progress.uploadStarted})),O=j.filter((function(e){return!a[e].isPaused})),C=Object.keys(a).filter((function(e){return a[e].progress.preprocess||a[e].progress.postprocess})),S=p.length>0,_=100===e.totalProgress&&y.length===Object.keys(a).length&&0===C.length,k=S&&x.length===p.length,E=0!==j.length&&f.length===j.length,A=r._getAcquirers(n.targets),T=r._getProgressIndicators(n.targets),R=r._getEditors(n.targets);return t="auto"===r.opts.theme?l.darkMode?"dark":"light":r.opts.theme,["files","folders","both"].indexOf(r.opts.fileManagerSelectionType)<0&&(r.opts.fileManagerSelectionType="files",console.error('Unsupported option for "fileManagerSelectionType". Using default of "'+r.opts.fileManagerSelectionType+'".')),w({state:e,isHidden:n.isHidden,files:a,newFiles:h,uploadStartedFiles:p,completeFiles:y,erroredFiles:x,inProgressFiles:j,inProgressNotPausedFiles:O,processingFiles:C,isUploadStarted:S,isAllComplete:_,isAllErrored:k,isAllPaused:E,totalFileCount:Object.keys(a).length,totalProgress:e.totalProgress,allowNewUpload:d,acquirers:A,theme:t,disabled:r.opts.disabled,disableLocalFiles:r.opts.disableLocalFiles,direction:r.opts.direction,activePickerPanel:n.activePickerPanel,showFileEditor:n.showFileEditor,saveFileEditor:r.saveFileEditor,disableAllFocusableElements:r.disableAllFocusableElements,animateOpenClose:r.opts.animateOpenClose,isClosing:n.isClosing,getPlugin:r.uppy.getPlugin,progressindicators:T,editors:R,autoProceed:r.uppy.opts.autoProceed,id:r.id,closeModal:r.requestCloseModal,handleClickOutside:r.handleClickOutside,handleInputChange:r.handleInputChange,handlePaste:r.handlePaste,inline:r.opts.inline,showPanel:r.showPanel,hideAllPanels:r.hideAllPanels,log:r.uppy.log,i18n:r.i18n,i18nArray:r.i18nArray,removeFile:r.uppy.removeFile,uppy:r.uppy,info:r.uppy.info,note:r.opts.note,recoveredState:e.recoveredState,metaFields:n.metaFields,resumableUploads:l.resumableUploads||!1,individualCancellation:l.individualCancellation,isMobileDevice:l.isMobileDevice,pauseUpload:r.uppy.pauseResume,retryUpload:r.uppy.retryUpload,cancelUpload:r.cancelUpload,cancelAll:r.uppy.cancelAll,fileCardFor:n.fileCardFor,toggleFileCard:r.toggleFileCard,toggleAddFilesPanel:r.toggleAddFilesPanel,showAddFilesPanel:n.showAddFilesPanel,saveFileCard:r.saveFileCard,openFileEditor:r.openFileEditor,canEditFile:r.canEditFile,width:r.opts.width,height:r.opts.height,showLinkToFileUploadResult:r.opts.showLinkToFileUploadResult,fileManagerSelectionType:r.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:r.opts.proudlyDisplayPoweredByUppy,hideCancelButton:r.opts.hideCancelButton,hideRetryButton:r.opts.hideRetryButton,hidePauseResumeButton:r.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:r.opts.showRemoveButtonAfterComplete,containerWidth:n.containerWidth,containerHeight:n.containerHeight,areInsidesReadyToBeVisible:n.areInsidesReadyToBeVisible,isTargetDOMEl:r.isTargetDOMEl,parentElement:r.el,allowedFileTypes:r.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:r.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:r.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:r.opts.showSelectedFiles,handleCancelRestore:r.handleCancelRestore,handleRequestThumbnail:r.handleRequestThumbnail,handleCancelThumbnail:r.handleCancelThumbnail,isDraggingOver:n.isDraggingOver,handleDragOver:r.handleDragOver,handleDragLeave:r.handleDragLeave,handleDrop:r.handleDrop})},r.discoverProviderPlugins=function(){r.uppy.iteratePlugins((function(e){e&&!e.target&&e.opts&&e.opts.target===r.constructor&&r.addTarget(e)}))},r.install=function(){r.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:!1,showFileEditor:!1,metaFields:r.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});var e=r.opts,t=e.inline,n=e.closeAfterFinish;if(t&&n)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");r.uppy.opts.allowMultipleUploads&&n&&r.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploads` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");var a=r.opts.target;a&&r.mount(a,d(r)),(r.opts.plugins||[]).forEach((function(e){var t=r.uppy.getPlugin(e);t&&t.mount(d(r),t)})),r.opts.disableStatusBar||r.uppy.use(x,{id:r.id+":StatusBar",target:d(r),hideUploadButton:r.opts.hideUploadButton,hideRetryButton:r.opts.hideRetryButton,hidePauseResumeButton:r.opts.hidePauseResumeButton,hideCancelButton:r.opts.hideCancelButton,showProgressDetails:r.opts.showProgressDetails,hideAfterFinish:r.opts.hideProgressAfterFinish,locale:r.opts.locale,doneButtonHandler:r.opts.doneButtonHandler}),r.opts.disableInformer||r.uppy.use(j,{id:r.id+":Informer",target:d(r)}),r.opts.disableThumbnailGenerator||r.uppy.use(O,{id:r.id+":ThumbnailGenerator",thumbnailWidth:r.opts.thumbnailWidth,thumbnailType:r.opts.thumbnailType,waitForThumbnailsBeforeUpload:r.opts.waitForThumbnailsBeforeUpload,lazy:!r.opts.waitForThumbnailsBeforeUpload}),r.darkModeMediaQuery="undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;var l=!!r.darkModeMediaQuery&&r.darkModeMediaQuery.matches;r.uppy.log("[Dashboard] Dark mode is "+(l?"on":"off")),r.setDarkModeCapability(l),"auto"===r.opts.theme&&r.darkModeMediaQuery.addListener(r.handleSystemDarkModeChange),r.discoverProviderPlugins(),r.initEvents()},r.uninstall=function(){if(!r.opts.disableInformer){var e=r.uppy.getPlugin(r.id+":Informer");e&&r.uppy.removePlugin(e)}if(!r.opts.disableStatusBar){var t=r.uppy.getPlugin(r.id+":StatusBar");t&&r.uppy.removePlugin(t)}if(!r.opts.disableThumbnailGenerator){var n=r.uppy.getPlugin(r.id+":ThumbnailGenerator");n&&r.uppy.removePlugin(n)}(r.opts.plugins||[]).forEach((function(e){var t=r.uppy.getPlugin(e);t&&t.unmount()})),"auto"===r.opts.theme&&r.darkModeMediaQuery.removeListener(r.handleSystemDarkModeChange),r.unmount(),r.removeEvents()},r.id=r.opts.id||"Dashboard",r.title="Dashboard",r.type="orchestrator",r.modalName="uppy-Dashboard-"+A(),r.defaultLocale={strings:{closeModal:"Close Modal",importFrom:"Import from %{name}",addingMoreFiles:"Adding more files",addMoreFiles:"Add more files",dashboardWindowTitle:"File Uploader Window (Press escape to close)",dashboardTitle:"File Uploader",copyLinkToClipboardSuccess:"Link copied to clipboard",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",fileSource:"File source: %{name}",back:"Back",addMore:"Add more",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",finishEditingFile:"Finish editing file",save:"Save",saveChanges:"Save changes",cancel:"Cancel",myDevice:"My Device",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",dropHint:"Drop your files here",browseFiles:"browse files",browseFolders:"browse folders",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",poweredBy2:"%{backwardsCompat} %{uppy}",poweredBy:"Powered by"}};var a={target:"body",metaFields:[],trigger:"#uppy-select-files",inline:!1,width:750,height:550,thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:M,showLinkToFileUploadResult:!0,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,doneButtonHandler:function(){r.uppy.reset(),r.requestCloseModal()},note:null,closeModalOnClickOutside:!1,closeAfterFinish:!1,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:function(){return r.closeModal()},showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,browserBackButtonClose:!1,theme:"light",autoOpenFileEditor:!1,disabled:!1,disableLocalFiles:!1};return r.opts=l({},a,n),r.i18nInit(),r.superFocus=R(),r.ifFocusedOnUppyRecently=!1,r.makeDashboardInsidesVisibleAnywayTimeout=null,r.removeDragOverClassTimeout=null,r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n),r.prototype.onMount=function(){var e=this.el;k(e)||(e.dir="ltr")},r}(f),r.VERSION="1.21.1",a)},function(e,t,n){var r=n(477),a=n(89).h;e.exports=function(e){var t=e.file;if(t.preview)return a("img",{className:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview});var n=r(t.type),l=n.color,d=n.icon;return a("div",{className:"uppy-Dashboard-Item-previewIconWrap"},a("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:l}},d),a("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76"},a("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})))}},function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(89),l=a.h,d=function(e){var t,n;function a(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).triggerFileInputClick=function(){t.fileInput.click()},t.triggerFolderInputClick=function(){t.folderInput.click()},t.onFileInputChange=function(e){t.props.handleInputChange(e),e.target.value=null},t.renderHiddenInput=function(e,n){return l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:1!==t.props.maxNumberOfFiles,onChange:t.onFileInputChange,accept:t.props.allowedFileTypes,ref:n})},t.renderMyDeviceAcquirer=function(){return l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice"},l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:t.triggerFileInputClick},l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},l("g",{fill:"none",fillRule:"evenodd"},l("rect",{className:"uppy-ProviderIconBg",width:"32",height:"32",rx:"16",fill:"#2275D7"}),l("path",{d:"M21.973 21.152H9.863l-1.108-5.087h14.464l-1.246 5.087zM9.935 11.37h3.958l.886 1.444a.673.673 0 0 0 .585.316h6.506v1.37H9.935v-3.13zm14.898 3.44a.793.793 0 0 0-.616-.31h-.978v-2.126c0-.379-.275-.613-.653-.613H15.75l-.886-1.445a.673.673 0 0 0-.585-.316H9.232c-.378 0-.667.209-.667.587V14.5h-.782a.793.793 0 0 0-.61.303.795.795 0 0 0-.155.663l1.45 6.633c.078.36.396.618.764.618h13.354c.36 0 .674-.246.76-.595l1.631-6.636a.795.795 0 0 0-.144-.675z",fill:"#FFF"}))),l("div",{className:"uppy-DashboardTab-name"},t.props.i18n("myDevice"))))},t.renderBrowseButton=function(e,n){var r=t.props.acquirers.length;return l("button",{type:"button",className:"uppy-u-reset uppy-Dashboard-browse",onClick:n,"data-uppy-super-focusable":0===r},e)},t.renderDropPasteBrowseTagline=function(){var e=t.props.acquirers.length,n=t.props.fileManagerSelectionType,r=n.charAt(0).toUpperCase()+n.slice(1),a="browse",d="browse",h="browse";if("files"===n)try{a=t.props.i18n("browse"),d=t.props.i18n("browse"),h=t.props.i18n("browse")}catch(e){}try{d=t.props.i18n("browseFiles"),h=t.props.i18n("browseFolders")}catch(e){}var p,f=t.renderBrowseButton(a,t.triggerFileInputClick),y=t.renderBrowseButton(d,t.triggerFileInputClick),w=t.renderBrowseButton(h,t.triggerFolderInputClick);if(p=e>0?t.props.i18nArray("dropPasteImport"+r,{browseFiles:y,browseFolders:w,browse:f}):t.props.i18nArray("dropPaste"+r,{browseFiles:y,browseFolders:w,browse:f}),"files"===n)try{p=e>0?t.props.i18nArray("dropPasteImport",{browse:f}):t.props.i18nArray("dropPaste",{browse:f})}catch(e){}return t.props.disableLocalFiles&&(p=t.props.i18n("importFiles")),l("div",{className:"uppy-Dashboard-AddFiles-title"},p)},t.renderAcquirer=function(e){return l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id},l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"aria-controls":"uppy-DashboardContent-panel--"+e.id,"aria-selected":t.props.activePickerPanel.id===e.id,"data-uppy-super-focusable":!0,onClick:function(){return t.props.showPanel(e.id)}},e.icon(),l("div",{className:"uppy-DashboardTab-name"},e.name)))},t.renderAcquirers=function(e,n){var r=[].concat(e),a=r.splice(e.length-2,e.length);return l("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist"},!n&&t.renderMyDeviceAcquirer(),r.map((function(e){return t.renderAcquirer(e)})),l("span",{role:"presentation",style:"white-space: nowrap;"},a.map((function(e){return t.renderAcquirer(e)}))))},t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var d=a.prototype;return d.renderPoweredByUppy=function(){var e=l("span",null,l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11"},l("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})),l("span",{className:"uppy-Dashboard-poweredByUppy"},"Uppy")),t=this.props.i18nArray("poweredBy2",{backwardsCompat:this.props.i18n("poweredBy"),uppy:e});return l("a",{tabIndex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy"},t)},d.render=function(){var e=this;return l("div",{className:"uppy-Dashboard-AddFiles"},this.renderHiddenInput(!1,(function(t){e.fileInput=t})),this.renderHiddenInput(!0,(function(t){e.folderInput=t})),this.renderDropPasteBrowseTagline(),this.props.acquirers.length>0&&this.renderAcquirers(this.props.acquirers,this.props.disableLocalFiles),l("div",{className:"uppy-Dashboard-AddFiles-info"},this.props.note&&l("div",{className:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy(this.props)))},a}(a.Component);e.exports=d},function(e,t){e.exports=function(e){var t=e.target.tagName;"INPUT"!==t&&"TEXTAREA"!==t?(e.preventDefault(),e.stopPropagation()):e.stopPropagation()}},function(e,t){e.exports=function(){var e=document.createElement("div");return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&("FormData"in window&&"FileReader"in window)}},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=n(145).Plugin,f=n(214),y=n(897),w=n(576),x=n(900),j=n(901),O=n(577);e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).startUpload=function(){if(!r.uppy.getState().recoveredState)return r.uppy.upload().catch((function(){}));r.uppy.emit("restore-confirmed")},r.id=r.opts.id||"StatusBar",r.title="StatusBar",r.type="progressindicator",r.defaultLocale={strings:{uploading:"Uploading",upload:"Upload",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",retryUpload:"Retry upload",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"}}};return r.opts=l({},{target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null},n),r.i18nInit(),r.render=r.render.bind(d(r)),r.install=r.install.bind(d(r)),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var a=r.prototype;return a.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},a.i18nInit=function(){this.translator=new f([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},a.getTotalSpeed=function(e){var t=0;return e.forEach((function(e){t+=x(e.progress)})),t},a.getTotalETA=function(e){var t=this.getTotalSpeed(e);if(0===t)return 0;var n=e.reduce((function(e,t){return e+j(t.progress)}),0);return Math.round(n/t*10)/10},a.getUploadingState=function(e,t,n,r){if(e)return w.STATE_ERROR;if(t)return w.STATE_COMPLETE;if(n)return w.STATE_WAITING;for(var a=w.STATE_WAITING,l=Object.keys(r),d=0;d<l.length;d++){var h=r[l[d]].progress;if(h.uploadStarted&&!h.uploadComplete)return w.STATE_UPLOADING;h.preprocess&&a!==w.STATE_UPLOADING&&(a=w.STATE_PREPROCESSING),h.postprocess&&a!==w.STATE_UPLOADING&&a!==w.STATE_PREPROCESSING&&(a=w.STATE_POSTPROCESSING)}return a},a.render=function(e){var t=e.capabilities,n=e.files,r=e.allowNewUpload,a=e.totalProgress,l=e.error,d=e.recoveredState,h=Object.keys(n).map((function(e){return n[e]})),p=h.filter((function(e){return!e.progress.uploadStarted&&!e.progress.preprocess&&!e.progress.postprocess}));d&&(p=h);var f=h.filter((function(e){return e.progress.uploadStarted})).filter((function(e){return e.isPaused})),w=h.filter((function(e){return e.progress.uploadComplete})),x=h.filter((function(e){return e.error})),j=h.filter((function(e){return!e.progress.uploadComplete&&e.progress.uploadStarted})),O=j.filter((function(e){return!e.isPaused})),C=h.filter((function(e){return e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess})),S=h.filter((function(e){return e.progress.preprocess||e.progress.postprocess})),_=this.getTotalETA(O),k=0,E=0;C.forEach((function(e){k+=e.progress.bytesTotal||0,E+=e.progress.bytesUploaded||0}));var A=C.length>0,T=100===a&&w.length===Object.keys(n).length&&0===S.length,R=l&&x.length===h.length,I=0!==j.length&&f.length===j.length,P=j.length>0,D=t.resumableUploads||!1,M=!1!==t.uploadProgress,L=h.some((function(e){return e.isGhost}));return y({error:l,uploadState:this.getUploadingState(R,T,d,e.files||{}),allowNewUpload:r,totalProgress:a,totalSize:k,totalUploadedSize:E,isAllComplete:T,isAllPaused:I,isAllErrored:R,isUploadStarted:A,isUploadInProgress:P,isSomeGhost:L,recoveredState:d,complete:w.length,newFiles:p.length,numUploads:C.length,totalETA:_,files:n,i18n:this.i18n,pauseAll:this.uppy.pauseAll,resumeAll:this.uppy.resumeAll,retryAll:this.uppy.retryAll,cancelAll:this.uppy.cancelAll,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:D,supportsUploadProgress:M,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})},a.onMount=function(){var e=this.el;O(e)||(e.dir="ltr")},a.install=function(){var e=this.opts.target;e&&this.mount(e,this)},a.uninstall=function(){this.unmount()},r}(p),r.VERSION="1.9.6",a)},function(e,t){e.exports={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"}},function(e,t){e.exports=function(e){for(;e&&!e.dir;)e=e.parentNode;return e?e.dir:void 0}},function(e,t,n){var r=n(913),a=n(916);e.exports=function(e,t){var n=(void 0===t?{}:t).logDropError,l=void 0===n?function(){}:n;return e.items&&e.items[0]&&"webkitGetAsEntry"in e.items[0]?r(e,l):a(e)}},function(e,t){e.exports=function(e,t){if(t){var n=e.querySelector('[data-uppy-paneltype="'+t+'"]');if(n)return n}return e}},function(e,t,n){"use strict";n.r(t),function(e){var n=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var a=r[n];e.call(t,a[1],a[0])}},t}()}(),r="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,a=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),l="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(a):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var d=["top","right","bottom","left","width","height","size","weight"],h="undefined"!=typeof MutationObserver,p=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,a=0;function d(){n&&(n=!1,e()),r&&p()}function h(){l(d)}function p(){var e=Date.now();if(n){if(e-a<2)return;r=!0}else n=!0,r=!1,setTimeout(h,t);a=e}return p}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){r&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),h?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){r&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;d.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),f=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},y=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||a},w=_(0,0,0,0);function x(e){return parseFloat(e)||0}function j(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+x(e["border-"+n+"-width"])}),0)}function O(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return w;var r=y(e).getComputedStyle(e),a=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var a=r[n],l=e["padding-"+a];t[a]=x(l)}return t}(r),l=a.left+a.right,d=a.top+a.bottom,h=x(r.width),p=x(r.height);if("border-box"===r.boxSizing&&(Math.round(h+l)!==t&&(h-=j(r,"left","right")+l),Math.round(p+d)!==n&&(p-=j(r,"top","bottom")+d)),!function(e){return e===y(e).document.documentElement}(e)){var f=Math.round(h+l)-t,O=Math.round(p+d)-n;1!==Math.abs(f)&&(h-=f),1!==Math.abs(O)&&(p-=O)}return _(a.left,a.top,h,p)}var C="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof y(e).SVGGraphicsElement}:function(e){return e instanceof y(e).SVGElement&&"function"==typeof e.getBBox};function S(e){return r?C(e)?function(e){var t=e.getBBox();return _(0,0,t.width,t.height)}(e):O(e):w}function _(e,t,n,r){return{x:e,y:t,width:n,height:r}}var k=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=_(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=S(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),E=function(e,t){var n,r,a,l,d,h,p,y=(r=(n=t).x,a=n.y,l=n.width,d=n.height,h="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,p=Object.create(h.prototype),f(p,{x:r,y:a,width:l,height:d,top:a,right:r+l,bottom:d+a,left:r}),p);f(this,{target:e,contentRect:y})},A=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new n,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof y(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new k(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof y(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new E(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),T="undefined"!=typeof WeakMap?new WeakMap:new n,R=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=p.getInstance(),r=new A(t,n,this);T.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){R.prototype[e]=function(){var t;return(t=T.get(this))[e].apply(t,arguments)}}));var I=void 0!==a.ResizeObserver?a.ResizeObserver:R;t.default=I}.call(this,n(84))},function(e,t,n){"use strict";n.r(t);var r=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(a=e[n],l=t[n],!(a===l||r(a)&&r(l)))return!1;var a,l;return!0}t.default=function(e,t){var n;void 0===t&&(t=a);var r,l=[],d=!1;return function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];return d&&n===this&&t(a,l)||(r=e.apply(this,a),d=!0,n=this,l=a),r}}},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),d=n(1),h=n(570),p=n(248).dashboard,f=n(295),y=l.createElement,w=function(e){var t,n;function l(t){var n;return(n=e.call(this,t)||this).validProps=f(t),n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var d=l.prototype;return d.componentDidMount=function(){this.installPlugin()},d.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin()),e.open&&!this.props.open?this.plugin.closeModal():!e.open&&this.props.open&&this.plugin.openModal()},d.componentWillUnmount=function(){this.uninstallPlugin()},d.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:DashboardModal"},this.props,{onRequestCloseModal:this.props.onRequestClose});t.target||(t.target=this.container),delete t.uppy,e.use(h,t),this.plugin=e.getPlugin(t.id),this.props.open&&this.plugin.openModal()},d.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},d.render=function(){var e=this;return y("div",r({ref:function(t){e.container=t}},this.validProps))},l}(l.Component);w.propTypes=r({target:"undefined"!=typeof window?d.instanceOf(window.HTMLElement):d.any,open:d.bool,onRequestClose:d.func,closeModalOnClickOutside:d.bool,disablePageScrollWhenModalOpen:d.bool},p),w.defaultProps={},e.exports=w},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),d=n(920),h=n(248),p=n(295),f=l.createElement,y=function(e){var t,n;function l(t){var n;return(n=e.call(this,t)||this).validProps=p(t),n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var h=l.prototype;return h.componentDidMount=function(){this.installPlugin()},h.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin())},h.componentWillUnmount=function(){this.uninstallPlugin()},h.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:DragDrop"},this.props,{target:this.container});delete t.uppy,e.use(d,t),this.plugin=e.getPlugin(t.id)},h.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},h.render=function(){var e=this;return f("div",r({ref:function(t){e.container=t}},this.validProps))},l}(l.Component);y.propTypes={uppy:h.uppy,locale:h.locale},y.defaultProps={},e.exports=y},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),d=n(1),h=n(921),p=n(248).uppy,f=n(295),y=l.createElement,w=function(e){var t,n;function l(t){var n;return(n=e.call(this,t)||this).validProps=f(t),n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var d=l.prototype;return d.componentDidMount=function(){this.installPlugin()},d.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin())},d.componentWillUnmount=function(){this.uninstallPlugin()},d.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:ProgressBar"},this.props,{target:this.container});delete t.uppy,e.use(h,t),this.plugin=e.getPlugin(t.id)},d.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},d.render=function(){var e=this;return y("div",r({ref:function(t){e.container=t}},this.validProps))},l}(l.Component);w.propTypes={uppy:p,fixed:d.bool,hideAfterFinish:d.bool},w.defaultProps={},e.exports=w},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(2),d=n(1),h=n(575),p=n(248).uppy,f=n(295),y=l.createElement,w=function(e){var t,n;function l(t){var n;return(n=e.call(this,t)||this).validProps=f(t),n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var d=l.prototype;return d.componentDidMount=function(){this.installPlugin()},d.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin())},d.componentWillUnmount=function(){this.uninstallPlugin()},d.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:StatusBar"},this.props,{target:this.container});delete t.uppy,e.use(h,t),this.plugin=e.getPlugin(t.id)},d.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},d.render=function(){var e=this;return y("div",r({ref:function(t){e.container=t}},this.validProps))},l}(l.Component);w.propTypes={uppy:p,hideAfterFinish:d.bool,showProgressDetails:d.bool},w.defaultProps={},e.exports=w},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(1),d=n(2),h=n(922),p=n(248),f=d.createElement,y=function(e){var t,n;function l(){return e.apply(this,arguments)||this}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var d=l.prototype;return d.componentDidMount=function(){this.installPlugin()},d.componentDidUpdate=function(e){e.uppy!==this.props.uppy&&(this.uninstallPlugin(e),this.installPlugin())},d.componentWillUnmount=function(){this.uninstallPlugin()},d.installPlugin=function(){var e=this.props.uppy,t=r({id:"react:FileInput"},this.props,{target:this.container});delete t.uppy,e.use(h,t),this.plugin=e.getPlugin(t.id)},d.uninstallPlugin=function(e){void 0===e&&(e=this.props),e.uppy.removePlugin(this.plugin)},d.render=function(){var e=this;return f("div",{ref:function(t){e.container=t}})},l}(d.Component);y.propTypes={uppy:p.uppy,locale:p.locale,pretty:l.bool,inputName:l.string},y.defaultProps={},e.exports=y},function(e,t,n){var r=n(2),a=r.useEffect,l=r.useRef,d=n(145).Uppy;e.exports=function(e){if("function"!=typeof e)throw new TypeError("useUppy: expected a function that returns a new Uppy instance");var t=l(void 0);if(void 0===t.current&&(t.current=e(),!(t.current instanceof d)))throw new TypeError("useUppy: factory function must return an Uppy instance, got "+typeof t.current);return a((function(){return function(){t.current.close()}}),[]),t.current}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,a=n;return[a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]]].join("")}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){(function(e){ace.define("ace/snippets",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),a=e("./lib/event_emitter").EventEmitter,l=e("./lib/lang"),d=e("./range").Range,h=e("./range_list").RangeList,p=e("./keyboard/hash_handler").HashHandler,f=e("./tokenizer").Tokenizer,y=e("./clipboard"),w={CURRENT_WORD:function(e){return e.session.getTextRange(e.session.getWordRange())},SELECTION:function(e,t,n){var r=e.session.getTextRange();return n?r.replace(/\n\r?([ \t]*\S)/g,"\n"+n+"$1"):r},CURRENT_LINE:function(e){return e.session.getLine(e.getCursorPosition().row)},PREV_LINE:function(e){return e.session.getLine(e.getCursorPosition().row-1)},LINE_INDEX:function(e){return e.getCursorPosition().row},LINE_NUMBER:function(e){return e.getCursorPosition().row+1},SOFT_TABS:function(e){return e.session.getUseSoftTabs()?"YES":"NO"},TAB_SIZE:function(e){return e.session.getTabSize()},CLIPBOARD:function(e){return y.getText&&y.getText()},FILENAME:function(e){return/[^/\\]*$/.exec(this.FILEPATH(e))[0]},FILENAME_BASE:function(e){return/[^/\\]*$/.exec(this.FILEPATH(e))[0].replace(/\.[^.]*$/,"")},DIRECTORY:function(e){return this.FILEPATH(e).replace(/[^/\\]*$/,"")},FILEPATH:function(e){return"/not implemented.txt"},WORKSPACE_NAME:function(){return"Unknown"},FULLNAME:function(){return"Unknown"},BLOCK_COMMENT_START:function(e){var t=e.session.$mode||{};return t.blockComment&&t.blockComment.start||""},BLOCK_COMMENT_END:function(e){var t=e.session.$mode||{};return t.blockComment&&t.blockComment.end||""},LINE_COMMENT:function(e){return(e.session.$mode||{}).lineCommentStart||""},CURRENT_YEAR:x.bind(null,{year:"numeric"}),CURRENT_YEAR_SHORT:x.bind(null,{year:"2-digit"}),CURRENT_MONTH:x.bind(null,{month:"numeric"}),CURRENT_MONTH_NAME:x.bind(null,{month:"long"}),CURRENT_MONTH_NAME_SHORT:x.bind(null,{month:"short"}),CURRENT_DATE:x.bind(null,{day:"2-digit"}),CURRENT_DAY_NAME:x.bind(null,{weekday:"long"}),CURRENT_DAY_NAME_SHORT:x.bind(null,{weekday:"short"}),CURRENT_HOUR:x.bind(null,{hour:"2-digit",hour12:!1}),CURRENT_MINUTE:x.bind(null,{minute:"2-digit"}),CURRENT_SECOND:x.bind(null,{second:"2-digit"})};function x(e){var t=(new Date).toLocaleString("en-us",e);return 1==t.length?"0"+t:t}w.SELECTED_TEXT=w.SELECTION;var j=function(){this.snippetMap={},this.snippetNameMap={}};(function(){r.implement(this,a),this.getTokenizer=function(){return j.$tokenizer||this.createTokenizer()},this.createTokenizer=function(){function e(e){return e=e.substr(1),/^\d+$/.test(e)?[{tabstopId:parseInt(e,10)}]:[{text:e}]}function t(e){return"(?:[^\\\\"+e+"]|\\\\.)"}var n={regex:"/("+t("/")+"+)/",onMatch:function(e,t,n){var r=n[0];return r.fmtString=!0,r.guard=e.slice(1,-1),r.flag="",""},next:"formatString"};return j.$tokenizer=new f({start:[{regex:/\\./,onMatch:function(e,t,n){var r=e[1];return("}"==r&&n.length||-1!="`$\\".indexOf(r))&&(e=r),[e]}},{regex:/}/,onMatch:function(e,t,n){return[n.length?n.shift():e]}},{regex:/\$(?:\d+|\w+)/,onMatch:e},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(t,n,r){var a=e(t.substr(1));return r.unshift(a[0]),a},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+t("\\|")+"*\\|",onMatch:function(e,t,n){var r=e.slice(1,-1).replace(/\\[,|\\]|,/g,(function(e){return 2==e.length?e[1]:"\0"})).split("\0").map((function(e){return{value:e}}));return n[0].choices=r,[r[0]]},next:"start"},n,{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:/:/,onMatch:function(e,t,n){return n.length&&n[0].expectElse?(n[0].expectElse=!1,n[0].ifEnd={elseEnd:n[0]},[n[0].ifEnd]):":"}},{regex:/\\./,onMatch:function(e,t,n){var r=e[1];return"}"==r&&n.length||-1!="`$\\".indexOf(r)?e=r:"n"==r?e="\n":"t"==r?e="\t":-1!="ulULE".indexOf(r)&&(e={changeCase:r,local:r>"a"}),[e]}},{regex:"/\\w*}",onMatch:function(e,t,n){var r=n.shift();return r&&(r.flag=e.slice(1,-1)),this.next=r&&r.tabstopId?"start":"",[r||e]},next:"start"},{regex:/\$(?:\d+|\w+)/,onMatch:function(e,t,n){return[{text:e.slice(1)}]}},{regex:/\${\w+/,onMatch:function(e,t,n){var r={text:e.slice(2)};return n.unshift(r),[r]},next:"formatStringVar"},{regex:/\n/,token:"newline",merge:!1},{regex:/}/,onMatch:function(e,t,n){var r=n.shift();return this.next=r&&r.tabstopId?"start":"",[r||e]},next:"start"}],formatStringVar:[{regex:/:\/\w+}/,onMatch:function(e,t,n){return n[0].formatFunction=e.slice(2,-1),[n.shift()]},next:"formatString"},n,{regex:/:[\?\-+]?/,onMatch:function(e,t,n){"+"==e[1]&&(n[0].ifEnd=n[0]),"?"==e[1]&&(n[0].expectElse=!0)},next:"formatString"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"formatString"}]})},this.tokenizeTmSnippet=function(e,t){return this.getTokenizer().getLineTokens(e,t).tokens.map((function(e){return e.value||e}))},this.getVariableValue=function(e,t,n){if(/^\d+$/.test(t))return(this.variables.__||{})[t]||"";if(/^[A-Z]\d+$/.test(t))return(this.variables[t[0]+"__"]||{})[t.substr(1)]||"";if(t=t.replace(/^TM_/,""),!this.variables.hasOwnProperty(t))return"";var r=this.variables[t];return"function"==typeof r&&(r=this.variables[t](e,t,n)),null==r?"":r},this.variables=w,this.tmStrFormat=function(e,t,n){if(!t.fmt)return e;var r=t.flag||"",a=t.guard;a=new RegExp(a,r.replace(/[^gim]/g,""));var l="string"==typeof t.fmt?this.tokenizeTmSnippet(t.fmt,"formatString"):t.fmt,d=this;return e.replace(a,(function(){var e=d.variables.__;d.variables.__=[].slice.call(arguments);for(var t=d.resolveVariables(l,n),r="E",a=0;a<t.length;a++){var h=t[a];if("object"==typeof h)if(t[a]="",h.changeCase&&h.local){var p=t[a+1];p&&"string"==typeof p&&("u"==h.changeCase?t[a]=p[0].toUpperCase():t[a]=p[0].toLowerCase(),t[a+1]=p.substr(1))}else h.changeCase&&(r=h.changeCase);else"U"==r?t[a]=h.toUpperCase():"L"==r&&(t[a]=h.toLowerCase())}return d.variables.__=e,t.join("")}))},this.tmFormatFunction=function(e,t,n){return"upcase"==t.formatFunction?e.toUpperCase():"downcase"==t.formatFunction?e.toLowerCase():e},this.resolveVariables=function(e,t){for(var n=[],r="",a=!0,l=0;l<e.length;l++){var d=e[l];if("string"!=typeof d){if(d){if(a=!1,d.fmtString){var h=e.indexOf(d,l+1);-1==h&&(h=e.length),d.fmt=e.slice(l+1,h),l=h}if(d.text){var p=this.getVariableValue(t,d.text,r)+"";d.fmtString&&(p=this.tmStrFormat(p,d,t)),d.formatFunction&&(p=this.tmFormatFunction(p,d,t)),p&&!d.ifEnd?(n.push(p),f(d)):!p&&d.ifEnd&&f(d.ifEnd)}else d.elseEnd?f(d.elseEnd):(null!=d.tabstopId||null!=d.changeCase)&&n.push(d)}}else n.push(d),"\n"==d?(a=!0,r=""):a&&(r=/^\t*/.exec(d)[0],a=/\S/.test(d))}function f(t){var n=e.indexOf(t,l+1);-1!=n&&(l=n)}return n},this.insertSnippetForSelection=function(e,t){var n=e.getCursorPosition(),r=e.session.getLine(n.row),a=e.session.getTabString(),l=r.match(/^\s*/)[0];n.column<l.length&&(l=l.slice(0,n.column)),t=t.replace(/\r/g,"");var d=this.tokenizeTmSnippet(t);d=(d=this.resolveVariables(d,e)).map((function(e){return"\n"==e?e+l:"string"==typeof e?e.replace(/\t/g,a):e}));var h=[];d.forEach((function(e,t){if("object"==typeof e){var n=e.tabstopId,r=h[n];if(r||((r=h[n]=[]).index=n,r.value="",r.parents={}),-1===r.indexOf(e)){e.choices&&!r.choices&&(r.choices=e.choices),r.push(e);var a=d.indexOf(e,t+1);if(-1!==a){var l=d.slice(t+1,a);l.some((function(e){return"object"==typeof e}))&&!r.value?r.value=l:!l.length||r.value&&"string"==typeof r.value||(r.value=l.join(""))}}}})),h.forEach((function(e){e.length=0}));var p={};function f(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if("object"==typeof r){if(p[r.tabstopId])continue;r=t[e.lastIndexOf(r,n-1)]||{tabstopId:r.tabstopId}}t[n]=r}return t}for(var y=0;y<d.length;y++){var w=d[y];if("object"==typeof w){var x=w.tabstopId,j=h[x],C=d.indexOf(w,y+1);if(p[x])p[x]===w&&(delete p[x],Object.keys(p).forEach((function(e){j.parents[e]=!0})));else{p[x]=w;var S=j.value;"string"!=typeof S?S=f(S):w.fmt&&(S=this.tmStrFormat(S,w,e)),d.splice.apply(d,[y+1,Math.max(0,C-y)].concat(S,w)),-1===j.indexOf(w)&&j.push(w)}}}var _=0,k=0,E="";d.forEach((function(e){if("string"==typeof e){var t=e.split("\n");t.length>1?(k=t[t.length-1].length,_+=t.length-1):k+=e.length,E+=e}else e&&(e.start?e.end={row:_,column:k}:e.start={row:_,column:k})}));var A=e.getSelectionRange(),T=e.session.replace(A,E),R=new O(e),I=e.inVirtualSelectionMode&&e.selection.index;R.addTabstops(h,A.start,T,I)},this.insertSnippet=function(e,t){var n=this;if(e.inVirtualSelectionMode)return n.insertSnippetForSelection(e,t);e.forEachSelection((function(){n.insertSnippetForSelection(e,t)}),null,{keepOrder:!0}),e.tabstopManager&&e.tabstopManager.tabNext()},this.$getScope=function(e){var t=e.session.$mode.$id||"";if("html"===(t=t.split("/").pop())||"php"===t){"php"!==t||e.session.$mode.inlinePhp||(t="html");var n=e.getCursorPosition(),r=e.session.getState(n.row);"object"==typeof r&&(r=r[0]),r.substring&&("js-"==r.substring(0,3)?t="javascript":"css-"==r.substring(0,4)?t="css":"php-"==r.substring(0,4)&&(t="php"))}return t},this.getActiveScopes=function(e){var t=this.$getScope(e),n=[t],r=this.snippetMap;return r[t]&&r[t].includeScopes&&n.push.apply(n,r[t].includeScopes),n.push("_"),n},this.expandWithTab=function(e,t){var n=this,r=e.forEachSelection((function(){return n.expandSnippetForSelection(e,t)}),null,{keepOrder:!0});return r&&e.tabstopManager&&e.tabstopManager.tabNext(),r},this.expandSnippetForSelection=function(e,t){var n,r=e.getCursorPosition(),a=e.session.getLine(r.row),l=a.substring(0,r.column),d=a.substr(r.column),h=this.snippetMap;return this.getActiveScopes(e).some((function(e){var t=h[e];return t&&(n=this.findMatchingSnippet(t,l,d)),!!n}),this),!!n&&(t&&t.dryRun||(e.session.doc.removeInLine(r.row,r.column-n.replaceBefore.length,r.column+n.replaceAfter.length),this.variables.M__=n.matchBefore,this.variables.T__=n.matchAfter,this.insertSnippetForSelection(e,n.content),this.variables.M__=this.variables.T__=null),!0)},this.findMatchingSnippet=function(e,t,n){for(var r=e.length;r--;){var a=e[r];if((!a.startRe||a.startRe.test(t))&&((!a.endRe||a.endRe.test(n))&&(a.startRe||a.endRe)))return a.matchBefore=a.startRe?a.startRe.exec(t):[""],a.matchAfter=a.endRe?a.endRe.exec(n):[""],a.replaceBefore=a.triggerRe?a.triggerRe.exec(t)[0]:"",a.replaceAfter=a.endTriggerRe?a.endTriggerRe.exec(n)[0]:"",a}},this.snippetMap={},this.snippetNameMap={},this.register=function(e,t){var n=this.snippetMap,r=this.snippetNameMap,a=this;function d(e){return e&&!/^\^?\(.*\)\$?$|^\\b$/.test(e)&&(e="(?:"+e+")"),e||""}function h(e,t,n){return e=d(e),t=d(t),n?(e=t+e)&&"$"!=e[e.length-1]&&(e+="$"):(e+=t)&&"^"!=e[0]&&(e="^"+e),new RegExp(e)}function p(e){e.scope||(e.scope=t||"_"),t=e.scope,n[t]||(n[t]=[],r[t]={});var d=r[t];if(e.name){var p=d[e.name];p&&a.unregister(p),d[e.name]=e}n[t].push(e),e.prefix&&(e.tabTrigger=e.prefix),!e.content&&e.body&&(e.content=Array.isArray(e.body)?e.body.join("\n"):e.body),e.tabTrigger&&!e.trigger&&(!e.guard&&/^\w/.test(e.tabTrigger)&&(e.guard="\\b"),e.trigger=l.escapeRegExp(e.tabTrigger)),(e.trigger||e.guard||e.endTrigger||e.endGuard)&&(e.startRe=h(e.trigger,e.guard,!0),e.triggerRe=new RegExp(e.trigger),e.endRe=h(e.endTrigger,e.endGuard,!0),e.endTriggerRe=new RegExp(e.endTrigger))}e||(e=[]),Array.isArray(e)?e.forEach(p):Object.keys(e).forEach((function(t){p(e[t])})),this._signal("registerSnippets",{scope:t})},this.unregister=function(e,t){var n=this.snippetMap,r=this.snippetNameMap;function a(e){var a=r[e.scope||t];if(a&&a[e.name]){delete a[e.name];var l=n[e.scope||t],d=l&&l.indexOf(e);d>=0&&l.splice(d,1)}}e.content?a(e):Array.isArray(e)&&e.forEach(a)},this.parseSnippetFile=function(e){e=e.replace(/\r/g,"");for(var t,n=[],r={},a=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm;t=a.exec(e);){if(t[1])try{r=JSON.parse(t[1]),n.push(r)}catch(e){}if(t[4])r.content=t[4].replace(/^\t/gm,""),n.push(r),r={};else{var l=t[2],d=t[3];if("regex"==l){var h=/\/((?:[^\/\\]|\\.)*)|$/g;r.guard=h.exec(d)[1],r.trigger=h.exec(d)[1],r.endTrigger=h.exec(d)[1],r.endGuard=h.exec(d)[1]}else"snippet"==l?(r.tabTrigger=d.match(/^\S*/)[0],r.name||(r.name=d)):l&&(r[l]=d)}}return n},this.getSnippetByName=function(e,t){var n,r=this.snippetNameMap;return this.getActiveScopes(t).some((function(t){var a=r[t];return a&&(n=a[e]),!!n}),this),n}}).call(j.prototype);var O=function(e){if(e.tabstopManager)return e.tabstopManager;e.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=l.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(e)};(function(){this.attach=function(e){this.index=0,this.ranges=[],this.tabstops=[],this.$openTabstops=null,this.selectedTabstop=null,this.editor=e,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges=null,this.tabstops=null,this.selectedTabstop=null,this.editor.removeListener("change",this.$onChange),this.editor.removeListener("changeSelection",this.$onChangeSelection),this.editor.removeListener("changeSession",this.$onChangeSession),this.editor.commands.removeListener("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.editor=null},this.onChange=function(e){for(var t="r"==e.action[0],n=this.selectedTabstop||{},r=n.parents||{},a=(this.tabstops||[]).slice(),l=0;l<a.length;l++){var d=a[l],h=d==n||r[d.index];if(d.rangeList.$bias=h?0:1,"remove"==e.action&&d!==n){var p=d.parents&&d.parents[n.index],f=d.rangeList.pointIndex(e.start,p);f=f<0?-f-1:f+1;var y=d.rangeList.pointIndex(e.end,p);y=y<0?-y-1:y-1;for(var w=d.rangeList.ranges.slice(f,y),x=0;x<w.length;x++)this.removeRange(w[x])}d.rangeList.$onChange(e)}var j=this.editor.session;this.$inChange||!t||1!=j.getLength()||j.getValue()||this.detach()},this.updateLinkedFields=function(){var e=this.selectedTabstop;if(e&&e.hasLinkedRanges&&e.firstNonLinked){this.$inChange=!0;for(var n=this.editor.session,r=n.getTextRange(e.firstNonLinked),a=0;a<e.length;a++){var l=e[a];if(l.linked){var d=l.original,h=t.snippetManager.tmStrFormat(r,d,this.editor);n.replace(l,h)}}this.$inChange=!1}},this.onAfterExec=function(e){e.command&&!e.command.readOnly&&this.updateLinkedFields()},this.onChangeSelection=function(){if(this.editor){for(var e=this.editor.selection.lead,t=this.editor.selection.anchor,n=this.editor.selection.isEmpty(),r=0;r<this.ranges.length;r++)if(!this.ranges[r].linked){var a=this.ranges[r].contains(e.row,e.column),l=n||this.ranges[r].contains(t.row,t.column);if(a&&l)return}this.detach()}},this.onChangeSession=function(){this.detach()},this.tabNext=function(e){var t=this.tabstops.length,n=this.index+(e||1);(n=Math.min(Math.max(n,1),t))==t&&(n=0),this.selectTabstop(n),0===n&&this.detach()},this.selectTabstop=function(e){this.$openTabstops=null;var t=this.tabstops[this.index];if(t&&this.addTabstopMarkers(t),this.index=e,(t=this.tabstops[this.index])&&t.length){this.selectedTabstop=t;var n=t.firstNonLinked||t;if(t.choices&&(n.cursor=n.start),this.editor.inVirtualSelectionMode)this.editor.selection.fromOrientedRange(n);else{var r=this.editor.multiSelect;r.toSingleRange(n);for(var a=0;a<t.length;a++)t.hasLinkedRanges&&t[a].linked||r.addRange(t[a].clone(),!0)}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler),this.selectedTabstop&&this.selectedTabstop.choices&&this.editor.execCommand("startAutocomplete",{matches:this.selectedTabstop.choices})}},this.addTabstops=function(e,t,n){var r=this.useLink||!this.editor.getOption("enableMultiselect");if(this.$openTabstops||(this.$openTabstops=[]),!e[0]){var a=d.fromPoints(n,n);S(a.start,t),S(a.end,t),e[0]=[a],e[0].index=0}var l=[this.index+1,0],p=this.ranges;e.forEach((function(e,n){for(var a=this.$openTabstops[n]||e,f=0;f<e.length;f++){var y=e[f],w=d.fromPoints(y.start,y.end||y.start);C(w.start,t),C(w.end,t),w.original=y,w.tabstop=a,p.push(w),a!=e?a.unshift(w):a[f]=w,y.fmtString||a.firstNonLinked&&r?(w.linked=!0,a.hasLinkedRanges=!0):a.firstNonLinked||(a.firstNonLinked=w)}a.firstNonLinked||(a.hasLinkedRanges=!1),a===e&&(l.push(a),this.$openTabstops[n]=a),this.addTabstopMarkers(a),a.rangeList=a.rangeList||new h,a.rangeList.$bias=0,a.rangeList.addList(a)}),this),l.length>2&&(this.tabstops.length&&l.push(l.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,l))},this.addTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){e.markerId||(e.markerId=t.addMarker(e,"ace_snippet-marker","text"))}))},this.removeTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){t.removeMarker(e.markerId),e.markerId=null}))},this.removeRange=function(e){var t=e.tabstop.indexOf(e);-1!=t&&e.tabstop.splice(t,1),-1!=(t=this.ranges.indexOf(e))&&this.ranges.splice(t,1),-1!=(t=e.tabstop.rangeList.ranges.indexOf(e))&&e.tabstop.splice(t,1),this.editor.session.removeMarker(e.markerId),e.tabstop.length||(-1!=(t=this.tabstops.indexOf(e.tabstop))&&this.tabstops.splice(t,1),this.tabstops.length||this.detach())},this.keyboardHandler=new p,this.keyboardHandler.bindKeys({Tab:function(e){t.snippetManager&&t.snippetManager.expandWithTab(e)||(e.tabstopManager.tabNext(1),e.renderer.scrollCursorIntoView())},"Shift-Tab":function(e){e.tabstopManager.tabNext(-1),e.renderer.scrollCursorIntoView()},Esc:function(e){e.tabstopManager.detach()}})}).call(O.prototype);var C=function(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row},S=function(e,t){e.row==t.row&&(e.column-=t.column),e.row-=t.row};e("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}"),t.snippetManager=new j;var _=e("./editor").Editor;(function(){this.insertSnippet=function(e,n){return t.snippetManager.insertSnippet(this,e,n)},this.expandSnippet=function(e){return t.snippetManager.expandWithTab(this,e)}}).call(_.prototype)})),ace.define("ace/autocomplete/popup",[],(function(e,t,n){"use strict";var r=e("../virtual_renderer").VirtualRenderer,a=e("../editor").Editor,l=e("../range").Range,d=e("../lib/event"),h=e("../lib/lang"),p=e("../lib/dom"),f=function(e){var t=new r(e);t.$maxLines=4;var n=new a(t);return n.setHighlightActiveLine(!1),n.setShowPrintMargin(!1),n.renderer.setShowGutter(!1),n.renderer.setHighlightGutterLine(!1),n.$mouseHandler.$focusTimeout=0,n.$highlightTagPending=!0,n};p.importCssString(".ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #3a674e;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);    position: absolute;    z-index: 2;}.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid rgba(109, 150, 13, 0.8);    background: rgba(58, 103, 78, 0.62);}.ace_completion-meta {    opacity: 0.5;    margin: 0.9em;}.ace_completion-message {    color: blue;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #2d69c7;}.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #93ca12;}.ace_editor.ace_autocomplete {    width: 300px;    z-index: 200000;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;    background: #fefefe;    color: #111;}.ace_dark.ace_editor.ace_autocomplete {    border: 1px #484747 solid;    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);    line-height: 1.4;    background: #25282c;    color: #c1c1c1;}","autocompletion.css"),t.AcePopup=function(e){var t=p.createElement("div"),n=new f(t);e&&e.appendChild(t),t.style.display="none",n.renderer.content.style.cursor="default",n.renderer.setStyle("ace_autocomplete"),n.setOption("displayIndentGuides",!1),n.setOption("dragDelay",150);var r,a=function(){};n.focus=a,n.$isFocused=!0,n.renderer.$cursorLayer.restartTimer=a,n.renderer.$cursorLayer.element.style.opacity=0,n.renderer.$maxLines=8,n.renderer.$keepTextAreaAtCursor=!1,n.setHighlightActiveLine(!1),n.session.highlight(""),n.session.$searchHighlight.clazz="ace_highlight-marker",n.on("mousedown",(function(e){var t=e.getDocumentPosition();n.selection.moveToPosition(t),w.start.row=w.end.row=t.row,e.stop()}));var y=new l(-1,0,-1,1/0),w=new l(-1,0,-1,1/0);w.id=n.session.addMarker(w,"ace_active-line","fullLine"),n.setSelectOnHover=function(e){e?y.id&&(n.session.removeMarker(y.id),y.id=null):y.id=n.session.addMarker(y,"ace_line-hover","fullLine")},n.setSelectOnHover(!1),n.on("mousemove",(function(e){if(r){if(r.x!=e.x||r.y!=e.y){(r=e).scrollTop=n.renderer.scrollTop;var t=r.getDocumentPosition().row;y.start.row!=t&&(y.id||n.setRow(t),j(t))}}else r=e})),n.renderer.on("beforeRender",(function(){if(r&&-1!=y.start.row){r.$pos=null;var e=r.getDocumentPosition().row;y.id||n.setRow(e),j(e,!0)}})),n.renderer.on("afterRender",(function(){var e=n.getRow(),t=n.renderer.$textLayer,r=t.element.childNodes[e-t.config.firstRow];r!==t.selectedNode&&t.selectedNode&&p.removeCssClass(t.selectedNode,"ace_selected"),t.selectedNode=r,r&&p.addCssClass(r,"ace_selected")}));var x=function(){j(-1)},j=function(e,t){e!==y.start.row&&(y.start.row=y.end.row=e,t||n.session._emit("changeBackMarker"),n._emit("changeHoverMarker"))};n.getHoveredRow=function(){return y.start.row},d.addListener(n.container,"mouseout",x),n.on("hide",x),n.on("changeSelection",x),n.session.doc.getLength=function(){return n.data.length},n.session.doc.getLine=function(e){var t=n.data[e];return"string"==typeof t?t:t&&t.value||""};var O=n.session.bgTokenizer;return O.$tokenizeRow=function(e){var t=n.data[e],r=[];if(!t)return r;"string"==typeof t&&(t={value:t});var a=t.caption||t.value||t.name;function l(e,n){e&&r.push({type:(t.className||"")+(n||""),value:e})}for(var d=a.toLowerCase(),h=(n.filterText||"").toLowerCase(),p=0,f=0,y=0;y<=h.length;y++)if(y!=f&&(t.matchMask&1<<y||y==h.length)){var w=h.slice(f,y);f=y;var x=d.indexOf(w,p);if(-1==x)continue;l(a.slice(p,x),""),p=x+w.length,l(a.slice(x,p),"completion-highlight")}return l(a.slice(p,a.length),""),t.meta&&r.push({type:"completion-meta",value:t.meta}),t.message&&r.push({type:"completion-message",value:t.message}),r},O.$updateOnChange=a,O.start=a,n.session.$computeWidth=function(){return this.screenWidth=0},n.isOpen=!1,n.isTopdown=!1,n.autoSelect=!0,n.filterText="",n.data=[],n.setData=function(e,t){n.filterText=t||"",n.setValue(h.stringRepeat("\n",e.length),-1),n.data=e||[],n.setRow(0)},n.getData=function(e){return n.data[e]},n.getRow=function(){return w.start.row},n.setRow=function(e){e=Math.max(this.autoSelect?0:-1,Math.min(this.data.length,e)),w.start.row!=e&&(n.selection.clearSelection(),w.start.row=w.end.row=e||0,n.session._emit("changeBackMarker"),n.moveCursorTo(e||0,0),n.isOpen&&n._signal("select"))},n.on("changeSelection",(function(){n.isOpen&&n.setRow(n.selection.lead.row),n.renderer.scrollCursorIntoView()})),n.hide=function(){this.container.style.display="none",this._signal("hide"),n.isOpen=!1},n.show=function(e,t,a){var l=this.container,d=window.innerHeight,h=window.innerWidth,p=this.renderer,f=p.$maxLines*t*1.4,y=e.top+this.$borderSize;y>d/2&&!a&&y+t+f>d?(p.$maxPixelHeight=y-2*this.$borderSize,l.style.top="",l.style.bottom=d-y+"px",n.isTopdown=!1):(y+=t,p.$maxPixelHeight=d-y-.2*t,l.style.top=y+"px",l.style.bottom="",n.isTopdown=!0),l.style.display="";var w=e.left;w+l.offsetWidth>h&&(w=h-l.offsetWidth),l.style.left=w+"px",this._signal("show"),r=null,n.isOpen=!0},n.goTo=function(e){var t=this.getRow(),n=this.session.getLength()-1;switch(e){case"up":t=t<=0?n:t-1;break;case"down":t=t>=n?-1:t+1;break;case"start":t=0;break;case"end":t=n}this.setRow(t)},n.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},n.$imageSize=0,n.$borderSize=1,n},t.$singleLineEditor=f})),ace.define("ace/autocomplete/util",[],(function(e,t,n){"use strict";t.parForEach=function(e,t,n){var r=0,a=e.length;0===a&&n();for(var l=0;l<a;l++)t(e[l],(function(e,t){++r===a&&n(e,t)}))};var r=/[a-zA-Z_0-9\$\-\u00A2-\u2000\u2070-\uFFFF]/;t.retrievePrecedingIdentifier=function(e,t,n){n=n||r;for(var a=[],l=t-1;l>=0&&n.test(e[l]);l--)a.push(e[l]);return a.reverse().join("")},t.retrieveFollowingIdentifier=function(e,t,n){n=n||r;for(var a=[],l=t;l<e.length&&n.test(e[l]);l++)a.push(e[l]);return a},t.getCompletionPrefix=function(e){var t,n=e.getCursorPosition(),r=e.session.getLine(n.row);return e.completers.forEach(function(e){e.identifierRegexps&&e.identifierRegexps.forEach(function(e){!t&&e&&(t=this.retrievePrecedingIdentifier(r,n.column,e))}.bind(this))}.bind(this)),t||this.retrievePrecedingIdentifier(r,n.column)}})),ace.define("ace/autocomplete",[],(function(e,t,n){"use strict";var r=e("./keyboard/hash_handler").HashHandler,a=e("./autocomplete/popup").AcePopup,l=e("./autocomplete/util"),d=e("./lib/lang"),h=e("./lib/dom"),p=e("./snippets").snippetManager,f=e("./config"),y=function(){this.autoInsert=!1,this.autoSelect=!0,this.exactMatch=!1,this.gatherCompletionsId=0,this.keyboardHandler=new r,this.keyboardHandler.bindKeys(this.commands),this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.changeTimer=d.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=d.delayedCall(this.updateDocTooltip.bind(this),50)};(function(){this.$init=function(){return this.popup=new a(document.body||document.documentElement),this.popup.on("click",function(e){this.insertMatch(),e.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.tooltipTimer.bind(null,null)),this.popup.on("select",this.tooltipTimer.bind(null,null)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup},this.getPopup=function(){return this.popup||this.$init()},this.openPopup=function(e,t,n){this.popup||this.$init(),this.popup.autoSelect=this.autoSelect,this.popup.setData(this.completions.filtered,this.completions.filterText),e.keyBinding.addKeyboardHandler(this.keyboardHandler);var r=e.renderer;if(this.popup.setRow(this.autoSelect?0:-1),n)n&&!t&&this.detach();else{this.popup.setTheme(e.getTheme()),this.popup.setFontSize(e.getFontSize());var a=r.layerConfig.lineHeight,l=r.$cursorLayer.getPixelPosition(this.base,!0);l.left-=this.popup.getTextLeftOffset();var d=e.container.getBoundingClientRect();l.top+=d.top-r.layerConfig.offset,l.left+=d.left-e.renderer.scrollLeft,l.left+=r.gutterWidth,this.popup.show(l,a)}this.changeTimer.cancel()},this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener),this.changeTimer.cancel(),this.hideDocTooltip(),this.gatherCompletionsId+=1,this.popup&&this.popup.isOpen&&this.popup.hide(),this.base&&this.base.detach(),this.activated=!1,this.completions=this.base=null},this.changeListener=function(e){var t=this.editor.selection.lead;(t.row!=this.base.row||t.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},this.blurListener=function(e){var t=document.activeElement,n=this.editor.textInput.getElement(),r=e.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(e.relatedTarget),a=this.popup&&this.popup.container;t==n||t.parentNode==a||r||t==this.tooltipNode||e.relatedTarget==n||this.detach()},this.mousedownListener=function(e){this.detach()},this.mousewheelListener=function(e){this.detach()},this.goTo=function(e){this.popup.goTo(e)},this.insertMatch=function(e,t){if(e||(e=this.popup.getData(this.popup.getRow())),!e)return!1;var n=this.completions;if(this.editor.startOperation({command:{name:"insertMatch"}}),e.completer&&e.completer.insertMatch)e.completer.insertMatch(this.editor,e);else{if(n.filterText)for(var r,a=this.editor.selection.getAllRanges(),l=0;r=a[l];l++)r.start.column-=n.filterText.length,this.editor.session.remove(r);e.snippet?p.insertSnippet(this.editor,e.snippet):this.editor.execCommand("insertstring",e.value||e)}this.completions==n&&this.detach(),this.editor.endOperation()},this.commands={Up:function(e){e.completer.goTo("up")},Down:function(e){e.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(e){e.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(e){e.completer.goTo("end")},Esc:function(e){e.completer.detach()},Return:function(e){return e.completer.insertMatch()},"Shift-Return":function(e){e.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(e){var t=e.completer.insertMatch();if(t||e.tabstopManager)return t;e.completer.goTo("down")},PageUp:function(e){e.completer.popup.gotoPageUp()},PageDown:function(e){e.completer.popup.gotoPageDown()}},this.gatherCompletions=function(e,t){var n=e.getSession(),r=e.getCursorPosition(),a=l.getCompletionPrefix(e);this.base=n.doc.createAnchor(r.row,r.column-a.length),this.base.$insertRight=!0;var d=[],h=e.completers.length;return e.completers.forEach((function(p,f){p.getCompletions(e,n,r,a,(function(n,r){!n&&r&&(d=d.concat(r)),t(null,{prefix:l.getCompletionPrefix(e),matches:d,finished:0==--h})}))})),!0},this.showPopup=function(e,t){this.editor&&this.detach(),this.activated=!0,this.editor=e,e.completer!=this&&(e.completer&&e.completer.detach(),e.completer=this),e.on("changeSelection",this.changeListener),e.on("blur",this.blurListener),e.on("mousedown",this.mousedownListener),e.on("mousewheel",this.mousewheelListener),this.updateCompletions(!1,t)},this.updateCompletions=function(e,t){if(e&&this.base&&this.completions){var n=this.editor.getCursorPosition(),r=this.editor.session.getTextRange({start:this.base,end:n});if(r==this.completions.filterText)return;return this.completions.setFilter(r),this.completions.filtered.length?1!=this.completions.filtered.length||this.completions.filtered[0].value!=r||this.completions.filtered[0].snippet?void this.openPopup(this.editor,r,e):this.detach():this.detach()}if(t&&t.matches){n=this.editor.getSelectionRange().start;return this.base=this.editor.session.doc.createAnchor(n.row,n.column),this.base.$insertRight=!0,this.completions=new w(t.matches),this.openPopup(this.editor,"",e)}var a=this.gatherCompletionsId;this.gatherCompletions(this.editor,function(t,n){var r=function(){if(n.finished)return this.detach()}.bind(this),l=n.prefix,d=n&&n.matches;if(!d||!d.length)return r();if(0===l.indexOf(n.prefix)&&a==this.gatherCompletionsId){this.completions=new w(d),this.exactMatch&&(this.completions.exactMatch=!0),this.completions.setFilter(l);var h=this.completions.filtered;return h.length&&(1!=h.length||h[0].value!=l||h[0].snippet)?this.autoInsert&&1==h.length&&n.finished?this.insertMatch(h[0]):void this.openPopup(this.editor,l,e):r()}}.bind(this))},this.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},this.updateDocTooltip=function(){var e=this.popup,t=e.data,n=t&&(t[e.getHoveredRow()]||t[e.getRow()]),r=null;return n&&this.editor&&this.popup.isOpen?(this.editor.completers.some((function(e){return e.getDocTooltip&&(r=e.getDocTooltip(n)),r})),r||"string"==typeof n||(r=n),"string"==typeof r&&(r={docText:r}),r&&(r.docHTML||r.docText)?void this.showDocTooltip(r):this.hideDocTooltip()):this.hideDocTooltip()},this.showDocTooltip=function(e){this.tooltipNode||(this.tooltipNode=h.createElement("div"),this.tooltipNode.className="ace_tooltip ace_doc-tooltip",this.tooltipNode.style.margin=0,this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this));var t=this.tooltipNode;e.docHTML?t.innerHTML=e.docHTML:e.docText&&(t.textContent=e.docText),t.parentNode||document.body.appendChild(t);var n=this.popup,r=n.container.getBoundingClientRect();t.style.top=n.container.style.top,t.style.bottom=n.container.style.bottom,t.style.display="block",window.innerWidth-r.right<320?r.left<320?n.isTopdown?(t.style.top=r.bottom+"px",t.style.left=r.left+"px",t.style.right="",t.style.bottom=""):(t.style.top=n.container.offsetTop-t.offsetHeight+"px",t.style.left=r.left+"px",t.style.right="",t.style.bottom=""):(t.style.right=window.innerWidth-r.left+"px",t.style.left=""):(t.style.left=r.right+1+"px",t.style.right="")},this.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),this.tooltipNode){var e=this.tooltipNode;this.editor.isFocused()||document.activeElement!=e||this.editor.focus(),this.tooltipNode=null,e.parentNode&&e.parentNode.removeChild(e)}},this.onTooltipClick=function(e){for(var t=e.target;t&&t!=this.tooltipNode;){if("A"==t.nodeName&&t.href){t.rel="noreferrer",t.target="_blank";break}t=t.parentNode}},this.destroy=function(){if(this.detach(),this.popup){this.popup.destroy();var e=this.popup.container;e&&e.parentNode&&e.parentNode.removeChild(e)}this.editor&&this.editor.completer==this&&this.editor.completer,this.popup=null}}).call(y.prototype),y.for=function(e){return e.completer||(f.get("sharedPopups")?(y.$shared||(y.$sharedInstance=new y),e.completer=y.$sharedInstance):(e.completer=new y,e.once("destroy",(function(e,t){t.completer.destroy()})))),e.completer},y.startCommand={name:"startAutocomplete",exec:function(e,t){var n=y.for(e);n.autoInsert=!1,n.autoSelect=!0,n.showPopup(e,t),n.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var w=function(e,t){this.all=e,this.filtered=e,this.filterText=t||"",this.exactMatch=!1};(function(){this.setFilter=function(e){if(e.length>this.filterText&&0===e.lastIndexOf(this.filterText,0))var t=this.filtered;else t=this.all;this.filterText=e,t=(t=this.filterCompletions(t,this.filterText)).sort((function(e,t){return t.exactMatch-e.exactMatch||t.$score-e.$score||(e.caption||e.value).localeCompare(t.caption||t.value)}));var n=null;t=t.filter((function(e){var t=e.snippet||e.caption||e.value;return t!==n&&(n=t,!0)})),this.filtered=t},this.filterCompletions=function(e,t){var n=[],r=t.toUpperCase(),a=t.toLowerCase();e:for(var l,d=0;l=e[d];d++){var h=l.value||l.caption||l.snippet;if(h){var p,f,y=-1,w=0,x=0;if(this.exactMatch){if(t!==h.substr(0,t.length))continue e}else{var j=h.toLowerCase().indexOf(a);if(j>-1)x=j;else for(var O=0;O<t.length;O++){var C=h.indexOf(a[O],y+1),S=h.indexOf(r[O],y+1);if((p=C>=0&&(S<0||C<S)?C:S)<0)continue e;(f=p-y-1)>0&&(-1===y&&(x+=10),x+=f,w|=1<<O),y=p}}l.matchMask=w,l.exactMatch=x?0:1,l.$score=(l.score||0)-x,n.push(l)}}return n}}).call(w.prototype),t.Autocomplete=y,t.FilteredList=w})),ace.define("ace/autocomplete/text_completer",[],(function(e,t,n){var r=e("../range").Range,a=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;function l(e,t){var n=function(e,t){return e.getTextRange(r.fromPoints({row:0,column:0},t)).split(a).length-1}(e,t),l=e.getValue().split(a),d=Object.create(null),h=l[n];return l.forEach((function(e,t){if(e&&e!==h){var r=Math.abs(n-t),a=l.length-r;d[e]?d[e]=Math.max(a,d[e]):d[e]=a}})),d}t.getCompletions=function(e,t,n,r,a){var d=l(t,n);a(null,Object.keys(d).map((function(e){return{caption:e,value:e,score:d[e],meta:"local"}})))}})),ace.define("ace/ext/language_tools",[],(function(e,t,n){"use strict";var r=e("../snippets").snippetManager,a=e("../autocomplete").Autocomplete,l=e("../config"),d=e("../lib/lang"),h=e("../autocomplete/util"),p=e("../autocomplete/text_completer"),f={getCompletions:function(e,t,n,r,a){if(t.$mode.completer)return t.$mode.completer.getCompletions(e,t,n,r,a);var l=e.session.getState(n.row);a(null,t.$mode.getCompletions(l,t,n,r))}},y={getCompletions:function(e,t,n,a,l){var d=[],h=t.getTokenAt(n.row,n.column);h&&h.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\.xml$/)?d.push("html-tag"):d=r.getActiveScopes(e);var p=r.snippetMap,f=[];d.forEach((function(e){for(var t=p[e]||[],n=t.length;n--;){var r=t[n],a=r.name||r.tabTrigger;a&&f.push({caption:a,snippet:r.content,meta:r.tabTrigger&&!r.name?r.tabTrigger+"⇥ ":"snippet",type:"snippet"})}}),this),l(null,f)},getDocTooltip:function(e){"snippet"!=e.type||e.docHTML||(e.docHTML=["<b>",d.escapeHTML(e.caption),"</b>","<hr></hr>",d.escapeHTML(e.snippet)].join(""))}},w=[y,p,f];t.setCompleters=function(e){w.length=0,e&&w.push.apply(w,e)},t.addCompleter=function(e){w.push(e)},t.textCompleter=p,t.keyWordCompleter=f,t.snippetCompleter=y;var x={name:"expandSnippet",exec:function(e){return r.expandWithTab(e)},bindKey:"Tab"},j=function(e,t){O(t.session.$mode)},O=function(e){"string"==typeof e&&(e=l.$modes[e]),e&&(r.files||(r.files={}),C(e.$id,e.snippetFileId),e.modes&&e.modes.forEach(O))},C=function(e,t){t&&e&&!r.files[e]&&(r.files[e]={},l.loadModule(t,(function(t){t&&(r.files[e]=t,!t.snippets&&t.snippetText&&(t.snippets=r.parseSnippetFile(t.snippetText)),r.register(t.snippets||[],t.scope),t.includeScopes&&(r.snippetMap[t.scope].includeScopes=t.includeScopes,t.includeScopes.forEach((function(e){O("ace/mode/"+e)}))))})))},S=function(e){var t=e.editor,n=t.completer&&t.completer.activated;if("backspace"===e.command.name)n&&!h.getCompletionPrefix(t)&&t.completer.detach();else if("insertstring"===e.command.name){if(h.getCompletionPrefix(t)&&!n){var r=a.for(t);r.autoInsert=!1,r.showPopup(t)}}},_=e("../editor").Editor;e("../config").defineOptions(_.prototype,"editor",{enableBasicAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:w),this.commands.addCommand(a.startCommand)):this.commands.removeCommand(a.startCommand)},value:!1},enableLiveAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:w),this.commands.on("afterExec",S)):this.commands.removeListener("afterExec",S)},value:!1},enableSnippets:{set:function(e){e?(this.commands.addCommand(x),this.on("changeMode",j),j(0,this)):(this.commands.removeCommand(x),this.off("changeMode",j))},value:!1}})})),ace.require(["ace/ext/language_tools"],(function(t){e&&(e.exports=t)}))}).call(this,n(151)(e))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["Overleaf","overleaf","ShareLaTeX","sharelatex","LaTeX","TeX","BibTeX","BibLaTeX","XeTeX","XeLaTeX","LuaTeX","LuaLaTeX","http","https","www","COVID","Lockdown","lockdown","Coronavirus","coronavirus"]},function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=n(1),d=n(7),h=d.get,p=(d.deepValue,d.isArray),f=function(){function e(t,n){var r=n.location,a=void 0===r?0:r,l=n.distance,d=void 0===l?100:l,p=n.threshold,f=void 0===p?.6:p,y=n.maxPatternLength,w=void 0===y?32:y,x=n.caseSensitive,j=void 0!==x&&x,O=n.tokenSeparator,C=void 0===O?/ +/g:O,S=n.findAllMatches,_=void 0!==S&&S,k=n.minMatchCharLength,E=void 0===k?1:k,A=n.id,T=void 0===A?null:A,R=n.keys,I=void 0===R?[]:R,P=n.shouldSort,D=void 0===P||P,M=n.getFn,L=void 0===M?h:M,F=n.sortFn,q=void 0===F?function(e,t){return e.score-t.score}:F,N=n.tokenize,B=void 0!==N&&N,U=n.matchAllTokens,H=void 0!==U&&U,z=n.includeMatches,V=void 0!==z&&z,W=n.includeScore,K=void 0!==W&&W,G=n.verbose,Y=void 0!==G&&G;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:a,distance:d,threshold:f,maxPatternLength:w,isCaseSensitive:j,tokenSeparator:C,findAllMatches:_,minMatchCharLength:E,id:T,keys:I,includeMatches:V,includeScore:K,shouldSort:D,getFn:L,sortFn:q,verbose:Y,tokenize:B,matchAllTokens:H},this.setCollection(t),this._processKeys(I)}var t,n;return t=e,(n=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var t=0,n=e.length;t<n;t+=1){var r=e[t];this._keyWeights[r]=1,this._keyNames.push(r)}else{for(var a=null,l=null,d=0,h=0,p=e.length;h<p;h+=1){var f=e[h];if(!f.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var y=f.name;if(this._keyNames.push(y),!f.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var w=f.weight;if(w<0||w>1)throw new Error('"weight" property in key must bein the range of [0, 1)');l=null==l?w:Math.max(l,w),a=null==a?w:Math.min(a,w),this._keyWeights[y]=w,d+=w}if(d>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),r=n.tokenSearchers,a=n.fullSearcher,l=this._search(r,a);return this._computeScore(l),this.options.shouldSort&&this._sort(l),t.limit&&"number"==typeof t.limit&&(l=l.slice(0,t.limit)),this._format(l)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),r=0,a=n.length;r<a;r+=1)t.push(new l(n[r],this.options));return{tokenSearchers:t,fullSearcher:new l(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,r={},a=[];if("string"==typeof n[0]){for(var l=0,d=n.length;l<d;l+=1)this._analyze({key:"",value:n[l],record:l,index:l},{resultMap:r,results:a,tokenSearchers:e,fullSearcher:t});return a}for(var h=0,p=n.length;h<p;h+=1)for(var f=n[h],y=0,w=this._keyNames.length;y<w;y+=1){var x=this._keyNames[y];this._analyze({key:x,value:this.options.getFn(f,x),record:f,index:h},{resultMap:r,results:a,tokenSearchers:e,fullSearcher:t})}return a}},{key:"_analyze",value:function(e,t){var n=this,r=e.key,a=e.arrayIndex,l=void 0===a?-1:a,d=e.value,h=e.record,f=e.index,y=t.tokenSearchers,w=void 0===y?[]:y,x=t.fullSearcher,j=t.resultMap,O=void 0===j?{}:j,C=t.results,S=void 0===C?[]:C;!function e(t,a,l,d){if(null!=a)if("string"==typeof a){var h=!1,f=-1,y=0;n._log("\nKey: ".concat(""===r?"--":r));var j=x.search(a);if(n._log('Full text: "'.concat(a,'", score: ').concat(j.score)),n.options.tokenize){for(var C=a.split(n.options.tokenSeparator),_=C.length,k=[],E=0,A=w.length;E<A;E+=1){var T=w[E];n._log('\nPattern: "'.concat(T.pattern,'"'));for(var R=!1,I=0;I<_;I+=1){var P=C[I],D=T.search(P),M={};D.isMatch?(M[P]=D.score,h=!0,R=!0,k.push(D.score)):(M[P]=1,n.options.matchAllTokens||k.push(1)),n._log('Token: "'.concat(P,'", score: ').concat(M[P]))}R&&(y+=1)}f=k[0];for(var L=k.length,F=1;F<L;F+=1)f+=k[F];f/=L,n._log("Token score average:",f)}var q=j.score;f>-1&&(q=(q+f)/2),n._log("Score average:",q);var N=!n.options.tokenize||!n.options.matchAllTokens||y>=w.length;if(n._log("\nCheck Matches: ".concat(N)),(h||j.isMatch)&&N){var B={key:r,arrayIndex:t,value:a,score:q};n.options.includeMatches&&(B.matchedIndices=j.matchedIndices);var U=O[d];U?U.output.push(B):(O[d]={item:l,output:[B]},S.push(O[d]))}}else if(p(a))for(var H=0,z=a.length;H<z;H+=1)e(H,a[H],l,d)}(l,d,h,f)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var t=this._keyWeights,n=!!Object.keys(t).length,r=0,a=e.length;r<a;r+=1){for(var l=e[r],d=l.output,h=d.length,p=1,f=0;f<h;f+=1){var y=d[f],w=y.key,x=n?t[w]:1,j=0===y.score&&t&&t[w]>0?Number.EPSILON:y.score;p*=Math.pow(j,x)}l.score=p,this._log(l)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,(function(e,t){if("object"===r(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}),2)),n=null}var a=[];this.options.includeMatches&&a.push((function(e,t){var n=e.output;t.matches=[];for(var r=0,a=n.length;r<a;r+=1){var l=n[r];if(0!==l.matchedIndices.length){var d={indices:l.matchedIndices,value:l.value};l.key&&(d.key=l.key),l.hasOwnProperty("arrayIndex")&&l.arrayIndex>-1&&(d.arrayIndex=l.arrayIndex),t.matches.push(d)}}})),this.options.includeScore&&a.push((function(e,t){t.score=e.score}));for(var l=0,d=e.length;l<d;l+=1){var h=e[l];if(this.options.id&&(h.item=this.options.getFn(h.item,this.options.id)[0]),a.length){for(var p={item:h.item},f=0,y=a.length;f<y;f+=1)a[f](h,p);t.push(p)}else t.push(h.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&a(t.prototype,n),e}();e.exports=f},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(2),l=n(3),d=n(6),h=function(){function e(t,n){var r=n.location,a=void 0===r?0:r,l=n.distance,h=void 0===l?100:l,p=n.threshold,f=void 0===p?.6:p,y=n.maxPatternLength,w=void 0===y?32:y,x=n.isCaseSensitive,j=void 0!==x&&x,O=n.tokenSeparator,C=void 0===O?/ +/g:O,S=n.findAllMatches,_=void 0!==S&&S,k=n.minMatchCharLength,E=void 0===k?1:k,A=n.includeMatches,T=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:a,distance:h,threshold:f,maxPatternLength:w,isCaseSensitive:j,tokenSeparator:C,findAllMatches:_,includeMatches:T,minMatchCharLength:E},this.pattern=j?t:t.toLowerCase(),this.pattern.length<=w&&(this.patternAlphabet=d(this.pattern))}var t,n;return t=e,(n=[{key:"search",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var d={isMatch:!0,score:0};return r&&(d.matchedIndices=[[0,e.length-1]]),d}var h=this.options,p=h.maxPatternLength,f=h.tokenSeparator;if(this.pattern.length>p)return a(e,this.pattern,f);var y=this.options,w=y.location,x=y.distance,j=y.threshold,O=y.findAllMatches,C=y.minMatchCharLength;return l(e,this.pattern,this.patternAlphabet,{location:w,distance:x,threshold:j,findAllMatches:O,minMatchCharLength:C,includeMatches:r})}}])&&r(t.prototype,n),e}();e.exports=h},function(e,t){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,a=new RegExp(t.replace(n,"\\$&").replace(r,"|")),l=e.match(a),d=!!l,h=[];if(d)for(var p=0,f=l.length;p<f;p+=1){var y=l[p];h.push([e.indexOf(y),y.length-1])}return{score:d?.5:1,isMatch:d,matchedIndices:h}}},function(e,t,n){var r=n(4),a=n(5);e.exports=function(e,t,n,l){for(var d=l.location,h=void 0===d?0:d,p=l.distance,f=void 0===p?100:p,y=l.threshold,w=void 0===y?.6:y,x=l.findAllMatches,j=void 0!==x&&x,O=l.minMatchCharLength,C=void 0===O?1:O,S=l.includeMatches,_=void 0!==S&&S,k=h,E=e.length,A=w,T=e.indexOf(t,k),R=t.length,I=[],P=0;P<E;P+=1)I[P]=0;if(-1!==T){var D=r(t,{errors:0,currentLocation:T,expectedLocation:k,distance:f});if(A=Math.min(D,A),-1!==(T=e.lastIndexOf(t,k+R))){var M=r(t,{errors:0,currentLocation:T,expectedLocation:k,distance:f});A=Math.min(M,A)}}T=-1;for(var L=[],F=1,q=R+E,N=1<<(R<=31?R-1:30),B=0;B<R;B+=1){for(var U=0,H=q;U<H;)r(t,{errors:B,currentLocation:k+H,expectedLocation:k,distance:f})<=A?U=H:q=H,H=Math.floor((q-U)/2+U);q=H;var z=Math.max(1,k-H+1),V=j?E:Math.min(k+H,E)+R,W=Array(V+2);W[V+1]=(1<<B)-1;for(var K=V;K>=z;K-=1){var G=K-1,Y=n[e.charAt(G)];if(Y&&(I[G]=1),W[K]=(W[K+1]<<1|1)&Y,0!==B&&(W[K]|=(L[K+1]|L[K])<<1|1|L[K+1]),W[K]&N&&(F=r(t,{errors:B,currentLocation:G,expectedLocation:k,distance:f}))<=A){if(A=F,(T=G)<=k)break;z=Math.max(1,2*k-T)}}if(r(t,{errors:B+1,currentLocation:k,expectedLocation:k,distance:f})>A)break;L=W}var X={isMatch:T>=0,score:0===F?.001:F};return _&&(X.matchedIndices=a(I,C)),X}},function(e,t){e.exports=function(e,t){var n=t.errors,r=void 0===n?0:n,a=t.currentLocation,l=void 0===a?0:a,d=t.expectedLocation,h=void 0===d?0:d,p=t.distance,f=void 0===p?100:p,y=r/e.length,w=Math.abs(h-l);return f?y+w/f:w?1:y}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,a=-1,l=0,d=e.length;l<d;l+=1){var h=e[l];h&&-1===r?r=l:h||-1===r||((a=l-1)-r+1>=t&&n.push([r,a]),r=-1)}return e[l-1]&&l-r>=t&&n.push([r,l-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,r=0;r<n;r+=1)t[e.charAt(r)]=0;for(var a=0;a<n;a+=1)t[e.charAt(a)]|=1<<n-a-1;return t}},function(e,t){var n=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},r=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)},a=function(e){return"string"==typeof e},l=function(e){return"number"==typeof e};e.exports={get:function(e,t){var d=[];return function e(t,h){if(h){var p=h.indexOf("."),f=h,y=null;-1!==p&&(f=h.slice(0,p),y=h.slice(p+1));var w=t[f];if(null!=w)if(y||!a(w)&&!l(w))if(n(w))for(var x=0,j=w.length;x<j;x+=1)e(w[x],y);else y&&e(w,y);else d.push(r(w))}else d.push(t)}(e,t),d},isArray:n,isString:a,isNum:l,toString:r}}])},,,,,,,,,,,,,,,,function(e,t,n){!function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),a={error:null,info:null},l=function(e){var t,n;function l(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=e.call.apply(e,[this].concat(r))||this).state=a,t.resetErrorBoundary=function(){for(var e,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.setState(a)},t}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,l.getDerivedStateFromError=function getDerivedStateFromError(e){return{error:e}};var d=l.prototype;return d.componentDidCatch=function(e,t){var n,r;null==(n=(r=this.props).onError)||n.call(r,e,null==t?void 0:t.componentStack),this.setState({info:t})},d.componentDidUpdate=function(e){var t,n,r,l,d=this.state,h=d.error,p=d.info,f=this.props.resetKeys;null!==h&&null!==p&&(void 0===(r=e.resetKeys)&&(r=[]),void 0===(l=f)&&(l=[]),r.length!==l.length||r.some((function(e,t){return!Object.is(e,l[t])})))&&(null==(t=(n=this.props).onResetKeysChange)||t.call(n,e.resetKeys,f),this.setState(a))},d.render=function(){var e=this.state,t=e.error,n=e.info,a=this.props,l=a.fallbackRender,d=a.FallbackComponent,h=a.fallback;if(null!==t){if(!n)return null;var p={componentStack:null==n?void 0:n.componentStack,error:t,resetErrorBoundary:this.resetErrorBoundary};if(r.default.isValidElement(h))return h;if("function"==typeof l)return l(p);if(d)return r.default.createElement(d,p);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},l}(r.default.Component);e.ErrorBoundary=l,e.useErrorHandler=function(e){var t=r.default.useState(null),n=t[0],a=t[1];if(e)throw e;if(n)throw n;return a},e.withErrorBoundary=function(e,t){function n(n){return r.default.createElement(l,t,r.default.createElement(e,n))}var a=e.displayName||e.name||"Unknown";return n.displayName="withErrorBoundary("+a+")",n},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2))},function(e,t){e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},function(e,t,n){e.exports=n(832)},function(e,t,n){"use strict";var r=n(27),a=n(35),l=n(34),d=n(19),h=n.n(d),p=n(2),f=n.n(p),y=n(1),w=n.n(y),x=n(255),j=n.n(x),O=n(305),C=n(23),S={vertical:w.a.bool,justified:w.a.bool,block:j()(w.a.bool,(function(e){var t=e.block,n=e.vertical;return t&&!n?new Error("`block` requires `vertical` to be set to have any effect"):null}))},_=function(e){function t(){return e.apply(this,arguments)||this}return Object(l.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.block,l=t.justified,d=t.vertical,p=t.className,y=Object(a.a)(t,["block","justified","vertical","className"]),w=Object(C.f)(y),x=w[0],j=w[1],S=Object(r.a)({},Object(C.d)(x),((e={})[Object(C.e)(x)]=!d,e[Object(C.e)(x,"vertical")]=d,e[Object(C.e)(x,"justified")]=l,e[Object(C.e)(O.a.defaultProps,"block")]=n,e));return f.a.createElement("div",Object(r.a)({},j,{className:h()(p,S)}))},t}(f.a.Component);_.propTypes=S,_.defaultProps={block:!1,justified:!1,vertical:!1},t.a=Object(C.a)("btn-group",_)},function(e,t,n){"use strict";var r=n(311);t.__esModule=!0,t.default=void 0;var a=r(n(367)),l=r(n(495)),d=r(n(496)),h=r(n(19)),p=r(n(2)),f=r(n(1)),y=n(500),w=n(501),x=r(n(847)),j={controlId:f.default.string,validationState:f.default.oneOf(["success","warning","error",null])},O={$bs_formGroup:f.default.object.isRequired},C=function(e){function t(){return e.apply(this,arguments)||this}(0,d.default)(t,e);var n=t.prototype;return n.getChildContext=function(){var e=this.props;return{$bs_formGroup:{controlId:e.controlId,validationState:e.validationState}}},n.hasFeedback=function(e){var t=this;return x.default.some(e,(function(e){return"feedback"===e.props.bsRole||e.props.children&&t.hasFeedback(e.props.children)}))},n.render=function(){var e=this.props,t=e.validationState,n=e.className,r=e.children,d=(0,l.default)(e,["validationState","className","children"]),f=(0,y.splitBsPropsAndOmit)(d,["controlId"]),w=f[0],x=f[1],j=(0,a.default)({},(0,y.getClassSet)(w),{"has-feedback":this.hasFeedback(r)});return t&&(j["has-"+t]=!0),p.default.createElement("div",(0,a.default)({},x,{className:(0,h.default)(n,j)}),r)},t}(p.default.Component);C.propTypes=j,C.childContextTypes=O;var S=(0,y.bsClass)("form-group",(0,y.bsSizes)([w.Size.LARGE,w.Size.SMALL],C));t.default=S,e.exports=t.default},function(e,t,n){"use strict";var r=n(311);t.__esModule=!0,t.default=void 0;var a=r(n(367)),l=r(n(495)),d=r(n(496)),h=r(n(19)),p=r(n(2)),f=r(n(1)),y=(r(n(177)),n(500)),w={htmlFor:f.default.string,srOnly:f.default.bool},x={$bs_formGroup:f.default.object},j=function(e){function t(){return e.apply(this,arguments)||this}return(0,d.default)(t,e),t.prototype.render=function(){var e=this.context.$bs_formGroup,t=e&&e.controlId,n=this.props,r=n.htmlFor,d=void 0===r?t:r,f=n.srOnly,w=n.className,x=(0,l.default)(n,["htmlFor","srOnly","className"]),j=(0,y.splitBsProps)(x),O=j[0],C=j[1],S=(0,a.default)({},(0,y.getClassSet)(O),{"sr-only":f});return p.default.createElement("label",(0,a.default)({},C,{htmlFor:d,className:(0,h.default)(w,S)}))},t}(p.default.Component);j.propTypes=w,j.defaultProps={srOnly:!1},j.contextTypes=x;var O=(0,y.bsClass)("control-label",j);t.default=O,e.exports=t.default},function(e,t,n){var r,a;function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h=n(145).Plugin,p=n(473),f=n(214),y=n(862),w=y.Provider,x=y.RequestClient,j=y.Socket,O=n(873),C=n(874),S=n(875),_=n(876),k=n(877),E=n(878),A=n(568),T=n(879);function buildResponseError(e,t){return t||(t=new Error("Upload error")),"string"==typeof t&&(t=new Error(t)),t instanceof Error||(t=d(new Error("Upload error"),{data:t})),T(e)?t=new A(t,e):(t.request=e,t)}function R(e){return e.data.slice(0,e.data.size,e.meta.type)}e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).type="uploader",r.id=r.opts.id||"XHRUpload",r.title="XHRUpload",r.defaultLocale={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}};var a={formData:!0,fieldName:"files[]",method:"post",metaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},timeout:3e4,limit:0,withCredentials:!1,responseType:"",getResponseData:function(e,t){var n={};try{n=JSON.parse(e)}catch(e){console.log(e)}return n},getResponseError:function getResponseError(e,t){var n=new Error("Upload error");return T(t)&&(n=new A(n,t)),n},validateStatus:function(e,t,n){return e>=200&&e<300}};if(r.opts=d({},a,n),r.i18nInit(),r.handleUpload=r.handleUpload.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r.opts.__queue instanceof E?r.requests=r.opts.__queue:r.requests=new E(r.opts.limit),r.opts.bundle&&!r.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");return r.uploaderEvents=Object.create(null),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var a=r.prototype;return a.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},a.i18nInit=function(){this.translator=new f([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},a.getOptions=function(e){var t=this.uppy.getState().xhrUpload,n=this.opts.headers,r=d({},this.opts,t||{},e.xhrUpload||{},{headers:{}});return"function"==typeof n?r.headers=n(e):d(r.headers,this.opts.headers),t&&d(r.headers,t.headers),e.xhrUpload&&d(r.headers,e.xhrUpload.headers),r},a.addMetadata=function(e,t,n){(Array.isArray(n.metaFields)?n.metaFields:Object.keys(t)).forEach((function(n){e.append(n,t[n])}))},a.createFormDataUpload=function(e,t){var n=new FormData;this.addMetadata(n,e.meta,t);var r=R(e);return e.name?n.append(t.fieldName,r,e.meta.name):n.append(t.fieldName,r),n},a.createBundledUpload=function(e,t){var n=this,r=new FormData,a=this.uppy.getState().meta;return this.addMetadata(r,a,t),e.forEach((function(e){var t=n.getOptions(e),a=R(e);e.name?r.append(t.fieldName,a,e.name):r.append(t.fieldName,a)})),r},a.createBareUpload=function(e,t){return e.data},a.upload=function(e,t,n){var r=this,a=this.getOptions(e);return this.uppy.log("uploading "+t+" of "+n),new Promise((function(t,n){r.uppy.emit("upload-started",e);var l=a.formData?r.createFormDataUpload(e,a):r.createBareUpload(e,a),d=new XMLHttpRequest;r.uploaderEvents[e.id]=new _(r.uppy);var h=new k(a.timeout,(function(){d.abort(),y.done();var t=new Error(r.i18n("timedOut",{seconds:Math.ceil(a.timeout/1e3)}));r.uppy.emit("upload-error",e,t),n(t)})),f=p();d.upload.addEventListener("loadstart",(function(e){r.uppy.log("[XHRUpload] "+f+" started")})),d.upload.addEventListener("progress",(function(t){r.uppy.log("[XHRUpload] "+f+" progress: "+t.loaded+" / "+t.total),h.progress(),t.lengthComputable&&r.uppy.emit("upload-progress",e,{uploader:r,bytesUploaded:t.loaded,bytesTotal:t.total})})),d.addEventListener("load",(function(l){if(r.uppy.log("[XHRUpload] "+f+" finished"),h.done(),y.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null),a.validateStatus(l.target.status,d.responseText,d)){var p=a.getResponseData(d.responseText,d),w=p[a.responseUrlFieldName],x={status:l.target.status,body:p,uploadURL:w};return r.uppy.emit("upload-success",e,x),w&&r.uppy.log("Download "+e.name+" from "+w),t(e)}var j=a.getResponseData(d.responseText,d),O=buildResponseError(d,a.getResponseError(d.responseText,d)),C={status:l.target.status,body:j};return r.uppy.emit("upload-error",e,O,C),n(O)})),d.addEventListener("error",(function(t){r.uppy.log("[XHRUpload] "+f+" errored"),h.done(),y.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null);var l=buildResponseError(d,a.getResponseError(d.responseText,d));return r.uppy.emit("upload-error",e,l),n(l)})),d.open(a.method.toUpperCase(),a.endpoint,!0),d.withCredentials=a.withCredentials,""!==a.responseType&&(d.responseType=a.responseType);var y=r.requests.run((function(){var t=r.getOptions(e);return Object.keys(t.headers).forEach((function(e){d.setRequestHeader(e,t.headers[e])})),d.send(l),function(){h.done(),d.abort()}}));r.onFileRemove(e.id,(function(){y.abort(),n(new Error("File removed"))})),r.onCancelAll(e.id,(function(){y.abort(),n(new Error("Upload cancelled"))}))}))},a.uploadRemote=function(e,t,n){var r=this,a=this.getOptions(e);return new Promise((function(t,n){r.uppy.emit("upload-started",e);var l={};(Array.isArray(a.metaFields)?a.metaFields:Object.keys(e.meta)).forEach((function(t){l[t]=e.meta[t]})),new(e.remote.providerOptions.provider?w:x)(r.uppy,e.remote.providerOptions).post(e.remote.url,d({},e.remote.body,{endpoint:a.endpoint,size:e.data.size,fieldname:a.fieldName,metadata:l,httpMethod:a.method,useFormData:a.formData,headers:a.headers})).then((function(l){var h=l.token,p=C(e.remote.companionUrl),f=new j({target:p+"/api/"+h,autoOpen:!1});r.uploaderEvents[e.id]=new _(r.uppy),r.onFileRemove(e.id,(function(){f.send("pause",{}),y.abort(),t("upload "+e.id+" was removed")})),r.onCancelAll(e.id,(function(){f.send("pause",{}),y.abort(),t("upload "+e.id+" was canceled")})),r.onRetry(e.id,(function(){f.send("pause",{}),f.send("resume",{})})),r.onRetryAll(e.id,(function(){f.send("pause",{}),f.send("resume",{})})),f.on("progress",(function(t){return O(r,t,e)})),f.on("success",(function(n){var l=a.getResponseData(n.response.responseText,n.response),d=l[a.responseUrlFieldName],h={status:n.response.status,body:l,uploadURL:d};return r.uppy.emit("upload-success",e,h),y.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null),t()})),f.on("error",(function(t){var l=t.response,h=l?a.getResponseError(l.responseText,l):d(new Error(t.error.message),{cause:t.error});r.uppy.emit("upload-error",e,h),y.done(),r.uploaderEvents[e.id]&&(r.uploaderEvents[e.id].remove(),r.uploaderEvents[e.id]=null),n(h)}));var y=r.requests.run((function(){return f.open(),e.isPaused&&f.send("pause",{}),function(){return f.close()}}))})).catch((function(t){r.uppy.emit("upload-error",e,t),n(t)}))}))},a.uploadBundle=function(e){var t=this;return new Promise((function(n,r){var a=t.opts.endpoint,l=t.opts.method,h=t.uppy.getState().xhrUpload,p=t.createBundledUpload(e,d({},t.opts,h||{})),f=new XMLHttpRequest,y=new k(t.opts.timeout,(function(){f.abort();var e=new Error(t.i18n("timedOut",{seconds:Math.ceil(t.opts.timeout/1e3)}));w(e),r(e)})),w=function emitError(n){e.forEach((function(e){t.uppy.emit("upload-error",e,n)}))};f.upload.addEventListener("loadstart",(function(e){t.uppy.log("[XHRUpload] started uploading bundle"),y.progress()})),f.upload.addEventListener("progress",(function(n){y.progress(),n.lengthComputable&&e.forEach((function(e){t.uppy.emit("upload-progress",e,{uploader:t,bytesUploaded:n.loaded/n.total*e.size,bytesTotal:e.size})}))})),f.addEventListener("load",(function(a){if(y.done(),t.opts.validateStatus(a.target.status,f.responseText,f)){var l=t.opts.getResponseData(f.responseText,f),d={status:a.target.status,body:l};return e.forEach((function(e){t.uppy.emit("upload-success",e,d)})),n()}var h=t.opts.getResponseError(f.responseText,f)||new Error("Upload error");return h.request=f,w(h),r(h)})),f.addEventListener("error",(function(e){y.done();var n=t.opts.getResponseError(f.responseText,f)||new Error("Upload error");return w(n),r(n)})),t.uppy.on("cancel-all",(function(){y.done(),f.abort()})),f.open(l.toUpperCase(),a,!0),f.withCredentials=t.opts.withCredentials,""!==t.opts.responseType&&(f.responseType=t.opts.responseType),Object.keys(t.opts.headers).forEach((function(e){f.setRequestHeader(e,t.opts.headers[e])})),f.send(p),e.forEach((function(e){t.uppy.emit("upload-started",e)}))}))},a.uploadFiles=function(e){var t=this,n=e.map((function(n,r){var a=parseInt(r,10)+1,l=e.length;return n.error?Promise.reject(new Error(n.error)):n.isRemote?t.uploadRemote(n,a,l):t.upload(n,a,l)}));return S(n)},a.onFileRemove=function(e,t){this.uploaderEvents[e].on("file-removed",(function(n){e===n.id&&t(n.id)}))},a.onRetry=function(e,t){this.uploaderEvents[e].on("upload-retry",(function(n){e===n&&t()}))},a.onRetryAll=function(e,t){var n=this;this.uploaderEvents[e].on("retry-all",(function(r){n.uppy.getFile(e)&&t()}))},a.onCancelAll=function(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",(function(){n.uppy.getFile(e)&&t()}))},a.handleUpload=function(e){var t=this;if(0===e.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();0!==this.opts.limit||this.opts.__queue||this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning"),this.uppy.log("[XHRUpload] Uploading...");var n=e.map((function(e){return t.uppy.getFile(e)}));if(this.opts.bundle){if(n.some((function(e){return e.isRemote})))throw new Error("Can’t upload remote files when the `bundle: true` option is set");if("function"==typeof this.opts.headers)throw new TypeError("`headers` may not be a function when the `bundle: true` option is set");return this.uploadBundle(n)}return this.uploadFiles(n).then((function(){return null}))},a.install=function(){if(this.opts.bundle){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:d({},e,{individualCancellation:!1})})}this.uppy.addUploader(this.handleUpload)},a.uninstall=function(){if(this.opts.bundle){var e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:d({},e,{individualCancellation:!0})})}this.uppy.removeUploader(this.handleUpload)},r}(h),r.VERSION="1.7.5",a)},function(e,t,n){(function(r){var a,l,d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{!r&&h.return&&h.return()}finally{if(a)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a=[n(144),n(486)],void 0===(l=function(e,t){var n,r,a,l=void 0;window.sharejs=l={};var y=l.types={};l._bt=r=function(e,t,n,r){var a=void 0;return e.transformX=e.transformX=a=function(e,l){n(e),n(l);var d,h,f,y=[],w=!0,x=!1,j=void 0;try{for(var O,C=Array.from(l)[Symbol.iterator]();!(w=(O=C.next()).done);w=!0){for(var S=O.value,_=[],k=0;k<e.length;){var E,A=[];if(d=e[k],f=A,t(_,d,h=S,"left"),t(f,h,d,"right"),k++,1!==A.length){if(0===A.length){var T=!0,R=!1,I=void 0;try{for(var P,D=Array.from(e.slice(k))[Symbol.iterator]();!(T=(P=D.next()).done);T=!0)E=P.value,r(_,E)}catch(e){R=!0,I=e}finally{try{!T&&D.return&&D.return()}finally{if(R)throw I}}S=null;break}var M=Array.from(a(e.slice(k),A)),L=p(M,2),F=L[0],q=L[1],N=!0,B=!1,U=void 0;try{for(var H,z=Array.from(F)[Symbol.iterator]();!(N=(H=z.next()).done);N=!0)E=H.value,r(_,E)}catch(e){B=!0,U=e}finally{try{!N&&z.return&&z.return()}finally{if(B)throw U}}var V=!0,W=!1,K=void 0;try{for(var G,Y=Array.from(q)[Symbol.iterator]();!(V=(G=Y.next()).done);V=!0){var X=G.value;r(y,X)}}catch(e){W=!0,K=e}finally{try{!V&&Y.return&&Y.return()}finally{if(W)throw K}}S=null;break}S=A[0]}null!=S&&r(y,S),e=_}}catch(e){x=!0,j=e}finally{try{!w&&C.return&&C.return()}finally{if(x)throw j}}return[e,y]},e.transform=e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");if(0===n.length)return e;if(1===e.length&&1===n.length)return t([],e[0],n[0],r);if("left"===r){var l,d=Array.from(a(e,n)),h=p(d,2);return l=h[0],h[1],l}var f=Array.from(a(n,e)),y=p(f,2);return y[0],y[1]}};var w={name:"text",create:function(){return""}},x=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},j=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if(!("string"===h(e.i)^"string"===h(e.d)^"string"===h(e.c)))throw new Error("component needs an i, d or c field");if(!(e.p>=0))throw new Error("position cannot be negative")},O=function(e){var t=!0,n=!1,r=void 0;try{for(var a,l=Array.from(e)[Symbol.iterator]();!(t=(a=l.next()).done);t=!0){var d=a.value;j(d)}}catch(e){n=!0,r=e}finally{try{!t&&l.return&&l.return()}finally{if(n)throw r}}return!0};w.apply=function(e,t){O(t);var n=!0,r=!1,a=void 0;try{for(var l,d=Array.from(t)[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var h=l.value;if(null!=h.i)e=x(e,h.p,h.i);else if(null!=h.d){var p=e.slice(h.p,h.p+h.d.length);if(h.d!==p)throw new Error("Delete component '"+h.d+"' does not match deleted text '"+p+"'");e=e.slice(0,h.p)+e.slice(h.p+h.d.length)}else{if(null==h.c)throw new Error("Unknown op type");var f=e.slice(h.p,h.p+h.c.length);if(h.c!==f)throw new Error("Comment component '"+h.c+"' does not match commented text '"+f+"'")}}}catch(e){r=!0,a=e}finally{try{!n&&d.return&&d.return()}finally{if(r)throw a}}return e};var C=function(e,t){var n=void 0,r={};for(var a in e)n=e[a],r[a]=n;for(a in t)n=t[a],r[a]=n;return r};w._append=n=function(e,t){if(""!==t.i&&""!==t.d){if(0===e.length)return e.push(t);var n=e[e.length-1];return null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length&&n.u===t.u?e[e.length-1]=C(n,{i:x(n.i,t.p-n.p,t.i)}):null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length&&n.u===t.u?e[e.length-1]=C(n,{d:x(t.d,n.p-t.p,n.d),p:t.p}):e.push(t)}},w.compose=function(e,t){O(e),O(t);var r=e.slice(),a=!0,l=!1,d=void 0;try{for(var h,p=Array.from(t)[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var f=h.value;n(r,f)}}catch(e){l=!0,d=e}finally{try{!a&&p.return&&p.return()}finally{if(l)throw d}}return r},w.compress=function(e){return w.compose([],e)},w.normalize=function(e){var t=[];null==e.i&&null==e.p||(e=[e]);var r=!0,a=!1,l=void 0;try{for(var d,h=Array.from(e)[Symbol.iterator]();!(r=(d=h.next()).done);r=!0){var p=d.value;null==p.p&&(p.p=0),n(t,p)}}catch(e){a=!0,l=e}finally{try{!r&&h.return&&h.return()}finally{if(a)throw l}}return t};var S=function(e,t,n){if(null!=t.i)return t.p<e||t.p===e&&n?e+t.i.length:e;if(null!=t.d)return e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length;if(null!=t.c)return e;throw new Error("unknown op type")};w.transformCursor=function(e,t,n){var r="right"===n,a=!0,l=!1,d=void 0;try{for(var h,p=Array.from(t)[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var f=h.value;e=S(e,f,r)}}catch(e){l=!0,d=e}finally{try{!a&&p.return&&p.return()}finally{if(l)throw d}}return e},w._tc=a=function(e,t,r,a){var l=void 0,d=void 0,h=void 0;if(O([t]),O([r]),null!=t.i)n(e,C(t,{p:S(t.p,r,"right"===a)}));else if(null!=t.d)if(null!=r.i){var p=t.d;t.p<r.p&&(n(e,C(t,{d:p.slice(0,r.p-t.p)})),p=p.slice(r.p-t.p)),""!==p&&n(e,C(t,{d:p,p:t.p+r.i.length}))}else if(null!=r.d)if(t.p>=r.p+r.d.length)n(e,C(t,{p:t.p-r.d.length}));else if(t.p+t.d.length<=r.p)n(e,t);else{if(h=C(t,{d:""}),t.p<r.p&&(h.d=t.d.slice(0,r.p-t.p)),t.p+t.d.length>r.p+r.d.length&&(h.d+=t.d.slice(r.p+r.d.length-t.p)),d=Math.max(t.p,r.p),l=Math.min(t.p+t.d.length,r.p+r.d.length),t.d.slice(d-t.p,l-t.p)!==r.d.slice(d-r.p,l-r.p))throw new Error("Delete ops delete different text in the same region of the document");""!==h.d&&(h.p=S(h.p,r),n(e,h))}else{if(null==r.c)throw new Error("unknown op type");n(e,t)}else if(null!=t.c)if(null!=r.i)if(t.p<r.p&&r.p<t.p+t.c.length){var f=r.p-t.p,y=t.c.slice(0,+(f-1)+1||void 0)+r.i+t.c.slice(f);n(e,C(t,{c:y}))}else n(e,C(t,{p:S(t.p,r,!0)}));else if(null!=r.d)if(t.p>=r.p+r.d.length)n(e,C(t,{p:t.p-r.d.length}));else if(t.p+t.c.length<=r.p)n(e,t);else{if(h=C(t,{c:""}),t.p<r.p&&(h.c=t.c.slice(0,r.p-t.p)),t.p+t.c.length>r.p+r.d.length&&(h.c+=t.c.slice(r.p+r.d.length-t.p)),d=Math.max(t.p,r.p),l=Math.min(t.p+t.c.length,r.p+r.d.length),t.c.slice(d-t.p,l-t.p)!==r.d.slice(d-r.p,l-r.p))throw new Error("Delete ops delete different text in the same region of the document");h.p=S(h.p,r),n(e,h)}else{if(null==r.c)throw new Error("unknown op type");n(e,t)}return e};w.invert=function(e){return Array.from(e.slice().reverse()).map((function(e){return function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}}(e)}))},l.types||(l.types={}),r(w,a,O,n),l.types.text=w,w.api={provides:{text:!0},getLength:function(){return this.snapshot.length},getText:function(){return this.snapshot},insert:function(e,t,n,r){var a={p:e,i:t};return n&&(a.u=!0),a=[a],this.submitOp(a,r),a},del:function(e,t,n,r){var a={p:e,d:this.snapshot.slice(e,e+t)};return n&&(a.u=!0),a=[a],this.submitOp(a,r),a},_register:function(){return this.on("remoteop",(function(e){var t=this;return function(){var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=Array.from(e)[Symbol.iterator]();!(r=(d=h.next()).done);r=!0){var p=d.value;void 0!==p.i?n.push(t.emit("insert",p.p,p.i)):void 0!==p.d?n.push(t.emit("delete",p.p,p.d)):n.push(void 0)}}catch(e){a=!0,l=e}finally{try{!r&&h.return&&h.return()}finally{if(a)throw l}}return n}()}))}};var _=function(e){return setTimeout(e,0)},k=function(){function e(){f(this,e)}return d(e,[{key:"on",value:function(e,t){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this}},{key:"removeListener",value:function(e,t){var n=this;this._events||(this._events={});for(var r=this._events[e]||(this._events[e]=[]),a=0;a<r.length;)r[a]===t&&(r[a]=void 0),a++;return _((function(){return n._events[e]=Array.from(n._events[e]).filter((function(e){return e}))})),this}},{key:"emit",value:function(e){if(!(null!=this._events?this._events[e]:void 0))return this;for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=!0,l=!1,d=void 0;try{for(var h,p=Array.from(this._events[e])[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var f=h.value;f&&f.apply(this,n)}}catch(e){l=!0,d=e}finally{try{!a&&p.return&&p.return()}finally{if(l)throw d}}return this}}]),e}();k.mixin=function(e){var t=e.prototype||e;return t.on=k.prototype.on,t.removeListener=k.prototype.removeListener,t.emit=k.prototype.emit,e},l.extendDoc=function(e,t){return E.prototype[e]=t};var E=function(){function e(t,n,r){f(this,e),this.flush=this.flush.bind(this),this.setFlushDelay=this.setFlushDelay.bind(this),this.shout=this.shout.bind(this),this.connection=t,this.name=n,r||(r={}),this.version=r.v,this.snapshot=r.snaphot,r.type&&this._setType(r.type),this.state="closed",this.autoOpen=!1,this._create=r.create,this.inflightOp=null,this.inflightCallbacks=[],this.inflightSubmittedIds=[],this.pendingOp=null,this.pendingCallbacks=[],this.serverOps={}}return d(e,[{key:"_xf",value:function(e,t){return this.type.transformX?this.type.transformX(e,t):[this.type.transform(e,t,"left"),this.type.transform(t,e,"right")]}},{key:"_otApply",value:function(e,t,n){var r=this.snapshot;if(this.snapshot=this.type.apply(this.snapshot,e),this.emit("change",e,r,n),t)return this.emit("remoteop",e,r,n)}},{key:"_connectionStateChanged",value:function(e,t){switch(e){case"disconnected":this.state="closed",this.inflightOp&&this.inflightSubmittedIds.push(this.connection.id),this.emit("closed");break;case"ok":this.autoOpen&&this.open();break;case"stopped":"function"==typeof this._openCallback&&this._openCallback(t)}return this.emit(e,t)}},{key:"_setType",value:function(e){if("string"==typeof e&&(e=y[e]),!e||!e.compose)throw new Error("Support for types without compose() is not implemented");if(this.type=e,e.api){for(var t in e.api){var n=e.api[t];this[t]=n}return"function"==typeof this._register?this._register():void 0}return this.provides={}}},{key:"_onMessage",value:function(e){if(!0===e.open){if(this.state="open",this._create=!1,null==this.created&&(this.created=!!e.create),e.type&&this._setType(e.type),e.create?(this.created=!0,this.snapshot=this.type.create()):(!0!==this.created&&(this.created=!1),void 0!==e.snapshot&&(this.snapshot=e.snapshot)),null!=e.v&&(this.version=e.v),this.inflightOp){var t={doc:this.name,op:this.inflightOp,v:this.version};this.inflightSubmittedIds.length&&(t.dupIfSource=this.inflightSubmittedIds),this.connection.send(t)}else this.flush();return this.emit("open"),"function"==typeof this._openCallback?this._openCallback(null):void 0}if(!1===e.open)return e.error&&("undefined"!=typeof console&&null!==console&&console.error("Could not open document: "+e.error),this.emit("error",e.error),"function"==typeof this._openCallback&&this._openCallback(e.error)),this.state="closed",this.emit("closed"),"function"==typeof this._closeCallback&&this._closeCallback(),this._closeCallback=null;if(null===e.op&&"Op already submitted"===r);else{if(void 0===e.op&&void 0!==e.v||e.op&&Array.from(this.inflightSubmittedIds).includes(e.meta.source)){var n=this.inflightOp;this.inflightOp=null,this.inflightSubmittedIds.length=0,null===this.pendingOp&&this.emit("saved");var r=e.error;if(r){if(this.type.invert){var a=this.type.invert(n);if(this.pendingOp){var l=Array.from(this._xf(this.pendingOp,a)),d=p(l,2);this.pendingOp=d[0],a=d[1]}this._otApply(a,!0,e)}else this.emit("error","Op apply failed ("+r+") and the op could not be reverted");var h=!0,f=!1,y=void 0;try{for(var w,x=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(h=(w=x.next()).done);h=!0)(0,w.value)(r)}catch(e){f=!0,y=e}finally{try{!h&&x.return&&x.return()}finally{if(f)throw y}}}else{if(e.v<this.version)return;if(e.v!==this.version)throw new Error("Invalid version from server");this.serverOps[this.version]=n,this.version++,this.emit("acknowledge",n);var j=!0,O=!1,C=void 0;try{for(var S,_=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(j=(S=_.next()).done);j=!0)(0,S.value)(null,n)}catch(e){O=!0,C=e}finally{try{!j&&_.return&&_.return()}finally{if(O)throw C}}}return this.delayedFlush()}if(e.op){if(e.v<this.version)return;if(e.doc!==this.name)return this.emit("error","Expected docName '"+this.name+"' but got "+e.doc);if(e.v!==this.version)return this.emit("error","Expected version "+this.version+" but got "+e.v);var k=e.op;this.serverOps[this.version]=k;var E=k;if(null!==this.inflightOp){var A=Array.from(this._xf(this.inflightOp,E)),T=p(A,2);this.inflightOp=T[0],E=T[1]}if(null!==this.pendingOp){var R=Array.from(this._xf(this.pendingOp,E)),I=p(R,2);this.pendingOp=I[0],E=I[1]}return this.version++,this._otApply(E,!0,e)}if(!e.meta)return"undefined"!=typeof console&&null!==console?console.warn("Unhandled document message:",e):void 0;var P=e.meta,D=P.path,M=P.value;switch(null!=D?D[0]:void 0){case"shout":return this.emit("shout",M);default:return"undefined"!=typeof console&&null!==console?console.warn("Unhandled meta op:",e):void 0}}}},{key:"flush",value:function(){if(this.flushTimeout=null,"ok"===this.connection.state&&null===this.inflightOp&&null!==this.pendingOp){if(this.inflightOp=this.pendingOp,this.inflightCallbacks=this.pendingCallbacks,this.pendingOp=null,this.pendingCallbacks=[],this.emit("flipped_pending_to_inflight"),window.useShareJsHash||window.sl_debugging){var e=Date.now(),n=this.__lastSubmitTimestamp&&e-this.__lastSubmitTimestamp;if(!this.__lastSubmitTimestamp||n>5e3||n<0||window.sl_debugging){var r=t("blob "+this.snapshot.length+"\0"+this.snapshot).toString();this.__lastSubmitTimestamp=e}}var a=this.__lastVersion;return this.__lastVersion=this.version,this.connection.send({doc:this.name,op:this.inflightOp,v:this.version,lastV:a,hash:r})}}},{key:"submitOp",value:function(e,t){null!=this.type.normalize&&(e=this.type.normalize(e));var n=this.snapshot;return this.snapshot=this.type.apply(this.snapshot,e),null!==this.pendingOp?this.pendingOp=this.type.compose(this.pendingOp,e):this.pendingOp=e,t&&this.pendingCallbacks.push(t),this.emit("change",e,n),this.delayedFlush()}},{key:"delayedFlush",value:function(){if(null==this.flushTimeout)return this.flushTimeout=setTimeout(this.flush,this._flushDelay||0)}},{key:"setFlushDelay",value:function(e){return this._flushDelay=e}},{key:"shout",value:function(e){return this.connection.send({doc:this.name,meta:{path:["shout"],value:e}})}},{key:"open",value:function(e){var t=this;if(this.autoOpen=!0,"closed"===this.state){var n={doc:this.name,open:!0};return void 0===this.snapshot&&(n.snapshot=null),this.type&&(n.type=this.type.name),null!=this.version&&(n.v=this.version),this._create&&(n.create=!0),this.connection.send(n),this.state="opening",this._openCallback=function(n){return t._openCallback=null,"function"==typeof e?e(n):void 0}}}},{key:"close",value:function(e){return this.autoOpen=!1,"closed"===this.state?"function"==typeof e?e():void 0:(this.connection.send({doc:this.name,open:!1}),this.state="closed",this.emit("closing"),this._closeCallback=e)}}]),e}();k.mixin(E),l.Doc=E;var A=ace.require("ace/range").Range;window.sharejs.extendDoc("attach_ace",(function(e,t){if(!this.provides.text)throw new Error("Only text documents can be attached to ace");var n=this,r=e.getSession().getDocument();function a(){return window.setTimeout((function(){var e=r.getValue(),t=n.getText();if(e!==t)return n.emit("error","Text does not match in ace"),console.error("Text does not match!"),console.error("editor: "+e),console.error("ot:     "+t)}),0)}function l(l){if("remote"!==l.origin){if(!(null!=t&&r.getValue().length>=t)){var d=!(!e.getSession().$fromUndo&&!e.getSession().$fromReject);return function(e,t,n,r){var a=function(t){for(var n=e.getLines(0,t.row),r=0,a=0;a<n.length;a++){var l=n[a];r+=a<t.row?l.length:t.column}return r+t.row}(t.start);switch(t.action){case"insert":w=t.lines.join("\n"),n.insert(a,w,r);break;case"remove":w=t.lines.join("\n"),n.del(a,w.length,r);break;default:throw new Error("unknown action: "+t.action)}}(r,l,n,d),a()}n.emit("error",new Error("document length is greater than maxDocLength"))}}function d(e){var t=r.getAllLines(),n=0;for(n=0;n<t.length;n++){if(e<=t[n].length)break;e-=t[n].length+1}return{row:n,column:e}}function h(e,t){r.getLength()<=1&&r.$detectNewLine(t);var n=r.$split(t),l=d(e),h=r.clippedPos(l.row,l.column),p={row:h.row+n.length-1,column:(1===n.length?h.column:0)+n[n.length-1].length};return r.applyDelta({start:h,end:p,action:"insert",lines:n,origin:"remote"}),a()}function p(e,t){var n=A.fromPoints(d(e),d(e+t.length)),l=r.clippedPos(n.start.row,n.start.column),h=r.clippedPos(n.end.row,n.end.column);return r.applyDelta({start:l,end:h,action:"remove",lines:r.getLinesForRange({start:l,end:h}),origin:"remote"}),a()}r.setNewLineMode("unix"),p(0,r.getValue()),h(0,n.getText()),a(),r.on("change",l),n.on("insert",h),n.on("delete",p),n.detach_ace=function(){return n.removeListener("insert",h),n.removeListener("delete",p),r.removeListener("change",l),delete n.detach_ace}}));return window.sharejs.extendDoc("attach_cm",(function(e,t){if(!this.provides.text)throw new Error("Only text documents can be attached to CodeMirror2");var n=this,r=e.getDoc();function a(){return window.setTimeout((function(){var t=e.getValue(),r=n.getText();if(t!==r)return n.emit("error","Text does not match in CodeMirror"),console.error("Text does not match!"),console.error("editor: "+t),console.error("ot:     "+r)}),0)}function l(e,l){if("remote"!==l.origin){if(!(null!=t&&r.getValue().length>=t)){var d="undo"===l.origin;return function(e,t,n,r){for(var a=0,l=0,d=n.snapshot.split("\n",t.from.line);l<t.from.line;)a+=d[l].length+1,l++;if(a+=t.from.ch,t.removed&&n.del(a,t.removed.join("\n").length,r),t.text)n.insert(a,t.text.join("\n"),r)}(0,l,n,d),a()}n.emit("error",new Error("document length is greater than maxDocLength"))}}function d(t,n){return e.replaceRange(n,e.posFromIndex(t),void 0,"remote"),e.clearHistory(),a()}function h(t,n){var r=e.posFromIndex(t),l=e.posFromIndex(t+n.length);return e.replaceRange("",r,l,"remote"),e.clearHistory(),a()}h(0,e.getValue()),d(0,n.getText()),a(),r.on("change",l),this.on("insert",d),this.on("delete",h),this.detach_cm=function(){return this.removeListener("insert",d),this.removeListener("delete",h),r.off("change",l),delete this.detach_cm}})),window.sharejs}.apply(t,a))||(e.exports=l)}).call(this,n(229))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(931),l=(r=a)&&r.__esModule?r:{default:r};t.default=l.default},function(e,t){var n={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ấ":"A","Ắ":"A","Ẳ":"A","Ẵ":"A","Ặ":"A","Æ":"AE","Ầ":"A","Ằ":"A","Ȃ":"A","Ç":"C","Ḉ":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ế":"E","Ḗ":"E","Ề":"E","Ḕ":"E","Ḝ":"E","Ȇ":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ḯ":"I","Ȋ":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ố":"O","Ṍ":"O","Ṓ":"O","Ȏ":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ấ":"a","ắ":"a","ẳ":"a","ẵ":"a","ặ":"a","æ":"ae","ầ":"a","ằ":"a","ȃ":"a","ç":"c","ḉ":"c","è":"e","é":"e","ê":"e","ë":"e","ế":"e","ḗ":"e","ề":"e","ḕ":"e","ḝ":"e","ȇ":"e","ì":"i","í":"i","î":"i","ï":"i","ḯ":"i","ȋ":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ố":"o","ṍ":"o","ṓ":"o","ȏ":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","C̆":"C","c̆":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","Ǵ":"G","ĝ":"g","ǵ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ḫ":"H","ḫ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ḱ":"K","ḱ":"k","K̆":"K","k̆":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ḿ":"M","ḿ":"m","M̆":"M","m̆":"m","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","N̆":"N","n̆":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","P̆":"P","p̆":"p","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","R̆":"R","r̆":"r","Ȓ":"R","ȓ":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","Ș":"S","ș":"s","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","ț":"t","Ț":"T","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","T̆":"T","t̆":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ȗ":"U","ȗ":"u","V̆":"V","v̆":"v","Ŵ":"W","ŵ":"w","Ẃ":"W","ẃ":"w","X̆":"X","x̆":"x","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Y̆":"Y","y̆":"y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ứ":"U","ứ":"u","Ṹ":"U","ṹ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o","Þ":"TH","þ":"th","Ṕ":"P","ṕ":"p","Ṥ":"S","ṥ":"s","X́":"X","x́":"x","Ѓ":"Г","ѓ":"г","Ќ":"К","ќ":"к","A̋":"A","a̋":"a","E̋":"E","e̋":"e","I̋":"I","i̋":"i","Ǹ":"N","ǹ":"n","Ồ":"O","ồ":"o","Ṑ":"O","ṑ":"o","Ừ":"U","ừ":"u","Ẁ":"W","ẁ":"w","Ỳ":"Y","ỳ":"y","Ȁ":"A","ȁ":"a","Ȅ":"E","ȅ":"e","Ȉ":"I","ȉ":"i","Ȍ":"O","ȍ":"o","Ȑ":"R","ȑ":"r","Ȕ":"U","ȕ":"u","B̌":"B","b̌":"b","Č̣":"C","č̣":"c","Ê̌":"E","ê̌":"e","F̌":"F","f̌":"f","Ǧ":"G","ǧ":"g","Ȟ":"H","ȟ":"h","J̌":"J","ǰ":"j","Ǩ":"K","ǩ":"k","M̌":"M","m̌":"m","P̌":"P","p̌":"p","Q̌":"Q","q̌":"q","Ř̩":"R","ř̩":"r","Ṧ":"S","ṧ":"s","V̌":"V","v̌":"v","W̌":"W","w̌":"w","X̌":"X","x̌":"x","Y̌":"Y","y̌":"y","A̧":"A","a̧":"a","B̧":"B","b̧":"b","Ḑ":"D","ḑ":"d","Ȩ":"E","ȩ":"e","Ɛ̧":"E","ɛ̧":"e","Ḩ":"H","ḩ":"h","I̧":"I","i̧":"i","Ɨ̧":"I","ɨ̧":"i","M̧":"M","m̧":"m","O̧":"O","o̧":"o","Q̧":"Q","q̧":"q","U̧":"U","u̧":"u","X̧":"X","x̧":"x","Z̧":"Z","z̧":"z"},r=Object.keys(n).join("|"),a=new RegExp(r,"g"),l=new RegExp(r,""),d=function(e){return e.replace(a,(function(e){return n[e]}))};e.exports=d,e.exports.has=function(e){return!!e.match(l)},e.exports.remove=d},,,,,function(e,t,n){var r=n(41),a=n(353).values;r({target:"Object",stat:!0},{values:function(e){return a(e)}})},,,,,function(e,t,n){"use strict";var r,a=n(41),l=n(40),d=n(149).f,h=n(147),p=n(66),f=n(277),y=n(100),w=n(278),x=n(124),j=l("".endsWith),O=l("".slice),C=Math.min,S=w("endsWith");a({target:"String",proto:!0,forced:!!(x||S||(r=d(String.prototype,"endsWith"),!r||r.writable))&&!S},{endsWith:function(e){var t=p(y(this));f(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,a=void 0===n?r:C(h(n),r),l=p(e);return j?j(t,l,a):O(t,a-l.length,a)===l}})},function(e,t,n){"use strict";(function(e){var r=n(909),a=n(910),l=n(911);function d(){return p.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function h(e,t){if(d()<t)throw new RangeError("Invalid typed array length");return p.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=p.prototype:(null===e&&(e=new p(t)),e.length=t),e}function p(e,t,n){if(!(p.TYPED_ARRAY_SUPPORT||this instanceof p))return new p(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return w(this,e)}return f(this,e,t,n)}function f(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);p.TYPED_ARRAY_SUPPORT?(e=t).__proto__=p.prototype:e=x(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!p.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|O(t,n),a=(e=h(e,r)).write(t,n);a!==r&&(e=e.slice(0,a));return e}(e,t,n):function(e,t){if(p.isBuffer(t)){var n=0|j(t.length);return 0===(e=h(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?h(e,0):x(e,t);if("Buffer"===t.type&&l(t.data))return x(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function y(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function w(e,t){if(y(t),e=h(e,t<0?0:0|j(t)),!p.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function x(e,t){var n=t.length<0?0:0|j(t.length);e=h(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function j(e){if(e>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|e}function O(e,t){if(p.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(r)return X(e).length;t=(""+t).toLowerCase(),r=!0}}function C(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return q(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return L(this,t,n);case"latin1":case"binary":return F(this,t,n);case"base64":return D(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,a){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=p.from(t,r)),p.isBuffer(t))return 0===t.length?-1:k(e,t,n,r,a);if("number"==typeof t)return t&=255,p.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):k(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function k(e,t,n,r,a){var l,d=1,h=e.length,p=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;d=2,h/=2,p/=2,n/=2}function f(e,t){return 1===d?e[t]:e.readUInt16BE(t*d)}if(a){var y=-1;for(l=n;l<h;l++)if(f(e,l)===f(t,-1===y?0:l-y)){if(-1===y&&(y=l),l-y+1===p)return y*d}else-1!==y&&(l-=l-y),y=-1}else for(n+p>h&&(n=h-p),l=n;l>=0;l--){for(var w=!0,x=0;x<p;x++)if(f(e,l+x)!==f(t,x)){w=!1;break}if(w)return l}return-1}function E(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var l=t.length;if(l%2!=0)throw new TypeError("Invalid hex string");r>l/2&&(r=l/2);for(var d=0;d<r;++d){var h=parseInt(t.substr(2*d,2),16);if(isNaN(h))return d;e[n+d]=h}return d}function A(e,t,n,r){return Q(X(t,e.length-n),e,n,r)}function T(e,t,n,r){return Q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function R(e,t,n,r){return T(e,t,n,r)}function I(e,t,n,r){return Q(J(t),e,n,r)}function P(e,t,n,r){return Q(function(e,t){for(var n,r,a,l=[],d=0;d<e.length&&!((t-=2)<0);++d)n=e.charCodeAt(d),r=n>>8,a=n%256,l.push(a),l.push(r);return l}(t,e.length-n),e,n,r)}function D(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var l,d,h,p,f=e[a],y=null,w=f>239?4:f>223?3:f>191?2:1;if(a+w<=n)switch(w){case 1:f<128&&(y=f);break;case 2:128==(192&(l=e[a+1]))&&(p=(31&f)<<6|63&l)>127&&(y=p);break;case 3:l=e[a+1],d=e[a+2],128==(192&l)&&128==(192&d)&&(p=(15&f)<<12|(63&l)<<6|63&d)>2047&&(p<55296||p>57343)&&(y=p);break;case 4:l=e[a+1],d=e[a+2],h=e[a+3],128==(192&l)&&128==(192&d)&&128==(192&h)&&(p=(15&f)<<18|(63&l)<<12|(63&d)<<6|63&h)>65535&&p<1114112&&(y=p)}null===y?(y=65533,w=1):y>65535&&(y-=65536,r.push(y>>>10&1023|55296),y=56320|1023&y),r.push(y),a+=w}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=p,t.SlowBuffer=function(e){+e!=e&&(e=0);return p.alloc(+e)},t.INSPECT_MAX_BYTES=50,p.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=d(),p.poolSize=8192,p._augment=function(e){return e.__proto__=p.prototype,e},p.from=function(e,t,n){return f(null,e,t,n)},p.TYPED_ARRAY_SUPPORT&&(p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0})),p.alloc=function(e,t,n){return function(e,t,n,r){return y(t),t<=0?h(e,t):void 0!==n?"string"==typeof r?h(e,t).fill(n,r):h(e,t).fill(n):h(e,t)}(null,e,t,n)},p.allocUnsafe=function(e){return w(null,e)},p.allocUnsafeSlow=function(e){return w(null,e)},p.isBuffer=function(e){return!(null==e||!e._isBuffer)},p.compare=function(e,t){if(!p.isBuffer(e)||!p.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,l=Math.min(n,r);a<l;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},p.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(e,t){if(!l(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return p.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=p.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var d=e[n];if(!p.isBuffer(d))throw new TypeError('"list" argument must be an Array of Buffers');d.copy(r,a),a+=d.length}return r},p.byteLength=O,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},p.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},p.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},p.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):C.apply(this,arguments)},p.prototype.equals=function(e){if(!p.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===p.compare(this,e)},p.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},p.prototype.compare=function(e,t,n,r,a){if(!p.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var l=(a>>>=0)-(r>>>=0),d=(n>>>=0)-(t>>>=0),h=Math.min(l,d),f=this.slice(r,a),y=e.slice(t,n),w=0;w<h;++w)if(f[w]!==y[w]){l=f[w],d=y[w];break}return l<d?-1:d<l?1:0},p.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},p.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},p.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},p.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var l=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return A(this,e,t,n);case"ascii":return T(this,e,t,n);case"latin1":case"binary":return R(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),l=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function F(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function q(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",l=t;l<n;++l)a+=Y(e[l]);return a}function N(e,t,n){for(var r=e.slice(t,n),a="",l=0;l<r.length;l+=2)a+=String.fromCharCode(r[l]+256*r[l+1]);return a}function B(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function U(e,t,n,r,a,l){if(!p.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<l)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function H(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,l=Math.min(e.length-n,2);a<l;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function z(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,l=Math.min(e.length-n,4);a<l;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function V(e,t,n,r,a,l){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,r,l){return l||V(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function K(e,t,n,r,l){return l||V(e,0,n,8),a.write(e,t,n,r,52,8),n+8}p.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),p.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=p.prototype;else{var a=t-e;n=new p(a,void 0);for(var l=0;l<a;++l)n[l]=this[l+e]}return n},p.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e],a=1,l=0;++l<t&&(a*=256);)r+=this[e+l]*a;return r},p.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},p.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},p.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},p.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},p.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},p.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},p.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e],a=1,l=0;++l<t&&(a*=256);)r+=this[e+l]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},p.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=t,a=1,l=this[e+--r];r>0&&(a*=256);)l+=this[e+--r]*a;return l>=(a*=128)&&(l-=Math.pow(2,8*t)),l},p.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},p.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},p.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},p.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),a.read(this,e,!0,23,4)},p.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),a.read(this,e,!1,23,4)},p.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),a.read(this,e,!0,52,8)},p.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),a.read(this,e,!1,52,8)},p.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||U(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,l=0;for(this[t]=255&e;++l<n&&(a*=256);)this[t+l]=e/a&255;return t+n},p.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||U(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,l=1;for(this[t+a]=255&e;--a>=0&&(l*=256);)this[t+a]=e/l&255;return t+n},p.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,255,0),p.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},p.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):H(this,e,t,!0),t+2},p.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):H(this,e,t,!1),t+2},p.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):z(this,e,t,!0),t+4},p.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},p.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}var l=0,d=1,h=0;for(this[t]=255&e;++l<n&&(d*=256);)e<0&&0===h&&0!==this[t+l-1]&&(h=1),this[t+l]=(e/d>>0)-h&255;return t+n},p.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);U(this,e,t,n,a-1,-a)}var l=n-1,d=1,h=0;for(this[t+l]=255&e;--l>=0&&(d*=256);)e<0&&0===h&&0!==this[t+l+1]&&(h=1),this[t+l]=(e/d>>0)-h&255;return t+n},p.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,1,127,-128),p.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},p.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):H(this,e,t,!0),t+2},p.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):H(this,e,t,!1),t+2},p.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),p.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):z(this,e,t,!0),t+4},p.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),p.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},p.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},p.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},p.prototype.writeDoubleLE=function(e,t,n){return K(this,e,t,!0,n)},p.prototype.writeDoubleBE=function(e,t,n){return K(this,e,t,!1,n)},p.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,l=r-n;if(this===e&&n<t&&t<r)for(a=l-1;a>=0;--a)e[a+t]=this[a+n];else if(l<1e3||!p.TYPED_ARRAY_SUPPORT)for(a=0;a<l;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+l),t);return l},p.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!p.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var l;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(l=t;l<n;++l)this[l]=e;else{var d=p.isBuffer(e)?e:X(new p(e,r).toString()),h=d.length;for(l=0;l<n-t;++l)this[l+t]=d[l%h]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function Y(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){var n;t=t||1/0;for(var r=e.length,a=null,l=[],d=0;d<r;++d){if((n=e.charCodeAt(d))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&l.push(239,191,189);continue}if(d+1===r){(t-=3)>-1&&l.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&l.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&l.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;l.push(n)}else if(n<2048){if((t-=2)<0)break;l.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;l.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;l.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return l}function J(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(G,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Q(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}}).call(this,n(84))},function(e,t,n){var r=n(41),a=n(927),l=n(148);r({target:"Array",proto:!0},{fill:a}),l("fill")},function(e,t,n){"use strict";var r=n(41),a=n(560),l=n(118),d=n(135),h=n(159),p=n(271);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=l(this),n=d(t),r=p(t,0);return r.length=a(r,t,t,n,0,void 0===e?1:h(e)),r}})},function(e,t,n){n(148)("flat")},function(e,t,n){var r=n(40),a=n(100),l=n(66),d=/"/g,h=r("".replace);e.exports=function(e,t,n,r){var p=l(a(e)),f="<"+t;return""!==n&&(f+=" "+n+'="'+h(l(r),d,"&quot;")+'"'),f+">"+p+"</"+t+">"}},function(e,t,n){var r=n(48);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},function(e,t,n){var r=n(41),a=n(32),l=n(40),d=n(233),h=a.RangeError,p=String.fromCharCode,f=String.fromCodePoint,y=l([].join);r({target:"String",stat:!0,forced:!!f&&1!=f.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],d(t,1114111)!==t)throw h(t+" is not a valid code point");n[a]=t<65536?p(t):p(55296+((t-=65536)>>10),t%1024+56320)}return y(n,"")}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n(833),n(839),e.exports=n(101).Array.from},function(e,t,n){"use strict";var r=n(834)(!0);n(835)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(242),a=n(240);e.exports=function(e){return function(t,n){var l,d,h=String(a(t)),p=r(n),f=h.length;return p<0||p>=f?e?"":void 0:(l=h.charCodeAt(p))<55296||l>56319||p+1===f||(d=h.charCodeAt(p+1))<56320||d>57343?e?h.charAt(p):l:e?h.slice(p,p+2):d-56320+(l-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(347),a=n(121),l=n(836),d=n(245),h=n(470),p=n(837),f=n(562),y=n(838),w=n(213)("iterator"),x=!([].keys&&"next"in[].keys()),j=function(){return this};e.exports=function(e,t,n,O,C,S,_){p(n,t,O);var k,E,A,T=function(e){if(!x&&e in D)return D[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},R=t+" Iterator",I="values"==C,P=!1,D=e.prototype,M=D[w]||D["@@iterator"]||C&&D[C],L=M||T(C),F=C?I?T("entries"):L:void 0,q="Array"==t&&D.entries||M;if(q&&(A=y(q.call(new e)))!==Object.prototype&&A.next&&(f(A,R,!0),r||"function"==typeof A[w]||d(A,w,j)),I&&M&&"values"!==M.name&&(P=!0,L=function(){return M.call(this)}),r&&!_||!x&&!P&&D[w]||d(D,w,L),h[t]=L,h[R]=j,C)if(k={values:I?L:T("values"),keys:S?L:T("keys"),entries:F},_)for(E in k)E in D||l(D,E,k[E]);else a(a.P+a.F*(x||P),t,k);return k}},function(e,t,n){e.exports=n(245)},function(e,t,n){"use strict";var r=n(349),a=n(211),l=n(562),d={};n(245)(d,n(213)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(d,{next:a(1,n)}),l(e,t+" Iterator")}},function(e,t,n){var r=n(173),a=n(209),l=n(243)("IE_PROTO"),d=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),r(e,l)?e[l]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?d:null}},function(e,t,n){"use strict";var r=n(244),a=n(121),l=n(209),d=n(840),h=n(841),p=n(345),f=n(842),y=n(843);a(a.S+a.F*!n(845)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,a,w,x=l(e),j="function"==typeof this?this:Array,O=arguments.length,C=O>1?arguments[1]:void 0,S=void 0!==C,_=0,k=y(x);if(S&&(C=r(C,O>2?arguments[2]:void 0,2)),null==k||j==Array&&h(k))for(n=new j(t=p(x.length));t>_;_++)f(n,_,S?C(x[_],_):x[_]);else for(w=k.call(x),n=new j;!(a=w.next()).done;_++)f(n,_,S?d(w,C,[a.value,_],!0):a.value);return n.length=_,n}})},function(e,t,n){var r=n(162);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){var l=e.return;throw void 0!==l&&r(l.call(e)),t}}},function(e,t,n){var r=n(470),a=n(213)("iterator"),l=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||l[a]===e)}},function(e,t,n){"use strict";var r=n(210),a=n(211);e.exports=function(e,t,n){t in e?r.f(e,t,a(0,n)):e[t]=n}},function(e,t,n){var r=n(844),a=n(213)("iterator"),l=n(470);e.exports=n(101).getIteratorMethod=function(e){if(null!=e)return e[a]||e["@@iterator"]||l[r(e)]}},function(e,t,n){var r=n(241),a=n(213)("toStringTag"),l="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,d;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:l?r(t):"Object"==(d=r(t))&&"function"==typeof t.callee?"Arguments":d}},function(e,t,n){var r=n(213)("iterator"),a=!1;try{var l=[7][r]();l.return=function(){a=!0},Array.from(l,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var l=[7],d=l[r]();d.next=function(){return{done:n=!0}},l[r]=function(){return d},e(l)}catch(e){}return n}},function(e,t,n){var r=n(251);function a(t,n){return e.exports=a=r||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,a(t,n)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=n(311);t.__esModule=!0,t.default=void 0;var a=r(n(2));var l={map:function(e,t,n){var r=0;return a.default.Children.map(e,(function(e){return a.default.isValidElement(e)?t.call(n,e,r++):e}))},forEach:function(e,t,n){var r=0;a.default.Children.forEach(e,(function(e){a.default.isValidElement(e)&&t.call(n,e,r++)}))},count:function(e){var t=0;return a.default.Children.forEach(e,(function(e){a.default.isValidElement(e)&&++t})),t},find:function(e,t,n){var r,l=0;return a.default.Children.forEach(e,(function(e){r||a.default.isValidElement(e)&&t.call(n,e,l++)&&(r=e)})),r},filter:function(e,t,n){var r=0,l=[];return a.default.Children.forEach(e,(function(e){a.default.isValidElement(e)&&t.call(n,e,r++)&&l.push(e)})),l},every:function(e,t,n){var r=0,l=!0;return a.default.Children.forEach(e,(function(e){l&&a.default.isValidElement(e)&&(t.call(n,e,r++)||(l=!1))})),l},some:function(e,t,n){var r=0,l=!1;return a.default.Children.forEach(e,(function(e){l||a.default.isValidElement(e)&&t.call(n,e,r++)&&(l=!0)})),l},toArray:function(e){var t=[];return a.default.Children.forEach(e,(function(e){a.default.isValidElement(e)&&t.push(e)})),t}};t.default=l,e.exports=t.default},function(e,t){e.exports=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},function(e,t,n){var r=n(564),a="object"==typeof window?window:self,l=Object.keys(a).length,d=r(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+l.toString(36),4);e.exports=function(){return d}},function(e,t){var n,r="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;if(r){var a=Math.pow(2,32)-1;n=function(){return Math.abs(r.getRandomValues(new Uint32Array(1))[0]/a)}}else n=Math.random;e.exports=n},function(e,t,n){var r=n(852),a=/[\/\+\.]/;e.exports=function(e,t){function n(t){var n=r(t,e,a);return n&&n.length>=2}return t?n(t.split(";")[0]):n}},function(e,t,n){"use strict";function r(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}r.prototype.match=function(e){var t,n,r=!0,a=this.parts,l=a.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(n=(e||"").split(this.separator),t=0;r&&t<l;t++)"*"!==a[t]&&(r=t<n.length&&a[t]===n[t]);r=r&&n}else r=!1;else if("function"==typeof e.splice)for(r=[],t=e.length;t--;)this.match(e[t])&&(r[r.length]=e[t]);else if("object"==typeof e)for(var d in r={},e)this.match(d)&&(r[d]=e[d]);return r},e.exports=function(e,t,n){var a=new r(e,n||/[\/\.]/);return void 0!==t?a.match(t):a}},function(e,t){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var r=function(){function e(){this.state={},this.callbacks=[]}var t=e.prototype;return t.getState=function(){return this.state},t.setState=function(e){var t=n({},this.state),r=n({},this.state,e);this.state=r,this._publish(t,r,e)},t.subscribe=function(e){var t=this;return this.callbacks.push(e),function(){t.callbacks.splice(t.callbacks.indexOf(e),1)}},t._publish=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.callbacks.forEach((function(e){e.apply(void 0,t)}))},e}();r.VERSION="1.2.7",e.exports=function(){return new r}},function(e,t,n){var r=n(565),a=n(855);e.exports=function(e){var t=e.name?r(e.name).extension:null;return t=t?t.toLowerCase():null,e.type?e.type:t&&a[t]?a[t]:"application/octet-stream"}},function(e,t){e.exports={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"}},function(e,t){function n(e){var t="";return e.replace(/[^A-Z0-9]/gi,(function(e){return t+="-"+function(e){return e.charCodeAt(0).toString(32)}(e),"/"}))+t}e.exports=function(e){var t="uppy";return"string"==typeof e.name&&(t+="-"+n(e.name.toLowerCase())),void 0!==e.type&&(t+="-"+e.type),e.meta&&"string"==typeof e.meta.relativePath&&(t+="-"+n(e.meta.relativePath.toLowerCase())),void 0!==e.data.size&&(t+="-"+e.data.size),void 0!==e.data.lastModified&&(t+="-"+e.data.lastModified),t}},function(e,t){e.exports=function(e){if(null==e&&(e="undefined"!=typeof navigator?navigator.userAgent:null),!e)return!0;var t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;var n=t[1].split("."),r=n[0],a=n[1];return r=parseInt(r,10),a=parseInt(a,10),r<15||15===r&&a<15063||(r>18||18===r&&a>=18218)}},function(e,t,n){var r=n(859),a={debug:function(){},warn:function(){},error:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).error.apply(e,["[Uppy] ["+r()+"]"].concat(n))}},l={debug:function(){for(var e=console.debug||console.log,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];e.call.apply(e,[console,"[Uppy] ["+r()+"]"].concat(n))},warn:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).warn.apply(e,["[Uppy] ["+r()+"]"].concat(n))},error:function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).error.apply(e,["[Uppy] ["+r()+"]"].concat(n))}};e.exports={justErrorsLogger:a,debugLogger:l}},function(e,t){function n(e){return 2!==e.length?0+e:e}e.exports=function(){var e=new Date;return n(e.getHours().toString())+":"+n(e.getMinutes().toString())+":"+n(e.getSeconds().toString())}},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=n(89),l=n(861);e.exports=function(){function e(e,t){this.uppy=e,this.opts=t||{},this.update=this.update.bind(this),this.mount=this.mount.bind(this),this.install=this.install.bind(this),this.uninstall=this.uninstall.bind(this)}var t=e.prototype;return t.getPluginState=function(){return this.uppy.getState().plugins[this.id]||{}},t.setPluginState=function(e){var t,n=this.uppy.getState().plugins;this.uppy.setState({plugins:r({},n,(t={},t[this.id]=r({},n[this.id],e),t))})},t.setOptions=function(e){this.opts=r({},this.opts,e),this.setPluginState()},t.update=function(e){void 0!==this.el&&this._updateUI&&this._updateUI(e)},t.afterUpdate=function(){},t.onMount=function(){},t.mount=function(t,n){var r,d,h,p,f=this,y=n.id,w=l(t);if(w)return this.isTargetDOMEl=!0,this.rerender=function(e){f.uppy.getPlugin(f.id)&&(f.el=a.render(f.render(e),w,f.el),f.afterUpdate())},this._updateUI=(r=this.rerender,d=null,h=null,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h=t,d||(d=Promise.resolve().then((function(){return d=null,r.apply(void 0,h)}))),d}),this.uppy.log("Installing "+y+" to a DOM element '"+t+"'"),this.opts.replaceTargetContent&&(w.innerHTML=""),this.el=a.render(this.render(this.uppy.getState()),w),this.onMount(),this.el;if("object"==typeof t&&t instanceof e)p=t;else if("function"==typeof t){var x=t;this.uppy.iteratePlugins((function(e){if(e instanceof x)return p=e,!1}))}if(p)return this.uppy.log("Installing "+y+" to "+p.id),this.parent=p,this.el=p.addTarget(n),this.onMount(),this.el;this.uppy.log("Not installing "+y);var j="Invalid target option given to "+y+".";throw j+="function"==typeof t?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(j)},t.render=function(e){throw new Error("Extend the render method to add your plugin to a DOM element")},t.addTarget=function(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")},t.unmount=function(){this.isTargetDOMEl&&this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.install=function(){},t.uninstall=function(){this.unmount()},e}()},function(e,t,n){var r=n(567);e.exports=function(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):r(e)?e:void 0}},function(e,t,n){"use strict";var r=n(476),a=n(865),l=n(871),d=n(872);e.exports={RequestClient:r,Provider:a,SearchProvider:l,Socket:d}},function(e,t,n){"use strict";function r(e){var t="function"==typeof Map?new Map:void 0;return(r=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return a(e,arguments,h(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)})(e)}function a(e,t,n){return(a=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&d(a,n.prototype),a}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){var t,n;function AuthError(){var t;return(t=e.call(this,"Authorization required")||this).name="AuthError",t.isAuthError=!0,t}return n=e,(t=AuthError).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n),AuthError}(r(Error));e.exports=p},function(e,t,n){var r=n(568);e.exports=function fetchWithNetworkError(){return fetch.apply(void 0,arguments).catch((function(e){throw"AbortError"===e.name?e:new r(e)}))}},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(866),d=n(867),h=n(476),p=n(870);e.exports=function(e){var t,n;function h(t,n){var r;return(r=e.call(this,t,n)||this).provider=n.provider,r.id=r.provider,r.name=r.opts.name||r.id.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "),r.pluginId=r.opts.pluginId,r.tokenKey="companion-"+r.pluginId+"-auth-token",r.companionKeysParams=r.opts.companionKeysParams,r.preAuthToken=null,r}n=e,(t=h).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var f=h.prototype;return f.headers=function(){var t=this;return Promise.all([e.prototype.headers.call(this),this.getAuthToken()]).then((function(e){var n=e[0],a=e[1],l={};return a&&(l["uppy-auth-token"]=a),t.companionKeysParams&&(l["uppy-credentials-params"]=btoa(JSON.stringify({params:t.companionKeysParams}))),r({},n,l)}))},f.onReceiveResponse=function(t){t=e.prototype.onReceiveResponse.call(this,t);var n=this.uppy.getPlugin(this.pluginId),r=n.getPluginState().authenticated?401!==t.status:t.status<400;return n.setPluginState({authenticated:r}),t},f.setAuthToken=function(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)},f.getAuthToken=function(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)},f.authUrl=function(e){void 0===e&&(e={}),this.preAuthToken&&(e.uppyPreAuthToken=this.preAuthToken);var t=l(e);return t=t?"?"+t:t,this.hostname+"/"+this.id+"/connect"+t},f.fileUrl=function(e){return this.hostname+"/"+this.id+"/get/"+e},f.fetchPreAuthToken=function(){var e=this;return this.companionKeysParams?this.post(this.id+"/preauth/",{params:this.companionKeysParams}).then((function(t){e.preAuthToken=t.token})).catch((function(t){e.uppy.log("[CompanionClient] unable to fetch preAuthToken "+t,"warning")})):Promise.resolve()},f.list=function(e){return this.get(this.id+"/list/"+(e||""))},f.logout=function(){var e=this;return this.get(this.id+"/logout").then((function(t){return Promise.all([t,e.uppy.getPlugin(e.pluginId).storage.removeItem(e.tokenKey)])})).then((function(e){return e[0]}))},h.initPlugin=function(e,t,n){if(e.type="acquirer",e.files=[],n&&(e.opts=r({},n,t)),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){var a=t.companionAllowedHosts;if(!("string"==typeof a||Array.isArray(a)||a instanceof RegExp))throw new TypeError(e.id+': the option "companionAllowedHosts" must be one of string, Array, RegExp');e.opts.companionAllowedHosts=a}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts="https://"+t.companionUrl.replace(/^\/\//,""):e.opts.companionAllowedHosts=new d(t.companionUrl).origin;e.storage=e.opts.storage||p},h}(h)},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function e(t,r){var a=[];for(var l in t)if(n.call(t,l)){var d,h=t[l],p=encodeURIComponent(l);d="object"==typeof h?e(h,r?r+"["+p+"]":p):(r?r+"["+p+"]":p)+"="+encodeURIComponent(h),a.push(d)}return a.join("&")}},function(e,t,n){"use strict";(function(t){var r=n(868),a=n(869),l=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,d=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,h=/^[a-zA-Z]:/,p=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function f(e){return(e||"").toString().replace(p,"")}var y=[["#","hash"],["?","query"],function(e,t){return j(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],w={hash:1,query:1};function x(e){var n,r=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},a={},d=typeof(e=e||r);if("blob:"===e.protocol)a=new C(unescape(e.pathname),{});else if("string"===d)for(n in a=new C(e,{}),w)delete a[n];else if("object"===d){for(n in e)n in w||(a[n]=e[n]);void 0===a.slashes&&(a.slashes=l.test(e.href))}return a}function j(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function O(e,t){e=f(e),t=t||{};var n,r=d.exec(e),a=r[1]?r[1].toLowerCase():"",l=!!r[2],h=!!r[3],p=0;return l?h?(n=r[2]+r[3]+r[4],p=r[2].length+r[3].length):(n=r[2]+r[4],p=r[2].length):h?(n=r[3]+r[4],p=r[3].length):n=r[4],"file:"===a?p>=2&&(n=n.slice(2)):j(a)?n=r[4]:a?l&&(n=n.slice(2)):p>=2&&j(t.protocol)&&(n=r[4]),{protocol:a,slashes:l||j(a),slashesCount:p,rest:n}}function C(e,t,n){if(e=f(e),!(this instanceof C))return new C(e,t,n);var l,d,p,w,S,_,k=y.slice(),E=typeof t,A=this,T=0;for("object"!==E&&"string"!==E&&(n=t,t=null),n&&"function"!=typeof n&&(n=a.parse),l=!(d=O(e||"",t=x(t))).protocol&&!d.slashes,A.slashes=d.slashes||l&&t.slashes,A.protocol=d.protocol||t.protocol||"",e=d.rest,("file:"===d.protocol&&(2!==d.slashesCount||h.test(e))||!d.slashes&&(d.protocol||d.slashesCount<2||!j(A.protocol)))&&(k[3]=[/(.*)/,"pathname"]);T<k.length;T++)"function"!=typeof(w=k[T])?(p=w[0],_=w[1],p!=p?A[_]=e:"string"==typeof p?~(S=e.indexOf(p))&&("number"==typeof w[2]?(A[_]=e.slice(0,S),e=e.slice(S+w[2])):(A[_]=e.slice(S),e=e.slice(0,S))):(S=p.exec(e))&&(A[_]=S[1],e=e.slice(0,S.index)),A[_]=A[_]||l&&w[3]&&t[_]||"",w[4]&&(A[_]=A[_].toLowerCase())):e=w(e,A);n&&(A.query=n(A.query)),l&&t.slashes&&"/"!==A.pathname.charAt(0)&&(""!==A.pathname||""!==t.pathname)&&(A.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,a=n[r-1],l=!1,d=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),d++):d&&(0===r&&(l=!0),n.splice(r,1),d--);return l&&n.unshift(""),"."!==a&&".."!==a||n.push(""),n.join("/")}(A.pathname,t.pathname)),"/"!==A.pathname.charAt(0)&&j(A.protocol)&&(A.pathname="/"+A.pathname),r(A.port,A.protocol)||(A.host=A.hostname,A.port=""),A.username=A.password="",A.auth&&(w=A.auth.split(":"),A.username=w[0],A.password=w[1]||""),A.origin="file:"!==A.protocol&&j(A.protocol)&&A.host?A.protocol+"//"+A.host:"null",A.href=A.toString()}C.prototype={set:function(e,t,n){var l=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||a.parse)(t)),l[e]=t;break;case"port":l[e]=t,r(t,l.protocol)?t&&(l.host=l.hostname+":"+t):(l.host=l.hostname,l[e]="");break;case"hostname":l[e]=t,l.port&&(t+=":"+l.port),l.host=t;break;case"host":l[e]=t,/:\d+$/.test(t)?(t=t.split(":"),l.port=t.pop(),l.hostname=t.join(":")):(l.hostname=t,l.port="");break;case"protocol":l.protocol=t.toLowerCase(),l.slashes=!n;break;case"pathname":case"hash":if(t){var d="pathname"===e?"/":"#";l[e]=t.charAt(0)!==d?d+t:t}else l[e]=t;break;case"username":case"password":l[e]=encodeURIComponent(t);break;case"auth":var h=t.split(":");l.username=h[0],l.password=2===h.length?h[1]:""}for(var p=0;p<y.length;p++){var f=y[p];f[4]&&(l[f[1]]=l[f[1]].toLowerCase())}return l.auth=l.password?l.username+":"+l.password:l.username,l.origin="file:"!==l.protocol&&j(l.protocol)&&l.host?l.protocol+"//"+l.host:"null",l.href=l.toString(),l},toString:function(e){e&&"function"==typeof e||(e=a.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var l=r+(n.protocol&&n.slashes||j(n.protocol)?"//":"");return n.username?(l+=n.username,n.password&&(l+=":"+n.password),l+="@"):n.password&&(l+=":"+n.password,l+="@"),l+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(l+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(l+=n.hash),l}},C.extractProtocol=O,C.location=x,C.trimLeft=f,C.qs=a,e.exports=C}).call(this,n(84))},function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function a(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function l(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,a,d=[];for(a in"string"!=typeof t&&(t="?"),e)if(r.call(e,a)){if((n=e[a])||null!=n&&!isNaN(n)||(n=""),a=l(a),n=l(n),null===a||null===n)continue;d.push(a+"="+n)}return d.length?t+d.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,r={};t=n.exec(e);){var l=a(t[1]),d=a(t[2]);null===l||null===d||l in r||(r[l]=d)}return r}},function(e,t,n){"use strict";e.exports.setItem=function(e,t){return new Promise((function(n){localStorage.setItem(e,t),n()}))},e.exports.getItem=function(e){return Promise.resolve(localStorage.getItem(e))},e.exports.removeItem=function(e){return new Promise((function(t){localStorage.removeItem(e),t()}))}},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(476);e.exports=function(e){var t,n;function a(t,n){var r;return(r=e.call(this,t,n)||this).provider=n.provider,r.id=r.provider,r.name=r.opts.name||r.id.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "),r.pluginId=r.opts.pluginId,r}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var l=a.prototype;return l.fileUrl=function(e){return this.hostname+"/search/"+this.id+"/get/"+e},l.search=function(e,t){return t=t?"&"+t:"",this.get("search/"+this.id+"/list?q="+encodeURIComponent(e)+t)},a}(a)},function(e,t,n){var r=n(563);e.exports=function(){function e(e){this.opts=e,this._queued=[],this.isOpen=!1,this.emitter=r(),this._handleMessage=this._handleMessage.bind(this),this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this),e&&!1===e.autoOpen||this.open()}var t=e.prototype;return t.open=function(){var e=this;this.socket=new WebSocket(this.opts.target),this.socket.onopen=function(t){for(e.isOpen=!0;e._queued.length>0&&e.isOpen;){var n=e._queued[0];e.send(n.action,n.payload),e._queued=e._queued.slice(1)}},this.socket.onclose=function(t){e.isOpen=!1},this.socket.onmessage=this._handleMessage},t.close=function(){this.socket&&this.socket.close()},t.send=function(e,t){this.isOpen?this.socket.send(JSON.stringify({action:e,payload:t})):this._queued.push({action:e,payload:t})},t.on=function(e,t){this.emitter.on(e,t)},t.emit=function(e,t){this.emitter.emit(e,t)},t.once=function(e,t){this.emitter.once(e,t)},t._handleMessage=function(e){try{var t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){console.log(e)}},e}()},function(e,t,n){var r=n(474);e.exports=r((function(e,t,n){var r=t.progress,a=t.bytesUploaded,l=t.bytesTotal;r&&(e.uppy.log("Upload progress: "+r),e.uppy.emit("upload-progress",n,{uploader:e,bytesUploaded:a,bytesTotal:l}))}),300,{leading:!0,trailing:!0})},function(e,t){e.exports=function(e){var t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return(/^http:\/\//i.test(e)?"ws":"wss")+"://"+t}},function(e,t){e.exports=function(e){var t=[],n=[];function r(e){t.push(e)}function a(e){n.push(e)}return Promise.all(e.map((function(e){return e.then(r,a)}))).then((function(){return{successful:t,failed:n}}))}},function(e,t){e.exports=function(){function e(e){this._events=[],this._emitter=e}var t=e.prototype;return t.on=function(e,t){return this._events.push([e,t]),this._emitter.on(e,t)},t.remove=function(){var e=this;this._events.forEach((function(t){var n=t[0],r=t[1];e._emitter.off(n,r)}))},e}()},function(e,t){var n=function(){function e(e,t){this._timeout=e,this._onTimedOut=t,this._isDone=!1,this._aliveTimer=null,this._onTimedOut=this._onTimedOut.bind(this)}var t=e.prototype;return t.progress=function(){this._isDone||this._timeout>0&&(this._aliveTimer&&clearTimeout(this._aliveTimer),this._aliveTimer=setTimeout(this._onTimedOut,this._timeout))},t.done=function(){this._aliveTimer&&(clearTimeout(this._aliveTimer),this._aliveTimer=null),this._isDone=!0},e}();e.exports=n},function(e,t,n){var r=n(566);function createCancelError(){return new Error("Cancelled")}e.exports=function(){function e(e){this.limit="number"!=typeof e||0===e?1/0:e,this.activeRequests=0,this.queuedHandlers=[]}var t=e.prototype;return t._call=function(e){var t=this;this.activeRequests+=1;var n,r=!1;try{n=e()}catch(e){throw this.activeRequests-=1,e}return{abort:function(){r||(r=!0,t.activeRequests-=1,n(),t._queueNext())},done:function(){r||(r=!0,t.activeRequests-=1,t._queueNext())}}},t._queueNext=function(){var e=this;Promise.resolve().then((function(){e._next()}))},t._next=function(){if(!(this.activeRequests>=this.limit)&&0!==this.queuedHandlers.length){var e=this.queuedHandlers.shift(),t=this._call(e.fn);e.abort=t.abort,e.done=t.done}},t._queue=function(e,t){var n=this;void 0===t&&(t={});var a={fn:e,priority:t.priority||0,abort:function(){n._dequeue(a)},done:function(){throw new Error("Cannot mark a queued request as done: this indicates a bug")}},l=r(this.queuedHandlers,(function(e){return a.priority>e.priority}));return-1===l?this.queuedHandlers.push(a):this.queuedHandlers.splice(l,0,a),a},t._dequeue=function(e){var t=this.queuedHandlers.indexOf(e);-1!==t&&this.queuedHandlers.splice(t,1)},t.run=function(e,t){return this.activeRequests<this.limit?this._call(e):this._queue(e,t)},t.wrapPromiseFunction=function(e,t){var n=this;return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];var d,h=new Promise((function(r,l){d=n.run((function(){var t,n;try{n=Promise.resolve(e.apply(void 0,a))}catch(e){n=Promise.reject(e)}return n.then((function(e){t?l(t):(d.done(),r(e))}),(function(e){t?l(t):(d.done(),l(e))})),function(){t=createCancelError()}}),t)}));return h.abort=function(){d.abort()},h}},e}()},function(e,t){e.exports=function isNetworkError(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)}},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=n(89).h,l=n(19),d=n(881),h=n(572),p=n(891),f=n(892),y=n(893),w=n(894),x=n(895),j=n(896),O=n(574);e.exports=function(e){var t=0===e.totalFileCount,n=e.containerWidth>576,C=l({"uppy-Root":e.isTargetDOMEl}),S=l({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":e.disabled,"uppy-Dashboard--animateOpenClose":e.animateOpenClose,"uppy-Dashboard--isClosing":e.isClosing,"uppy-Dashboard--isDraggingOver":e.isDraggingOver,"uppy-Dashboard--modal":!e.inline,"uppy-size--md":e.containerWidth>576,"uppy-size--lg":e.containerWidth>700,"uppy-size--xl":e.containerWidth>900,"uppy-size--height-md":e.containerHeight>400,"uppy-Dashboard--isAddFilesPanelVisible":e.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":e.areInsidesReadyToBeVisible}),_=1;e.containerWidth>900?_=5:e.containerWidth>700?_=4:e.containerWidth>576&&(_=3);var k=e.showSelectedFiles&&!t,E=e.recoveredState?Object.keys(e.recoveredState.files).length:null,A=e.files?Object.keys(e.files).filter((function(t){return e.files[t].isGhost})).length:null,T=a("div",{className:S,"data-uppy-theme":e.theme,"data-uppy-num-acquirers":e.acquirers.length,"data-uppy-drag-drop-supported":!e.disableLocalFiles&&O(),"aria-hidden":e.inline?"false":e.isHidden,"aria-disabled":e.disabled,"aria-label":e.inline?e.i18n("dashboardTitle"):e.i18n("dashboardWindowTitle"),onPaste:e.handlePaste,onDragOver:e.handleDragOver,onDragLeave:e.handleDragLeave,onDrop:e.handleDrop},a("div",{className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:e.handleClickOutside}),a("div",{className:"uppy-Dashboard-inner","aria-modal":!e.inline&&"true",role:!e.inline&&"dialog",style:{width:e.inline&&e.width?e.width:"",height:e.inline&&e.height?e.height:""}},e.inline?null:a("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":e.i18n("closeModal"),title:e.i18n("closeModal"),onClick:e.closeModal},a("span",{"aria-hidden":"true"},"×")),a("div",{className:"uppy-Dashboard-innerWrap"},a("div",{className:"uppy-Dashboard-dropFilesHereHint"},e.i18n("dropHint")),k&&a(w,e),E&&a("div",{className:"uppy-Dashboard-serviceMsg"},a("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19"},a("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd"},a("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),a("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),a("circle",{fill:"#000",cx:"12",cy:"17",r:"1"}))),a("strong",{className:"uppy-Dashboard-serviceMsg-title"},e.i18n("sessionRestored")),a("div",{class:"uppy-Dashboard-serviceMsg-text"},A>0?e.i18n("recoveredXFiles",{smart_count:A}):e.i18n("recoveredAllFiles"))),k?a(d,r({},e,{itemsPerRow:_})):a(h,r({},e,{isSizeMD:n})),a(j,null,e.showAddFilesPanel?a(p,r({key:"AddFiles"},e,{isSizeMD:n})):null),a(j,null,e.fileCardFor?a(x,r({key:"FileCard"},e)):null),a(j,null,e.activePickerPanel?a(f,r({key:"Picker"},e)):null),a(j,null,e.showFileEditor?a(y,r({key:"Editor"},e)):null),a("div",{className:"uppy-Dashboard-progressindicators"},e.progressindicators.map((function(t){return e.getPlugin(t.id).render(e.state)}))))));return a("div",{className:C,dir:e.direction},T)}},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=n(882),l=n(890),d=n(19),h=n(89).h;e.exports=function(e){var t=0===e.totalFileCount,n=d("uppy-Dashboard-files",{"uppy-Dashboard-files--noFiles":t}),p=1===e.itemsPerRow?71:200,f={id:e.id,error:e.error,i18n:e.i18n,log:e.log,info:e.info,acquirers:e.acquirers,resumableUploads:e.resumableUploads,individualCancellation:e.individualCancellation,hideRetryButton:e.hideRetryButton,hidePauseResumeButton:e.hidePauseResumeButton,hideCancelButton:e.hideCancelButton,showLinkToFileUploadResult:e.showLinkToFileUploadResult,showRemoveButtonAfterComplete:e.showRemoveButtonAfterComplete,isWide:e.isWide,metaFields:e.metaFields,recoveredState:e.recoveredState,retryUpload:e.retryUpload,pauseUpload:e.pauseUpload,cancelUpload:e.cancelUpload,toggleFileCard:e.toggleFileCard,removeFile:e.removeFile,handleRequestThumbnail:e.handleRequestThumbnail,handleCancelThumbnail:e.handleCancelThumbnail},y=Object.keys(e.files);e.recoveredState&&y.sort((function(t,n){return e.files[n].isGhost-e.files[t].isGhost}));var w,x,j,O,C=(w=y,x=e.itemsPerRow,j=[],O=[],w.forEach((function(e,t){O.length<x?O.push(e):(j.push(O),O=[e])})),O.length&&j.push(O),j);return h(l,{class:n,role:"list",data:C,renderRow:function(t){return h("div",{role:"presentation",key:t[0]},t.map((function(t){return h(a,r({key:t},f,{role:"listitem",openFileEditor:e.openFileEditor,canEditFile:e.canEditFile,toggleAddFilesPanel:e.toggleAddFilesPanel,file:e.files[t]}))})))},rowHeight:p})}},function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(89),l=a.h,d=a.Component,h=n(19),p=n(883),f=n(884),y=n(885),w=n(886),x=n(888);e.exports=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var d=a.prototype;return d.shouldComponentUpdate=function(e){return!p(this.props,e)},d.componentDidMount=function(){var e=this.props.file;e.preview||this.props.handleRequestThumbnail(e)},d.componentDidUpdate=function(){var e=this.props.file;e.preview||this.props.handleRequestThumbnail(e)},d.componentWillUnmount=function(){var e=this.props.file;e.preview||this.props.handleCancelThumbnail(e)},d.render=function(){var e=this.props.file,t=e.progress.preprocess||e.progress.postprocess,n=e.progress.uploadComplete&&!t&&!e.error,r=e.progress.uploadStarted||t,a=e.progress.uploadStarted&&!e.progress.uploadComplete||t,d=e.error||!1,p=e.isGhost,j=(this.props.individualCancellation||!a)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(j=!0);var O=h({"uppy-Dashboard-Item":!0,"is-inprogress":a&&!this.props.recoveredState,"is-processing":t,"is-complete":n,"is-error":!!d,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":p});return l("div",{className:O,id:"uppy_"+e.id,role:this.props.role},l("div",{className:"uppy-Dashboard-Item-preview"},l(f,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult}),l(y,{file:e,error:d,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,showRemoveButtonAfterComplete:this.props.showRemoveButtonAfterComplete,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,pauseUpload:this.props.pauseUpload,cancelUpload:this.props.cancelUpload,retryUpload:this.props.retryUpload,i18n:this.props.i18n})),l("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons"},l(w,{file:e,id:this.props.id,acquirers:this.props.acquirers,containerWidth:this.props.containerWidth,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel}),l(x,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:j,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,removeFile:this.props.removeFile,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,i18n:this.props.i18n,log:this.props.log,info:this.props.info})))},a}(d)},function(e,t){e.exports=function(e,t){if(e===t)return!0;for(var n in e)if(!(n in t))return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}},function(e,t,n){var r=n(89).h,a=n(571),l=n(477);e.exports=function(e){return r("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:l(e.file.type).color}},e.showLinkToFileUploadResult&&e.file.uploadURL&&r("a",{className:"uppy-Dashboard-Item-previewLink",href:e.file.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.file.meta.name}),r(a,{file:e.file}))}},function(e,t,n){var r=n(89).h;function a(e){return e.isUploaded?e.i18n("uploadComplete"):e.error?e.i18n("retryUpload"):e.resumableUploads?e.file.isPaused?e.i18n("resumeUpload"):e.i18n("pauseUpload"):e.individualCancellation?e.i18n("cancelUpload"):""}function l(e){return r("div",{className:"uppy-Dashboard-Item-progress"},r("button",{className:"uppy-u-reset uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":a(e),title:a(e),onClick:function(){return function(e){e.isUploaded||(!e.error||e.hideRetryButton?e.resumableUploads&&!e.hidePauseResumeButton?e.pauseUpload(e.file.id):e.individualCancellation&&!e.hideCancelButton&&e.cancelUpload(e.file.id):e.retryUpload(e.file.id))}(e)}},e.children))}function d(e){var t=e.children;return r("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle"},t)}function h(e){var t=e.progress,n=2*Math.PI*15;return r("g",null,r("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),r("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":n,"stroke-dashoffset":n-n/100*t}))}e.exports=function(e){return e.file.progress.uploadStarted?e.isUploaded?r("div",{className:"uppy-Dashboard-Item-progress"},r("div",{className:"uppy-Dashboard-Item-progressIndicator"},r(d,null,r("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),r("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})))):e.recoveredState?void 0:e.error&&!e.hideRetryButton?r(l,e,r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19"},r("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),r("path",{d:"M7.9 3H10v2H7.9z"}),r("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),r("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))):e.resumableUploads&&!e.hidePauseResumeButton?r(l,e,r(d,null,r(h,{progress:e.file.progress.percentage}),e.file.isPaused?r("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):r("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)"},r("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),r("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})))):e.resumableUploads||!e.individualCancellation||e.hideCancelButton?r("div",{className:"uppy-Dashboard-Item-progress"},r("div",{className:"uppy-Dashboard-Item-progressIndicator"},r(d,null,r(h,{progress:e.file.progress.percentage})))):r(l,e,r(d,null,r(h,{progress:e.file.progress.percentage}),r("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"}))):null}},function(e,t,n){var r=n(89).h,a=n(475),l=n(887),d=function(e){var t=e.file,n=e.onClick;return t.error?r("span",{className:"uppy-Dashboard-Item-errorDetails","aria-label":t.error,"data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip",onClick:n},"?"):null};e.exports=function(e){return r("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.file.source},function(e){var t;return t=e.containerWidth<=352?35:e.containerWidth<=576?60:30,r("div",{className:"uppy-Dashboard-Item-name",title:e.file.meta.name},l(e.file.meta.name,t))}(e),r("div",{className:"uppy-Dashboard-Item-status"},function(e){return e.file.size&&r("div",{className:"uppy-Dashboard-Item-statusSize"},a(e.file.size))}(e),function(e){return e.file.isGhost&&r("span",null," • ",r("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:e.toggleAddFilesPanel},e.i18n("reSelect")))}(e),r(d,{file:e.file,onClick:function(){alert(e.file.error)}})))}},function(e,t){e.exports=function(e,t){if(e.length<=t)return e;if(t<="...".length)return e.substr(0,t);var n=t-"...".length,r=Math.ceil(n/2),a=Math.floor(n/2);return e.substr(0,r)+"..."+e.substr(e.length-a)}},function(e,t,n){var r=n(89).h,a=n(889);function l(e){var t=e.file,n=e.uploadInProgressOrComplete,a=e.metaFields,l=e.canEditFile,d=e.i18n,h=e.onClick;return!n&&a&&a.length>0||!n&&l(t)?r("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":d("editFile")+" "+t.meta.name,title:d("editFile"),onClick:function(){return h()}},r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14"},r("g",{fillRule:"evenodd"},r("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),r("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),r("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})))):null}function d(e){var t=e.i18n,n=e.onClick;return r("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":t("removeFile"),title:t("removeFile"),onClick:function(){return n()}},r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18"},r("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),r("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})))}function h(e){return r("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":e.i18n("copyLink"),title:e.i18n("copyLink"),onClick:function(t){return function(e,t){a(t.file.uploadURL,t.i18n("copyLinkToClipboardFallback")).then((function(){t.log("Link copied to clipboard."),t.info(t.i18n("copyLinkToClipboardSuccess"),"info",3e3)})).catch(t.log).then((function(){return e.target.focus({preventScroll:!0})}))}(t,e)}},r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12"},r("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})))}e.exports=function(e){var t=e.file,n=e.uploadInProgressOrComplete,a=e.canEditFile,p=e.metaFields,f=e.showLinkToFileUploadResult,y=e.showRemoveButton,w=e.i18n,x=e.removeFile,j=e.toggleFileCard,O=e.openFileEditor,C=e.log,S=e.info;return r("div",{className:"uppy-Dashboard-Item-actionWrapper"},r(l,{i18n:w,file:t,uploadInProgressOrComplete:n,canEditFile:a,metaFields:p,onClick:function(){p&&p.length>0?j(!0,t.id):O(t)}}),f&&t.uploadURL?r(h,{file:t,i18n:w,info:S,log:C}):null,y?r(d,{i18n:w,info:e.info,log:e.log,onClick:function(){return x(t.id,"removed-by-user")}}):null)}},function(e,t){e.exports=function(e,t){return t=t||"Copy the URL below",new Promise((function(n){var r=document.createElement("textarea");r.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),r.value=e,document.body.appendChild(r),r.select();var a=function(){document.body.removeChild(r),window.prompt(t,e),n()};try{return document.execCommand("copy")?(document.body.removeChild(r),n()):a()}catch(e){return document.body.removeChild(r),a()}}))}},function(e,t,n){var r=["data","rowHeight","renderRow","overscanCount","sync"];function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=n(89),h=d.h,p=d.Component,f={position:"relative",width:"100%",minHeight:"100%"},y={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"},w=function(e){var t,n;function d(t){var n;return(n=e.call(this,t)||this).handleResize=function(){n.resize()},n.handleScroll=function(){n.setState({offset:n.base.scrollTop}),n.props.sync&&n.forceUpdate()},n.focusElement=null,n.state={offset:0,height:0},n}n=e,(t=d).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n);var p=d.prototype;return p.resize=function(){this.state.height!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})},p.componentWillUpdate=function(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)},p.componentDidUpdate=function(){this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()},p.componentDidMount=function(){this.resize(),window.addEventListener("resize",this.handleResize)},p.componentWillUnmount=function(){window.removeEventListener("resize",this.handleResize)},p.render=function(e){var t=e.data,n=e.rowHeight,l=e.renderRow,d=e.overscanCount,p=void 0===d?10:d,w=(e.sync,function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r)),x=this.state,j=x.offset,O=x.height,C=Math.floor(j/n),S=Math.floor(O/n);p&&(C=Math.max(0,C-C%p),S+=p);var _=C+S+4,k=t.slice(C,_),E=a({},f,{height:t.length*n}),A=a({},y,{top:C*n});return h("div",a({onScroll:this.handleScroll},w),h("div",{role:"presentation",style:E},h("div",{role:"presentation",style:A},k.map(l))))},d}(p);e.exports=w},function(e,t,n){var r=n(89).h,a=n(19),l=n(572);e.exports=function(e){return r("div",{className:a("uppy-Dashboard-AddFilesPanel",e.className),"data-uppy-panelType":"AddFiles","aria-hidden":e.showAddFilesPanel},r("div",{className:"uppy-DashboardContent-bar"},r("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18n("addingMoreFiles")),r("button",{className:"uppy-DashboardContent-back",type:"button",onClick:function(t){return e.toggleAddFilesPanel(!1)}},e.i18n("back"))),r(l,e))}},function(e,t,n){var r=n(89).h,a=n(19),l=n(573);e.exports=function(e){return r("div",{className:a("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:"uppy-DashboardContent-panel--"+e.activePickerPanel.id,onDragOver:l,onDragLeave:l,onDrop:l,onPaste:l},r("div",{className:"uppy-DashboardContent-bar"},r("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18n("importFrom",{name:e.activePickerPanel.name})),r("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e.hideAllPanels},e.i18n("cancel"))),r("div",{className:"uppy-DashboardContent-panelBody"},e.getPlugin(e.activePickerPanel.id).render(e.state)))}},function(e,t,n){var r=n(89).h,a=n(19);e.exports=function(e){var t=this.props.files[this.props.fileCardFor];return r("div",{className:a("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor"},r("div",{className:"uppy-DashboardContent-bar"},r("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18nArray("editing",{file:r("span",{className:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),r("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e.hideAllPanels},e.i18n("cancel")),r("button",{className:"uppy-DashboardContent-save",type:"button",onClick:e.saveFileEditor},e.i18n("save"))),r("div",{className:"uppy-DashboardContent-panelBody"},e.editors.map((function(t){return e.getPlugin(t.id).render(e.state)}))))}},function(e,t,n){var r=n(89).h,a="error",l="waiting",d="preprocessing",h="uploading",p="postprocessing",f="complete",y="paused";function w(e){switch(function(e,t,n,r){if(void 0===r&&(r={}),e)return a;if(t)return f;if(n)return y;for(var w=l,x=Object.keys(r),j=0;j<x.length;j++){var O=r[x[j]].progress;if(O.uploadStarted&&!O.uploadComplete)return h;O.preprocess&&w!==h&&(w=d),O.postprocess&&w!==h&&w!==d&&(w=p)}return w}(e.isAllErrored,e.isAllComplete,e.isAllPaused,e.files)){case"uploading":return e.i18n("uploadingXFiles",{smart_count:e.inProgressNotPausedFiles.length});case"preprocessing":case"postprocessing":return e.i18n("processingXFiles",{smart_count:e.processingFiles.length});case"paused":return e.i18n("uploadPaused");case"waiting":return e.i18n("xFilesSelected",{smart_count:e.newFiles.length});case"complete":return e.i18n("uploadComplete")}}e.exports=function(e){var t=e.allowNewUpload;return t&&e.maxNumberOfFiles&&(t=e.totalFileCount<e.maxNumberOfFiles),r("div",{className:"uppy-DashboardContent-bar"},e.isAllComplete||e.hideCancelButton?r("div",null):r("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e.cancelAll},e.i18n("cancel")),r("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},r(w,e)),t?r("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e.i18n("addMoreFiles"),title:e.i18n("addMoreFiles"),onClick:function(){return e.toggleAddFilesPanel(!0)}},r("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15"},r("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})),r("span",{className:"uppy-DashboardContent-addMoreCaption"},e.i18n("addMore"))):r("div",null))}},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=n(89),d=l.h,h=l.Component,p=n(19),f=n(477),y=n(573),w=n(571),x=function(e){var t,n;function l(t){var n;(n=e.call(this,t)||this).updateMeta=function(e,t){var a;n.setState({formState:r({},n.state.formState,(a={},a[t]=e,a))})},n.handleSave=function(e){e.preventDefault();var t=n.props.fileCardFor;n.props.saveFileCard(n.state.formState,t)},n.handleCancel=function(){n.props.toggleFileCard(!1)},n.saveOnEnter=function(e){if(13===e.keyCode){e.stopPropagation(),e.preventDefault();var t=n.props.files[n.props.fileCardFor];n.props.saveFileCard(n.state.formState,t.id)}},n.renderMetaFields=function(){var e=n.getMetaFields()||[],t={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map((function(e){var r="uppy-Dashboard-FileCard-input-"+e.id,a=n.props.requiredMetaFields.includes(e.id);return d("fieldset",{key:e.id,className:"uppy-Dashboard-FileCard-fieldset"},d("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:r},e.name),void 0!==e.render?e.render({value:n.state.formState[e.id],onChange:function(t){return n.updateMeta(t,e.id)},fieldCSSClasses:t,required:a},d):d("input",{className:t.text,id:r,type:e.type||"text",required:a,value:n.state.formState[e.id],placeholder:e.placeholder,onKeyUp:n.saveOnEnter,onKeyDown:n.saveOnEnter,onKeyPress:n.saveOnEnter,onInput:function(t){return n.updateMeta(t.target.value,e.id)},"data-uppy-super-focusable":!0}))}))};var a=n.props.files[n.props.fileCardFor],l=n.getMetaFields()||[],h={};return l.forEach((function(e){h[e.id]=a.meta[e.id]||""})),n.state={formState:h},n}n=e,(t=l).prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n);var h=l.prototype;return h.getMetaFields=function(){return"function"==typeof this.props.metaFields?this.props.metaFields(this.props.files[this.props.fileCardFor]):this.props.metaFields},h.render=function(){var e=this,t=this.props.files[this.props.fileCardFor],n=this.props.canEditFile(t);return d("div",{className:p("uppy-Dashboard-FileCard",this.props.className),"data-uppy-panelType":"FileCard",onDragOver:y,onDragLeave:y,onDrop:y,onPaste:y},d("div",{className:"uppy-DashboardContent-bar"},d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},this.props.i18nArray("editing",{file:d("span",{className:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),d("button",{className:"uppy-DashboardContent-back",type:"button",title:this.props.i18n("finishEditingFile"),onClick:this.handleCancel},this.props.i18n("cancel"))),d("div",{className:"uppy-Dashboard-FileCard-inner"},d("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:f(t.type).color}},d(w,{file:t}),n&&d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:function(){return e.props.openFileEditor(t)}},this.props.i18n("editFile"))),d("div",{className:"uppy-Dashboard-FileCard-info"},this.renderMetaFields()),d("div",{className:"uppy-Dashboard-FileCard-actions"},d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:this.handleSave},this.props.i18n("saveChanges")),d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:this.handleCancel},this.props.i18n("cancel")))))},l}(h);e.exports=x},function(e,t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=n(89),l=a.cloneElement,d=a.Component,h=n(19),p="uppy-transition-slideDownUp",f=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this).state={cachedChildren:null,className:""},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var d=a.prototype;return d.componentWillUpdate=function(e){var t=this,n=this.state.cachedChildren,r=e.children[0];if(n!==r){var a={cachedChildren:r};r&&!n&&(a.className=p+"-enter",cancelAnimationFrame(this.animationFrame),clearTimeout(this.leaveTimeout),this.leaveTimeout=void 0,this.animationFrame=requestAnimationFrame((function(){t.base.getBoundingClientRect(),t.setState({className:p+"-enter "+p+"-enter-active"}),t.enterTimeout=setTimeout((function(){t.setState({className:""})}),250)}))),n&&!r&&void 0===this.leaveTimeout&&(a.cachedChildren=n,a.className=p+"-leave",cancelAnimationFrame(this.animationFrame),clearTimeout(this.enterTimeout),this.enterTimeout=void 0,this.animationFrame=requestAnimationFrame((function(){t.setState({className:p+"-leave "+p+"-leave-active"}),t.leaveTimeout=setTimeout((function(){t.setState({cachedChildren:null,className:""})}),250)}))),this.setState(a)}},d.render=function(){var e=this.state,t=e.cachedChildren,n=e.className;return t?l(t,{className:h(n,t.attributes.className)}):null},a}(d);e.exports=f},function(e,t,n){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=n(474),l=n(19),d=n(576),h=n(475),p=n(898),f=n(89).h;e.exports=function(e){var t,n,a=e=e||{},h=a.newFiles,p=a.allowNewUpload,C=a.isUploadInProgress,_=a.isAllPaused,k=a.resumableUploads,E=a.error,I=a.hideUploadButton,P=a.hidePauseResumeButton,D=a.hideCancelButton,M=a.hideRetryButton,L=a.recoveredState,F=e.uploadState,q=e.totalProgress;if(F===d.STATE_PREPROCESSING||F===d.STATE_POSTPROCESSING){var N=function(e){var t=[];Object.keys(e).forEach((function(n){var r=e[n].progress;r.preprocess&&t.push(r.preprocess),r.postprocess&&t.push(r.postprocess)}));var n=t[0];return{mode:n.mode,message:n.message,value:t.filter((function(e){return"determinate"===e.mode})).reduce((function(e,t,n,r){return e+t.value/r.length}),0)}}(e.files);"determinate"===(t=N.mode)&&(q=100*N.value),n=S(N)}else F===d.STATE_COMPLETE?n=T(e):F===d.STATE_UPLOADING?(e.supportsUploadProgress||(t="indeterminate",q=null),n=A(e)):F===d.STATE_ERROR&&(q=void 0,n=R(e));var B="number"==typeof q?q:100,U=F===d.STATE_WAITING&&e.hideUploadButton||F===d.STATE_WAITING&&!e.newFiles>0||F===d.STATE_COMPLETE&&e.hideAfterFinish,H=!E&&h&&!C&&!_&&p&&!I;L&&(U=!1,H=!0);var z=!D&&F!==d.STATE_WAITING&&F!==d.STATE_COMPLETE,V=k&&!P&&F===d.STATE_UPLOADING,W=E&&!M,K=e.doneButtonHandler&&F===d.STATE_COMPLETE,G="uppy-StatusBar-progress\n                           "+(t?"is-"+t:""),Y=l({"uppy-Root":e.isTargetDOMEl},"uppy-StatusBar","is-"+F,{"has-ghosts":e.isSomeGhost});return f("div",{className:Y,"aria-hidden":U},f("div",{className:G,style:{width:B+"%"},role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":q}),n,f("div",{className:"uppy-StatusBar-actions"},H?f(y,r({},e,{uploadState:F})):null,W?f(w,e):null,V?f(j,e):null,z?f(x,e):null,K?f(O,e):null))};var y=function(e){var t=l("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":e.uploadState===d.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":e.isSomeGhost}),n=e.newFiles&&e.isUploadStarted&&!e.recoveredState?e.i18n("uploadXNewFiles",{smart_count:e.newFiles}):e.i18n("uploadXFiles",{smart_count:e.newFiles});return f("button",{type:"button",className:t,"aria-label":e.i18n("uploadXFiles",{smart_count:e.newFiles}),onClick:e.startUpload,disabled:e.isSomeGhost,"data-uppy-super-focusable":!0},n)},w=function(e){return f("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e.i18n("retryUpload"),onClick:e.retryAll,"data-uppy-super-focusable":!0},f("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},f("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e.i18n("retry"))},x=function(e){return f("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e.i18n("cancel"),"aria-label":e.i18n("cancel"),onClick:e.cancelAll,"data-uppy-super-focusable":!0},f("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},f("g",{fill:"none",fillRule:"evenodd"},f("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),f("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))},j=function(e){var t=e.isAllPaused,n=e.i18n,r=n(t?"resume":"pause");return f("button",{title:r,"aria-label":r,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:function(){return function(e){if(!e.isAllComplete)return e.resumableUploads?e.isAllPaused?e.resumeAll():e.pauseAll():e.cancelAll()}(e)},"data-uppy-super-focusable":!0},f("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},f("g",{fill:"none",fillRule:"evenodd"},f("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),f("path",t?{fill:"#FFF",d:"M6 4.25L11.5 8 6 11.75z"}:{d:"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z",fill:"#FFF"}))))},O=function(e){var t=e.i18n;return f("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:e.doneButtonHandler,"data-uppy-super-focusable":!0},t("done"))},C=function(){return f("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},f("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))},S=function(e){var t=Math.round(100*e.value);return f("div",{className:"uppy-StatusBar-content"},f(C,null),"determinate"===e.mode?t+"% · ":"",e.message)},_=function(e){return f("div",{className:"uppy-StatusBar-statusSecondary"},e.i18n("filesUploadedOfTotal",{complete:e.complete,smart_count:e.numUploads}))},k=function(e){var t=l("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return f("div",{className:"uppy-StatusBar-statusSecondary"},f("div",{className:"uppy-StatusBar-statusSecondaryHint"},e.i18n("xMoreFilesAdded",{smart_count:e.newFiles})),f("button",{type:"button",className:t,"aria-label":e.i18n("uploadXFiles",{smart_count:e.newFiles}),onClick:e.startUpload},e.i18n("upload")))},E=a((function(e){var t=e.numUploads>1;return f("div",{className:"uppy-StatusBar-statusSecondary"},t&&e.i18n("filesUploadedOfTotal",{complete:e.complete,smart_count:e.numUploads}),f("span",{className:"uppy-StatusBar-additionalInfo"},t&&" · ",e.i18n("dataUploadedOfTotal",{complete:h(e.totalUploadedSize),total:h(e.totalSize)})," · ",e.i18n("xTimeLeft",{time:p(e.totalETA)})))}),500,{leading:!0,trailing:!0}),A=function(e){if(!e.isUploadStarted||e.isAllComplete)return null;var t=e.isAllPaused?e.i18n("paused"):e.i18n("uploading"),n=e.newFiles&&e.isUploadStarted;return f("div",{className:"uppy-StatusBar-content","aria-label":t,title:t},e.isAllPaused?null:f(C,null),f("div",{className:"uppy-StatusBar-status"},f("div",{className:"uppy-StatusBar-statusPrimary"},e.supportsUploadProgress?t+": "+e.totalProgress+"%":t),e.isAllPaused||n||!e.showProgressDetails?null:e.supportsUploadProgress?f(E,e):f(_,e),n?f(k,e):null))},T=function(e){e.totalProgress;var t=e.i18n;return f("div",{className:"uppy-StatusBar-content",role:"status",title:t("complete")},f("div",{className:"uppy-StatusBar-status"},f("div",{className:"uppy-StatusBar-statusPrimary"},f("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},f("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),t("complete"))))},R=function ProgressBarError(e){var t=e.error,n=(e.retryAll,e.hideRetryButton,e.i18n);return f("div",{className:"uppy-StatusBar-content",role:"alert",title:n("uploadFailed")},f("div",{className:"uppy-StatusBar-status"},f("div",{className:"uppy-StatusBar-statusPrimary"},f("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},f("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),n("uploadFailed"))),f("span",{className:"uppy-StatusBar-details","aria-label":t,"data-microtip-position":"top-right","data-microtip-size":"medium",role:"tooltip",onClick:function(){var e=n("uploadFailed")+" \n\n "+t;alert(e)}},"?"))}},function(e,t,n){var r=n(899);e.exports=function(e){var t=r(e),n=t.hours?t.hours+"h ":"",a=t.hours?("0"+t.minutes).substr(-2):t.minutes,l=a?a+"m":"",d=a?("0"+t.seconds).substr(-2):t.seconds;return""+n+l+(t.hours?"":a?" "+d+"s":d+"s")}},function(e,t){e.exports=function(e){return{hours:Math.floor(e/3600)%24,minutes:Math.floor(e/60)%60,seconds:Math.floor(e%60)}}},function(e,t){e.exports=function(e){if(!e.bytesUploaded)return 0;var t=new Date-e.uploadStarted;return e.bytesUploaded/(t/1e3)}},function(e,t){e.exports=function(e){return e.bytesTotal-e.bytesUploaded}},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=n(145).Plugin,p=n(89).h;e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).render=function(e){var t=e.info,n=t.isHidden,a=t.message,l=t.details;return p("div",{className:"uppy uppy-Informer","aria-hidden":n},p("p",{role:"alert"},a," ",l&&p("span",{"aria-label":l,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:function(){alert(a+" \n\n "+l)},onMouseOver:function(){clearTimeout(r.uppy.infoTimeoutID)},onMouseLeave:function(){r.uppy.infoTimeoutID=setTimeout(r.uppy.hideInfo,2e3)}},"?")))},r.type="progressindicator",r.id=r.opts.id||"Informer",r.title="Informer";return r.opts=l({},{},n),r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n),r.prototype.install=function(){var e=this.opts.target;e&&this.mount(e,this)},r}(h),r.VERSION="1.6.6",a)},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=n(145).Plugin,p=n(214),f=n(904),y=n(905),w=n(906),x=n(907),j=n(908);e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).onFileAdded=function(e){!e.preview&&e.data&&w(e.type)&&!e.isRemote&&r.addToQueue(e.id)},r.onCancelRequest=function(e){var t=r.queue.indexOf(e.id);-1!==t&&r.queue.splice(t,1)},r.onFileRemoved=function(e){var t=r.queue.indexOf(e.id);-1!==t&&r.queue.splice(t,1),e.preview&&y(e.preview)&&URL.revokeObjectURL(e.preview)},r.onRestored=function(){r.uppy.getFiles().filter((function(e){return e.isRestored})).forEach((function(e){e.preview&&!y(e.preview)||r.addToQueue(e.id)}))},r.waitUntilAllProcessed=function(e){e.forEach((function(e){var t=r.uppy.getFile(e);r.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:r.i18n("generatingThumbnails")})}));var t=function(){e.forEach((function(e){var t=r.uppy.getFile(e);r.uppy.emit("preprocess-complete",t)}))};return new Promise((function(e,n){r.queueProcessing?r.uppy.once("thumbnail:all-generated",(function(){t(),e()})):(t(),e())}))},r.type="modifier",r.id=r.opts.id||"ThumbnailGenerator",r.title="Thumbnail Generator",r.queue=[],r.queueProcessing=!1,r.defaultThumbnailDimension=200,r.thumbnailType=r.opts.thumbnailType||"image/jpeg",r.defaultLocale={strings:{generatingThumbnails:"Generating thumbnails..."}};if(r.opts=l({},{thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1},n),r.opts.lazy&&r.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.");return r.i18nInit(),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var a=r.prototype;return a.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},a.i18nInit=function(){this.translator=new p([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.setPluginState()},a.createThumbnail=function(e,t,n){var r=this,a=URL.createObjectURL(e.data),l=new Promise((function(e,t){var n=new Image;n.src=a,n.addEventListener("load",(function(){URL.revokeObjectURL(a),e(n)})),n.addEventListener("error",(function(e){URL.revokeObjectURL(a),t(e.error||new Error("Could not create thumbnail"))}))})),d=j.rotation(e.data).catch((function(e){return 1}));return Promise.all([l,d]).then((function(e){var a=e[0],l=e[1],d=r.getProportionalDimensions(a,t,n,l.deg),h=r.rotateImage(a,l),p=r.resizeImage(h,d.width,d.height);return r.canvasToBlob(p,r.thumbnailType,80)})).then((function(e){return URL.createObjectURL(e)}))},a.getProportionalDimensions=function(e,t,n,r){var a=e.width/e.height;return 90!==r&&270!==r||(a=e.height/e.width),null!=t?{width:t,height:Math.round(t/a)}:null!=n?{width:Math.round(n*a),height:n}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/a)}},a.protect=function(e){var t=e.width/e.height,n=Math.floor(Math.sqrt(5e6*t)),r=Math.floor(5e6/Math.sqrt(5e6*t));if(n>4096&&(n=4096,r=Math.round(n/t)),r>4096&&(r=4096,n=Math.round(t*r)),e.width>n){var a=document.createElement("canvas");a.width=n,a.height=r,a.getContext("2d").drawImage(e,0,0,n,r),e=a}return e},a.resizeImage=function(e,t,n){e=this.protect(e);var r=Math.ceil(x(e.width/t));r<1&&(r=1);for(var a=t*Math.pow(2,r-1),l=n*Math.pow(2,r-1);r--;){var d=document.createElement("canvas");d.width=a,d.height=l,d.getContext("2d").drawImage(e,0,0,a,l),e=d,a=Math.round(a/2),l=Math.round(l/2)}return e},a.rotateImage=function(e,t){var n=e.width,r=e.height;90!==t.deg&&270!==t.deg||(n=e.height,r=e.width);var a=document.createElement("canvas");a.width=n,a.height=r;var l=a.getContext("2d");return l.translate(n/2,r/2),t.canvas&&(l.rotate(t.rad),l.scale(t.scaleX,t.scaleY)),l.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),a},a.canvasToBlob=function(e,t,n){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((function(r){e.toBlob(r,t,n)})).then((function(e){if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((function(){return f(e.toDataURL(t,n),{})})).then((function(e){if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))},a.setPreviewURL=function(e,t){this.uppy.setFileState(e,{preview:t})},a.addToQueue=function(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()},a.processQueue=function(){var e=this;if(this.queueProcessing=!0,this.queue.length>0){var t=this.uppy.getFile(this.queue.shift());return t?this.requestThumbnail(t).catch((function(e){})).then((function(){return e.processQueue()})):void this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error")}this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated")},a.requestThumbnail=function(e){var t=this;return w(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((function(n){t.setPreviewURL(e.id,n),t.uppy.log("[ThumbnailGenerator] Generated thumbnail for "+e.id),t.uppy.emit("thumbnail:generated",t.uppy.getFile(e.id),n)})).catch((function(n){t.uppy.log("[ThumbnailGenerator] Failed thumbnail for "+e.id+":","warning"),t.uppy.log(n,"warning"),t.uppy.emit("thumbnail:error",t.uppy.getFile(e.id),n)})):Promise.resolve()},a.install=function(){this.uppy.on("file-removed",this.onFileRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)},a.uninstall=function(){this.uppy.off("file-removed",this.onFileRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)},r}(h),r.VERSION="1.7.11",a)},function(e,t){e.exports=function(e,t,n){var r=e.split(",")[1],a=t.mimeType||e.split(",")[0].split(":")[1].split(";")[0];null==a&&(a="plain/text");for(var l,d=atob(r),h=[],p=0;p<d.length;p++)h.push(d.charCodeAt(p));try{l=new Uint8Array(h)}catch(e){return null}return n?new File([l],t.name||"",{type:a}):new Blob([l],{type:a})}},function(e,t){e.exports=function(e){return 0===e.indexOf("blob:")}},function(e,t){e.exports=function(e){if(!e)return!1;var t=e.split("/")[1];return!!/^(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(t)}},function(e,t,n){"use strict";e.exports=Math.log2||function(e){return Math.log(e)*Math.LOG2E}},function(e,t,n){(function(e,n,r){!function(t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});var n=["prototype","__proto__","caller","arguments","length","name"];Object.getOwnPropertyNames(t).forEach((function(r){-1===n.indexOf(r)&&e[r]!==t[r]&&(e[r]=t[r])})),t&&y(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function x(e,t,n){return(x=w()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&y(a,n.prototype),a}).apply(null,arguments)}function j(e){var t="function"==typeof Map?new Map:void 0;return(j=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return x(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),y(r,e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?O(e):t}function S(e){var t=w();return function(){var n,r=f(e);if(t){var a=f(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return C(this,n)}}function _(e,t,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}var k=Object.values||function(e){var t=[];for(var n in e)t.push(e[n]);return t},E=Object.entries||function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t},A=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach((function(t){for(var n in t)e[n]=t[n]})),e},T=Object.fromEntries||function(e){var t={};return R(e).forEach((function(e){var n=e[0],r=e[1];t[n]=r})),t},R=Array.from||function(e){if(e instanceof F){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t}return Array.prototype.slice.call(e)};function I(e){return-1!==this.indexOf(e)}Array.prototype.includes||(Array.prototype.includes=I),String.prototype.includes||(String.prototype.includes=I),String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,t+e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return this.substring(t-e.length,t)===e});var P="undefined"!=typeof self?self:e,D=P.fetch||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){var a=new XMLHttpRequest;if(a.open("get",e,!0),a.responseType="arraybuffer",a.onerror=r,t.headers)for(var l in t.headers)a.setRequestHeader(l,t.headers[l]);a.onload=function(){n({ok:a.status>=200&&a.status<300,status:a.status,arrayBuffer:function(){return Promise.resolve(a.response)}})},a.send(null)}))},M=function(e){var t=[];if(Object.defineProperties(t,{size:{get:function(){return this.length}},has:{value:function(e){return-1!==this.indexOf(e)}},add:{value:function(e){this.has(e)||this.push(e)}},delete:{value:function(e){if(this.has(e)){var t=this.indexOf(e);this.splice(t,1)}}}}),Array.isArray(e))for(var n=0;n<e.length;n++)t.add(e[n]);return t},L=function(e){return new F(e)},F=void 0!==P.Map&&void 0!==P.Map.prototype.keys?P.Map:function(){function e(t){if(a(this,e),this.clear(),t)for(var n=0;n<t.length;n++)this.set(t[n][0],t[n][1])}return d(e,[{key:"clear",value:function(){this._map={},this._keys=[]}},{key:"size",get:function(){return this._keys.length}},{key:"get",value:function(e){return this._map["map_"+e]}},{key:"set",value:function(e,t){return this._map["map_"+e]=t,this._keys.indexOf(e)<0&&this._keys.push(e),this}},{key:"has",value:function(e){return this._keys.indexOf(e)>=0}},{key:"delete",value:function(e){var t=this._keys.indexOf(e);return!(t<0||(delete this._map["map_"+e],this._keys.splice(t,1),0))}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"values",value:function(){var e=this;return this._keys.map((function(t){return e.get(t)}))}},{key:"entries",value:function(){var e=this;return this._keys.map((function(t){return[t,e.get(t)]}))}},{key:"forEach",value:function(e,t){for(var n=0;n<this._keys.length;n++)e.call(t,this._map["map_"+this._keys[n]],this._keys[n],this)}}]),e}(),q="undefined"!=typeof self?self:e,N="undefined"!=typeof navigator,B=N&&"undefined"==typeof HTMLImageElement,U=!(void 0===e||void 0===n||!n.versions||!n.versions.node),H=q.Buffer,z=!!H,V=function(e){return void 0!==e};function W(e){return void 0===e||(e instanceof F?0===e.size:0===k(e).filter(V).length)}function K(e){var t=new Error(e);throw delete t.stack,t}function G(e){var t=function(e){var t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var Y=function(e){return String.fromCharCode.apply(null,e)},X="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function J(e){return X?X.decode(e):z?r.from(e).toString("utf8"):decodeURIComponent(escape(Y(e)))}var Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;if(a(this,e),"boolean"==typeof l&&(this.le=l),Array.isArray(t)&&(t=new Uint8Array(t)),0===t)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){void 0===r&&(r=t.byteLength-n);var d=new DataView(t,n,r);this._swapDataView(d)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof e){void 0===r&&(r=t.byteLength-n),(n+=t.byteOffset)+r>t.byteOffset+t.byteLength&&K("Creating view outside of available memory in ArrayBuffer");var h=new DataView(t.buffer,n,r);this._swapDataView(h)}else if("number"==typeof t){var p=new DataView(new ArrayBuffer(t));this._swapDataView(p)}else K("Invalid input argument for BufferView: "+t)}return d(e,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||K("BufferView.set(): Invalid data argument.");var a=this.toUint8();return a.set(t,n),new r(this,n,t.byteLength)}},{key:"subarray",value:function(t,n){return new e(this,t,n=n||this._lengthToEnd(t))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return J(n)}},{key:"getLatin1String",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return Y(n)}},{key:"getUnicodeString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return Y(n)}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}],[{key:"from",value:function(t,n){return t instanceof this&&t.le===n?t:new e(t,void 0,void 0,n)}}]),e}();function Z(e,t){K("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var ee=function(e){p(n,e);var t=S(n);function n(e){var r;return a(this,n),(r=t.call(this)).kind=e,r}return d(n,[{key:"get",value:function(e,t){return this.has(e)||Z(this.kind,e),t&&(e in t||function(e,t){K("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||Z(this.kind,e)),_(f(n.prototype),"get",this).call(this,e)}},{key:"keyList",value:function(){return R(this.keys())}}]),n}(j(F)),te=new ee("file parser"),ne=new ee("segment parser"),re=new ee("file reader");function oe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function ae(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var se=oe((function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){return t(r.result||new ArrayBuffer)},r.onerror=n,r.readAsArrayBuffer(e)}))})),le=oe((function(e){return D(e).then((function(e){return e.arrayBuffer()}))})),ce=oe((function(e,t){return ae(t(e),(function(e){return new Q(e)}))})),ue=oe((function(e,t,n){var r=new(re.get(n))(e,t);return ae(r.read(),(function(){return r}))})),de=oe((function(e,t,n,r){return re.has(n)?ue(e,t,n):r?ce(e,r):(K("Parser ".concat(n," is not loaded")),ae())})),he="Invalid input argument";function pe(e,t){return(n=e).startsWith("data:")||n.length>1e4?ue(e,t,"base64"):N?de(e,t,"url",le):U?ue(e,t,"fs"):void K(he);var n}var fe=function(e){p(n,e);var t=S(n);function n(){return a(this,n),t.apply(this,arguments)}return d(n,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=R(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=R(this.values())),this.allValues}}]),n}(j(F));function ge(e,t,n){var r=new fe,a=n;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++){var d=a[l],h=d[0],p=d[1];r.set(h,p)}if(Array.isArray(t)){var f=t;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=R(f));for(var y=0;y<f.length;y++){var w=f[y];e.set(w,r)}}else e.set(t,r);return r}function me(e,t,n){var r,a=e.get(t),l=n;Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=R(l));for(var d=0;d<l.length;d++)r=l[d],a.set(r[0],r[1])}var ve=L(),be=L(),ye=L(),we=37500,xe=37510,je=40965,Oe=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Ce=["jfif","xmp","icc","iptc","ihdr"],Se=["tiff"].concat(Ce),_e=["ifd0","ifd1","exif","gps","interop"],ke=[].concat(Se,_e),Ee=["makerNote","userComment"],Ae=["translateKeys","translateValues","reviveValues","multiSegment"],$e=[].concat(Ae,["sanitize","mergeOutput","silentErrors"]),Te=function(){function e(){a(this,e)}return d(e,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),e}(),Re=function(e){p(n,e);var t=S(n);function n(e,r,l,d){var p;if(a(this,n),h(O(p=t.call(this)),"enabled",!1),h(O(p),"skip",M()),h(O(p),"pick",M()),h(O(p),"deps",M()),h(O(p),"translateKeys",!1),h(O(p),"translateValues",!1),h(O(p),"reviveValues",!1),p.key=e,p.enabled=r,p.parse=p.enabled,p.applyInheritables(d),p.canBeFiltered=_e.includes(e),p.canBeFiltered&&(p.dict=ve.get(e)),void 0!==l)if(Array.isArray(l))p.parse=p.enabled=!0,p.canBeFiltered&&l.length>0&&p.translateTagSet(l,p.pick);else if("object"==typeof l){if(p.enabled=!0,p.parse=!1!==l.parse,p.canBeFiltered){var f=l.pick,y=l.skip;f&&f.length>0&&p.translateTagSet(f,p.pick),y&&y.length>0&&p.translateTagSet(y,p.skip)}p.applyInheritables(l)}else!0===l||!1===l?p.parse=p.enabled=l:K("Invalid options argument: ".concat(l));return p}return d(n,[{key:"needed",get:function(){return this.enabled||this.deps.size>0}},{key:"applyInheritables",value:function(e){var t,n,r=Ae;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=R(r));for(var a=0;a<r.length;a++)void 0!==(n=e[t=r[a]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,r,a=this.dict,l=a.tagKeys,d=a.tagValues,h=e;Array.isArray(h)||("function"==typeof h.entries&&(h=h.entries()),h=R(h));for(var p=0;p<h.length;p++)"string"==typeof(n=h[p])?(-1===(r=d.indexOf(n))&&(r=l.indexOf(Number(n))),-1!==r&&t.add(Number(l[r]))):t.add(n)}else{var f=e;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=R(f));for(var y=0;y<f.length;y++){var w=f[y];t.add(w)}}}},{key:"finalizeFilters",value:function(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Fe(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Fe(this.pick,this.deps)}}]),n}(Te),Ie={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Pe=L(),De=function(e){p(n,e);var t=S(n);function n(e){var r;return a(this,n),r=t.call(this),!0===e?r.setupFromTrue():void 0===e?r.setupFromUndefined():Array.isArray(e)?r.setupFromArray(e):"object"==typeof e?r.setupFromObject(e):K("Invalid options argument ".concat(e)),void 0===r.firstChunkSize&&(r.firstChunkSize=N?r.firstChunkSizeBrowser:r.firstChunkSizeNode),r.mergeOutput&&(r.ifd1.enabled=!1),r.filterNestedSegmentTags(),r.traverseTiffDependencyTree(),r.checkLoadedPlugins(),r}return d(n,[{key:"setupFromUndefined",value:function(){var e,t=Oe;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=R(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Ie[e];var r=$e;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=R(r));for(var a=0;a<r.length;a++)this[e=r[a]]=Ie[e];var l=Ee;Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=R(l));for(var d=0;d<l.length;d++)this[e=l[d]]=Ie[e];var h=ke;Array.isArray(h)||("function"==typeof h.entries&&(h=h.entries()),h=R(h));for(var p=0;p<h.length;p++)this[e=h[p]]=new Re(e,Ie[e],void 0,this)}},{key:"setupFromTrue",value:function(){var e,t=Oe;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=R(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Ie[e];var r=$e;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=R(r));for(var a=0;a<r.length;a++)this[e=r[a]]=Ie[e];var l=Ee;Array.isArray(l)||("function"==typeof l.entries&&(l=l.entries()),l=R(l));for(var d=0;d<l.length;d++)this[e=l[d]]=!0;var h=ke;Array.isArray(h)||("function"==typeof h.entries&&(h=h.entries()),h=R(h));for(var p=0;p<h.length;p++)this[e=h[p]]=new Re(e,!0,void 0,this)}},{key:"setupFromArray",value:function(e){var t,n=Oe;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Ie[t];var a=$e;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++)this[t=a[l]]=Ie[t];var d=Ee;Array.isArray(d)||("function"==typeof d.entries&&(d=d.entries()),d=R(d));for(var h=0;h<d.length;h++)this[t=d[h]]=Ie[t];var p=ke;Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=R(p));for(var f=0;f<p.length;f++)this[t=p[f]]=new Re(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,_e)}},{key:"setupFromObject",value:function(e){var t;_e.ifd0=_e.ifd0||_e.image,_e.ifd1=_e.ifd1||_e.thumbnail,A(this,e);var n=Oe;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Le(e[t],Ie[t]);var a=$e;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++)this[t=a[l]]=Le(e[t],Ie[t]);var d=Ee;Array.isArray(d)||("function"==typeof d.entries&&(d=d.entries()),d=R(d));for(var h=0;h<d.length;h++)this[t=d[h]]=Le(e[t],Ie[t]);var p=Se;Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=R(p));for(var f=0;f<p.length;f++)this[t=p[f]]=new Re(t,Ie[t],e[t],this);var y=_e;Array.isArray(y)||("function"==typeof y.entries&&(y=y.entries()),y=R(y));for(var w=0;w<y.length;w++)this[t=y[w]]=new Re(t,Ie[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,_e,ke),!0===e.tiff?this.batchEnableWithBool(_e,!0):!1===e.tiff?this.batchEnableWithUserValue(_e,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,_e):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,_e)}},{key:"batchEnableWithBool",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++)this[n[r]].enabled=t}},{key:"batchEnableWithUserValue",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++){var a=n[r],l=t[a];this[a].enabled=!1!==l&&void 0!==l}}},{key:"setupGlobalFilters",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(e&&e.length){var a=r;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++){var d=a[l];this[d].enabled=!1}var h=Me(e,n),p=h;Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=R(p));for(var f=0;f<p.length;f++){var y=p[f],w=y[0],x=y[1];Fe(this[w].pick,x),this[w].enabled=!0}}else if(t&&t.length){var j=Me(t,n),O=j;Array.isArray(O)||("function"==typeof O.entries&&(O=O.entries()),O=R(O));for(var C=0;C<O.length;C++){var S=O[C],_=S[0],k=S[1];Fe(this[_].skip,k)}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,r=this.iptc,a=this.icc;this.makerNote?t.deps.add(we):t.skip.add(we),this.userComment?t.deps.add(xe):t.skip.add(xe),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),a.enabled||e.skip.add(34675)}},{key:"traverseTiffDependencyTree",value:function(){var e=this,t=this.ifd0,n=this.exif,r=this.gps;this.interop.needed&&(n.deps.add(je),t.deps.add(je)),n.needed&&t.deps.add(34665),r.needed&&t.deps.add(34853),this.tiff.enabled=_e.some((function(t){return!0===e[t].enabled}))||this.makerNote||this.userComment;var a=_e;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++)this[a[l]].finalizeFilters()}},{key:"onlyTiff",get:function(){var e=this;return!Ce.map((function(t){return e[t].enabled})).some((function(e){return!0===e}))&&this.tiff.enabled}},{key:"checkLoadedPlugins",value:function(){var e=Se;Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=R(e));for(var t=0;t<e.length;t++){var n=e[t];this[n].enabled&&!ne.has(n)&&Z("segment parser",n)}}}],[{key:"useCached",value:function(e){var t=Pe.get(e);return void 0!==t||(t=new this(e),Pe.set(e,t)),t}}]),n}(Te);function Me(e,t){var n,r,a,l=[],d=t;Array.isArray(d)||("function"==typeof d.entries&&(d=d.entries()),d=R(d));for(var h=0;h<d.length;h++){r=d[h],n=[];var p=ve.get(r);Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=R(p));for(var f=0;f<p.length;f++)a=p[f],(e.includes(a[0])||e.includes(a[1]))&&n.push(a[0]);n.length&&l.push([r,n])}return l}function Le(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Fe(e,t){var n=t;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++){var a=n[r];e.add(a)}}function qe(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ne(){}function Be(e,t){if(!t)return e&&e.then?e.then(Ne):Promise.resolve()}function Ue(e,t){var n=e();return n&&n.then?n.then(t):t(n)}h(De,"default",Ie);var He,ze=function(){function e(t){a(this,e),h(this,"parsers",{}),this.options=De.useCached(t)}return d(e,[{key:"setup",value:function(){if(!this.fileParser){var e=this.file,t=e.getUint16(0),n=te;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++){var a=n[r],l=a[0],d=a[1];if(d.canHandle(e,t))return this.fileParser=new d(this.options,this.file,this.parsers),e[l]=!0}K("Unknown file format")}}},{key:"read",value:function(e){try{var t=this;return qe(function(e,t){return"string"==typeof e?pe(e,t):N&&!B&&e instanceof HTMLImageElement?pe(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new Q(e):N&&e instanceof Blob?de(e,t,"blob",se):void K(he)}(e,t.options),(function(e){t.file=e}))}catch(e){return Promise.reject(e)}}},{key:"parse",value:function(){try{var e=this;e.setup();var t={},n=[];return Ue((function(){return e.options.silentErrors?qe(e.doParse(t,n).catch((function(e){return n.push(e)})),(function(){n.push.apply(n,e.fileParser.errors)})):Be(e.doParse(t,n))}),(function(){return e.file.close&&e.file.close(),e.options.silentErrors&&n.length>0&&(t.errors=n),W(r=t)?void 0:r;var r}))}catch(e){return Promise.reject(e)}}},{key:"doParse",value:function(e,t){try{var n=this;return qe(n.fileParser.parse(),(function(){var r,a=k(n.parsers).map((r=function(t){return qe(t.parse(),(function(n){t.assignToOutput(e,n)}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}));if(n.options.silentErrors){var l=function(e){return t.push(e)};a=a.map((function(e){return e.catch(l)}))}return Be(Promise.all(a))}))}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;e.setup();var t,n=e.options,r=e.file,a=ne.get("tiff",n);return Ue((function(){if(!r.tiff)return function(e){var t=e();if(t&&t.then)return t.then(Ne)}((function(){if(r.jpeg)return qe(e.fileParser.getOrFindSegment("tiff"),(function(e){t=e}))}));t={start:0,type:"tiff"}}),(function(){if(void 0!==t)return qe(e.fileParser.ensureSegmentChunk(t),(function(t){return qe((e.parsers.tiff=new a(t,n,r)).extractThumbnail(),(function(e){return r.close&&r.close(),e}))}))}))}catch(e){return Promise.reject(e)}}}]),e}(),Ve=(He=function(e,t){var n,r,a=new ze(t);return r=function(){return a.parse()},(n=a.read(e))&&n.then||(n=Promise.resolve(n)),r?n.then(r):n},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(He.apply(this,e))}catch(e){return Promise.reject(e)}}),We=Object.freeze({__proto__:null,parse:Ve,Exifr:ze,fileParsers:te,segmentParsers:ne,fileReaders:re,tagKeys:ve,tagValues:be,tagRevivers:ye,createDictionary:ge,extendDictionary:me,fetchUrlAsArrayBuffer:le,readBlobAsArrayBuffer:se,chunkedProps:Oe,otherSegments:Ce,segments:Se,tiffBlocks:_e,segmentsAndBlocks:ke,tiffExtractables:Ee,inheritables:Ae,allFormatters:$e,Options:De});function Ke(){}var Ge=function(){function e(t,n,r){var l=this;a(this,e),h(this,"errors",[]),h(this,"ensureSegmentChunk",function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t,n,r,a=e.start,d=e.size||65536;return t=function(){if(l.file.chunked)return function(e){var t=e();if(t&&t.then)return t.then(Ke)}((function(){if(!l.file.available(a,d))return function(e){if(e&&e.then)return e.then(Ke)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return n=function(t){e.chunk=t},(t=l.file.readChunk(a,d))&&t.then||(t=Promise.resolve(t)),n?t.then(n):t;var t,n}),(function(t){K("Couldn't read segment: ".concat(JSON.stringify(e),". ").concat(t.message))})));e.chunk=l.file.subarray(a,d)}));l.file.byteLength>a+d?e.chunk=l.file.subarray(a,d):void 0===e.size?e.chunk=l.file.subarray(a):K("Segment unreachable: "+JSON.stringify(e))},n=function(){return e.chunk},(r=t())&&r.then?r.then(n):n()}))),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=n,this.parsers=r}return d(e,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){var n=new(ne.get(e))(t,this.options,this.file);return this.parsers[e]=n}},{key:"createParsers",value:function(e){var t=e;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=R(t));for(var n=0;n<t.length;n++){var r=t[n],a=r.type,l=r.chunk,d=this.options[a];if(d&&d.enabled){var h=this.parsers[a];h&&h.append||h||this.createParser(a,l)}}}},{key:"readSegments",value:function(e){try{var t=e.map(this.ensureSegmentChunk);return function(e,t){return e&&e.then?e.then(Ke):Promise.resolve()}(Promise.all(t))}catch(e){return Promise.reject(e)}}}]),e}(),Ye=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;a(this,e),h(this,"errors",[]),h(this,"raw",L()),h(this,"handleError",(function(e){if(!n.options.silentErrors)throw e;n.errors.push(e.message)})),this.chunk=this.normalizeInput(t),this.file=l,this.type=this.constructor.type,this.globalOptions=this.options=r,this.localOptions=r[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}return d(e,[{key:"normalizeInput",value:function(e){return e instanceof Q?e:new Q(e)}},{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"output",get:function(){return this.translated?this.translated:this.raw?T(this.raw):void 0}},{key:"translateBlock",value:function(e,t){var n=ye.get(t),r=be.get(t),a=ve.get(t),l=this.options[t],d=l.reviveValues&&!!n,h=l.translateValues&&!!r,p=l.translateKeys&&!!a,f={},y=e;Array.isArray(y)||("function"==typeof y.entries&&(y=y.entries()),y=R(y));for(var w=0;w<y.length;w++){var x=y[w],j=x[0],O=x[1];d&&n.has(j)?O=n.get(j)(O):h&&r.has(j)&&(O=this.translateValue(O,r.get(j))),p&&a.has(j)&&(j=a.get(j)||j),f[j]=O}return f}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return A(e,n);e[t]?A(e[t],n):e[t]=n}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,a=t+r,l=n-r;return{offset:t,length:n,headerLength:r,start:a,size:l,end:a+l}}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new De(h({},this.type,t)),r=new this(e,n);return r.parse()}}]),e}();function Xe(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Je(){}function Qe(e,t){if(!t)return e&&e.then?e.then(Je):Promise.resolve()}function Ze(e){var t=e();if(t&&t.then)return t.then(Je)}function et(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function tt(e,t,n){if(!e.s){if(n instanceof nt){if(!n.s)return void(n.o=tt.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(tt.bind(null,e,t),tt.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}h(Ye,"headerLength",4),h(Ye,"type",void 0),h(Ye,"multiSegment",!1),h(Ye,"canHandle",(function(){return!1}));var nt=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,a=this.s;if(a){var l=1&a?t:n;if(l){try{tt(r,1,l(this.v))}catch(e){tt(r,2,e)}return r}return this}return this.o=function(e){try{var a=e.v;1&e.s?tt(r,1,t?t(a):a):n?tt(r,1,n(a)):tt(r,2,a)}catch(e){tt(r,2,e)}},r},e}();function rt(e){return e instanceof nt&&1&e.s}function it(e,t,n){for(var r;;){var a=e();if(rt(a)&&(a=a.v),!a)return l;if(a.then){r=0;break}var l=n();if(l&&l.then){if(!rt(l)){r=1;break}l=l.s}if(t){var d=t();if(d&&d.then&&!rt(d)){r=2;break}}}var h=new nt,p=tt.bind(null,h,2);return(0===r?a.then(y):1===r?l.then(f):d.then(w)).then(void 0,p),h;function f(r){l=r;do{if(t&&(d=t())&&d.then&&!rt(d))return void d.then(w).then(void 0,p);if(!(a=e())||rt(a)&&!a.v)return void tt(h,1,l);if(a.then)return void a.then(y).then(void 0,p);rt(l=n())&&(l=l.v)}while(!l||!l.then);l.then(f).then(void 0,p)}function y(e){e?(l=n())&&l.then?l.then(f).then(void 0,p):f(l):tt(h,1,l)}function w(){(a=e())?a.then?a.then(y).then(void 0,p):y(a):tt(h,1,l)}}function ot(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function at(e){return e>=224&&e<=239}function st(e,t,n){var r=ne;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=R(r));for(var a=0;a<r.length;a++){var l=r[a],d=l[0];if(l[1].canHandle(e,t,n))return d}}var lt=function(e){p(n,e);var t=S(n);function n(){var e;a(this,n);for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return h(O(e=t.call.apply(t,[this].concat(l))),"appSegments",[]),h(O(e),"jpegSegments",[]),h(O(e),"unknownSegments",[]),e}return d(n,[{key:"parse",value:function(){try{var e=this;return Xe(e.findAppSegments(),(function(){return Xe(e.readSegments(e.appSegments),(function(){e.mergeMultiSegments(),e.createParsers(e.mergedAppSegments||e.appSegments)}))}))}catch(e){return Promise.reject(e)}}},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=M(ne.keyList())):(e=void 0===e?ne.keyList().filter((function(e){return t.options[e].enabled})):e.filter((function(e){return t.options[e].enabled&&ne.has(e)})),this.findAll=!1,this.remaining=M(e),this.wanted=M(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;try{var n=this;n.setupSegmentFinderArgs(t);var r=n.file,a=n.findAll,l=n.wanted,d=n.remaining;return et((function(){if(!a&&n.file.chunked)return a=R(l).some((function(e){var t=ne.get(e),r=n.options[e];return t.multiSegment&&r.multiSegment})),Ze((function(){if(a)return Qe(n.file.readWhole())}))}),(function(){var t=!1;if(e=n.findAppSegmentsInRange(e,r.byteLength),!n.options.onlyTiff)return function(){if(r.chunked){var a=!1;return it((function(){return!t&&d.size>0&&!a&&(!!r.canReadNextChunk||!!n.unfinishedMultiSegment)}),void 0,(function(){var l=r.nextChunkOffset,d=n.appSegments.some((function(e){return!n.file.available(e.offset||e.start,e.length||e.size)}));return et((function(){return Xe(e>l&&!d?r.readNextChunk(e):r.readNextChunk(l),(function(e){a=!e}))}),(function(){void 0===(e=n.findAppSegmentsInRange(e,r.byteLength))&&(t=!0)}))}))}}()}))}catch(e){return Promise.reject(e)}}},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,r,a,l,d,h,p=this.file,f=this.findAll,y=this.wanted,w=this.remaining,x=this.options;e<t;e++)if(255===p.getUint8(e))if(at(n=p.getUint8(e+1))){if(r=p.getUint16(e+2),(a=st(p,e,r))&&y.has(a)&&(d=(l=ne.get(a)).findPosition(p,e),h=x[a],d.type=a,this.appSegments.push(d),!f&&(l.multiSegment&&h.multiSegment?(this.unfinishedMultiSegment=d.chunkNumber<d.chunkCount,this.unfinishedMultiSegment||w.delete(a)):w.delete(a),0===w.size)))break;x.recordUnknownSegments&&((d=Ye.findPosition(p,e)).marker=n,this.unknownSegments.push(d)),e+=r+1}else if(ot(n)){if(r=p.getUint16(e+2),218===n&&!1!==x.stopAfterSos)return;x.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}},{key:"mergeMultiSegments",value:function(){var e=this;if(this.appSegments.some((function(e){return e.multiSegment}))){var t=function(e,t){for(var n,r,a,l=L(),d=0;d<e.length;d++)r=(n=e[d]).type,l.has(r)?a=l.get(r):l.set(r,a=[]),a.push(n);return R(l)}(this.appSegments);this.mergedAppSegments=t.map((function(t){var n=t[0],r=t[1],a=ne.get(n,e.options);return a.handleMultiSegments?{type:n,chunk:a.handleMultiSegments(r)}:r[0]}))}}},{key:"getSegment",value:function(e){return this.appSegments.find((function(t){return t.type===e}))}},{key:"getOrFindSegment",value:function(e){try{var t=this,n=t.getSegment(e);return et((function(){if(void 0===n)return Xe(t.findAppSegments(0,[e]),(function(){n=t.getSegment(e)}))}),(function(){return n}))}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),n}(Ge);function ct(){}function ut(e,t){if(!t)return e&&e.then?e.then(ct):Promise.resolve()}function dt(e,t){var n=e();return n&&n.then?n.then(t):t(n)}h(lt,"type","jpeg"),te.set("jpeg",lt);var ht=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],pt=function(e){p(n,e);var t=S(n);function n(){return a(this,n),t.apply(this,arguments)}return d(n,[{key:"parse",value:function(){try{var e=this;e.parseHeader();var t=e.options;return dt((function(){if(t.ifd0.enabled)return ut(e.parseIfd0Block())}),(function(){return dt((function(){if(t.exif.enabled)return ut(e.safeParse("parseExifBlock"))}),(function(){return dt((function(){if(t.gps.enabled)return ut(e.safeParse("parseGpsBlock"))}),(function(){return dt((function(){if(t.interop.enabled)return ut(e.safeParse("parseInteropBlock"))}),(function(){return dt((function(){if(t.ifd1.enabled)return ut(e.safeParse("parseThumbnailBlock"))}),(function(){return e.createOutput()}))}))}))}))}))}catch(e){return Promise.reject(e)}}},{key:"safeParse",value:function(e){var t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){if(void 0===this.ifd1Offset){this.findIfd0Offset();var e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}},{key:"parseBlock",value:function(e,t){var n=L();return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:function(){try{var e=this;if(e.ifd0)return;var t=e.file;return e.findIfd0Offset(),e.ifd0Offset<8&&K("Malformed EXIF data"),!t.chunked&&e.ifd0Offset>t.byteLength&&K("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(e.ifd0Offset,", file.byteLength: ").concat(t.byteLength)),dt((function(){if(t.tiff)return ut(t.ensureChunk(e.ifd0Offset,G(e.options)))}),(function(){var t=e.parseBlock(e.ifd0Offset,"ifd0");if(0!==t.size)return e.exifOffset=t.get(34665),e.interopOffset=t.get(je),e.gpsOffset=t.get(34853),e.xmp=t.get(700),e.iptc=t.get(33723),e.icc=t.get(34675),e.options.sanitize&&(t.delete(34665),t.delete(je),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t}))}catch(e){return Promise.reject(e)}}},{key:"parseExifBlock",value:function(){try{var e=this;if(e.exif)return;return dt((function(){if(!e.ifd0)return ut(e.parseIfd0Block())}),(function(){if(void 0!==e.exifOffset)return dt((function(){if(e.file.tiff)return ut(e.file.ensureChunk(e.exifOffset,G(e.options)))}),(function(){var t=e.parseBlock(e.exifOffset,"exif");return e.interopOffset||(e.interopOffset=t.get(je)),e.makerNote=t.get(we),e.userComment=t.get(xe),e.options.sanitize&&(t.delete(je),t.delete(we),t.delete(xe)),e.unpack(t,41728),e.unpack(t,41729),t}))}))}catch(e){return Promise.reject(e)}}},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:function(){try{var e=this;if(e.gps)return;return dt((function(){if(!e.ifd0)return ut(e.parseIfd0Block())}),(function(){if(void 0!==e.gpsOffset){var t=e.parseBlock(e.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",ft.apply(void 0,t.get(2).concat([t.get(1)]))),t.set("longitude",ft.apply(void 0,t.get(4).concat([t.get(3)])))),t}}))}catch(e){return Promise.reject(e)}}},{key:"parseInteropBlock",value:function(){try{var e=this;if(e.interop)return;return dt((function(){if(!e.ifd0)return ut(e.parseIfd0Block())}),(function(){return dt((function(){if(void 0===e.interopOffset&&!e.exif)return ut(e.parseExifBlock())}),(function(){if(void 0!==e.interopOffset)return e.parseBlock(e.interopOffset,"interop")}))}))}catch(e){return Promise.reject(e)}}},{key:"parseThumbnailBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t=this;if(t.ifd1||t.ifd1Parsed)return;if(t.options.mergeOutput&&!e)return;return t.findIfd1Offset(),t.ifd1Offset>0&&(t.parseBlock(t.ifd1Offset,"ifd1"),t.ifd1Parsed=!0),t.ifd1}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;return e.headerParsed||e.parseHeader(),dt((function(){if(!e.ifd1Parsed)return ut(e.parseThumbnailBlock(!0))}),(function(){if(void 0!==e.ifd1){var t=e.ifd1.get(513),n=e.ifd1.get(514);return e.chunk.getUint8Array(t,n)}}))}catch(e){return Promise.reject(e)}}},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}},{key:"createOutput",value:function(){var e,t,n,r={},a=_e;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=R(a));for(var l=0;l<a.length;l++)if(!W(e=this[t=a[l]]))if(n=this.canTranslate?this.translateBlock(e,t):T(e),this.options.mergeOutput){if("ifd1"===t)continue;A(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)A(e,t);else{var n=E(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=R(n));for(var r=0;r<n.length;r++){var a=n[r],l=a[0],d=a[1];this.assignObjectToOutput(e,l,d)}}}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),n}(function(e){p(n,e);var t=S(n);function n(){return a(this,n),t.apply(this,arguments)}return d(n,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L(),r=this.options[t],a=r.pick,l=r.skip,d=(a=M(a)).size>0,h=0===l.size,p=this.chunk.getUint16(e);e+=2;for(var f=0;f<p;f++){var y=this.chunk.getUint16(e);if(d){if(a.has(y)&&(n.set(y,this.parseTag(e,y,t)),a.delete(y),0===a.size))break}else!h&&l.has(y)||n.set(y,this.parseTag(e,y,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var r,a=this.chunk,l=a.getUint16(e+2),d=a.getUint32(e+4),h=ht[l];if(h*d<=4?e+=8:e=a.getUint32(e+8),(l<1||l>13)&&K("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(l,", offset ").concat(e)),e>a.byteLength&&K("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(l,", offset ").concat(e," is outside of chunk size ").concat(a.byteLength)),1===l)return a.getUint8Array(e,d);if(2===l)return""===(r=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(r=a.getString(e,d)).trim())?void 0:r;if(7===l)return a.getUint8Array(e,d);if(1===d)return this.parseTagValue(l,e);for(var p=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(l))(d),f=h,y=0;y<d;y++)p[y]=this.parseTagValue(l,e),e+=f;return p}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:K("Invalid tiff type ".concat(e))}}}]),n}(Ye));function ft(e,t,n,r){var a=e+t/60+n/3600;return"S"!==r&&"W"!==r||(a*=-1),a}h(pt,"type","tiff"),h(pt,"headerLength",10),ne.set("tiff",pt);var gt=Object.freeze({__proto__:null,default:We,Exifr:ze,fileParsers:te,segmentParsers:ne,fileReaders:re,tagKeys:ve,tagValues:be,tagRevivers:ye,createDictionary:ge,extendDictionary:me,fetchUrlAsArrayBuffer:le,readBlobAsArrayBuffer:se,chunkedProps:Oe,otherSegments:Ce,segments:Se,tiffBlocks:_e,segmentsAndBlocks:ke,tiffExtractables:Ee,inheritables:Ae,allFormatters:$e,Options:De,parse:Ve});function mt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function vt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var bt=vt((function(e){var t=new ze(Ct);return mt(t.read(e),(function(){return mt(t.parse(),(function(e){if(e&&e.ifd0)return e.ifd0[274]}))}))})),yt=vt((function(e){var t=new ze(Ot);return mt(t.read(e),(function(){return mt(t.parse(),(function(e){if(e&&e.gps){var t=e.gps;return{latitude:t.latitude,longitude:t.longitude}}}))}))})),wt=vt((function(e){return mt(this.thumbnail(e),(function(e){if(void 0!==e){var t=new Blob([e]);return URL.createObjectURL(t)}}))})),xt=vt((function(e){var t=new ze(St);return mt(t.read(e),(function(){return mt(t.extractThumbnail(),(function(e){return e&&z?H.from(e):e}))}))})),jt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Ot=A({},jt,{firstChunkSize:4e4,gps:[1,2,3,4]}),Ct=A({},jt,{firstChunkSize:4e4,ifd0:[274]}),St=A({},jt,{tiff:!1,ifd1:!0,mergeOutput:!1}),_t=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(t.rotateCanvas=!0,t.rotateCss=!0,"object"==typeof navigator){var kt=navigator.userAgent;if(kt.includes("iPad")||kt.includes("iPhone")){var Et=kt.match(/OS (\d+)_(\d+)/);if(Et){var At=Et[1],$t=Et[2],Tt=Number(At)+.1*Number($t);t.rotateCanvas=Tt<13.4,t.rotateCss=!1}}else if(kt.includes("OS X 10")){var Rt=kt.match(/OS X 10[_.](\d+)/)[1];t.rotateCanvas=t.rotateCss=Number(Rt)<15}if(kt.includes("Chrome/")){var It=kt.match(/Chrome\/(\d+)/)[1];t.rotateCanvas=t.rotateCss=Number(It)<81}else if(kt.includes("Firefox/")){var Pt=kt.match(/Firefox\/(\d+)/)[1];t.rotateCanvas=t.rotateCss=Number(Pt)<77}}function Dt(){}var Mt=function(e){p(n,e);var t=S(n);function n(){var e;a(this,n);for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return h(O(e=t.call.apply(t,[this].concat(l))),"ranges",new Lt),0!==e.byteLength&&e.ranges.add(0,e.byteLength),e}return d(n,[{key:"_tryExtend",value:function(e,t,n){if(0===e&&0===this.byteLength&&n){var r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{var a=e+t;if(a>this.byteLength){var l=this._extend(a).dataView;this._swapDataView(l)}}}},{key:"_extend",value:function(e){var t;t=z?H.allocUnsafe(e):new Uint8Array(e);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}},{key:"subarray",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),_(f(n.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&this._tryExtend(t,e.byteLength,e);var a=_(f(n.prototype),"set",this).call(this,e,t);return this.ranges.add(t,a.byteLength),a}},{key:"ensureChunk",value:function(e,t){try{var n=this;if(!n.chunked)return;if(n.ranges.available(e,t))return;return function(e,t){return e&&e.then?e.then(Dt):Promise.resolve()}(n.readChunk(e,t))}catch(e){return Promise.reject(e)}}},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),n}(Q),Lt=function(){function e(){a(this,e),h(this,"list",[])}return d(e,[{key:"length",get:function(){return this.list.length}},{key:"add",value:function(e,t){var n=e+t,r=this.list.filter((function(t){return Ft(e,t.offset,n)||Ft(e,t.end,n)}));if(r.length>0){e=Math.min.apply(Math,[e].concat(r.map((function(e){return e.offset})))),t=(n=Math.max.apply(Math,[n].concat(r.map((function(e){return e.end})))))-e;var a=r.shift();a.offset=e,a.length=t,a.end=n,this.list=this.list.filter((function(e){return!r.includes(e)}))}else this.list.push({offset:e,length:t,end:n})}},{key:"available",value:function(e,t){var n=e+t;return this.list.some((function(t){return t.offset<=e&&n<=t.end}))}}]),e}();function Ft(e,t,n){return e<=t&&t<=n}function qt(){}function Nt(e,t){if(!t)return e&&e.then?e.then(qt):Promise.resolve()}function Bt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Ut=function(e){p(n,e);var t=S(n);function n(){return a(this,n),t.apply(this,arguments)}return d(n,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Bt(se(e.input),(function(t){e._swapArrayBuffer(t)}))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,_(f(n.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t:void 0,a=n.input.slice(e,r);return Bt(se(a),(function(t){return n.set(t,e,!0)}))}catch(e){return Promise.reject(e)}}}]),n}(function(e){p(n,e);var t=S(n);function n(e,r){var l;return a(this,n),h(O(l=t.call(this,0)),"chunksRead",0),l.input=e,l.options=r,l}return d(n,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Nt(e.readChunk(e.nextChunkOffset))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){try{var e=this;return e.chunked=!0,Nt(e.readChunk(0,e.options.firstChunkSize))}catch(e){return Promise.reject(e)}}},{key:"readNextChunk",value:function(e){try{var t=this;if(void 0===e&&(e=t.nextChunkOffset),t.fullyRead)return t.chunksRead++,!1;var n=t.options.chunkSize;return r=t.readChunk(e,n),a=function(e){return!!e&&e.byteLength===n},r&&r.then||(r=Promise.resolve(r)),a?r.then(a):r}catch(e){return Promise.reject(e)}var r,a}},{key:"readChunk",value:function(e,t){try{var n=this;if(n.chunksRead++,0===(t=n.safeWrapAddress(e,t)))return;return n._readChunk(e,t)}catch(e){return Promise.reject(e)}}},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}}]),n}(Mt));re.set("blob",Ut),t.Exifr=ze,t.Options=De,t.allFormatters=$e,t.chunkedProps=Oe,t.createDictionary=ge,t.default=gt,t.disableAllOptions=jt,t.extendDictionary=me,t.fetchUrlAsArrayBuffer=le,t.fileParsers=te,t.fileReaders=re,t.gps=yt,t.gpsOnlyOptions=Ot,t.inheritables=Ae,t.orientation=bt,t.orientationOnlyOptions=Ct,t.otherSegments=Ce,t.parse=Ve,t.readBlobAsArrayBuffer=se,t.rotation=function(e){return mt(bt(e),(function(e){return A({canvas:t.rotateCanvas,css:t.rotateCss},_t[e])}))},t.rotations=_t,t.segmentParsers=ne,t.segments=Se,t.segmentsAndBlocks=ke,t.tagKeys=ve,t.tagRevivers=ye,t.tagValues=be,t.thumbnail=xt,t.thumbnailOnlyOptions=St,t.thumbnailUrl=wt,t.tiffBlocks=_e,t.tiffExtractables=Ee,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,n(84),n(229),n(629).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=f(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=f(e),d=r[0],h=r[1],p=new l(function(e,t,n){return 3*(t+n)/4-n}(0,d,h)),y=0,w=h>0?d-4:d;for(n=0;n<w;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],p[y++]=t>>16&255,p[y++]=t>>8&255,p[y++]=255&t;2===h&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,p[y++]=255&t);1===h&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,p[y++]=t>>8&255,p[y++]=255&t);return p},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,l=[],d=0,h=n-a;d<h;d+=16383)l.push(y(e,d,d+16383>h?h:d+16383));1===a?(t=e[n-1],l.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],l.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return l.join("")};for(var r=[],a=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,p=d.length;h<p;++h)r[h]=d[h],a[d.charCodeAt(h)]=h;function f(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function y(e,t,n){for(var a,l,d=[],h=t;h<n;h+=3)a=(e[h]<<16&16711680)+(e[h+1]<<8&65280)+(255&e[h+2]),d.push(r[(l=a)>>18&63]+r[l>>12&63]+r[l>>6&63]+r[63&l]);return d.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,a){var l,d,h=8*a-r-1,p=(1<<h)-1,f=p>>1,y=-7,w=n?a-1:0,x=n?-1:1,j=e[t+w];for(w+=x,l=j&(1<<-y)-1,j>>=-y,y+=h;y>0;l=256*l+e[t+w],w+=x,y-=8);for(d=l&(1<<-y)-1,l>>=-y,y+=r;y>0;d=256*d+e[t+w],w+=x,y-=8);if(0===l)l=1-f;else{if(l===p)return d?NaN:1/0*(j?-1:1);d+=Math.pow(2,r),l-=f}return(j?-1:1)*d*Math.pow(2,l-r)},t.write=function(e,t,n,r,a,l){var d,h,p,f=8*l-a-1,y=(1<<f)-1,w=y>>1,x=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,j=r?0:l-1,O=r?1:-1,C=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(h=isNaN(t)?1:0,d=y):(d=Math.floor(Math.log(t)/Math.LN2),t*(p=Math.pow(2,-d))<1&&(d--,p*=2),(t+=d+w>=1?x/p:x*Math.pow(2,1-w))*p>=2&&(d++,p/=2),d+w>=y?(h=0,d=y):d+w>=1?(h=(t*p-1)*Math.pow(2,a),d+=w):(h=t*Math.pow(2,w-1)*Math.pow(2,a),d=0));a>=8;e[n+j]=255&h,j+=O,h/=256,a-=8);for(d=d<<a|h,f+=a;f>0;e[n+j]=255&d,j+=O,d/=256,f-=8);e[n+j-O]|=128*C}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(567);e.exports=function(e){if("string"==typeof e){var t=[].slice.call(document.querySelectorAll(e));return t.length>0?t:null}if("object"==typeof e&&r(e))return[e]}},function(e,t,n){var r=n(247),a=n(914),l=n(915);e.exports=function(e,t){var n=[],d=[];return r(e.items).forEach((function(e){var r=e.webkitGetAsEntry();r&&d.push(function e(r){return new Promise((function(d){if(r.isFile)r.file((function(e){e.relativePath=a(r),n.push(e),d()}),(function(e){t(e),d()}));else if(r.isDirectory){var h=r.createReader();l(h,[],t,{onSuccess:function(t){var n=t.map((function(t){return e(t)}));Promise.all(n).then((function(){return d()}))}})}}))}(r))})),Promise.all(d).then((function(){return n}))}},function(e,t){e.exports=function(e){return e.fullPath&&e.fullPath!=="/"+e.name?e.fullPath:null}},function(e,t){e.exports=function e(t,n,r,a){var l=a.onSuccess;t.readEntries((function(a){var d=[].concat(n,a);a.length?setTimeout((function(){e(t,d,r,{onSuccess:l})}),0):l(d)}),(function(e){r(e),l(n)}))}},function(e,t,n){var r=n(247);e.exports=function(e){var t=r(e.files);return Promise.resolve(t)}},function(e,t,n){var r=n(247),a=n(579),l=n(478);function d(e,t){var n=t[0];n&&(n.focus(),e.preventDefault())}function h(e,t,n){var h=a(n,t),p=r(h.querySelectorAll(l)),f=p.indexOf(document.activeElement);!function(e){return e.contains(document.activeElement)}(h)?d(e,p):e.shiftKey&&0===f?function(e,t){var n=t[t.length-1];n&&(n.focus(),e.preventDefault())}(e,p):e.shiftKey||f!==p.length-1||d(e,p)}e.exports={forModal:function(e,t,n){h(e,t,n)},forInline:function(e,t,n){null===t||h(e,t,n)}}},function(e,t,n){var r=n(919),a=n(478),l=n(579);e.exports=function(){var e=!1;return r((function(t,n){var r=l(t,n),d=r.contains(document.activeElement);if(!d||!e){var h=r.querySelector("[data-uppy-super-focusable]");if(!d||h)if(h)h.focus({preventScroll:!0}),e=!0;else{var p=r.querySelector(a);p&&p.focus({preventScroll:!0}),e=!1}}}),260)}},function(e,t,n){(function(t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,h="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")(),y=Object.prototype.toString,w=Math.max,x=Math.min,j=function(){return f.Date.now()};function O(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function C(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==y.call(e)}(e))return NaN;if(O(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=O(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var h=a.test(e);return h||l.test(e)?d(e.slice(2),h?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var r,a,l,d,h,p,f=0,y=!1,S=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function k(t){var n=r,l=a;return r=a=void 0,f=t,d=e.apply(l,n)}function E(e){return f=e,h=setTimeout(T,t),y?k(e):d}function A(e){var n=e-p;return void 0===p||n>=t||n<0||S&&e-f>=l}function T(){var e=j();if(A(e))return R(e);h=setTimeout(T,function(e){var n=t-(e-p);return S?x(n,l-(e-f)):n}(e))}function R(e){return h=void 0,_&&r?k(e):(r=a=void 0,d)}function I(){var e=j(),n=A(e);if(r=arguments,a=this,p=e,n){if(void 0===h)return E(p);if(S)return h=setTimeout(T,t),k(p)}return void 0===h&&(h=setTimeout(T,t)),d}return t=C(t)||0,O(n)&&(y=!!n.leading,l=(S="maxWait"in n)?w(C(n.maxWait)||0,t):l,_="trailing"in n?!!n.trailing:_),I.cancel=function(){void 0!==h&&clearTimeout(h),f=0,r=p=a=h=void 0},I.flush=function(){return void 0===h?d:R(j())},I}}).call(this,n(84))},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=n(145).Plugin,f=n(214),y=n(247),w=n(574),x=n(578),j=n(89).h;e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).type="acquirer",r.id=r.opts.id||"DragDrop",r.title="Drag & Drop",r.defaultLocale={strings:{dropHereOr:"Drop files here or %{browse}",browse:"browse"}};return r.opts=l({},{target:null,inputName:"files[]",width:"100%",height:"100%",note:null},n),r.isDragDropSupported=w(),r.removeDragOverClassTimeout=null,r.i18nInit(),r.onInputChange=r.onInputChange.bind(d(r)),r.handleDragOver=r.handleDragOver.bind(d(r)),r.handleDragLeave=r.handleDragLeave.bind(d(r)),r.handleDrop=r.handleDrop.bind(d(r)),r.addFiles=r.addFiles.bind(d(r)),r.render=r.render.bind(d(r)),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var a=r.prototype;return a.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},a.i18nInit=function(){this.translator=new f([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},a.addFiles=function(e){var t=this,n=e.map((function(e){return{source:t.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||null}}}));try{this.uppy.addFiles(n)}catch(e){this.uppy.log(e)}},a.onInputChange=function(e){this.uppy.log("[DragDrop] Files selected through input");var t=y(e.target.files);this.addFiles(t),e.target.value=null},a.handleDrop=function(e){var t=this;this.opts.onDrop&&this.opts.onDrop(e),e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1}),this.uppy.log("[DragDrop] Files were dropped");x(e.dataTransfer,{logDropError:function logDropError(e){t.uppy.log(e,"error")}}).then((function(e){return t.addFiles(e)}))},a.handleDragOver=function(e){this.opts.onDragOver&&this.opts.onDragOver(e),e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0})},a.handleDragLeave=function(e){var t=this;this.opts.onDragLeave&&this.opts.onDragLeave(e),e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout((function(){t.setPluginState({isDraggingOver:!1})}),50)},a.renderHiddenFileInput=function(){var e=this,t=this.uppy.opts.restrictions;return j("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:function(t){e.fileInputRef=t},name:this.opts.inputName,multiple:1!==t.maxNumberOfFiles,accept:t.allowedFileTypes,onChange:this.onInputChange})},r.renderArrowSvg=function(){return j("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},j("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"}))},a.renderLabel=function(){return j("div",{className:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:j("span",{className:"uppy-DragDrop-browse"},this.i18n("browse"))}))},a.renderNote=function(){return j("span",{className:"uppy-DragDrop-note"},this.opts.note)},a.render=function(){var e=this,t="uppy-Root\n      uppy-u-reset\n      uppy-DragDrop-container\n      "+(this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":"")+"\n      "+(this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":"")+"\n    ",n={width:this.opts.width,height:this.opts.height};return j("button",{type:"button",className:t,style:n,onClick:function(){return e.fileInputRef.click()},onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),j("div",{className:"uppy-DragDrop-inner"},r.renderArrowSvg(),this.renderLabel(),this.renderNote()))},a.install=function(){var e=this.opts.target;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)},a.uninstall=function(){this.unmount()},r}(p),r.VERSION="1.4.31",a)},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=n(145).Plugin,p=n(89).h;e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).id=r.opts.id||"ProgressBar",r.title="Progress Bar",r.type="progressindicator";return r.opts=l({},{target:"body",replaceTargetContent:!1,fixed:!1,hideAfterFinish:!0},n),r.render=r.render.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n);var a=r.prototype;return a.render=function(e){var t=e.totalProgress||0,n=(0===t||100===t)&&this.opts.hideAfterFinish;return p("div",{className:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":n},p("div",{className:"uppy-ProgressBar-inner",style:{width:t+"%"}}),p("div",{className:"uppy-ProgressBar-percentage"},t))},a.install=function(){var e=this.opts.target;e&&this.mount(e,this)},a.uninstall=function(){this.unmount()},r}(h),r.VERSION="1.3.30",a)},function(e,t,n){var r,a;function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=n(145).Plugin,f=n(247),y=n(214),w=n(89).h;e.exports=(a=r=function(e){var t,n;function r(t,n){var r;(r=e.call(this,t,n)||this).id=r.opts.id||"FileInput",r.title="File Input",r.type="acquirer",r.defaultLocale={strings:{chooseFiles:"Choose files"}};return r.opts=l({},{target:null,pretty:!0,inputName:"files[]"},n),r.i18nInit(),r.render=r.render.bind(d(r)),r.handleInputChange=r.handleInputChange.bind(d(r)),r.handleClick=r.handleClick.bind(d(r)),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var a=r.prototype;return a.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},a.i18nInit=function(){this.translator=new y([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},a.addFiles=function(e){var t=this,n=e.map((function(e){return{source:t.id,name:e.name,type:e.type,data:e}}));try{this.uppy.addFiles(n)}catch(e){this.uppy.log(e)}},a.handleInputChange=function(e){this.uppy.log("[FileInput] Something selected through input...");var t=f(e.target.files);this.addFiles(t),e.target.value=null},a.handleClick=function(e){this.input.click()},a.render=function(e){var t=this,n=this.uppy.opts.restrictions,r=n.allowedFileTypes?n.allowedFileTypes.join(","):null;return w("div",{className:"uppy-Root uppy-FileInput-container"},w("input",{className:"uppy-FileInput-input",style:this.opts.pretty&&{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},type:"file",name:this.opts.inputName,onChange:this.handleInputChange,multiple:1!==n.maxNumberOfFiles,accept:r,ref:function(e){t.input=e}}),this.opts.pretty&&w("button",{className:"uppy-FileInput-btn",type:"button",onClick:this.handleClick},this.i18n("chooseFiles")))},a.install=function(){var e=this.opts.target;e&&this.mount(e,this)},a.uninstall=function(){this.unmount()},r}(p),r.VERSION="1.5.2",a)},function(e,t,n){},function(e,t,n){},function(e,t,n){var r,a,l=n(588),d=n(589),h=0,p=0;e.exports=function(e,t,n){var f=t&&n||0,y=t||[],w=(e=e||{}).node||r,x=void 0!==e.clockseq?e.clockseq:a;if(null==w||null==x){var j=l();null==w&&(w=r=[1|j[0],j[1],j[2],j[3],j[4],j[5]]),null==x&&(x=a=16383&(j[6]<<8|j[7]))}var O=void 0!==e.msecs?e.msecs:(new Date).getTime(),C=void 0!==e.nsecs?e.nsecs:p+1,S=O-h+(C-p)/1e4;if(S<0&&void 0===e.clockseq&&(x=x+1&16383),(S<0||O>h)&&void 0===e.nsecs&&(C=0),C>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=O,p=C,a=x;var _=(1e4*(268435455&(O+=122192928e5))+C)%4294967296;y[f++]=_>>>24&255,y[f++]=_>>>16&255,y[f++]=_>>>8&255,y[f++]=255&_;var k=O/4294967296*1e4&268435455;y[f++]=k>>>8&255,y[f++]=255&k,y[f++]=k>>>24&15|16,y[f++]=k>>>16&255,y[f++]=x>>>8|128,y[f++]=255&x;for(var E=0;E<6;++E)y[f+E]=w[E];return t||d(y)}},function(e,t,n){var r=n(588),a=n(589);e.exports=function(e,t,n){var l=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var d=(e=e||{}).random||(e.rng||r)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,t)for(var h=0;h<16;++h)t[l+h]=d[h];return t||a(d)}},function(e,t,n){"use strict";var r=n(118),a=n(233),l=n(135);e.exports=function(e){for(var t=r(this),n=l(t),d=arguments.length,h=a(d>1?arguments[1]:void 0,n),p=d>2?arguments[2]:void 0,f=void 0===p?n:a(p,n);f>h;)t[h++]=e;return t}},function(e,t,n){(function(e){ace.define("ace/ext/searchbox",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),a=e("../lib/lang"),l=e("../lib/event"),d=e("../keyboard/hash_handler").HashHandler,h=e("../lib/keys");r.importCssString('.ace_search {background-color: #ddd;color: #666;border: 1px solid #cbcbcb;border-top: 0 none;overflow: hidden;margin: 0;padding: 4px 6px 0 4px;position: absolute;top: 0;z-index: 99;white-space: normal;}.ace_search.left {border-left: 0 none;border-radius: 0px 0px 5px 0px;left: 0;}.ace_search.right {border-radius: 0px 0px 0px 5px;border-right: 0 none;right: 0;}.ace_search_form, .ace_replace_form {margin: 0 20px 4px 0;overflow: hidden;line-height: 1.9;}.ace_replace_form {margin-right: 0;}.ace_search_form.ace_nomatch {outline: 1px solid red;}.ace_search_field {border-radius: 3px 0 0 3px;background-color: white;color: black;border: 1px solid #cbcbcb;border-right: 0 none;outline: 0;padding: 0;font-size: inherit;margin: 0;line-height: inherit;padding: 0 6px;min-width: 17em;vertical-align: top;min-height: 1.8em;box-sizing: content-box;}.ace_searchbtn {border: 1px solid #cbcbcb;line-height: inherit;display: inline-block;padding: 0 6px;background: #fff;border-right: 0 none;border-left: 1px solid #dcdcdc;cursor: pointer;margin: 0;position: relative;color: #666;}.ace_searchbtn:last-child {border-radius: 0 3px 3px 0;border-right: 1px solid #cbcbcb;}.ace_searchbtn:disabled {background: none;cursor: default;}.ace_searchbtn:hover {background-color: #eef1f6;}.ace_searchbtn.prev, .ace_searchbtn.next {padding: 0px 0.7em}.ace_searchbtn.prev:after, .ace_searchbtn.next:after {content: "";border: solid 2px #888;width: 0.5em;height: 0.5em;border-width:  2px 0 0 2px;display:inline-block;transform: rotate(-45deg);}.ace_searchbtn.next:after {border-width: 0 2px 2px 0 ;}.ace_searchbtn_close {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;border-radius: 50%;border: 0 none;color: #656565;cursor: pointer;font: 16px/16px Arial;padding: 0;height: 14px;width: 14px;top: 9px;right: 7px;position: absolute;}.ace_searchbtn_close:hover {background-color: #656565;background-position: 50% 100%;color: white;}.ace_button {margin-left: 2px;cursor: pointer;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;overflow: hidden;opacity: 0.7;border: 1px solid rgba(100,100,100,0.23);padding: 1px;box-sizing:    border-box!important;color: black;}.ace_button:hover {background-color: #eee;opacity:1;}.ace_button:active {background-color: #ddd;}.ace_button.checked {border-color: #3399ff;opacity:1;}.ace_search_options{margin-bottom: 3px;text-align: right;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;clear: both;}.ace_search_counter {float: left;font-family: arial;padding: 0 8px;}',"ace_searchbox");var p=function(e,t,n){var a=r.createElement("div");r.buildDom(["div",{class:"ace_search right"},["span",{action:"hide",class:"ace_searchbtn_close"}],["div",{class:"ace_search_form"},["input",{class:"ace_search_field",placeholder:"Search for",spellcheck:"false"}],["span",{action:"findPrev",class:"ace_searchbtn prev"},"​"],["span",{action:"findNext",class:"ace_searchbtn next"},"​"],["span",{action:"findAll",class:"ace_searchbtn",title:"Alt-Enter"},"All"]],["div",{class:"ace_replace_form"},["input",{class:"ace_search_field",placeholder:"Replace with",spellcheck:"false"}],["span",{action:"replaceAndFindNext",class:"ace_searchbtn"},"Replace"],["span",{action:"replaceAll",class:"ace_searchbtn"},"All"]],["div",{class:"ace_search_options"},["span",{action:"toggleReplace",class:"ace_button",title:"Toggle Replace mode",style:"float:left;margin-top:-2px;padding:0 5px;"},"+"],["span",{class:"ace_search_counter"}],["span",{action:"toggleRegexpMode",class:"ace_button",title:"RegExp Search"},".*"],["span",{action:"toggleCaseSensitive",class:"ace_button",title:"CaseSensitive Search"},"Aa"],["span",{action:"toggleWholeWords",class:"ace_button",title:"Whole Word Search"},"\\b"],["span",{action:"searchInSelection",class:"ace_button",title:"Search In Selection"},"S"]]],a),this.element=a.firstChild,this.setSession=this.setSession.bind(this),this.$init(),this.setEditor(e)};(function(){this.setEditor=function(e){e.searchBox=this,e.renderer.scroller.appendChild(this.element),this.editor=e},this.setSession=function(e){this.searchRange=null,this.$syncOptions(!0)},this.$initElements=function(e){this.searchBox=e.querySelector(".ace_search_form"),this.replaceBox=e.querySelector(".ace_replace_form"),this.searchOption=e.querySelector("[action=searchInSelection]"),this.replaceOption=e.querySelector("[action=toggleReplace]"),this.regExpOption=e.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=e.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=e.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field"),this.searchCounter=e.querySelector(".ace_search_counter")},this.$init=function(){var e=this.element;this.$initElements(e);var t=this;l.addListener(e,"mousedown",(function(e){setTimeout((function(){t.activeInput.focus()}),0),l.stopPropagation(e)})),l.addListener(e,"click",(function(e){var n=(e.target||e.srcElement).getAttribute("action");n&&t[n]?t[n]():t.$searchBarKb.commands[n]&&t.$searchBarKb.commands[n].exec(t),l.stopPropagation(e)})),l.addCommandKeyListener(e,(function(e,n,r){var a=h.keyCodeToString(r),d=t.$searchBarKb.findKeyCommand(n,a);d&&d.exec&&(d.exec(t),l.stopEvent(e))})),this.$onChange=a.delayedCall((function(){t.find(!1,!1)})),l.addListener(this.searchInput,"input",(function(){t.$onChange.schedule(20)})),l.addListener(this.searchInput,"focus",(function(){t.activeInput=t.searchInput,t.searchInput.value&&t.highlight()})),l.addListener(this.replaceInput,"focus",(function(){t.activeInput=t.replaceInput,t.searchInput.value&&t.highlight()}))},this.$closeSearchBarKb=new d([{bindKey:"Esc",name:"closeSearchBar",exec:function(e){e.searchBox.hide()}}]),this.$searchBarKb=new d,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f":function(e){var t=e.isReplace=!e.isReplace;e.replaceBox.style.display=t?"":"none",e.replaceOption.checked=!1,e.$syncOptions(),e.searchInput.focus()},"Ctrl-H|Command-Option-F":function(e){e.editor.getReadOnly()||(e.replaceOption.checked=!0,e.$syncOptions(),e.replaceInput.focus())},"Ctrl-G|Command-G":function(e){e.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(e){e.findPrev()},esc:function(e){setTimeout((function(){e.hide()}))},Return:function(e){e.activeInput==e.replaceInput&&e.replace(),e.findNext()},"Shift-Return":function(e){e.activeInput==e.replaceInput&&e.replace(),e.findPrev()},"Alt-Return":function(e){e.activeInput==e.replaceInput&&e.replaceAll(),e.findAll()},Tab:function(e){(e.activeInput==e.replaceInput?e.searchInput:e.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(e){e.regExpOption.checked=!e.regExpOption.checked,e.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(e){e.caseSensitiveOption.checked=!e.caseSensitiveOption.checked,e.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(e){e.wholeWordOption.checked=!e.wholeWordOption.checked,e.$syncOptions()}},{name:"toggleReplace",exec:function(e){e.replaceOption.checked=!e.replaceOption.checked,e.$syncOptions()}},{name:"searchInSelection",exec:function(e){e.searchOption.checked=!e.searchRange,e.setSearchRange(e.searchOption.checked&&e.editor.getSelectionRange()),e.$syncOptions()}}]),this.setSearchRange=function(e){this.searchRange=e,e?this.searchRangeMarker=this.editor.session.addMarker(e,"ace_active-line"):this.searchRangeMarker&&(this.editor.session.removeMarker(this.searchRangeMarker),this.searchRangeMarker=null)},this.$syncOptions=function(e){r.setCssClass(this.replaceOption,"checked",this.searchRange),r.setCssClass(this.searchOption,"checked",this.searchOption.checked),this.replaceOption.textContent=this.replaceOption.checked?"-":"+",r.setCssClass(this.regExpOption,"checked",this.regExpOption.checked),r.setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked),r.setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked);var t=this.editor.getReadOnly();this.replaceOption.style.display=t?"none":"",this.replaceBox.style.display=this.replaceOption.checked&&!t?"":"none",this.find(!1,!1,e)},this.highlight=function(e){this.editor.session.highlight(e||this.editor.$search.$options.re),this.editor.renderer.updateBackMarkers()},this.find=function(e,t,n){var a=!this.editor.find(this.searchInput.value,{skipCurrent:e,backwards:t,wrap:!0,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked,preventScroll:n,range:this.searchRange})&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",a),this.editor._emit("findSearchBox",{match:!a}),this.highlight(),this.updateCounter()},this.updateCounter=function(){var e=this.editor,t=e.$search.$options.re,n=0,r=0;if(t){var a=this.searchRange?e.session.getTextRange(this.searchRange):e.getValue(),l=e.session.doc.positionToIndex(e.selection.anchor);this.searchRange&&(l-=e.session.doc.positionToIndex(this.searchRange.start));for(var d,h=t.lastIndex=0;(d=t.exec(a))&&(n++,(h=d.index)<=l&&r++,!(n>999))&&(d[0]||(t.lastIndex=h+=1,!(h>=a.length))););}this.searchCounter.textContent=r+" of "+(n>999?"999+":n)},this.findNext=function(){this.find(!0,!1)},this.findPrev=function(){this.find(!0,!0)},this.findAll=function(){var e=!this.editor.findAll(this.searchInput.value,{regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked})&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",e),this.editor._emit("findSearchBox",{match:!e}),this.highlight(),this.hide()},this.replace=function(){this.editor.getReadOnly()||this.editor.replace(this.replaceInput.value)},this.replaceAndFindNext=function(){this.editor.getReadOnly()||(this.editor.replace(this.replaceInput.value),this.findNext())},this.replaceAll=function(){this.editor.getReadOnly()||this.editor.replaceAll(this.replaceInput.value)},this.hide=function(){this.active=!1,this.setSearchRange(null),this.editor.off("changeSession",this.setSession),this.element.style.display="none",this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb),this.editor.focus()},this.show=function(e,t){this.active=!0,this.editor.on("changeSession",this.setSession),this.element.style.display="",this.replaceOption.checked=t,e&&(this.searchInput.value=e),this.searchInput.focus(),this.searchInput.select(),this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb),this.$syncOptions(!0)},this.isFocused=function(){var e=document.activeElement;return e==this.searchInput||e==this.replaceInput}}).call(p.prototype),t.SearchBox=p,t.Search=function(e,t){(e.searchBox||new p(e)).show(e.session.getTextRange(),t)}})),ace.require(["ace/ext/searchbox"],(function(t){e&&(e.exports=t)}))}).call(this,n(151)(e))},function(e,t,n){(function(e){ace.define("ace/ext/modelist",[],(function(e,t,n){"use strict";var r=[];var a=function(e,t,n){var r;this.name=e,this.caption=t,this.mode="ace/mode/"+e,this.extensions=n,r=/\^/.test(n)?n.replace(/\|(\^)?/g,(function(e,t){return"$|"+(t?"^":"^.*\\.")}))+"$":"^.*\\.("+n+")$",this.extRe=new RegExp(r,"gi")};a.prototype.supportsFile=function(e){return e.match(this.extRe)};var l={ABAP:["abap"],ABC:["abc"],ActionScript:["as"],ADA:["ada|adb"],Alda:["alda"],Apache_Conf:["^htaccess|^htgroups|^htpasswd|^conf|htaccess|htgroups|htpasswd"],Apex:["apex|cls|trigger|tgr"],AQL:["aql"],AsciiDoc:["asciidoc|adoc"],ASL:["dsl|asl"],Assembly_x86:["asm|a"],AutoHotKey:["ahk"],BatchFile:["bat|cmd"],C_Cpp:["cpp|c|cc|cxx|h|hh|hpp|ino"],C9Search:["c9search_results"],Cirru:["cirru|cr"],Clojure:["clj|cljs"],Cobol:["CBL|COB"],coffee:["coffee|cf|cson|^Cakefile"],ColdFusion:["cfm"],Crystal:["cr"],CSharp:["cs"],Csound_Document:["csd"],Csound_Orchestra:["orc"],Csound_Score:["sco"],CSS:["css"],Curly:["curly"],D:["d|di"],Dart:["dart"],Diff:["diff|patch"],Dockerfile:["^Dockerfile"],Dot:["dot"],Drools:["drl"],Edifact:["edi"],Eiffel:["e|ge"],EJS:["ejs"],Elixir:["ex|exs"],Elm:["elm"],Erlang:["erl|hrl"],Forth:["frt|fs|ldr|fth|4th"],Fortran:["f|f90"],FSharp:["fsi|fs|ml|mli|fsx|fsscript"],FSL:["fsl"],FTL:["ftl"],Gcode:["gcode"],Gherkin:["feature"],Gitignore:["^.gitignore"],Glsl:["glsl|frag|vert"],Gobstones:["gbs"],golang:["go"],GraphQLSchema:["gql"],Groovy:["groovy"],HAML:["haml"],Handlebars:["hbs|handlebars|tpl|mustache"],Haskell:["hs"],Haskell_Cabal:["cabal"],haXe:["hx"],Hjson:["hjson"],HTML:["html|htm|xhtml|vue|we|wpy"],HTML_Elixir:["eex|html.eex"],HTML_Ruby:["erb|rhtml|html.erb"],INI:["ini|conf|cfg|prefs"],Io:["io"],Jack:["jack"],Jade:["jade|pug"],Java:["java"],JavaScript:["js|jsm|jsx"],JSON:["json"],JSON5:["json5"],JSONiq:["jq"],JSP:["jsp"],JSSM:["jssm|jssm_state"],JSX:["jsx"],Julia:["jl"],Kotlin:["kt|kts"],LaTeX:["tex|latex|ltx|bib"],LESS:["less"],Liquid:["liquid"],Lisp:["lisp"],LiveScript:["ls"],LogiQL:["logic|lql"],LSL:["lsl"],Lua:["lua"],LuaPage:["lp"],Lucene:["lucene"],Makefile:["^Makefile|^GNUmakefile|^makefile|^OCamlMakefile|make"],Markdown:["md|markdown"],Mask:["mask"],MATLAB:["matlab"],Maze:["mz"],MediaWiki:["wiki|mediawiki"],MEL:["mel"],MIXAL:["mixal"],MUSHCode:["mc|mush"],MySQL:["mysql"],Nginx:["nginx|conf"],Nim:["nim"],Nix:["nix"],NSIS:["nsi|nsh"],Nunjucks:["nunjucks|nunjs|nj|njk"],ObjectiveC:["m|mm"],OCaml:["ml|mli"],Pascal:["pas|p"],Perl:["pl|pm"],Perl6:["p6|pl6|pm6"],pgSQL:["pgsql"],PHP:["php|inc|phtml|shtml|php3|php4|php5|phps|phpt|aw|ctp|module"],PHP_Laravel_blade:["blade.php"],Pig:["pig"],Powershell:["ps1"],Praat:["praat|praatscript|psc|proc"],Prisma:["prisma"],Prolog:["plg|prolog"],Properties:["properties"],Protobuf:["proto"],Puppet:["epp|pp"],Python:["py"],QML:["qml"],R:["r"],Razor:["cshtml|asp"],RDoc:["Rd"],Red:["red|reds"],RHTML:["Rhtml"],RST:["rst"],Ruby:["rb|ru|gemspec|rake|^Guardfile|^Rakefile|^Gemfile"],Rust:["rs"],SASS:["sass"],SCAD:["scad"],Scala:["scala|sbt"],Scheme:["scm|sm|rkt|oak|scheme"],SCSS:["scss"],SH:["sh|bash|^.bashrc"],SJS:["sjs"],Slim:["slim|skim"],Smarty:["smarty|tpl"],snippets:["snippets"],Soy_Template:["soy"],Space:["space"],SQL:["sql"],SQLServer:["sqlserver"],Stylus:["styl|stylus"],SVG:["svg"],Swift:["swift"],Tcl:["tcl"],Terraform:["tf","tfvars","terragrunt"],Tex:["tex"],Text:["txt"],Textile:["textile"],Toml:["toml"],TSX:["tsx"],Twig:["latte|twig|swig"],Typescript:["ts|typescript|str"],Vala:["vala"],VBScript:["vbs|vb"],Velocity:["vm"],Verilog:["v|vh|sv|svh"],VHDL:["vhd|vhdl"],Visualforce:["vfp|component|page"],Wollok:["wlk|wpgm|wtest"],XML:["xml|rdf|rss|wsdl|xslt|atom|mathml|mml|xul|xbl|xaml"],XQuery:["xq"],YAML:["yaml|yml"],Zeek:["zeek|bro"],Django:["html"]},d={ObjectiveC:"Objective-C",CSharp:"C#",golang:"Go",C_Cpp:"C and C++",Csound_Document:"Csound Document",Csound_Orchestra:"Csound",Csound_Score:"Csound Score",coffee:"CoffeeScript",HTML_Ruby:"HTML (Ruby)",HTML_Elixir:"HTML (Elixir)",FTL:"FreeMarker",PHP_Laravel_blade:"PHP (Blade Template)",Perl6:"Perl 6",AutoHotKey:"AutoHotkey / AutoIt"},h={};for(var p in l){var f=l[p],y=(d[p]||p).replace(/_/g," "),w=p.toLowerCase(),x=new a(w,y,f[0]);h[w]=x,r.push(x)}n.exports={getModeForPath:function(e){for(var t=h.text,n=e.split(/[\/\\]/).pop(),a=0;a<r.length;a++)if(r[a].supportsFile(n)){t=r[a];break}return t},modes:r,modesByName:h}})),ace.require(["ace/ext/modelist"],(function(t){e&&(e.exports=t)}))}).call(this,n(151)(e))},function(e,t,n){(function(e){ace.define("ace/keyboard/vim",[],(function(e,t,n){"use strict";var r=e("../range").Range,a=e("../lib/event_emitter").EventEmitter,l=e("../lib/dom"),d=e("../lib/oop"),h=e("../lib/keys"),p=e("../lib/event"),f=e("../search").Search,y=e("../lib/useragent"),w=e("../search_highlight").SearchHighlight,x=e("../commands/multi_select_commands"),j=e("../mode/text").Mode.prototype.tokenRe;e("../multi_select");var O=function(e){this.ace=e,this.state={},this.marks={},this.$uid=0,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this),this.onBeforeEndOperation=this.onBeforeEndOperation.bind(this),this.ace.on("change",this.onChange),this.ace.on("changeSelection",this.onSelectionChange),this.ace.on("beforeEndOperation",this.onBeforeEndOperation)};function C(e){return{row:e.line,column:e.ch}}function S(e){return new A(e.row,e.column)}O.Pos=function(e,t){if(!(this instanceof A))return new A(e,t);this.line=e,this.ch=t},O.defineOption=function(e,t,n){},O.commands={redo:function(e){e.ace.redo()},undo:function(e){e.ace.undo()},newlineAndIndent:function(e){e.ace.insert("\n")}},O.keyMap={},O.addClass=O.rmClass=function(){},O.e_stop=O.e_preventDefault=p.stopEvent,O.keyName=function(e){var t=h[e.keyCode]||e.key||"";return 1==t.length&&(t=t.toUpperCase()),t=p.getModifierString(e).replace(/(^|-)\w/g,(function(e){return e.toUpperCase()}))+t},O.keyMap.default=function(e){return function(t){var n=t.ace.commands.commandKeyBinding[e.toLowerCase()];return n&&!1!==t.ace.execCommand(n)}},O.lookupKey=function e(t,n,r){n||(n="default"),"string"==typeof n&&(n=O.keyMap[n]);var a="function"==typeof n?n(t):n[t];if(!1===a)return"nothing";if("..."===a)return"multi";if(null!=a&&r(a))return"handled";if(n.fallthrough){if(!Array.isArray(n.fallthrough))return e(t,n.fallthrough,r);for(var l=0;l<n.fallthrough.length;l++){var d=e(t,n.fallthrough[l],r);if(d)return d}}},O.signal=function(e,t,n){return e._signal(t,n)},O.on=p.addListener,O.off=p.removeListener,O.isWordChar=function(e){return e<""?/^\w$/.test(e):(j.lastIndex=0,j.test(e))},function(){d.implement(O.prototype,a),this.destroy=function(){this.ace.off("change",this.onChange),this.ace.off("changeSelection",this.onSelectionChange),this.ace.off("beforeEndOperation",this.onBeforeEndOperation),this.removeOverlay()},this.virtualSelectionMode=function(){return this.ace.inVirtualSelectionMode&&this.ace.selection.index},this.onChange=function(e){var t={text:"i"==e.action[0]?e.lines:[]},n=this.curOp=this.curOp||{};n.changeHandlers||(n.changeHandlers=this._eventRegistry.change&&this._eventRegistry.change.slice()),n.lastChange?n.lastChange.next=n.lastChange=t:n.lastChange=n.change=t,this.$updateMarkers(e)},this.onSelectionChange=function(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._eventRegistry.cursorActivity&&this._eventRegistry.cursorActivity.slice()),this.curOp.cursorActivity=!0,this.ace.inMultiSelectMode&&this.ace.keyBinding.removeKeyboardHandler(x.keyboardHandler)},this.operation=function(e,t){if(!t&&this.curOp||t&&this.curOp&&this.curOp.force)return e();if(!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),!this.ace.curOp){var n=this.ace.prevOp;this.ace.startOperation({command:{name:"vim",scrollIntoView:"cursor"}})}var r=this.curOp=this.curOp||{};this.curOp.force=t;var a=e();return this.ace.curOp&&"vim"==this.ace.curOp.command.name&&(this.state.dialog&&(this.ace.curOp.command.scrollIntoView=!1),this.ace.endOperation(),r.cursorActivity||r.lastChange||!n||(this.ace.prevOp=n)),!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),a},this.onBeforeEndOperation=function(){var e=this.curOp;e&&(e.change&&this.signal("change",e.change,e),e&&e.cursorActivity&&this.signal("cursorActivity",null,e),this.curOp=null)},this.signal=function(e,t,n){var r=n?n[e+"Handlers"]:(this._eventRegistry||{})[e];if(r){r=r.slice();for(var a=0;a<r.length;a++)r[a](this,t)}},this.firstLine=function(){return 0},this.lastLine=function(){return this.ace.session.getLength()-1},this.lineCount=function(){return this.ace.session.getLength()},this.setCursor=function(e,t){"object"==typeof e&&(t=e.ch,e=e.line),this.ace.inVirtualSelectionMode||this.ace.exitMultiSelectMode(),this.ace.session.unfold({row:e,column:t}),this.ace.selection.moveTo(e,t)},this.getCursor=function(e){var t=this.ace.selection;return S("anchor"==e?t.isEmpty()?t.lead:t.anchor:"head"!=e&&e?t.getRange()[e]:t.lead)},this.listSelections=function(e){var t=this.ace.multiSelect.rangeList.ranges;return!t.length||this.ace.inVirtualSelectionMode?[{anchor:this.getCursor("anchor"),head:this.getCursor("head")}]:t.map((function(e){return{anchor:this.clipPos(S(e.cursor==e.end?e.start:e.end)),head:this.clipPos(S(e.cursor))}}),this)},this.setSelections=function(e,t){var n=this.ace.multiSelect,a=e.map((function(e){var t=C(e.anchor),n=C(e.head),a=r.comparePoints(t,n)<0?new r.fromPoints(t,n):new r.fromPoints(n,t);return a.cursor=r.comparePoints(a.start,n)?a.end:a.start,a}));if(this.ace.inVirtualSelectionMode)this.ace.selection.fromOrientedRange(a[0]);else{t?a[t]&&a.push(a.splice(t,1)[0]):a=a.reverse(),n.toSingleRange(a[0].clone());for(var l=this.ace.session,d=0;d<a.length;d++){var h=l.$clipRangeToDocument(a[d]);n.addRange(h)}}},this.setSelection=function(e,t,n){var r=this.ace.selection;r.moveTo(e.line,e.ch),r.selectTo(t.line,t.ch),n&&"*mouse"==n.origin&&this.onBeforeEndOperation()},this.somethingSelected=function(e){return!this.ace.selection.isEmpty()},this.clipPos=function(e){return S(this.ace.session.$clipPositionToDocument(e.line,e.ch))},this.markText=function(e){return{clear:function(){},find:function(){}}},this.$updateMarkers=function(e){var t="insert"==e.action,n=e.start,a=e.end,l=(a.row-n.row)*(t?1:-1),d=(a.column-n.column)*(t?1:-1);for(var h in t&&(a=n),this.marks){var p=this.marks[h],f=r.comparePoints(p,n);if(!(f<0)){if(0===f&&t){if(1!=p.bias){p.bias=-1;continue}f=1}var y=t?f:r.comparePoints(p,a);y>0?(p.row+=l,p.column+=p.row==a.row?d:0):!t&&y<=0&&(p.row=n.row,p.column=n.column,0===y&&(p.bias=1))}}};var e=function(e,t,n,r){this.cm=e,this.id=t,this.row=n,this.column=r,e.marks[this.id]=this};e.prototype.clear=function(){delete this.cm.marks[this.id]},e.prototype.find=function(){return S(this)},this.setBookmark=function(t,n){var r=new e(this,this.$uid++,t.line,t.ch);return n&&n.insertLeft||(r.$insertRight=!0),this.marks[r.id]=r,r},this.moveH=function(e,t){if("char"==t){var n=this.ace.selection;n.clearSelection(),n.moveCursorBy(0,e)}},this.findPosV=function(e,t,n,r){if("page"==n){var a=this.ace.renderer.layerConfig;t*=Math.floor(a.height/a.lineHeight),n="line"}if("line"==n){var l=this.ace.session.documentToScreenPosition(e.line,e.ch);return null!=r&&(l.column=r),l.row+=t,l.row=Math.min(Math.max(0,l.row),this.ace.session.getScreenLength()-1),S(this.ace.session.screenToDocumentPosition(l.row,l.column))}},this.charCoords=function(e,t){if("div"==t||!t)return{left:(r=this.ace.session.documentToScreenPosition(e.line,e.ch)).column,top:r.row};if("local"==t){var n=this.ace.renderer,r=this.ace.session.documentToScreenPosition(e.line,e.ch),a=n.layerConfig.lineHeight,l=n.layerConfig.characterWidth,d=a*r.row;return{left:r.column*l,top:d,bottom:d+a}}},this.coordsChar=function(e,t){var n=this.ace.renderer;if("local"==t){var r=Math.max(0,Math.floor(e.top/n.lineHeight)),a=Math.max(0,Math.floor(e.left/n.characterWidth));return S(n.session.screenToDocumentPosition(r,a))}if("div"==t)throw"not implemented"},this.getSearchCursor=function(e,t,n){var r=!1,a=!1;e instanceof RegExp&&!e.global&&(r=!e.ignoreCase,e=e.source,a=!0);var l=new f;null==t.ch&&(t.ch=Number.MAX_VALUE);var d={row:t.line,column:t.ch},h=this,p=null;return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){l.setOptions({needle:e,caseSensitive:r,wrap:!1,backwards:t,regExp:a,start:p||d});var n=l.find(h.ace.session);return n&&n.isEmpty()&&h.getLine(n.start.row).length==n.start.column&&(l.$options.start=n,n=l.find(h.ace.session)),p=n},from:function(){return p&&S(p.start)},to:function(){return p&&S(p.end)},replace:function(e){p&&(p.end=h.ace.session.doc.replace(p,e))}}},this.scrollTo=function(e,t){var n=this.ace.renderer,r=n.layerConfig,a=r.maxHeight;a-=(n.$size.scrollerHeight-n.lineHeight)*n.$scrollPastEnd,null!=t&&this.ace.session.setScrollTop(Math.max(0,Math.min(t,a))),null!=e&&this.ace.session.setScrollLeft(Math.max(0,Math.min(e,r.width)))},this.scrollInfo=function(){return 0},this.scrollIntoView=function(e,t){if(e){var n=this.ace.renderer,r={top:0,bottom:t};n.scrollCursorIntoView(C(e),2*n.lineHeight/n.$size.scrollerHeight,r)}},this.getLine=function(e){return this.ace.session.getLine(e)},this.getRange=function(e,t){return this.ace.session.getTextRange(new r(e.line,e.ch,t.line,t.ch))},this.replaceRange=function(e,t,n){return n||(n=t),this.ace.session.replace(new r(t.line,t.ch,n.line,n.ch),e)},this.replaceSelection=this.replaceSelections=function(e){var t=this.ace.selection;if(this.ace.inVirtualSelectionMode)this.ace.session.replace(t.getRange(),e[0]||"");else{t.inVirtualSelectionMode=!0;var n=t.rangeList.ranges;n.length||(n=[this.ace.multiSelect.getRange()]);for(var r=n.length;r--;)this.ace.session.replace(n[r],e[r]||"");t.inVirtualSelectionMode=!1}},this.getSelection=function(){return this.ace.getSelectedText()},this.getSelections=function(){return this.listSelections().map((function(e){return this.getRange(e.anchor,e.head)}),this)},this.getInputField=function(){return this.ace.textInput.getElement()},this.getWrapperElement=function(){return this.ace.container};var t={indentWithTabs:"useSoftTabs",indentUnit:"tabSize",tabSize:"tabSize",firstLineNumber:"firstLineNumber",readOnly:"readOnly"};this.setOption=function(e,n){switch(this.state[e]=n,e){case"indentWithTabs":e=t[e],n=!n;break;case"keyMap":return void(this.state.$keyMap=n);default:e=t[e]}e&&this.ace.setOption(e,n)},this.getOption=function(e,n){var r=t[e];switch(r&&(n=this.ace.getOption(r)),e){case"indentWithTabs":return e=t[e],!n;case"keyMap":return this.state.$keyMap}return r?n:this.state[e]},this.toggleOverwrite=function(e){return this.state.overwrite=e,this.ace.setOverwrite(e)},this.addOverlay=function(e){if(!this.$searchHighlight||!this.$searchHighlight.session){var t=new w(null,"ace_highlight-marker","text"),n=this.ace.session.addDynamicMarker(t);t.id=n.id,t.session=this.ace.session,t.destroy=function(e){t.session.off("change",t.updateOnChange),t.session.off("changeEditor",t.destroy),t.session.removeMarker(t.id),t.session=null},t.updateOnChange=function(e){var n=e.start.row;n==e.end.row?t.cache[n]=void 0:t.cache.splice(n,t.cache.length)},t.session.on("changeEditor",t.destroy),t.session.on("change",t.updateOnChange)}var r=new RegExp(e.query.source,"gmi");this.$searchHighlight=e.highlight=t,this.$searchHighlight.setRegexp(r),this.ace.renderer.updateBackMarkers()},this.removeOverlay=function(e){this.$searchHighlight&&this.$searchHighlight.session&&this.$searchHighlight.destroy()},this.getScrollInfo=function(){var e=this.ace.renderer,t=e.layerConfig;return{left:e.scrollLeft,top:e.scrollTop,height:t.maxHeight,width:t.width,clientHeight:t.height,clientWidth:t.width}},this.getValue=function(){return this.ace.getValue()},this.setValue=function(e){return this.ace.setValue(e,-1)},this.getTokenTypeAt=function(e){var t=this.ace.session.getTokenAt(e.line,e.ch);return t&&/comment|string/.test(t.type)?"string":""},this.findMatchingBracket=function(e){var t=this.ace.session.findMatchingBracket(C(e));return{to:t&&S(t)}},this.indentLine=function(e,t){!0===t?this.ace.session.indentRows(e,e,"\t"):!1===t&&this.ace.session.outdentRows(new r(e,0,e,0))},this.indexFromPos=function(e){return this.ace.session.doc.positionToIndex(C(e))},this.posFromIndex=function(e){return S(this.ace.session.doc.indexToPosition(e))},this.focus=function(e){return this.ace.textInput.focus()},this.blur=function(e){return this.ace.blur()},this.defaultTextHeight=function(e){return this.ace.renderer.layerConfig.lineHeight},this.scanForBracket=function(e,t,n,r){var a=r.bracketRegex.source,l=/paren|text|operator|tag/;if(1==t)var d=this.ace.session.$findClosingBracket(a.slice(1,2),C(e),l);else d=this.ace.session.$findOpeningBracket(a.slice(-2,-1),{row:e.line,column:e.ch+1},l);return d&&{pos:S(d)}},this.refresh=function(){return this.ace.resize(!0)},this.getMode=function(){return{name:this.getOption("mode")}},this.execCommand=function(e){"indentAuto"==e?this.ace.execCommand("autoindent"):console.log(e+" is not implemented")}}.call(O.prototype),(O.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0}).prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){throw"not implemented"},indentation:function(){throw"not implemented"},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}var a=function(e){return n?e.toLowerCase():e};if(a(this.string.substr(this.pos,e.length))==a(e))return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}},O.defineExtension=function(e,t){O.prototype[e]=t},l.importCssString(".normal-mode .ace_cursor{    border: none;    background-color: rgba(255,0,0,0.5);}.normal-mode .ace_hidden-cursors .ace_cursor{  background-color: transparent;  border: 1px solid red;  opacity: 0.7}.ace_dialog {  position: absolute;  left: 0; right: 0;  background: inherit;  z-index: 15;  padding: .1em .8em;  overflow: hidden;  color: inherit;}.ace_dialog-top {  border-bottom: 1px solid #444;  top: 0;}.ace_dialog-bottom {  border-top: 1px solid #444;  bottom: 0;}.ace_dialog input {  border: none;  outline: none;  background: transparent;  width: 20em;  color: inherit;  font-family: monospace;}","vimMode"),function(){function e(e,t,n){var r;return(r=e.ace.container.appendChild(document.createElement("div"))).className=n?"ace_dialog ace_dialog-bottom":"ace_dialog ace_dialog-top","string"==typeof t?r.innerHTML=t:r.appendChild(t),r}function t(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}O.defineExtension("openDialog",(function(n,r,a){if(!this.virtualSelectionMode()){a||(a={}),t(this,null);var l=e(this,n,a.bottom),d=!1,h=this;this.state.dialog=l;var p,f=l.getElementsByTagName("input")[0];return f?(a.value&&(f.value=a.value,!1!==a.selectValueOnOpen&&f.select()),a.onInput&&O.on(f,"input",(function(e){a.onInput(e,f.value,y)})),a.onKeyUp&&O.on(f,"keyup",(function(e){a.onKeyUp(e,f.value,y)})),O.on(f,"keydown",(function(e){a&&a.onKeyDown&&a.onKeyDown(e,f.value,y)||(13==e.keyCode&&r(f.value),(27==e.keyCode||!1!==a.closeOnEnter&&13==e.keyCode)&&(f.blur(),O.e_stop(e),y()))})),!1!==a.closeOnBlur&&O.on(f,"blur",y),f.focus()):(p=l.getElementsByTagName("button")[0])&&(O.on(p,"click",(function(){y(),h.focus()})),!1!==a.closeOnBlur&&O.on(p,"blur",y),p.focus()),y}function y(e){if("string"==typeof e)f.value=e;else{if(d)return;if(e&&"blur"==e.type&&document.activeElement===f)return;h.state.dialog=null,d=!0,l.parentNode.removeChild(l),h.focus(),a.onClose&&a.onClose(l)}}})),O.defineExtension("openNotification",(function(n,r){if(!this.virtualSelectionMode()){t(this,p);var a,l=e(this,n,r&&r.bottom),d=!1,h=r&&void 0!==r.duration?r.duration:5e3;return O.on(l,"click",(function(e){O.e_preventDefault(e),p()})),h&&(a=setTimeout(p,h)),p}function p(){d||(d=!0,clearTimeout(a),l.parentNode.removeChild(l))}}))}();var _=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<Del>",type:"keyToKey",toKeys:"x",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],k=_.length,E=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],A=O.Pos,T=function(){return de};function R(e,t){this==O.keyMap.vim&&O.rmClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==I||function(e){e.setOption("disableInput",!1),e.off("cursorActivity",Ct),O.off(e.getInputField(),"paste",L(e)),e.state.vim=null}(e)}function I(e,t){this==O.keyMap.vim&&O.addClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==I||function(e){e.setOption("disableInput",!0),e.setOption("showCursorWhenSelecting",!1),O.signal(e,"vim-mode-change",{mode:"normal"}),e.on("cursorActivity",Ct),ce(e),O.on(e.getInputField(),"paste",L(e))}(e)}function P(e,t){if(t){if(this[e])return this[e];var n=function(e){if("'"==e.charAt(0))return e.charAt(1);var t=e.split(/-(?!$)/),n=t[t.length-1];if(1==t.length&&1==t[0].length)return!1;if(2==t.length&&"Shift"==t[0]&&1==n.length)return!1;for(var r=!1,a=0;a<t.length;a++){var l=t[a];l in D?t[a]=D[l]:r=!0,l in M&&(t[a]=M[l])}if(!r)return!1;Y(n)&&(t[t.length-1]=n.toLowerCase());return"<"+t.join("-")+">"}(e);if(!n)return!1;var r=O.Vim.findKey(t,n);return"function"==typeof r&&O.signal(t,"vim-keypress",n),r}}O.defineOption("vimMode",!1,(function(e,t,n){t&&"vim"!=e.getOption("keyMap")?e.setOption("keyMap","vim"):!t&&n!=O.Init&&/^vim/.test(e.getOption("keyMap"))&&e.setOption("keyMap","default")}));var D={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},M={Enter:"CR",Backspace:"BS",Delete:"Del",Insert:"Ins"};function L(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(Ce(e.getCursor(),0,1)),xe.enterInsertMode(e,{},t))}),t.onPasteFn}var F=/[\d]/,q=[O.isWordChar,function(e){return e&&!O.isWordChar(e)&&!/\s/.test(e)}],N=[function(e){return/\S/.test(e)}];function B(e,t){for(var n=[],r=e;r<e+t;r++)n.push(String.fromCharCode(r));return n}var U=B(65,26),H=B(97,26),z=B(48,10),V=[].concat(U,H,z,["<",">"]),W=[].concat(U,H,z,["-",'"',".",":","/"]);function K(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function G(e){return/^[a-z]$/.test(e)}function Y(e){return/^[A-Z]$/.test(e)}function X(e){return/^\s*$/.test(e)}function J(e){return-1!=".?!".indexOf(e)}function Q(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}var Z={};function ee(e,t,n,r,a){if(void 0===t&&!a)throw Error("defaultValue is required unless callback is provided");if(n||(n="string"),Z[e]={type:n,defaultValue:t,callback:a},r)for(var l=0;l<r.length;l++)Z[r[l]]=Z[e];t&&te(e,t)}function te(e,t,n,r){var a=Z[e],l=(r=r||{}).scope;if(!a)return new Error("Unknown option: "+e);if("boolean"==a.type){if(t&&!0!==t)return new Error("Invalid argument: "+e+"="+t);!1!==t&&(t=!0)}a.callback?("local"!==l&&a.callback(t,void 0),"global"!==l&&n&&a.callback(t,n)):("local"!==l&&(a.value="boolean"==a.type?!!t:t),"global"!==l&&n&&(n.state.vim.options[e]={value:t}))}function ne(e,t,n){var r=Z[e],a=(n=n||{}).scope;if(!r)return new Error("Unknown option: "+e);if(r.callback){var l=t&&r.callback(void 0,t);return"global"!==a&&void 0!==l?l:"local"!==a?r.callback():void 0}return((l="global"!==a&&t&&t.state.vim.options[e])||"local"!==a&&r||{}).value}ee("filetype",void 0,"string",["ft"],(function(e,t){if(void 0!==t){if(void 0===e)return"null"==(n=t.getOption("mode"))?"":n;var n=""==e?"null":e;t.setOption("mode",n)}}));var re,oe,ae=function(){var e=-1,t=0,n=0,r=new Array(100);function a(a,l){(e+=l)>t?e=t:e<n&&(e=n);var d=r[(100+e)%100];if(d&&!d.find()){var h,p=l>0?1:-1,f=a.getCursor();do{if((d=r[(100+(e+=p))%100])&&(h=d.find())&&!Ee(f,h))break}while(e<t&&e>n)}return d}return{cachedCursor:void 0,add:function(a,l,d){var h=r[e%100];function p(t){var n=++e%100,l=r[n];l&&l.clear(),r[n]=a.setBookmark(t)}if(h){var f=h.find();f&&!Ee(f,l)&&p(l)}else p(l);p(d),t=e,(n=e-100+1)<0&&(n=0)},find:function(t,n){var r=e,l=a(t,n);return e=r,l&&l.find()},move:a}},se=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};function le(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=se()}function ce(e){return e.state.vim||(e.state.vim={inputState:new he,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),e.state.vim}function ue(){for(var e in re={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:ae(),macroModeState:new le,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new ge({}),searchHistoryController:new me,exCommandHistoryController:new me},Z){var t=Z[e];t.value=t.defaultValue}}le.prototype={exitMacroRecordMode:function(){var e=re.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=re.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,e.openDialog&&(this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0})),this.isRecording=!0)}};var de={buildKeyMap:function(){},getRegisterController:function(){return re.registerController},resetVimGlobalState_:ue,getVimGlobalState_:function(){return re},maybeInitVimState_:ce,suppressErrorLogging:!1,InsertModeKey:kt,map:function(e,t,n){yt.map(e,t,n)},unmap:function(e,t){yt.unmap(e,t)},noremap:function(e,t,n){function r(e){return e?[e]:["normal","insert","visual"]}for(var a=r(n),l=_.length,d=l-k;d<l&&a.length;d++){var h=_[d];if(!(h.keys!=t||n&&h.context&&h.context!==n||"ex"===h.type.substr(0,2)||"key"===h.type.substr(0,3))){var p={};for(var f in h)p[f]=h[f];p.keys=e,n&&!p.context&&(p.context=n),this._mapCommand(p);var y=r(h.context);a=a.filter((function(e){return-1===y.indexOf(e)}))}}},mapclear:function(e){var t=_.length,n=k,r=_.slice(0,t-n);if(_=_.slice(t-n),e)for(var a=r.length-1;a>=0;a--){var l=r[a];if(e!==l.context)if(l.context)this._mapCommand(l);else{var d=["normal","insert","visual"];for(var h in d)if(d[h]!==e){var p={};for(var f in l)p[f]=l[f];p.context=d[h],this._mapCommand(p)}}}},setOption:te,getOption:ne,defineOption:ee,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;bt[e]=n,yt.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){var r=this.findKey(e,t,n);if("function"==typeof r)return r()},findKey:function(e,t,n){var r,a=ce(e);function l(){var r=re.macroModeState;if(r.isRecording){if("q"==t)return r.exitMacroRecordMode(),pe(e),!0;"mapping"!=n&&function(e,t){if(e.isPlaying)return;var n=e.latestRegister,r=re.registerController.getRegister(n);r&&r.pushText(t)}(r,t)}}function d(){if("<Esc>"==t)return pe(e),a.visualMode?Be(e):a.insertMode&&wt(e),!0}return!1===(r=a.insertMode?function(){if(d())return!0;for(var n=a.inputState.keyBuffer=a.inputState.keyBuffer+t,r=1==t.length,l=ve.matchCommand(n,_,a.inputState,"insert");n.length>1&&"full"!=l.type;){n=a.inputState.keyBuffer=n.slice(1);var h=ve.matchCommand(n,_,a.inputState,"insert");"none"!=h.type&&(l=h)}if("none"==l.type)return pe(e),!1;if("partial"==l.type)return oe&&window.clearTimeout(oe),oe=window.setTimeout((function(){a.insertMode&&a.inputState.keyBuffer&&pe(e)}),ne("insertModeEscKeysTimeout")),!r;if(oe&&window.clearTimeout(oe),r){for(var p=e.listSelections(),f=0;f<p.length;f++){var y=p[f].head;e.replaceRange("",Ce(y,0,-(n.length-1)),y,"+input")}re.macroModeState.lastInsertModeChanges.changes.pop()}return pe(e),l.command}():function(){if(l()||d())return!0;var n=a.inputState.keyBuffer=a.inputState.keyBuffer+t;if(/^[1-9]\d*$/.test(n))return!0;if(!(r=/^(\d*)(.*)$/.exec(n)))return pe(e),!1;var r,h=a.visualMode?"visual":"normal",p=ve.matchCommand(r[2]||r[1],_,a.inputState,h);return"none"==p.type?(pe(e),!1):"partial"==p.type||(a.inputState.keyBuffer="",(r=/^(\d*)(.*)$/.exec(n))[1]&&"0"!=r[1]&&a.inputState.pushRepeatDigit(r[1]),p.command)}())?void 0:!0===r?function(){return!0}:function(){if(!r.operator&&!r.isEdit||!e.getOption("readOnly"))return e.operation((function(){e.curOp.isVimOp=!0;try{"keyToKey"==r.type?function(n){for(var r;n;)r=/<\w+-.+?>|<\w+>|./.exec(n),t=r[0],n=n.substring(r.index+t.length),O.Vim.handleKey(e,t,"mapping")}(r.toKeys):ve.processCommand(e,a,r)}catch(t){throw e.state.vim=void 0,ce(e),O.Vim.suppressErrorLogging||console.log(t),t}return!0}))}},handleEx:function(e,t){yt.processCommand(e,t)},defineMotion:function(e,t){be[e]=t},defineAction:function(e,t){xe[e]=t},defineOperator:function(e,t){we[e]=t},mapCommand:function(e,t,n,r,a){var l={keys:e,type:t};for(var d in l[t]=n,l[t+"Args"]=r,a)l[d]=a[d];xt(l)},_mapCommand:xt,defineRegister:function(e,t){var n=re.registerController.registers;if(!e||1!=e.length)throw Error("Register name must be 1 character");n[e]=t,W.push(e)},exitVisualMode:Be,exitInsertMode:wt};function he(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function pe(e,t){e.state.vim.inputState=new he,O.signal(e,"vim-command-done",t)}function fe(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}function ge(e){this.registers=e,this.unnamedRegister=e['"']=new fe,e["."]=new fe,e[":"]=new fe,e["/"]=new fe}function me(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}he.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},he.prototype.getRepeat=function(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e},fe.prototype={setText:function(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push(se(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},ge.prototype={pushText:function(e,t,n,r,a){r&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var l=this.isValidRegister(e)?this.getRegister(e):null;if(l){Y(e)?l.pushText(n,r):l.setText(n,r,a),this.unnamedRegister.setText(l.toString(),r)}else{switch(t){case"yank":this.registers[0]=new fe(n,r,a);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new fe(n,r):(this.shiftNumericRegisters_(),this.registers[1]=new fe(n,r))}this.unnamedRegister.setText(n,r,a)}},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new fe),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&Q(e,W)},shiftNumericRegisters_:function(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}},me.prototype={nextMatch:function(e,t){var n=this.historyBuffer,r=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var a=this.iterator+r;t?a>=0:a<n.length;a+=r)for(var l=n[a],d=0;d<=l.length;d++)if(this.initialPrefix==l.substring(0,d))return this.iterator=a,l;return a>=n.length?(this.iterator=n.length,this.initialPrefix):a<0?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var ve={matchCommand:function(e,t,n,r){var a,l=function(e,t,n,r){for(var a,l=[],d=[],h=0;h<t.length;h++){var p=t[h];"insert"==n&&"insert"!=p.context||p.context&&p.context!=n||r.operator&&"action"==p.type||!(a=Se(e,p.keys))||("partial"==a&&l.push(p),"full"==a&&d.push(p))}return{partial:l.length&&l,full:d.length&&d}}(e,t,r,n);if(!l.full&&!l.partial)return{type:"none"};if(!l.full&&l.partial)return{type:"partial"};for(var d=0;d<l.full.length;d++){var h=l.full[d];a||(a=h)}if("<character>"==a.keys.slice(-11)){var p=function(e){var t=/^.*(<[^>]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(n.length>1)switch(n){case"<CR>":n="\n";break;case"<Space>":n=" ";break;default:n=""}return n}(e);if(/<C-.>/.test(p)||!p)return{type:"none"};n.selectedCharacter=p}return{type:"full",command:a}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=Oe(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var r=t.inputState;if(r.operator){if(r.operator==n.operator)return r.motion="expandToLine",r.motionArgs={linewise:!0},void this.evalInput(e,t);pe(e)}r.operator=n.operator,r.operatorArgs=Oe(n.operatorArgs),n.exitVisualBlock&&(t.visualBlock=!1,qe(e)),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var r=t.visualMode,a=Oe(n.operatorMotionArgs);a&&r&&a.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),r||this.processMotion(e,t,n)},processAction:function(e,t,n){var r=t.inputState,a=r.getRepeat(),l=!!a,d=Oe(n.actionArgs)||{};r.selectedCharacter&&(d.selectedCharacter=r.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),d.repeat=a||1,d.repeatIsExplicit=l,d.registerName=r.registerName,pe(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,r,n),xe[n.action](e,d,t)},processSearch:function(e,t,n){if(e.getSearchCursor){var r=n.searchArgs.forward,a=n.searchArgs.wholeWordOnly;et(e).setReversed(!r);var l=r?"/":"?",d=et(e).getQuery(),h=e.getScrollInfo();switch(n.searchArgs.querySrc){case"prompt":var p=re.macroModeState;if(p.isPlaying)x(w=p.replaySearchQueries.shift(),!0,!1);else ct(e,{onClose:function(t){e.scrollTo(h.left,h.top),x(t,!0,!0);var n=re.macroModeState;n.isRecording&&function(e,t){if(e.isPlaying)return;var n=e.latestRegister,r=re.registerController.getRegister(n);r&&r.pushSearchQuery&&r.pushSearchQuery(t)}(n,t)},prefix:l,desc:lt,onKeyUp:function(t,n,a){var l,d,p,f=O.keyName(t);"Up"==f||"Down"==f?(l="Up"==f,d=t.target?t.target.selectionEnd:0,a(n=re.searchHistoryController.nextMatch(n,l)||""),d&&t.target&&(t.target.selectionEnd=t.target.selectionStart=Math.min(d,t.target.value.length))):"Left"!=f&&"Right"!=f&&"Ctrl"!=f&&"Alt"!=f&&"Shift"!=f&&re.searchHistoryController.reset();try{p=ut(e,n,!0,!0)}catch(t){}p?e.scrollIntoView(ht(e,!r,p),30):(pt(e),e.scrollTo(h.left,h.top))},onKeyDown:function(t,n,r){var a=O.keyName(t);"Esc"==a||"Ctrl-C"==a||"Ctrl-["==a||"Backspace"==a&&""==n?(re.searchHistoryController.pushInput(n),re.searchHistoryController.reset(),ut(e,d),pt(e),e.scrollTo(h.left,h.top),O.e_stop(t),pe(e),r(),e.focus()):"Up"==a||"Down"==a?O.e_stop(t):"Ctrl-U"==a&&(O.e_stop(t),r(""))}});break;case"wordUnderCursor":var f=He(e,!1,!0,!1,!0),y=!0;if(f||(f=He(e,!1,!0,!1,!1),y=!1),!f)return;var w=e.getLine(f.start.line).substring(f.start.ch,f.end.ch);w=y&&a?"\\b"+w+"\\b":function(e){return e.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}(w),re.jumpList.cachedCursor=e.getCursor(),e.setCursor(f.start),x(w,!0,!1)}}function x(r,a,l){re.searchHistoryController.pushInput(r),re.searchHistoryController.reset();try{ut(e,r,a,l)}catch(t){return st(e,"Invalid regex: "+r),void pe(e)}ve.processMotion(e,t,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:n.searchArgs.toJumplist}})}},processEx:function(e,t,n){function r(t){re.exCommandHistoryController.pushInput(t),re.exCommandHistoryController.reset(),yt.processCommand(e,t)}function a(t,n,r){var a,l,d=O.keyName(t);("Esc"==d||"Ctrl-C"==d||"Ctrl-["==d||"Backspace"==d&&""==n)&&(re.exCommandHistoryController.pushInput(n),re.exCommandHistoryController.reset(),O.e_stop(t),pe(e),r(),e.focus()),"Up"==d||"Down"==d?(O.e_stop(t),a="Up"==d,l=t.target?t.target.selectionEnd:0,r(n=re.exCommandHistoryController.nextMatch(n,a)||""),l&&t.target&&(t.target.selectionEnd=t.target.selectionStart=Math.min(l,t.target.value.length))):"Ctrl-U"==d?(O.e_stop(t),r("")):"Left"!=d&&"Right"!=d&&"Ctrl"!=d&&"Alt"!=d&&"Shift"!=d&&re.exCommandHistoryController.reset()}"keyToEx"==n.type?yt.processCommand(e,n.exArgs.input):t.visualMode?ct(e,{onClose:r,prefix:":",value:"'<,'>",onKeyDown:a,selectValueOnOpen:!1}):ct(e,{onClose:r,prefix:":",onKeyDown:a})},evalInput:function(e,t){var n,r,a,l=t.inputState,d=l.motion,h=l.motionArgs||{},p=l.operator,f=l.operatorArgs||{},y=l.registerName,w=t.sel,x=ke(t.visualMode?je(e,w.head):e.getCursor("head")),j=ke(t.visualMode?je(e,w.anchor):e.getCursor("anchor")),O=ke(x),C=ke(j);if(p&&this.recordLastEdit(t,l),(a=void 0!==l.repeatOverride?l.repeatOverride:l.getRepeat())>0&&h.explicitRepeat?h.repeatIsExplicit=!0:(h.noRepeat||!h.explicitRepeat&&0===a)&&(a=1,h.repeatIsExplicit=!1),l.selectedCharacter&&(h.selectedCharacter=f.selectedCharacter=l.selectedCharacter),h.repeat=a,pe(e),d){var S=be[d](e,x,h,t);if(t.lastMotion=be[d],!S)return;if(h.toJumplist){p||null==e.ace.curOp||(e.ace.curOp.command.scrollIntoView="center-animate");var _=re.jumpList,k=_.cachedCursor;k?(ze(e,k,S),delete _.cachedCursor):ze(e,x,S)}S instanceof Array?(r=S[0],n=S[1]):n=S,n||(n=ke(x)),t.visualMode?(t.visualBlock&&n.ch===1/0||(n=je(e,n,t.visualBlock)),r&&(r=je(e,r,!0)),r=r||C,w.anchor=r,w.head=n,qe(e),Xe(e,t,"<",Ae(r,n)?r:n),Xe(e,t,">",Ae(r,n)?n:r)):p||(n=je(e,n),e.setCursor(n.line,n.ch))}if(p){if(f.lastSel){r=C;var E=f.lastSel,T=Math.abs(E.head.line-E.anchor.line),R=Math.abs(E.head.ch-E.anchor.ch);n=E.visualLine?A(C.line+T,C.ch):E.visualBlock?A(C.line+T,C.ch+R):E.head.line==E.anchor.line?A(C.line,C.ch+R):A(C.line+T,C.ch),t.visualMode=!0,t.visualLine=E.visualLine,t.visualBlock=E.visualBlock,w=t.sel={anchor:r,head:n},qe(e)}else t.visualMode&&(f.lastSel={anchor:ke(w.anchor),head:ke(w.head),visualBlock:t.visualBlock,visualLine:t.visualLine});var I,P,D,M,L;if(t.visualMode){if(I=$e(w.head,w.anchor),P=Te(w.head,w.anchor),D=t.visualLine||f.linewise,L=Ne(e,{anchor:I,head:P},M=t.visualBlock?"block":D?"line":"char"),D){var F=L.ranges;if("block"==M)for(var q=0;q<F.length;q++)F[q].head.ch=Ie(e,F[q].head.line);else"line"==M&&(F[0].head=A(F[0].head.line+1,0))}}else{if(I=ke(r||C),Ae(P=ke(n||O),I)){var N=I;I=P,P=N}(D=h.linewise||f.linewise)?function(e,t,n){t.ch=0,n.ch=0,n.line++}(0,I,P):h.forward&&function(e,t,n){var r=e.getRange(t,n);if(/\n\s*$/.test(r)){var a=r.split("\n");a.pop();for(var l=a.pop();a.length>0&&l&&X(l);l=a.pop())n.line--,n.ch=0;l?(n.line--,n.ch=Ie(e,n.line)):n.ch=0}}(e,I,P),L=Ne(e,{anchor:I,head:P},M="char",!h.inclusive||D)}e.setSelections(L.ranges,L.primary),t.lastMotion=null,f.repeat=a,f.registerName=y,f.linewise=D;var B=we[p](e,f,L.ranges,C,n);t.visualMode&&Be(e,null!=B),B&&e.setCursor(B)}},recordLastEdit:function(e,t,n){var r=re.macroModeState;r.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,r.lastInsertModeChanges.changes=[],r.lastInsertModeChanges.expectCursorActivityForChange=!1,r.lastInsertModeChanges.visualBlock=e.visualBlock?e.sel.head.line-e.sel.anchor.line:0)}},be={moveToTopLine:function(e,t,n){var r=ft(e).top+n.repeat-1;return A(r,Ue(e.getLine(r)))},moveToMiddleLine:function(e){var t=ft(e),n=Math.floor(.5*(t.top+t.bottom));return A(n,Ue(e.getLine(n)))},moveToBottomLine:function(e,t,n){var r=ft(e).bottom-n.repeat+1;return A(r,Ue(e.getLine(r)))},expandToLine:function(e,t,n){return A(t.line+n.repeat-1,1/0)},findNext:function(e,t,n){var r=et(e),a=r.getQuery();if(a){var l=!n.forward;return l=r.isReversed()?!l:l,dt(e,a),ht(e,l,a,n.repeat)}},goToMark:function(e,t,n,r){var a=gt(e,r,n.selectedCharacter);return a?n.linewise?{line:a.line,ch:Ue(e.getLine(a.line))}:a:null},moveToOtherHighlightedEnd:function(e,t,n,r){if(r.visualBlock&&n.sameLine){var a=r.sel;return[je(e,A(a.anchor.line,a.head.ch)),je(e,A(a.head.line,a.anchor.ch))]}return[r.sel.head,r.sel.anchor]},jumpToMark:function(e,t,n,r){for(var a=t,l=0;l<n.repeat;l++){var d=a;for(var h in r.marks)if(G(h)){var p=r.marks[h].find();if(!((n.forward?Ae(p,d):Ae(d,p))||n.linewise&&p.line==d.line)){var f=Ee(d,a),y=n.forward?Re(d,p,a):Re(a,p,d);(f||y)&&(a=p)}}}return n.linewise&&(a=A(a.line,Ue(e.getLine(a.line)))),a},moveByCharacters:function(e,t,n){var r=t,a=n.repeat,l=n.forward?r.ch+a:r.ch-a;return A(r.line,l)},moveByLines:function(e,t,n,r){var a=t,l=a.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:l=r.lastHPos;break;default:r.lastHPos=l}var d=n.repeat+(n.repeatOffset||0),h=n.forward?a.line+d:a.line-d,p=e.firstLine(),f=e.lastLine();if(h<p&&a.line==p)return this.moveToStartOfLine(e,t,n,r);if(h>f&&a.line==f)return this.moveToEol(e,t,n,r,!0);var y=e.ace.session.getFoldLine(h);return y&&(n.forward?h>y.start.row&&(h=y.end.row+1):h=y.start.row),n.toFirstChar&&(l=Ue(e.getLine(h)),r.lastHPos=l),r.lastHSPos=e.charCoords(A(h,l),"div").left,A(h,l)},moveByDisplayLines:function(e,t,n,r){var a=t;switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(a,"div").left}var l=n.repeat;if((h=e.findPosV(a,n.forward?l:-l,"line",r.lastHSPos)).hitSide)if(n.forward)var d={top:e.charCoords(h,"div").top+8,left:r.lastHSPos},h=e.coordsChar(d,"div");else{var p=e.charCoords(A(e.firstLine(),0),"div");p.left=r.lastHSPos,h=e.coordsChar(p,"div")}return r.lastHPos=h.ch,h},moveByPage:function(e,t,n){var r=t,a=n.repeat;return e.findPosV(r,n.forward?a:-a,"page")},moveByParagraph:function(e,t,n){var r=n.forward?1:-1;return Qe(e,t,n.repeat,r)},moveBySentence:function(e,t,n){var r=n.forward?1:-1;return function(e,t,n,r){function a(e,t){if(t.pos+t.dir<0||t.pos+t.dir>=t.line.length){if(t.ln+=t.dir,!K(e,t.ln))return t.line=null,t.ln=null,void(t.pos=null);t.line=e.getLine(t.ln),t.pos=t.dir>0?0:t.line.length-1}else t.pos+=t.dir}function l(e,t,n,r){var l=""===(f=e.getLine(t)),d={line:f,ln:t,pos:n,dir:r},h={ln:d.ln,pos:d.pos},p=""===d.line;for(a(e,d);null!==d.line;){if(h.ln=d.ln,h.pos=d.pos,""===d.line&&!p)return{ln:d.ln,pos:d.pos};if(l&&""!==d.line&&!X(d.line[d.pos]))return{ln:d.ln,pos:d.pos};!J(d.line[d.pos])||l||d.pos!==d.line.length-1&&!X(d.line[d.pos+1])||(l=!0),a(e,d)}var f=e.getLine(h.ln);h.pos=0;for(var y=f.length-1;y>=0;--y)if(!X(f[y])){h.pos=y;break}return h}function d(e,t,n,r){var l={line:p=e.getLine(t),ln:t,pos:n,dir:r},d={ln:l.ln,pos:null},h=""===l.line;for(a(e,l);null!==l.line;){if(""===l.line&&!h)return null!==d.pos?d:{ln:l.ln,pos:l.pos};if(J(l.line[l.pos])&&null!==d.pos&&(l.ln!==d.ln||l.pos+1!==d.pos))return d;""===l.line||X(l.line[l.pos])||(h=!1,d={ln:l.ln,pos:l.pos}),a(e,l)}var p=e.getLine(d.ln);d.pos=0;for(var f=0;f<p.length;++f)if(!X(p[f])){d.pos=f;break}return d}var h={ln:t.line,pos:t.ch};for(;n>0;)h=r<0?d(e,h.ln,h.pos,r):l(e,h.ln,h.pos,r),n--;return A(h.ln,h.pos)}(e,t,n.repeat,r)},moveByScroll:function(e,t,n,r){var a=e.getScrollInfo(),l=null,d=n.repeat;d||(d=a.clientHeight/(2*e.defaultTextHeight()));var h=e.charCoords(t,"local");if(n.repeat=d,!(l=be.moveByDisplayLines(e,t,n,r)))return null;var p=e.charCoords(l,"local");return e.scrollTo(null,a.top+p.top-h.top),l},moveByWords:function(e,t,n){return function(e,t,n,r,a,l){var d=ke(t),h=[];(r&&!a||!r&&a)&&n++;for(var p=!(r&&a),f=0;f<n;f++){var y=Ge(e,t,r,l,p);if(!y){var w=Ie(e,e.lastLine());h.push(r?{line:e.lastLine(),from:w,to:w}:{line:0,from:0,to:0});break}h.push(y),t=A(y.line,r?y.to-1:y.from)}var x=h.length!=n,j=h[0],O=h.pop();return r&&!a?(x||j.from==d.ch&&j.line==d.line||(O=h.pop()),A(O.line,O.from)):r&&a?A(O.line,O.to-1):!r&&a?(x||j.to==d.ch&&j.line==d.line||(O=h.pop()),A(O.line,O.to)):A(O.line,O.from)}(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var r=Ye(e,n.repeat,n.forward,n.selectedCharacter),a=n.forward?-1:1;return Ve(a,n),r?(r.ch+=a,r):null},moveToCharacter:function(e,t,n){var r=n.repeat;return Ve(0,n),Ye(e,r,n.forward,n.selectedCharacter)||t},moveToSymbol:function(e,t,n){return function(e,t,n,r){var a=ke(e.getCursor()),l=n?1:-1,d=n?e.lineCount():-1,h=a.ch,p=a.line,f=e.getLine(p),y={lineText:f,nextCh:f.charAt(h),lastCh:null,index:h,symb:r,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[r],forward:n,depth:0,curMoveThrough:!1},w=We[r];if(!w)return a;var x=Ke[w].init,j=Ke[w].isComplete;x&&x(y);for(;p!==d&&t;){if(y.index+=l,y.nextCh=y.lineText.charAt(y.index),!y.nextCh){if(p+=l,y.lineText=e.getLine(p)||"",l>0)y.index=0;else{var O=y.lineText.length;y.index=O>0?O-1:0}y.nextCh=y.lineText.charAt(y.index)}j(y)&&(a.line=p,a.ch=y.index,t--)}if(y.nextCh||y.curMoveThrough)return A(p,y.index);return a}(e,n.repeat,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,r){var a=n.repeat;return r.lastHPos=a-1,r.lastHSPos=e.charCoords(t,"div").left,function(e,t){var n=e.getCursor().line;return je(e,A(n,t-1))}(e,a)},moveToEol:function(e,t,n,r,a){var l=A(t.line+n.repeat-1,1/0),d=e.clipPos(l);return d.ch--,a||(r.lastHPos=1/0,r.lastHSPos=e.charCoords(d,"div").left),l},moveToFirstNonWhiteSpaceCharacter:function(e,t){var n=t;return A(n.line,Ue(e.getLine(n.line)))},moveToMatchedSymbol:function(e,t){for(var n,r=t,a=r.line,l=r.ch,d=e.getLine(a);l<d.length;l++)if((n=d.charAt(l))&&-1!="()[]{}".indexOf(n)){var h=e.getTokenTypeAt(A(a,l+1));if("string"!==h&&"comment"!==h)break}if(l<d.length){var p=/[<>]/.test(d[l])?/[(){}[\]<>]/:/[(){}[\]]/;return e.findMatchingBracket(A(a,l+1),{bracketRegex:p}).to}return r},moveToStartOfLine:function(e,t){return A(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var r=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(r=n.repeat-e.getOption("firstLineNumber")),A(r,Ue(e.getLine(r)))},textObjectManipulation:function(e,t,n,r){var a=n.selectedCharacter;"b"==a?a="(":"B"==a&&(a="{");var l,d=!n.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"}[a])l=function(e,t,n,r){var a,l,d=t,h={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[n],p={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[n],f=e.getLine(d.line).charAt(d.ch)===p?1:0;if(a=e.scanForBracket(A(d.line,d.ch+f),-1,void 0,{bracketRegex:h}),l=e.scanForBracket(A(d.line,d.ch+f),1,void 0,{bracketRegex:h}),!a||!l)return{start:d,end:d};if(a=a.pos,l=l.pos,a.line==l.line&&a.ch>l.ch||a.line>l.line){var y=a;a=l,l=y}r?l.ch+=1:a.ch+=1;return{start:a,end:l}}(e,t,a,d);else if({"'":!0,'"':!0,"`":!0}[a])l=function(e,t,n,r){var a,l,d,h,p=ke(t),f=e.getLine(p.line).split(""),y=f.indexOf(n);p.ch<y?p.ch=y:y<p.ch&&f[p.ch]==n&&(l=p.ch,--p.ch);if(f[p.ch]!=n||l)for(d=p.ch;d>-1&&!a;d--)f[d]==n&&(a=d+1);else a=p.ch+1;if(a&&!l)for(d=a,h=f.length;d<h&&!l;d++)f[d]==n&&(l=d);if(!a||!l)return{start:p,end:p};r&&(--a,++l);return{start:A(p.line,a),end:A(p.line,l)}}(e,t,a,d);else if("W"===a)l=He(e,d,!0,!0);else if("w"===a)l=He(e,d,!0,!1);else{if("p"!==a)return null;if(l=Qe(e,t,n.repeat,0,d),n.linewise=!0,r.visualMode)r.visualLine||(r.visualLine=!0);else{var h=r.inputState.operatorArgs;h&&(h.linewise=!0),l.end.line--}}return e.state.vim.visualMode?function(e,t,n){var r,a=e.state.vim.sel,l=a.head,d=a.anchor;Ae(n,t)&&(r=n,n=t,t=r);Ae(l,d)?(l=$e(t,l),d=Te(d,n)):(d=$e(t,d),-1==(l=Ce(l=Te(l,n),0,-1)).ch&&l.line!=e.firstLine()&&(l=A(l.line-1,Ie(e,l.line-1))));return[d,l]}(e,l.start,l.end):[l.start,l.end]},repeatLastCharacterSearch:function(e,t,n){var r=re.lastCharacterSearch,a=n.repeat,l=n.forward===r.forward,d=(r.increment?1:0)*(l?-1:1);e.moveH(-d,"char"),n.inclusive=!!l;var h=Ye(e,a,l,r.selectedCharacter);return h?(h.ch+=d,h):(e.moveH(d,"char"),t)}};function ye(e,t){for(var n=[],r=0;r<t;r++)n.push(e);return n}var we={change:function(e,t,n){var r,a,l=e.state.vim,d=n[0].anchor,h=n[0].head;if(l.visualMode)if(t.fullLine)h.ch=Number.MAX_VALUE,h.line--,e.setSelection(d,h),a=e.getSelection(),e.replaceSelection(""),r=d;else{a=e.getSelection();var p=ye("",n.length);e.replaceSelections(p),r=$e(n[0].head,n[0].anchor)}else{a=e.getRange(d,h);var f=l.lastEditInputState||{};if("moveByWords"==f.motion&&!X(a)){var y=/\s+$/.exec(a);y&&f.motionArgs&&f.motionArgs.forward&&(h=Ce(h,0,-y[0].length),a=a.slice(0,-y[0].length))}var w=new A(d.line-1,Number.MAX_VALUE),x=e.firstLine()==e.lastLine();h.line>e.lastLine()&&t.linewise&&!x?e.replaceRange("",w,h):e.replaceRange("",d,h),t.linewise&&(x||(e.setCursor(w),O.commands.newlineAndIndent(e)),d.ch=Number.MAX_VALUE),r=d}re.registerController.pushText(t.registerName,"change",a,t.linewise,n.length>1),xe.enterInsertMode(e,{head:r},e.state.vim)},delete:function(e,t,n){var r,a,l=e.state.vim;if(l.visualBlock){a=e.getSelection();var d=ye("",n.length);e.replaceSelections(d),r=n[0].anchor}else{var h=n[0].anchor,p=n[0].head;t.linewise&&p.line!=e.firstLine()&&h.line==e.lastLine()&&h.line==p.line-1&&(h.line==e.firstLine()?h.ch=0:h=A(h.line-1,Ie(e,h.line-1))),a=e.getRange(h,p),e.replaceRange("",h,p),r=h,t.linewise&&(r=be.moveToFirstNonWhiteSpaceCharacter(e,h))}return re.registerController.pushText(t.registerName,"delete",a,t.linewise,l.visualBlock),je(e,r,l.insertMode)},indent:function(e,t,n){var r=e.state.vim,a=n[0].anchor.line,l=r.visualBlock?n[n.length-1].anchor.line:n[0].head.line,d=r.visualMode?t.repeat:1;t.linewise&&l--;for(var h=a;h<=l;h++)for(var p=0;p<d;p++)e.indentLine(h,t.indentRight);return be.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},indentAuto:function(e,t,n){return e.execCommand("indentAuto"),be.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},changeCase:function(e,t,n,r,a){for(var l=e.getSelections(),d=[],h=t.toLower,p=0;p<l.length;p++){var f=l[p],y="";if(!0===h)y=f.toLowerCase();else if(!1===h)y=f.toUpperCase();else for(var w=0;w<f.length;w++){var x=f.charAt(w);y+=Y(x)?x.toLowerCase():x.toUpperCase()}d.push(y)}return e.replaceSelections(d),t.shouldMoveCursor?a:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?be.moveToFirstNonWhiteSpaceCharacter(e,r):t.linewise?r:$e(n[0].anchor,n[0].head)},yank:function(e,t,n,r){var a=e.state.vim,l=e.getSelection(),d=a.visualMode?$e(a.sel.anchor,a.sel.head,n[0].head,n[0].anchor):r;return re.registerController.pushText(t.registerName,"yank",l,t.linewise,a.visualBlock),d}};var xe={jumpListWalk:function(e,t,n){if(!n.visualMode){var r=t.repeat,a=t.forward,l=re.jumpList.move(e,a?r:-r),d=l?l.find():void 0;d=d||e.getCursor(),e.setCursor(d),e.ace.curOp.command.scrollIntoView="center-animate"}},scroll:function(e,t,n){if(!n.visualMode){var r=t.repeat||1,a=e.defaultTextHeight(),l=e.getScrollInfo().top,d=a*r,h=t.forward?l+d:l-d,p=ke(e.getCursor()),f=e.charCoords(p,"local");if(t.forward)h>f.top?(p.line+=(h-f.top)/a,p.line=Math.ceil(p.line),e.setCursor(p),f=e.charCoords(p,"local"),e.scrollTo(null,f.top)):e.scrollTo(null,h);else{var y=h+e.getScrollInfo().clientHeight;y<f.bottom?(p.line-=(f.bottom-y)/a,p.line=Math.floor(p.line),e.setCursor(p),f=e.charCoords(p,"local"),e.scrollTo(null,f.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,h)}}},scrollToCursor:function(e,t){var n=e.getCursor().line,r=e.charCoords(A(n,0),"local"),a=e.getScrollInfo().clientHeight,l=r.top,d=r.bottom-l;switch(t.position){case"center":l=l-a/2+d;break;case"bottom":l=l-a+d}e.scrollTo(null,l)},replayMacro:function(e,t,n){var r=t.selectedCharacter,a=t.repeat,l=re.macroModeState;for("@"==r?r=l.latestRegister:l.latestRegister=r;a--;)jt(e,n,l,r)},enterMacroRecordMode:function(e,t){var n=re.macroModeState,r=t.selectedCharacter;re.registerController.isValidRegister(r)&&n.enterMacroRecordMode(e,r)},toggleOverwrite:function(e){e.state.overwrite?(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),O.signal(e,"vim-mode-change",{mode:"insert"})):(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),O.signal(e,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(e,t,n){if(!e.getOption("readOnly")){n.insertMode=!0,n.insertModeRepeat=t&&t.repeat||1;var r=t?t.insertAt:null,a=n.sel,l=t.head||e.getCursor("head"),d=e.listSelections().length;if("eol"==r)l=A(l.line,Ie(e,l.line));else if("bol"==r)l=A(l.line,0);else if("charAfter"==r)l=Ce(l,0,1);else if("firstNonBlank"==r)l=be.moveToFirstNonWhiteSpaceCharacter(e,l);else if("startOfSelectedArea"==r){if(!n.visualMode)return;n.visualBlock?(l=A(Math.min(a.head.line,a.anchor.line),Math.min(a.head.ch,a.anchor.ch)),d=Math.abs(a.head.line-a.anchor.line)+1):l=a.head.line<a.anchor.line?a.head:A(a.anchor.line,0)}else if("endOfSelectedArea"==r){if(!n.visualMode)return;n.visualBlock?(l=A(Math.min(a.head.line,a.anchor.line),Math.max(a.head.ch+1,a.anchor.ch)),d=Math.abs(a.head.line-a.anchor.line)+1):l=a.head.line>=a.anchor.line?Ce(a.head,0,1):A(a.anchor.line,0)}else if("inplace"==r){if(n.visualMode)return}else"lastEdit"==r&&(l=mt(e)||l);e.setOption("disableInput",!1),t&&t.replace?(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),O.signal(e,"vim-mode-change",{mode:"replace"})):(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),O.signal(e,"vim-mode-change",{mode:"insert"})),re.macroModeState.isPlaying||(e.on("change",Ot),O.on(e.getInputField(),"keydown",Et)),n.visualMode&&Be(e),Le(e,l,d)}},toggleVisualMode:function(e,t,n){var r,a=t.repeat,l=e.getCursor();n.visualMode?n.visualLine^t.linewise||n.visualBlock^t.blockwise?(n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,O.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),qe(e)):Be(e):(n.visualMode=!0,n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,r=je(e,A(l.line,l.ch+a-1),!0),n.sel={anchor:l,head:r},O.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),qe(e),Xe(e,n,"<",$e(l,r)),Xe(e,n,">",Te(l,r)))},reselectLastSelection:function(e,t,n){var r=n.lastSelection;if(n.visualMode&&Fe(e,n),r){var a=r.anchorMark.find(),l=r.headMark.find();if(!a||!l)return;n.sel={anchor:a,head:l},n.visualMode=!0,n.visualLine=r.visualLine,n.visualBlock=r.visualBlock,qe(e),Xe(e,n,"<",$e(a,l)),Xe(e,n,">",Te(a,l)),O.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""})}},joinLines:function(e,t,n){var r,a;if(n.visualMode){if(r=e.getCursor("anchor"),Ae(a=e.getCursor("head"),r)){var l=a;a=r,r=l}a.ch=Ie(e,a.line)-1}else{var d=Math.max(t.repeat,2);r=e.getCursor(),a=je(e,A(r.line+d-1,1/0))}for(var h=0,p=r.line;p<a.line;p++){h=Ie(e,r.line);l=A(r.line+1,Ie(e,r.line+1));var f=e.getRange(r,l);f=t.keepSpaces?f.replace(/\n\r?/g,""):f.replace(/\n\s*/g," "),e.replaceRange(f,r,l)}var y=A(r.line,h);n.visualMode&&Be(e,!1),e.setCursor(y)},newLineAndEnterInsertMode:function(e,t,n){n.insertMode=!0;var r=ke(e.getCursor());r.line!==e.firstLine()||t.after?(r.line=t.after?r.line:r.line-1,r.ch=Ie(e,r.line),e.setCursor(r),(O.commands.newlineAndIndentContinueComment||O.commands.newlineAndIndent)(e)):(e.replaceRange("\n",A(e.firstLine(),0)),e.setCursor(e.firstLine(),0));this.enterInsertMode(e,{repeat:t.repeat},n)},paste:function(e,t,n){var r=ke(e.getCursor()),a=re.registerController.getRegister(t.registerName);if(x=a.toString()){if(t.matchIndent){var l=e.getOption("tabSize"),d=function(e){var t=e.split("\t").length-1,n=e.split(" ").length-1;return t*l+1*n},h=e.getLine(e.getCursor().line),p=d(h.match(/^\s*/)[0]),f=x.replace(/\n$/,""),y=x!==f,w=d(x.match(/^\s*/)[0]),x=f.replace(/^\s*/gm,(function(t){var n=p+(d(t)-w);if(n<0)return"";if(e.getOption("indentWithTabs")){var r=Math.floor(n/l);return Array(r+1).join("\t")}return Array(n+1).join(" ")}));x+=y?"\n":""}if(t.repeat>1)x=Array(t.repeat+1).join(x);var j,O,C=a.linewise,S=a.blockwise;if(S){x=x.split("\n"),C&&x.pop();for(var _=0;_<x.length;_++)x[_]=""==x[_]?" ":x[_];r.ch+=t.after?1:0,r.ch=Math.min(Ie(e,r.line),r.ch)}else C?n.visualMode?x=n.visualLine?x.slice(0,-1):"\n"+x.slice(0,x.length-1)+"\n":t.after?(x="\n"+x.slice(0,x.length-1),r.ch=Ie(e,r.line)):r.ch=0:r.ch+=t.after?1:0;if(n.visualMode){var k;n.lastPastedText=x;var E=function(e,t){var n=t.lastSelection;return t.visualMode?function(){var t=e.listSelections(),n=t[0],r=t[t.length-1];return[Ae(n.anchor,n.head)?n.anchor:n.head,Ae(r.anchor,r.head)?r.head:r.anchor]}():function(){var t=e.getCursor(),r=e.getCursor(),a=n.visualBlock;if(a){var l=a.width,d=a.height;r=A(t.line+d,t.ch+l);for(var h=[],p=t.line;p<r.line;p++){var f={anchor:A(p,t.ch),head:A(p,r.ch)};h.push(f)}e.setSelections(h)}else{var y=n.anchorMark.find(),w=n.headMark.find(),x=w.line-y.line,j=w.ch-y.ch;r={line:r.line+x,ch:x?r.ch:j+r.ch},n.visualLine&&(t=A(t.line,0),r=A(r.line,Ie(e,r.line))),e.setSelection(t,r)}return[t,r]}()}(e,n),T=E[0],R=E[1],I=e.getSelection(),P=e.listSelections(),D=new Array(P.length).join("1").split("1");n.lastSelection&&(k=n.lastSelection.headMark.find()),re.registerController.unnamedRegister.setText(I),S?(e.replaceSelections(D),R=A(T.line+x.length-1,T.ch),e.setCursor(T),Me(e,R),e.replaceSelections(x),j=T):n.visualBlock?(e.replaceSelections(D),e.setCursor(T),e.replaceRange(x,T,T),j=T):(e.replaceRange(x,T,R),j=e.posFromIndex(e.indexFromPos(T)+x.length-1)),k&&(n.lastSelection.headMark=e.setBookmark(k)),C&&(j.ch=0)}else if(S){e.setCursor(r);for(_=0;_<x.length;_++){var M=r.line+_;M>e.lastLine()&&e.replaceRange("\n",A(M,0)),Ie(e,M)<r.ch&&De(e,M,r.ch)}e.setCursor(r),Me(e,A(r.line+x.length-1,r.ch)),e.replaceSelections(x),j=r}else e.replaceRange(x,r),C&&t.after?j=A(r.line+1,Ue(e.getLine(r.line+1))):C&&!t.after?j=A(r.line,Ue(e.getLine(r.line))):!C&&t.after?(O=e.indexFromPos(r),j=e.posFromIndex(O+x.length-1)):(O=e.indexFromPos(r),j=e.posFromIndex(O+x.length));n.visualMode&&Be(e,!1),e.setCursor(j)}},undo:function(e,t){e.operation((function(){_e(e,O.commands.undo,t.repeat)(),e.setCursor(e.getCursor("anchor"))}))},redo:function(e,t){_e(e,O.commands.redo,t.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){Xe(e,n,t.selectedCharacter,e.getCursor())},replace:function(e,t,n){var r,a,l=t.selectedCharacter,d=e.getCursor(),h=e.listSelections();if(n.visualMode)d=e.getCursor("start"),a=e.getCursor("end");else{var p=e.getLine(d.line);(r=d.ch+t.repeat)>p.length&&(r=p.length),a=A(d.line,r)}if("\n"==l)n.visualMode||e.replaceRange("",d,a),(O.commands.newlineAndIndentContinueComment||O.commands.newlineAndIndent)(e);else{var f=e.getRange(d,a);if(f=f.replace(/[^\n]/g,l),n.visualBlock){var y=new Array(e.getOption("tabSize")+1).join(" ");f=(f=e.getSelection()).replace(/\t/g,y).replace(/[^\n]/g,l).split("\n"),e.replaceSelections(f)}else e.replaceRange(f,d,a);n.visualMode?(d=Ae(h[0].anchor,h[0].head)?h[0].anchor:h[0].head,e.setCursor(d),Be(e,!1)):e.setCursor(Ce(a,0,-1))}},incrementNumberToken:function(e,t){for(var n,r,a,l,d=e.getCursor(),h=e.getLine(d.line),p=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi;null!==(n=p.exec(h))&&(a=(r=n.index)+n[0].length,!(d.ch<a)););if((t.backtrack||!(a<=d.ch))&&n){var f=n[2]||n[4],y=n[3]||n[5],w=t.increase?1:-1,x={"0b":2,0:8,"":10,"0x":16}[f.toLowerCase()];l=(parseInt(n[1]+y,x)+w*t.repeat).toString(x);var j=f?new Array(y.length-l.length+1+n[1].length).join("0"):"";l="-"===l.charAt(0)?"-"+f+j+l.substr(1):f+j+l;var O=A(d.line,r),C=A(d.line,a);e.replaceRange(l,O,C),e.setCursor(A(d.line,r+l.length-1))}},repeatLastEdit:function(e,t,n){if(n.lastEditInputState){var r=t.repeat;r&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=r:r=n.lastEditInputState.repeatOverride||r,At(e,n,r,!1)}},indent:function(e,t){e.indentLine(e.getCursor().line,t.indentRight)},exitInsertMode:wt};function je(e,t,n){var r=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),a=Ie(e,r)-1;a=n?a+1:a;var l=Math.min(Math.max(0,t.ch),a);return A(r,l)}function Oe(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Ce(e,t,n){return"object"==typeof t&&(n=t.ch,t=t.line),A(e.line+t,e.ch+n)}function Se(e,t){if("<character>"==t.slice(-11)){var n=t.length-11,r=e.slice(0,n),a=t.slice(0,n);return r==a&&e.length>n?"full":0==a.indexOf(r)&&"partial"}return e==t?"full":0==t.indexOf(e)&&"partial"}function _e(e,t,n){return function(){for(var r=0;r<n;r++)t(e)}}function ke(e){return A(e.line,e.ch)}function Ee(e,t){return e.ch==t.ch&&e.line==t.line}function Ae(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function $e(e,t){return arguments.length>2&&(t=$e.apply(void 0,Array.prototype.slice.call(arguments,1))),Ae(e,t)?e:t}function Te(e,t){return arguments.length>2&&(t=Te.apply(void 0,Array.prototype.slice.call(arguments,1))),Ae(e,t)?t:e}function Re(e,t,n){var r=Ae(e,t),a=Ae(t,n);return r&&a}function Ie(e,t){return e.getLine(t).length}function Pe(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function De(e,t,n){var r=Ie(e,t),a=new Array(n-r+1).join(" ");e.setCursor(A(t,r)),e.replaceRange(a,e.getCursor())}function Me(e,t){var n=[],r=e.listSelections(),a=ke(e.clipPos(t)),l=!Ee(t,a),d=function(e,t,n){for(var r=0;r<e.length;r++){var a="head"!=n&&Ee(e[r].anchor,t),l="anchor"!=n&&Ee(e[r].head,t);if(a||l)return r}return-1}(r,e.getCursor("head")),h=Ee(r[d].head,r[d].anchor),p=r.length-1,f=p-d>d?p:0,y=r[f].anchor,w=Math.min(y.line,a.line),x=Math.max(y.line,a.line),j=y.ch,O=a.ch,C=r[f].head.ch-j,S=O-j;C>0&&S<=0?(j++,l||O--):C<0&&S>=0?(j--,h||O++):C<0&&-1==S&&(j--,O++);for(var _=w;_<=x;_++){var k={anchor:new A(_,j),head:new A(_,O)};n.push(k)}return e.setSelections(n),t.ch=O,y.ch=j,y}function Le(e,t,n){for(var r=[],a=0;a<n;a++){var l=Ce(t,a,0);r.push({anchor:l,head:l})}e.setSelections(r,0)}function Fe(e,t){var n=t.sel.anchor,r=t.sel.head;t.lastPastedText&&(r=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(r),anchor:ke(n),head:ke(r),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function qe(e,t,n){var r=e.state.vim,a=Ne(e,t=t||r.sel,n=n||r.visualLine?"line":r.visualBlock?"block":"char");e.setSelections(a.ranges,a.primary),St(e)}function Ne(e,t,n,r){var a=ke(t.head),l=ke(t.anchor);if("char"==n){var d=r||Ae(t.head,t.anchor)?0:1,h=Ae(t.head,t.anchor)?1:0;return a=Ce(t.head,0,d),{ranges:[{anchor:l=Ce(t.anchor,0,h),head:a}],primary:0}}if("line"==n){if(Ae(t.head,t.anchor))a.ch=0,l.ch=Ie(e,l.line);else{l.ch=0;var p=e.lastLine();a.line>p&&(a.line=p),a.ch=Ie(e,a.line)}return{ranges:[{anchor:l,head:a}],primary:0}}if("block"==n){for(var f=Math.min(l.line,a.line),y=Math.min(l.ch,a.ch),w=Math.max(l.line,a.line),x=Math.max(l.ch,a.ch)+1,j=w-f+1,O=a.line==f?0:j-1,C=[],S=0;S<j;S++)C.push({anchor:A(f+S,y),head:A(f+S,x)});return{ranges:C,primary:O}}}function Be(e,t){var n=e.state.vim;!1!==t&&e.setCursor(je(e,n.sel.head)),Fe(e,n),n.visualMode=!1,n.visualLine=!1,n.visualBlock=!1,O.signal(e,"vim-mode-change",{mode:"normal"}),n.fakeCursor&&n.fakeCursor.clear()}function Ue(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function He(e,t,n,r,a){for(var l=function(e){var t=e.getCursor("head");return 1==e.getSelection().length&&(t=$e(t,e.getCursor("anchor"))),t}(e),d=e.getLine(l.line),h=l.ch,p=a?q[0]:N[0];!p(d.charAt(h));)if(++h>=d.length)return null;r?p=N[0]:(p=q[0])(d.charAt(h))||(p=q[1]);for(var f=h,y=h;p(d.charAt(f))&&f<d.length;)f++;for(;p(d.charAt(y))&&y>=0;)y--;if(y++,t){for(var w=f;/\s/.test(d.charAt(f))&&f<d.length;)f++;if(w==f){for(var x=y;/\s/.test(d.charAt(y-1))&&y>0;)y--;y||(y=x)}}return{start:A(l.line,y),end:A(l.line,f)}}function ze(e,t,n){Ee(t,n)||re.jumpList.add(e,t,n)}function Ve(e,t){re.lastCharacterSearch.increment=e,re.lastCharacterSearch.forward=t.forward,re.lastCharacterSearch.selectedCharacter=t.selectedCharacter}var We={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Ke={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};function Ge(e,t,n,r,a){var l=t.line,d=t.ch,h=e.getLine(l),p=n?1:-1,f=r?N:q;if(a&&""==h){if(l+=p,h=e.getLine(l),!K(e,l))return null;d=n?0:h.length}for(;;){if(a&&""==h)return{from:0,to:0,line:l};for(var y=p>0?h.length:-1,w=y,x=y;d!=y;){for(var j=!1,O=0;O<f.length&&!j;++O)if(f[O](h.charAt(d))){for(w=d;d!=y&&f[O](h.charAt(d));)d+=p;if(j=w!=(x=d),w==t.ch&&l==t.line&&x==w+p)continue;return{from:Math.min(w,x+1),to:Math.max(w,x),line:l}}j||(d+=p)}if(!K(e,l+=p))return null;h=e.getLine(l),d=p>0?0:h.length}}function Ye(e,t,n,r){for(var a,l=e.getCursor(),d=l.ch,h=0;h<t;h++){if(-1==(a=Je(d,e.getLine(l.line),r,n,!0)))return null;d=a}return A(e.getCursor().line,a)}function Xe(e,t,n,r){Q(n,V)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(r))}function Je(e,t,n,r,a){var l;return r?-1==(l=t.indexOf(n,e+1))||a||(l-=1):-1==(l=t.lastIndexOf(n,e-1))||a||(l+=1),l}function Qe(e,t,n,r,a){var l,d=t.line,h=e.firstLine(),p=e.lastLine(),f=d;function y(t){return!/\S/.test(e.getLine(t))}function w(e,t,n){return n?y(e)!=y(e+t):!y(e)&&y(e+t)}function x(t){r=r>0?1:-1;var n=e.ace.session.getFoldLine(t);n&&t+r>n.start.row&&t+r<n.end.row&&(r=(r>0?n.end.row:n.start.row)-t)}if(r){for(;h<=f&&f<=p&&n>0;)x(f),w(f,r)&&n--,f+=r;return new A(f,0)}var j=e.state.vim;if(j.visualLine&&w(d,1,!0)){var O=j.sel.anchor;w(O.line,-1,!0)&&(a&&O.line==d||(d+=1))}var C=y(d);for(f=d;f<=p&&n;f++)w(f,1,!0)&&(a&&y(f)==C||n--);for(l=new A(f,0),f>p&&!C?C=!0:a=!1,f=d;f>h&&(a&&y(f)!=C&&f!=d||!w(f,-1,!0));f--);return{start:new A(f,0),end:l}}function Ze(){}function et(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new Ze)}function tt(e,t,n,r,a){e.openDialog?e.openDialog(t,r,{bottom:!0,value:a.value,onKeyDown:a.onKeyDown,onKeyUp:a.onKeyUp,selectValueOnOpen:!1,onClose:function(){e.state.vim&&(e.state.vim.status="",e.ace.renderer.$loop.schedule(e.ace.renderer.CHANGE_CURSOR))}}):r(prompt(n,""))}function nt(e,t){var n=rt(e,t)||[];if(!n.length)return[];var r=[];if(0===n[0]){for(var a=0;a<n.length;a++)"number"==typeof n[a]&&r.push(e.substring(n[a]+1,n[a+1]));return r}}function rt(e,t){t||(t="/");for(var n=!1,r=[],a=0;a<e.length;a++){var l=e.charAt(a);n||l!=t||r.push(a),n=!n&&"\\"==l}return r}ee("pcre",!0,"boolean"),Ze.prototype={getQuery:function(){return re.query},setQuery:function(e){re.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return re.isReversed},setReversed:function(e){re.isReversed=e},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(e){this.annotate=e}};var it={"\\n":"\n","\\r":"\r","\\t":"\t"};var ot={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"};function at(e,t,n){if(re.registerController.getRegister("/").setText(e),e instanceof RegExp)return e;var r,a,l=rt(e,"/");l.length?(r=e.substring(0,l[0]),a=-1!=e.substring(l[0]).indexOf("i")):r=e;return r?(ne("pcre")||(r=function(e){for(var t=!1,n=[],r=-1;r<e.length;r++){var a=e.charAt(r)||"",l=e.charAt(r+1)||"",d=l&&-1!="|(){".indexOf(l);t?("\\"===a&&d||n.push(a),t=!1):"\\"===a?(t=!0,l&&-1!="}".indexOf(l)&&(d=!0),d&&"\\"!==l||n.push(a)):(n.push(a),d&&"\\"!==l&&n.push("\\"))}return n.join("")}(r)),n&&(t=/^[^A-Z]*$/.test(r)),new RegExp(r,t||a?"i":void 0)):null}function st(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}var lt="(Javascript regexp)";function ct(e,t){var n,r,a,l=(t.prefix||"")+" "+(t.desc||"");tt(e,(n=t.prefix,r=t.desc,a='<span style="font-family: monospace; white-space: pre">'+(n||"")+'<input type="text" autocorrect="off" autocapitalize="none" autocomplete="off"></span>',r&&(a+=' <span style="color: #888">'+r+"</span>"),a),l,t.onClose,t)}function ut(e,t,n,r){if(t){var a=et(e),l=at(t,!!n,!!r);if(l)return dt(e,l),function(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],r=0;r<n.length;r++){var a=n[r];if(e[a]!==t[a])return!1}return!0}return!1}(l,a.getQuery())||a.setQuery(l),l}}function dt(e,t){var n=et(e),r=n.getOverlay();r&&t==r.query||(r&&e.removeOverlay(r),r=function(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(!t||n.sol()){var r=n.match(e,!1);if(r)return 0==r[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+r[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););}else n.skipToEnd()},query:e}}(t),e.addOverlay(r),e.showMatchesOnScrollbar&&(n.getScrollbarAnnotate()&&n.getScrollbarAnnotate().clear(),n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),n.setOverlay(r))}function ht(e,t,n,r){return void 0===r&&(r=1),e.operation((function(){for(var a=e.getCursor(),l=e.getSearchCursor(n,a),d=0;d<r;d++){var h=l.find(t);if(0==d&&h&&Ee(l.from(),a)&&(h=l.find(t)),!h&&!(l=e.getSearchCursor(n,t?A(e.lastLine()):A(e.firstLine(),0))).find(t))return}return l.from()}))}function pt(e){var t=et(e);e.removeOverlay(et(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function ft(e){var t=e.ace.renderer;return{top:t.getFirstFullyVisibleRow(),bottom:t.getLastFullyVisibleRow()}}function gt(e,t,n){if("'"==n||"`"==n)return re.jumpList.find(e,-1)||A(0,0);if("."==n)return mt(e);var r=t.marks[n];return r&&r.find()}function mt(e){var t=e.ace.session.$undoManager;if(t&&t.$lastDelta)return S(t.$lastDelta.end)}var vt=function(){this.buildCommandMap_()};vt.prototype={processCommand:function(e,t,n){var r=this;e.operation((function(){e.curOp.isVimOp=!0,r._processCommand(e,t,n)}))},_processCommand:function(e,t,n){var r=e.state.vim,a=re.registerController.getRegister(":"),l=a.toString();r.visualMode&&Be(e);var d=new O.StringStream(t);a.setText(t);var h,p,f=n||{};f.input=t;try{this.parseInput_(e,d,f)}catch(t){throw st(e,t),t}if(f.commandName){if(h=this.matchCommand_(f.commandName)){if(p=h.name,h.excludeFromCommandHistory&&a.setText(l),this.parseCommandArgs_(d,f,h),"exToKey"==h.type){for(var y=0;y<h.toKeys.length;y++)O.Vim.handleKey(e,h.toKeys[y],"mapping");return}if("exToEx"==h.type)return void this.processCommand(e,h.toInput)}}else void 0!==f.line&&(p="move");if(p)try{bt[p](e,f),h&&h.possiblyAsync||!f.callback||f.callback()}catch(t){throw st(e,t),t}else st(e,'Not an editor command ":'+t+'"')},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t)));var r=t.match(/^(\w+)/);return n.commandName=r?r[1]:t.match(/.*/)[0],n},parseLineSpec_:function(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return this.parseLineSpecOffset_(t,e.getCursor().line);case"$":return this.parseLineSpecOffset_(t,e.lastLine());case"'":var r=t.next(),a=gt(e,e.state.vim,r);if(!a)throw new Error("Mark not set");return this.parseLineSpecOffset_(t,a.line);case"-":case"+":return t.backUp(1),this.parseLineSpecOffset_(t,e.getCursor().line);default:return void t.backUp(1)}},parseLineSpecOffset_:function(e,t){var n=e.match(/^([+-])?(\d+)/);if(n){var r=parseInt(n[2],10);"-"==n[1]?t-=r:t+=r}return t},parseCommandArgs_:function(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)[0];var r=n.argDelimiter||/\s+/,a=Pe(t.argString).split(r);a.length&&a[0]&&(t.args=a)}},matchCommand_:function(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var r=this.commandMap_[n];if(0===r.name.indexOf(e))return r}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<E.length;e++){var t=E[e],n=t.shortName||t.name;this.commandMap_[n]=t}},map:function(e,t,n){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var r=e.substring(1);":"!=t&&":"==t.charAt(0)?this.commandMap_[r]={name:r,type:"exToEx",toInput:t.substring(1),user:!0}:this.commandMap_[r]={name:r,type:"exToKey",toKeys:t,user:!0}}else if(":"!=t&&":"==t.charAt(0)){var a={keys:e,type:"keyToEx",exArgs:{input:t.substring(1)}};n&&(a.context=n),_.unshift(a)}else{a={keys:e,type:"keyToKey",toKeys:t};n&&(a.context=n),_.unshift(a)}},unmap:function(e,t){if(":"!=e&&":"==e.charAt(0)){if(t)throw Error("Mode not supported for ex mappings");var n=e.substring(1);if(this.commandMap_[n]&&this.commandMap_[n].user)return void delete this.commandMap_[n]}else for(var r=e,a=0;a<_.length;a++)if(r==_[a].keys&&_[a].context===t)return void _.splice(a,1)}};var bt={colorscheme:function(e,t){!t.args||t.args.length<1?st(e,e.getOption("theme")):e.setOption("theme",t.args[0])},map:function(e,t,n){var r=t.args;!r||r.length<2?e&&st(e,"Invalid mapping: "+t.input):yt.map(r[0],r[1],n)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var r=t.args;!r||r.length<1?e&&st(e,"No such mapping: "+t.input):yt.unmap(r[0],n)},move:function(e,t){ve.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,r=t.setCfg||{};if(!n||n.length<1)e&&st(e,"Invalid mapping: "+t.input);else{var a=n[0].split("="),l=a[0],d=a[1],h=!1;if("?"==l.charAt(l.length-1)){if(d)throw Error("Trailing characters: "+t.argString);l=l.substring(0,l.length-1),h=!0}void 0===d&&"no"==l.substring(0,2)&&(l=l.substring(2),d=!1);var p=Z[l]&&"boolean"==Z[l].type;if(p&&null==d&&(d=!0),!p&&void 0===d||h){var f=ne(l,e,r);f instanceof Error?st(e,f.message):st(e,!0===f||!1===f?" "+(f?"":"no")+l:"  "+l+"="+f)}else{var y=te(l,d,e,r);y instanceof Error&&st(e,y.message)}}},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,t){var n=t.args,r=re.registerController.registers,a="----------Registers----------<br><br>";if(n){n=n.join("");for(var l=0;l<n.length;l++){if(d=n.charAt(l),re.registerController.isValidRegister(d))a+='"'+d+"    "+(r[d]||new fe).toString()+"<br>"}}else for(var d in r){var h=r[d].toString();h.length&&(a+='"'+d+"    "+h+"<br>")}st(e,a)},sort:function(e,t){var n,r,a,l,d;var h=function(){if(t.argString){var e=new O.StringStream(t.argString);if(e.eat("!")&&(n=!0),e.eol())return;if(!e.eatSpace())return"Invalid arguments";var h=e.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!h&&!e.eol())return"Invalid arguments";if(h[1]){r=-1!=h[1].indexOf("i"),a=-1!=h[1].indexOf("u");var p=-1!=h[1].indexOf("d")||-1!=h[1].indexOf("n")&&1,f=-1!=h[1].indexOf("x")&&1,y=-1!=h[1].indexOf("o")&&1;if(p+f+y>1)return"Invalid arguments";l=(p?"decimal":f&&"hex")||y&&"octal"}h[2]&&(d=new RegExp(h[2].substr(1,h[2].length-2),r?"i":""))}}();if(h)st(e,h+": "+t.argString);else{var p=t.line||e.firstLine(),f=t.lineEnd||t.line||e.lastLine();if(p!=f){var y=A(p,0),w=A(f,Ie(e,f)),x=e.getRange(y,w).split("\n"),j=d||("decimal"==l?/(-?)([\d]+)/:"hex"==l?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==l?/([0-7]+)/:null),C="decimal"==l?10:"hex"==l?16:"octal"==l?8:null,S=[],_=[];if(l||d)for(var k=0;k<x.length;k++){var E=d?x[k].match(d):null;E&&""!=E[0]?S.push(E):!d&&j.exec(x[k])?S.push(x[k]):_.push(x[k])}else _=x;if(S.sort(d?function(e,t){var a;return n&&(a=e,e=t,t=a),r&&(e[0]=e[0].toLowerCase(),t[0]=t[0].toLowerCase()),e[0]<t[0]?-1:1}:I),d)for(k=0;k<S.length;k++)S[k]=S[k].input;else l||_.sort(I);if(x=n?S.concat(_):_.concat(S),a){var T,R=x;x=[];for(k=0;k<R.length;k++)R[k]!=T&&x.push(R[k]),T=R[k]}e.replaceRange(x.join("\n"),y,w)}}function I(e,t){var a;n&&(a=e,e=t,t=a);r&&(e=e.toLowerCase(),t=t.toLowerCase());var d=l&&j.exec(e),h=l&&j.exec(t);return d?(d=parseInt((d[1]+d[2]).toLowerCase(),C))-(h=parseInt((h[1]+h[2]).toLowerCase(),C)):e<t?-1:1}},global:function(e,t){var n=t.argString;if(n){var r,a=void 0!==t.line?t.line:e.firstLine(),l=t.lineEnd||t.line||e.lastLine(),d=function(e){return nt(e,"/")}(n),h=n;if(d.length&&(h=d[0],r=d.slice(1,d.length).join("/")),h)try{ut(e,h,!0,!0)}catch(t){return void st(e,"Invalid regex: "+h)}for(var p=et(e).getQuery(),f=[],y="",w=a;w<=l;w++){p.test(e.getLine(w))&&(f.push(w+1),y+=e.getLine(w)+"<br>")}if(r){var x=0,j=function(){if(x<f.length){var t=f[x]+r;yt.processCommand(e,t,{callback:j})}x++};j()}else st(e,y)}else st(e,"Regular Expression missing from global")},substitute:function(e,t){if(!e.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var n,r,a,l,d=t.argString,h=d?nt(d,d[0]):[],p="",f=!1,y=!1;if(h.length)n=h[0],ne("pcre")&&""!==n&&(n=new RegExp(n).source),p=h[1],n&&"$"===n[n.length-1]&&(n=n.slice(0,n.length-1)+"\\n",p=p?p+"\n":"\n"),void 0!==p&&(p=ne("pcre")?function(e){for(var t=new O.StringStream(e),n=[];!t.eol();){for(;t.peek()&&"\\"!=t.peek();)n.push(t.next());var r=!1;for(var a in ot)if(t.match(a,!0)){r=!0,n.push(ot[a]);break}r||n.push(t.next())}return n.join("")}(p.replace(/([^\\])&/g,"$1$$&")):function(e){for(var t,n=!1,r=[],a=-1;a<e.length;a++){var l=e.charAt(a)||"",d=e.charAt(a+1)||"";it[l+d]?(r.push(it[l+d]),a++):n?(r.push(l),n=!1):"\\"===l?(n=!0,t=d,F.test(t)||"$"===d?r.push("$"):"/"!==d&&"\\"!==d&&r.push("\\")):("$"===l&&r.push("$"),r.push(l),"/"===d&&r.push("\\"))}return r.join("")}(p),re.lastSubstituteReplacePart=p),r=h[2]?h[2].split(" "):[];else if(d&&d.length)return void st(e,"Substitutions should be of the form :s/pattern/replace/");if(r&&(a=r[0],l=parseInt(r[1]),a&&(-1!=a.indexOf("c")&&(f=!0,a.replace("c","")),-1!=a.indexOf("g")&&(y=!0,a.replace("g","")),n=ne("pcre")?n+"/"+a:n.replace(/\//g,"\\/")+"/"+a)),n)try{ut(e,n,!0,!0)}catch(t){return void st(e,"Invalid regex: "+n)}if(void 0!==(p=p||re.lastSubstituteReplacePart)){var w=et(e).getQuery(),x=void 0!==t.line?t.line:e.getCursor().line,j=t.lineEnd||x;x==e.firstLine()&&j==e.lastLine()&&(j=1/0),l&&(j=(x=j)+l-1);var C=je(e,A(x,0)),S=e.getSearchCursor(w,C);!function(e,t,n,r,a,l,d,h,p){e.state.vim.exMode=!0;var f=!1,y=l.from();function w(){e.operation((function(){for(;!f;)x(),j();C()}))}function x(){var t=e.getRange(l.from(),l.to()).replace(d,h);l.replace(t)}function j(){for(;l.findNext()&&(t=l.from(),d=r,h=a,"number"!=typeof t&&(t=t.line),d instanceof Array?Q(t,d):h?t>=d&&t<=h:t==d);)if(n||!y||l.from().line!=y.line)return e.scrollIntoView(l.from(),30),e.setSelection(l.from(),l.to()),y=l.from(),void(f=!1);var t,d,h;f=!0}function C(t){if(t&&t(),e.focus(),y){e.setCursor(y);var n=e.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=y.ch}p&&p()}if(j(),f)return void st(e,"No matches for "+d.source);if(!t)return w(),void(p&&p());ct(e,{prefix:"replace with <strong>"+h+"</strong> (y/n/a/q/l)",onKeyDown:function(t,n,r){switch(O.e_stop(t),O.keyName(t)){case"Y":x(),j();break;case"N":j();break;case"A":var a=p;p=void 0,e.operation(w),p=a;break;case"L":x();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":C(r)}return f&&C(r),!0}})}(e,f,y,x,j,S,w,p,t.callback)}else st(e,"No previous substitute regular expression")},redo:O.commands.redo,undo:O.commands.undo,write:function(e){O.commands.save?O.commands.save(e):e.save&&e.save()},nohlsearch:function(e){pt(e)},yank:function(e){var t=ke(e.getCursor()).line,n=e.getLine(t);re.registerController.pushText("0","yank",n,!0,!0)},delmarks:function(e,t){if(t.argString&&Pe(t.argString))for(var n=e.state.vim,r=new O.StringStream(Pe(t.argString));!r.eol();){r.eatSpace();var a=r.pos;if(!r.match(/[a-zA-Z]/,!1))return void st(e,"Invalid argument: "+t.argString.substring(a));var l=r.next();if(r.match("-",!0)){if(!r.match(/[a-zA-Z]/,!1))return void st(e,"Invalid argument: "+t.argString.substring(a));var d=l,h=r.next();if(!(G(d)&&G(h)||Y(d)&&Y(h)))return void st(e,"Invalid argument: "+d+"-");var p=d.charCodeAt(0),f=h.charCodeAt(0);if(p>=f)return void st(e,"Invalid argument: "+t.argString.substring(a));for(var y=0;y<=f-p;y++){var w=String.fromCharCode(p+y);delete n.marks[w]}}else delete n.marks[l]}else st(e,"Argument required")}},yt=new vt;function wt(e){var t=e.state.vim,n=re.macroModeState,r=re.registerController.getRegister("."),a=n.isPlaying,l=n.lastInsertModeChanges;a||(e.off("change",Ot),O.off(e.getInputField(),"keydown",Et)),!a&&t.insertModeRepeat>1&&(At(e,t,t.insertModeRepeat-1,!0),t.lastEditInputState.repeatOverride=t.insertModeRepeat),delete t.insertModeRepeat,t.insertMode=!1,e.setCursor(e.getCursor().line,e.getCursor().ch-1),e.setOption("keyMap","vim"),e.setOption("disableInput",!0),e.toggleOverwrite(!1),r.setText(l.changes.join("")),O.signal(e,"vim-mode-change",{mode:"normal"}),n.isRecording&&function(e){if(e.isPlaying)return;var t=e.latestRegister,n=re.registerController.getRegister(t);n&&n.pushInsertModeChanges&&n.pushInsertModeChanges(e.lastInsertModeChanges)}(n)}function xt(e){_.unshift(e)}function jt(e,t,n,r){var a=re.registerController.getRegister(r);if(":"==r)return a.keyBuffer[0]&&yt.processCommand(e,a.keyBuffer[0]),void(n.isPlaying=!1);var l=a.keyBuffer,d=0;n.isPlaying=!0,n.replaySearchQueries=a.searchQueries.slice(0);for(var h=0;h<l.length;h++)for(var p,f,y=l[h];y;)if(f=(p=/<\w+-.+?>|<\w+>|./.exec(y))[0],y=y.substring(p.index+f.length),O.Vim.handleKey(e,f,"macro"),t.insertMode){var w=a.insertModeChanges[d++].changes;re.macroModeState.lastInsertModeChanges.changes=w,$t(e,w,1),wt(e)}n.isPlaying=!1}function Ot(e,t){var n=re.macroModeState,r=n.lastInsertModeChanges;if(!n.isPlaying)for(;t;){if(r.expectCursorActivityForChange=!0,r.ignoreCount>1)r.ignoreCount--;else if("+input"==t.origin||"paste"==t.origin||void 0===t.origin){var a=e.listSelections().length;a>1&&(r.ignoreCount=a);var l=t.text.join("\n");r.maybeReset&&(r.changes=[],r.maybeReset=!1),l&&(e.state.overwrite&&!/\n/.test(l)?r.changes.push([l]):r.changes.push(l))}t=t.next}}function Ct(e){var t=e.state.vim;if(t.insertMode){var n=re.macroModeState;if(n.isPlaying)return;var r=n.lastInsertModeChanges;r.expectCursorActivityForChange?r.expectCursorActivityForChange=!1:r.maybeReset=!0}else e.curOp.isVimOp||_t(e,t);t.visualMode&&St(e)}function St(e){var t=e.state.vim,n=je(e,ke(t.sel.head)),r=Ce(n,0,1);t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(n,r,{className:"cm-animate-fat-cursor"})}function _t(e,t,n){var r=e.getCursor("anchor"),a=e.getCursor("head");if(t.visualMode&&!e.somethingSelected()?Be(e,!1):t.visualMode||t.insertMode||!e.somethingSelected()||(t.visualMode=!0,t.visualLine=!1,O.signal(e,"vim-mode-change",{mode:"visual"})),t.visualMode){var l=Ae(a,r)?0:-1,d=Ae(a,r)?-1:0;a=Ce(a,0,l),r=Ce(r,0,d),t.sel={anchor:r,head:a},Xe(e,t,"<",$e(a,r)),Xe(e,t,">",Te(a,r))}else t.insertMode||n||(t.lastHPos=e.getCursor().ch)}function kt(e){this.keyName=e}function Et(e){var t=re.macroModeState.lastInsertModeChanges,n=O.keyName(e);n&&(-1==n.indexOf("Delete")&&-1==n.indexOf("Backspace")||O.lookupKey(n,"vim-insert",(function(){return t.maybeReset&&(t.changes=[],t.maybeReset=!1),t.changes.push(new kt(n)),!0})))}function At(e,t,n,r){var a=re.macroModeState;a.isPlaying=!0;var l=!!t.lastEditActionCommand,d=t.inputState;function h(){l?ve.processAction(e,t,t.lastEditActionCommand):ve.evalInput(e,t)}function p(n){if(a.lastInsertModeChanges.changes.length>0){n=t.lastEditActionCommand?n:1;var r=a.lastInsertModeChanges;$t(e,r.changes,n)}}if(t.inputState=t.lastEditInputState,l&&t.lastEditActionCommand.interlaceInsertRepeat)for(var f=0;f<n;f++)h(),p(1);else r||h(),p(n);t.inputState=d,t.insertMode&&!r&&wt(e),a.isPlaying=!1}function $t(e,t,n){function r(t){return"string"==typeof t?O.commands[t](e):t(e),!0}var a=e.getCursor("head"),l=re.macroModeState.lastInsertModeChanges.visualBlock;l&&(Le(e,a,l+1),n=e.listSelections().length,e.setCursor(a));for(var d=0;d<n;d++){l&&e.setCursor(Ce(a,d,0));for(var h=0;h<t.length;h++){var p=t[h];if(p instanceof kt)O.lookupKey(p.keyName,"vim-insert",r);else if("string"==typeof p){var f=e.getCursor();e.replaceRange(p,f,f)}else{var y=e.getCursor(),w=Ce(y,0,p[0].length);e.replaceRange(p[0],y,w)}}}l&&e.setCursor(Ce(a,0,1))}O.keyMap.vim={attach:I,detach:R,call:P},ee("insertModeEscKeysTimeout",200,"number"),O.keyMap["vim-insert"]={fallthrough:["default"],attach:I,detach:R,call:P},O.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:I,detach:R,call:P},ue(),O.Vim=T();var Tt={return:"CR",backspace:"BS",delete:"Del",esc:"Esc",left:"Left",right:"Right",up:"Up",down:"Down",space:"Space",home:"Home",end:"End",pageup:"PageUp",pagedown:"PageDown",enter:"CR"};var Rt=(T=O.Vim).handleKey.bind(T);function It(e){var t=new e.constructor;return Object.keys(e).forEach((function(n){var r=e[n];Array.isArray(r)?r=r.slice():r&&"object"==typeof r&&r.constructor!=Object&&(r=It(r)),t[n]=r})),e.sel&&(t.sel={head:e.sel.head&&ke(e.sel.head),anchor:e.sel.anchor&&ke(e.sel.anchor)}),t}T.handleKey=function(e,t,n){return e.operation((function(){return Rt(e,t,n)}),!0)},t.CodeMirror=O;var Pt=T.maybeInitVimState_;function Dt(e,t){t.off("beforeEndOperation",Dt);var n=t.state.cm.vimCmd;n&&t.execCommand(n.exec?n:n.name,n.args),t.curOp=t.prevOp}t.handler={$id:"ace/keyboard/vim",drawCursor:function(e,t,n,a,d){var h=this.state.vim||{},p=n.characterWidth,f=n.lineHeight,y=t.top,w=t.left;h.insertMode||!(a.cursor?r.comparePoints(a.cursor,a.start)<=0:d.selection.isBackwards()||d.selection.isEmpty())&&w>p&&(w-=p);!h.insertMode&&h.status&&(y+=f/=2),l.translate(e,w,y),l.setStyle(e.style,"width",p+"px"),l.setStyle(e.style,"height",f+"px")},handleKeyboard:function(e,t,n,r,a){var l=e.editor,d=l.state.cm,h=Pt(d);if(-1!=r){if(h.insertMode||(-1==t?(n.charCodeAt(0)>255&&e.inputKey&&(n=e.inputKey)&&4==e.inputHash&&(n=n.toUpperCase()),e.inputChar=n):4==t||0==t?e.inputKey==n&&e.inputHash==t&&e.inputChar?(n=e.inputChar,t=-1):(e.inputChar=null,e.inputKey=n,e.inputHash=t):e.inputChar=e.inputKey=null),"c"==n&&1==t&&!y.isMac&&l.getCopyText())return l.once("copy",(function(){l.selection.clearSelection()})),{command:"null",passEvent:!0};if("esc"==n&&!h.insertMode&&!h.visualMode&&!d.ace.inMultiSelectMode){var p=et(d).getOverlay();p&&d.removeOverlay(p)}if(-1==t||1&t||0===t&&n.length>1){var f=h.insertMode,w=function(e,t,n){t.length>1&&"n"==t[0]&&(t=t.replace("numpad","")),t=Tt[t]||t;var r="";return n.ctrlKey&&(r+="C-"),n.altKey&&(r+="A-"),(r||t.length>1)&&n.shiftKey&&(r+="S-"),(r+=t).length>1&&(r="<"+r+">"),r}(0,n,a||{});null==h.status&&(h.status="");var x=function(e,t,n){var r=!1,a=T.maybeInitVimState_(e),l=a.visualBlock||a.wasInVisualBlock,d=e.ace.inMultiSelectMode;if(a.wasInVisualBlock&&!d?a.wasInVisualBlock=!1:d&&a.visualBlock&&(a.wasInVisualBlock=!0),"<Esc>"!=t||a.insertMode||a.visualMode||!d)if(l||!d||e.ace.inVirtualSelectionMode)r=T.handleKey(e,t,n);else{var h=It(a);e.operation((function(){e.ace.forEachSelection((function(){var a=e.ace.selection;e.state.vim.lastHPos=null==a.$desiredColumn?a.lead.column:a.$desiredColumn;var l=e.getCursor("head"),d=e.getCursor("anchor"),p=Ae(l,d)?0:-1,f=Ae(l,d)?-1:0;l=Ce(l,0,p),d=Ce(d,0,f),e.state.vim.sel.head=l,e.state.vim.sel.anchor=d,r=Rt(e,t,n),a.$desiredColumn=-1==e.state.vim.lastHPos?null:e.state.vim.lastHPos,e.virtualSelectionMode()&&(e.state.vim=It(h))})),e.curOp.cursorActivity&&!r&&(e.curOp.cursorActivity=!1)}),!0)}else e.ace.exitMultiSelectMode();return!r||a.visualMode||a.insert||a.visualMode==e.somethingSelected()||_t(e,a,!0),r}(d,w,"user");if(h=Pt(d),x&&null!=h.status?h.status+=w:null==h.status&&(h.status=""),d._signal("changeStatus"),!x&&(-1!=t||f))return;return{command:"null",passEvent:!x}}}},attach:function(e){e.state||(e.state={});var t=new O(e);function n(){var n=Pt(t).insertMode;t.ace.renderer.setStyle("normal-mode",!n),e.textInput.setCommandMode(!n),e.renderer.$keepTextAreaAtCursor=n,e.renderer.$blockCursor=!n}e.state.cm=t,e.$vimModeHandler=this,O.keyMap.vim.attach(t),Pt(t).status=null,t.on("vim-command-done",(function(){t.virtualSelectionMode()||(Pt(t).status=null,t.ace._signal("changeStatus"),t.ace.session.markUndoGroup())})),t.on("changeStatus",(function(){t.ace.renderer.updateCursor(),t.ace._signal("changeStatus")})),t.on("vim-mode-change",(function(){t.virtualSelectionMode()||(n(),t._signal("changeStatus"))})),n(),e.renderer.$cursorLayer.drawCursor=this.drawCursor.bind(t)},detach:function(e){var t=e.state.cm;O.keyMap.vim.detach(t),t.destroy(),e.state.cm=null,e.$vimModeHandler=null,e.renderer.$cursorLayer.drawCursor=null,e.renderer.setStyle("normal-mode",!1),e.textInput.setCommandMode(!1),e.renderer.$keepTextAreaAtCursor=!0},getStatusText:function(e){var t=e.state.cm,n=Pt(t);if(n.insertMode)return"INSERT";var r="";return n.visualMode&&(r+="VISUAL",n.visualLine&&(r+=" LINE"),n.visualBlock&&(r+=" BLOCK")),n.status&&(r+=(r?" ":"")+n.status),r}},T.defineOption({name:"wrap",set:function(e,t){t&&t.ace.setOption("wrap",e)},type:"boolean"},!1),T.defineEx("write","w",(function(){console.log(":write is not implemented")})),_.push({keys:"zc",type:"action",action:"fold",actionArgs:{open:!1}},{keys:"zC",type:"action",action:"fold",actionArgs:{open:!1,all:!0}},{keys:"zo",type:"action",action:"fold",actionArgs:{open:!0}},{keys:"zO",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"za",type:"action",action:"fold",actionArgs:{toggle:!0}},{keys:"zA",type:"action",action:"fold",actionArgs:{toggle:!0,all:!0}},{keys:"zf",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"zd",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"<C-A-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAbove"}},{keys:"<C-A-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelow"}},{keys:"<C-A-S-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAboveSkipCurrent"}},{keys:"<C-A-S-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelowSkipCurrent"}},{keys:"<C-A-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreBefore"}},{keys:"<C-A-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreAfter"}},{keys:"<C-A-S-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextBefore"}},{keys:"<C-A-S-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextAfter"}}),xe.aceCommand=function(e,t,n){e.vimCmd=t,e.ace.inVirtualSelectionMode?e.ace.on("beforeEndOperation",Dt):Dt(null,e.ace)},xe.fold=function(e,t,n){e.ace.execCommand(["toggleFoldWidget","toggleFoldWidget","foldOther","unfoldall"][(t.all?2:0)+(t.open?1:0)])},t.handler.defaultKeymap=_,t.handler.actions=xe,t.Vim=T})),ace.require(["ace/keyboard/vim"],(function(t){e&&(e.exports=t)}))}).call(this,n(151)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2)),l=f(n(932)),d=f(n(933)),h=f(n(934)),p=f(n(942));function f(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var x=function(e){function t(){return y(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"parseString",value:function(e){var t=this;if(""===e)return e;var n=this.props.matchDecorator(e);if(!n)return e;var r=[],a=0;return n.forEach((function(n,l){n.index>a&&r.push(e.substring(a,n.index));var d=t.props.hrefDecorator(n.url),h=t.props.textDecorator(n.text),p=t.props.componentDecorator(d,h,l);r.push(p),a=n.lastIndex})),e.length>a&&r.push(e.substring(a)),1===r.length?r[0]:r}},{key:"parse",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"string"==typeof e?this.parseString(e):a.isValidElement(e)&&"a"!==e.type&&"button"!==e.type?a.cloneElement(e,{key:n},this.parse(e.props.children)):Array.isArray(e)?e.map((function(e,n){return t.parse(e,n)})):e}},{key:"render",value:function(){return a.createElement(a.Fragment,null,this.parse(this.props.children))}}]),t}(a.Component);x.defaultProps={componentDecorator:l.default,hrefDecorator:d.default,matchDecorator:h.default,textDecorator:p.default},t.default=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2));t.default=function(e,t,n){return r.createElement("a",{href:e,key:n},t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(935)),a=l(n(941));function l(e){return e&&e.__esModule?e:{default:e}}var d=new r.default;d.tlds(a.default),t.default=function(e){return d.match(e)}},function(e,t,n){"use strict";function r(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach((function(t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))})),e}function a(e){return Object.prototype.toString.call(e)}function l(e){return"[object Function]"===a(e)}function d(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var h={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var p={"http:":{validate:function(e,t,n){var r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){var r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){var r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},f="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function y(e){var t=e.re=n(936)(e.__opts__),r=e.__tlds__.slice();function h(e){return e.replace("%TLDS%",t.src_tlds)}e.onCompile(),e.__tlds_replaced__||r.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),r.push(t.src_xn),t.src_tlds=r.join("|"),t.email_fuzzy=RegExp(h(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(h(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(h(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(h(t.tpl_host_fuzzy_test),"i");var p=[];function schemaError(e,t){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}e.__compiled__={},Object.keys(e.__schemas__).forEach((function(t){var n=e.__schemas__[t];if(null!==n){var r={validate:null,link:null};if(e.__compiled__[t]=r,"[object Object]"===a(n))return!function(e){return"[object RegExp]"===a(e)}(n.validate)?l(n.validate)?r.validate=n.validate:schemaError(t,n):r.validate=function(e){return function(t,n){var r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}(n.validate),void(l(n.normalize)?r.normalize=n.normalize:n.normalize?schemaError(t,n):r.normalize=function(e,t){t.normalize(e)});!function(e){return"[object String]"===a(e)}(n)?schemaError(t,n):p.push(t)}})),p.forEach((function(t){e.__compiled__[e.__schemas__[t]]&&(e.__compiled__[t].validate=e.__compiled__[e.__schemas__[t]].validate,e.__compiled__[t].normalize=e.__compiled__[e.__schemas__[t]].normalize)})),e.__compiled__[""]={validate:null,normalize:function(e,t){t.normalize(e)}};var f=Object.keys(e.__compiled__).filter((function(t){return t.length>0&&e.__compiled__[t]})).map(d).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+f+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+f+")","ig"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(e)}function w(e,t){var n=e.__index__,r=e.__last_index__,a=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=a,this.text=a,this.url=a}function x(e,t){var n=new w(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function j(e,t){if(!(this instanceof j))return new j(e,t);var n;t||(n=e,Object.keys(n||{}).reduce((function(e,t){return e||h.hasOwnProperty(t)}),!1)&&(t=e,e={})),this.__opts__=r({},h,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=r({},p,e),this.__compiled__={},this.__tlds__=f,this.__tlds_replaced__=!1,this.re={},y(this)}j.prototype.add=function(e,t){return this.__schemas__[e]=t,y(this),this},j.prototype.set=function(e){return this.__opts__=r(this.__opts__,e),this},j.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;var t,n,r,a,l,d,h,p;if(this.re.schema_test.test(e))for((h=this.re.schema_search).lastIndex=0;null!==(t=h.exec(e));)if(a=this.testSchemaAt(e,t[2],h.lastIndex)){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+a;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(p=e.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||p<this.__index__)&&null!==(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(l=n.index+n[1].length,(this.__index__<0||l<this.__index__)&&(this.__schema__="",this.__index__=l,this.__last_index__=n.index+n[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&e.indexOf("@")>=0&&null!==(r=e.match(this.re.email_fuzzy))&&(l=r.index+r[1].length,d=r.index+r[0].length,(this.__index__<0||l<this.__index__||l===this.__index__&&d>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=l,this.__last_index__=d)),this.__index__>=0},j.prototype.pretest=function(e){return this.re.pretest.test(e)},j.prototype.testSchemaAt=function(e,t,n){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,n,this):0},j.prototype.match=function(e){var t=0,n=[];this.__index__>=0&&this.__text_cache__===e&&(n.push(x(this,t)),t=this.__last_index__);for(var r=t?e.slice(t):e;this.test(r);)n.push(x(this,t)),r=r.slice(this.__last_index__),t+=this.__last_index__;return n.length?n:null},j.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter((function(e,t,n){return e!==n[t-1]})).reverse(),y(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,y(this),this)},j.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},j.prototype.onCompile=function(){},e.exports=j},function(e,t,n){"use strict";e.exports=function(e){var t={};t.src_Any=n(937).source,t.src_Cc=n(938).source,t.src_Z=n(939).source,t.src_P=n(940).source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");return t.src_pseudo_letter="(?:(?![><｜]|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|[><｜]|"+t.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|[><｜]|[()[\\]{}.,\"'?!\\-]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-]).|\\.{2,4}[a-zA-Z0-9%/]|\\.(?!"+t.src_ZCc+"|[.]).|"+(e&&e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+"\\,(?!"+t.src_ZCc+").|\\!(?!"+t.src_ZCc+"|[!]).|\\?(?!"+t.src_ZCc+"|[?]).)+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}},function(e,t){e.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},function(e,t){e.exports=/[\0-\x1F\x7F-\x9F]/},function(e,t){e.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},function(e,t){e.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},function(e){e.exports=JSON.parse('["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","adac","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","budapest","bugatti","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","cancerresearch","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","csc","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","etisalat","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","lancaster","lancia","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","linde","link","lipsy","live","living","lk","llc","llp","loan","loans","locker","locus","loft","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","macys","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mutual","mv","mw","mx","my","mz","na","nab","nagoya","name","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","ses","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermögensberater","vermögensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","ελ","ευ","бг","бел","дети","ею","католик","ком","мкд","мон","москва","онлайн","орг","рус","рф","сайт","срб","укр","қаз","հայ","ישראל","קום","ابوظبي","اتصالات","ارامكو","الاردن","البحرين","الجزائر","السعودية","العليان","المغرب","امارات","ایران","بارت","بازار","بيتك","بھارت","تونس","سودان","سورية","شبكة","عراق","عرب","عمان","فلسطين","قطر","كاثوليك","كوم","مصر","مليسيا","موريتانيا","موقع","همراه","پاکستان","ڀارت","कॉम","नेट","भारत","भारतम्","भारोत","संगठन","বাংলা","ভারত","ভাৰত","ਭਾਰਤ","ભારત","ଭାରତ","இந்தியா","இலங்கை","சிங்கப்பூர்","భారత్","ಭಾರತ","ഭാരതം","ලංකා","คอม","ไทย","ລາວ","გე","みんな","アマゾン","クラウド","グーグル","コム","ストア","セール","ファッション","ポイント","世界","中信","中国","中國","中文网","亚马逊","企业","佛山","信息","健康","八卦","公司","公益","台湾","台灣","商城","商店","商标","嘉里","嘉里大酒店","在线","大拿","天主教","娱乐","家電","广东","微博","慈善","我爱你","手机","招聘","政务","政府","新加坡","新闻","时尚","書籍","机构","淡马锡","游戏","澳門","点看","移动","组织机构","网址","网店","网站","网络","联通","诺基亚","谷歌","购物","通販","集团","電訊盈科","飞利浦","食品","餐厅","香格里拉","香港","닷넷","닷컴","삼성","한국"]')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e}},function(module,exports){var uuid,removeData,eventType,orig;function focusable(e,t){var n,r,a,l=e.nodeName.toLowerCase();return"area"===l?(r=(n=e.parentNode).name,!(!e.href||!r||"map"!==n.nodeName.toLowerCase())&&(!!(a=$("img[usemap='#"+r+"']")[0])&&visible(a))):(/^(input|select|textarea|button|object)$/.test(l)?!e.disabled:"a"===l&&e.href||t)&&visible(e)}function visible(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.ui=$.ui||{},$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({scrollParent:function(e){var t=this.css("position"),n="absolute"===t,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter((function(){var e=$(this);return(!n||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==t&&a.length?a:$(this[0].ownerDocument||document)},uniqueId:(uuid=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++uuid)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")}))}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo((function(e){return function(t){return!!$.data(t,e)}})):function(e,t,n){return!!$.data(e,n[3])},focusable:function(e){return focusable(e,!isNaN($.attr(e,"tabindex")))},tabbable:function(e){var t=$.attr(e,"tabindex"),n=isNaN(t);return(n||t>=0)&&focusable(e,!n)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],(function(e,t){var n="Width"===t?["Left","Right"]:["Top","Bottom"],r=t.toLowerCase(),a={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function l(e,t,r,a){return $.each(n,(function(){t-=parseFloat($.css(e,"padding"+this))||0,r&&(t-=parseFloat($.css(e,"border"+this+"Width"))||0),a&&(t-=parseFloat($.css(e,"margin"+this))||0)})),t}$.fn["inner"+t]=function(e){return void 0===e?a["inner"+t].call(this):this.each((function(){$(this).css(r,l(this,e)+"px")}))},$.fn["outer"+t]=function(e,n){return"number"!=typeof e?a["outer"+t].call(this,e):this.each((function(){$(this).css(r,l(this,e,!0,n)+"px")}))}})),$.fn.addBack||($.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=(removeData=$.fn.removeData,function(e){return arguments.length?removeData.call(this,$.camelCase(e)):removeData.call(this)})),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:(orig=$.fn.focus,function(e,t){return"number"==typeof e?this.each((function(){var n=this;setTimeout((function(){$(n).focus(),t&&t.call(n)}),e)})):orig.apply(this,arguments)}),disableSelection:(eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(eventType+".ui-disableSelection",(function(e){e.preventDefault()}))}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,n,r=$(this[0]);r.length&&r[0]!==document;){if(("absolute"===(t=r.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),$.ui.plugin={add:function(e,t,n){var r,a=$.ui[e].prototype;for(r in n)a.plugins[r]=a.plugins[r]||[],a.plugins[r].push([t,n[r]])},call:function(e,t,n,r){var a,l=e.plugins[t];if(l&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(a=0;a<l.length;a++)e.options[l[a][0]]&&l[a][1].apply(e.element,n)}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(e){return function(t){var n,r,a;for(a=0;null!=(r=t[a]);a++)try{(n=$._data(r,"events"))&&n.remove&&$(r).triggerHandler("remove")}catch(e){}e(t)}}($.cleanData),$.widget=function(e,t,n){var r,a,l,d,h={},p=e.split(".")[0];return e=e.split(".")[1],r=p+"-"+e,n||(n=t,t=$.Widget),$.expr[":"][r.toLowerCase()]=function(e){return!!$.data(e,r)},$[p]=$[p]||{},a=$[p][e],l=$[p][e]=function(e,t){if(!this._createWidget)return new l(e,t);arguments.length&&this._createWidget(e,t)},$.extend(l,a,{version:n.version,_proto:$.extend({},n),_childConstructors:[]}),(d=new t).options=$.widget.extend({},d.options),$.each(n,(function(e,n){var r,a;$.isFunction(n)?h[e]=(r=function(){return t.prototype[e].apply(this,arguments)},a=function(n){return t.prototype[e].apply(this,n)},function(){var e,t=this._super,l=this._superApply;return this._super=r,this._superApply=a,e=n.apply(this,arguments),this._super=t,this._superApply=l,e}):h[e]=n})),l.prototype=$.widget.extend(d,{widgetEventPrefix:a&&d.widgetEventPrefix||e},h,{constructor:l,namespace:p,widgetName:e,widgetFullName:r}),a?($.each(a._childConstructors,(function(e,t){var n=t.prototype;$.widget(n.namespace+"."+n.widgetName,l,t._proto)})),delete a._childConstructors):t._childConstructors.push(l),$.widget.bridge(e,l),l},$.widget.extend=function(e){for(var t,n,r=widget_slice.call(arguments,1),a=0,l=r.length;a<l;a++)for(t in r[a])n=r[a][t],r[a].hasOwnProperty(t)&&void 0!==n&&($.isPlainObject(n)?e[t]=$.isPlainObject(e[t])?$.widget.extend({},e[t],n):$.widget.extend({},n):e[t]=n);return e},$.widget.bridge=function(e,t){var n=t.prototype.widgetFullName||e;$.fn[e]=function(r){var a="string"==typeof r,l=widget_slice.call(arguments,1),d=this;return a?this.each((function(){var t,a=$.data(this,n);return"instance"===r?(d=a,!1):a?$.isFunction(a[r])&&"_"!==r.charAt(0)?(t=a[r].apply(a,l))!==a&&void 0!==t?(d=t&&t.jquery?d.pushStack(t.get()):t,!1):void 0:$.error("no such method '"+r+"' for "+e+" widget instance"):$.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")})):(l.length&&(r=$.widget.extend.apply(null,[r].concat(l))),this.each((function(){var e=$.data(this,n);e?(e.option(r||{}),e._init&&e._init()):$.data(this,n,new t(r,this))}))),d}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=$(t||this.defaultElement||this)[0],this.element=$(t),this.uuid=widget_uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),t!==this&&($.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=$(t.style?t.ownerDocument:t.document||t),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(e,t){var n,r,a,l=e;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof e)if(l={},n=e.split("."),e=n.shift(),n.length){for(r=l[e]=$.widget.extend({},this.options[e]),a=0;a<n.length-1;a++)r[n[a]]=r[n[a]]||{},r=r[n[a]];if(e=n.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];l[e]=t}return this._setOptions(l),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,t,n){var r,a=this;"boolean"!=typeof e&&(n=t,t=e,e=!1),n?(t=r=$(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element,r=this.widget()),$.each(n,(function(n,l){function d(){if(e||!0!==a.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof l?a[l]:l).apply(a,arguments)}"string"!=typeof l&&(d.guid=l.guid=l.guid||d.guid||$.guid++);var h=n.match(/^([\w:-]*)\s*(.*)$/),p=h[1]+a.eventNamespace,f=h[2];f?r.delegate(f,p,d):t.bind(p,d)}))},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=$(this.bindings.not(e).get()),this.focusable=$(this.focusable.not(e).get()),this.hoverable=$(this.hoverable.not(e).get())},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){$(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){$(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){$(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){$(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,n){var r,a,l=this.options[e];if(n=n||{},(t=$.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],a=t.originalEvent)for(r in a)r in t||(t[r]=a[r]);return this.element.trigger(t,n),!($.isFunction(l)&&!1===l.apply(this.element[0],[t].concat(n))||t.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},(function(e,t){$.Widget.prototype["_"+e]=function(n,r,a){"string"==typeof r&&(r={effect:r});var l,d=r?!0===r||"number"==typeof r?t:r.effect||t:e;"number"==typeof(r=r||{})&&(r={duration:r}),l=!$.isEmptyObject(r),r.complete=a,r.delay&&n.delay(r.delay),l&&$.effects&&$.effects.effect[d]?n[e](r):d!==e&&n[d]?n[d](r.duration,r.easing,a):n.queue((function(t){$(this)[e](),a&&a.call(n[0]),t()}))}}));var widget=$.widget,mouseHandled=!1;$(document).mouseup((function(){mouseHandled=!1}));var mouse=$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).bind("click."+this.widgetName,(function(t){if(!0===$.data(t.target,e.widgetName+".preventClickEvent"))return $.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,n=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&$(e.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){t.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===$.data(e.target,this.widgetName+".preventClickEvent")&&$.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&$.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),mouseHandled=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});$.widget("ui.draggable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||$(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=$(this);return $("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&$(t.activeElement).blur()}catch(e){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===$(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!t.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,n=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(n=$.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==t._trigger("stop",e)&&t._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),$.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!$(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,n=$.isFunction(t.helper),r=n?$(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),n&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),$.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,n,r=this.options,a=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(n=(t=$(r.containment))[0])&&(e=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=r.containment:this.containment=[0,0,$(a).width()-this.helperProportions.width-this.margins.left,($(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,a,l,d=this.options,h=this._isRootNode(this.scrollParent[0]),p=e.pageX,f=e.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(r=this.relativeContainer.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(p=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(p=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),d.grid&&(a=d.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,f=n?a-this.offset.click.top>=n[1]||a-this.offset.click.top>n[3]?a:a-this.offset.click.top>=n[1]?a-d.grid[1]:a+d.grid[1]:a,l=d.grid[0]?this.originalPageX+Math.round((p-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,p=n?l-this.offset.click.left>=n[0]||l-this.offset.click.left>n[2]?l:l-this.offset.click.left>=n[0]?l-d.grid[0]:l+d.grid[0]:l),"y"===d.axis&&(p=this.originalPageX),"x"===d.axis&&(f=this.originalPageY)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:p-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,n){return n=n||this._uiHash(),$.ui.plugin.call(this,e,[t,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,e,t,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,n){var r=$.extend({},t,{item:n.element});n.sortables=[],$(n.options.connectToSortable).each((function(){var t=$(this).sortable("instance");t&&!t.options.disabled&&(n.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,r))}))},stop:function(e,t,n){var r=$.extend({},t,{item:n.element});n.cancelHelperRemoval=!1,$.each(n.sortables,(function(){this.isOver?(this.isOver=0,n.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,r))}))},drag:function(e,t,n){$.each(n.sortables,(function(){var r=!1,a=this;a.positionAbs=n.positionAbs,a.helperProportions=n.helperProportions,a.offset.click=n.offset.click,a._intersectsWith(a.containerCache)&&(r=!0,$.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&$.contains(a.element[0],this.element[0])&&(r=!1),r}))),r?(a.isOver||(a.isOver=1,n._parent=t.helper.parent(),a.currentItem=t.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return t.helper[0]},e.target=a.currentItem[0],a._mouseCapture(e,!0),a._mouseStart(e,!0,!0),a.offset.click.top=n.offset.click.top,a.offset.click.left=n.offset.click.left,a.offset.parent.left-=n.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=n.offset.parent.top-a.offset.parent.top,n._trigger("toSortable",e),n.dropped=a.element,$.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,a.fromOutside=n),a.currentItem&&(a._mouseDrag(e),t.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",e,a._uiHash(a)),a._mouseStop(e,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),t.helper.appendTo(n._parent),n._refreshOffsets(e),t.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,$.each(n.sortables,(function(){this.refreshPositions()})))}))}}),$.ui.plugin.add("draggable","cursor",{start:function(e,t,n){var r=$("body"),a=n.options;r.css("cursor")&&(a._cursor=r.css("cursor")),r.css("cursor",a.cursor)},stop:function(e,t,n){var r=n.options;r._cursor&&$("body").css("cursor",r._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(e,t,n){var r=$(t.helper),a=n.options;r.css("opacity")&&(a._opacity=r.css("opacity")),r.css("opacity",a.opacity)},stop:function(e,t,n){var r=n.options;r._opacity&&$(t.helper).css("opacity",r._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,t,n){var r=n.options,a=!1,l=n.scrollParentNotHidden[0],d=n.document[0];l!==d&&"HTML"!==l.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+l.offsetHeight-e.pageY<r.scrollSensitivity?l.scrollTop=a=l.scrollTop+r.scrollSpeed:e.pageY-n.overflowOffset.top<r.scrollSensitivity&&(l.scrollTop=a=l.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+l.offsetWidth-e.pageX<r.scrollSensitivity?l.scrollLeft=a=l.scrollLeft+r.scrollSpeed:e.pageX-n.overflowOffset.left<r.scrollSensitivity&&(l.scrollLeft=a=l.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-$(d).scrollTop()<r.scrollSensitivity?a=$(d).scrollTop($(d).scrollTop()-r.scrollSpeed):$(window).height()-(e.pageY-$(d).scrollTop())<r.scrollSensitivity&&(a=$(d).scrollTop($(d).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-$(d).scrollLeft()<r.scrollSensitivity?a=$(d).scrollLeft($(d).scrollLeft()-r.scrollSpeed):$(window).width()-(e.pageX-$(d).scrollLeft())<r.scrollSensitivity&&(a=$(d).scrollLeft($(d).scrollLeft()+r.scrollSpeed)))),!1!==a&&$.ui.ddmanager&&!r.dropBehaviour&&$.ui.ddmanager.prepareOffsets(n,e)}}),$.ui.plugin.add("draggable","snap",{start:function(e,t,n){var r=n.options;n.snapElements=[],$(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each((function(){var e=$(this),t=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})}))},drag:function(e,t,n){var r,a,l,d,h,p,f,y,w,x,j=n.options,O=j.snapTolerance,C=t.offset.left,S=C+n.helperProportions.width,_=t.offset.top,k=_+n.helperProportions.height;for(w=n.snapElements.length-1;w>=0;w--)p=(h=n.snapElements[w].left-n.margins.left)+n.snapElements[w].width,y=(f=n.snapElements[w].top-n.margins.top)+n.snapElements[w].height,S<h-O||C>p+O||k<f-O||_>y+O||!$.contains(n.snapElements[w].item.ownerDocument,n.snapElements[w].item)?(n.snapElements[w].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[w].item})),n.snapElements[w].snapping=!1):("inner"!==j.snapMode&&(r=Math.abs(f-k)<=O,a=Math.abs(y-_)<=O,l=Math.abs(h-S)<=O,d=Math.abs(p-C)<=O,r&&(t.position.top=n._convertPositionTo("relative",{top:f-n.helperProportions.height,left:0}).top),a&&(t.position.top=n._convertPositionTo("relative",{top:y,left:0}).top),l&&(t.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left),d&&(t.position.left=n._convertPositionTo("relative",{top:0,left:p}).left)),x=r||a||l||d,"outer"!==j.snapMode&&(r=Math.abs(f-_)<=O,a=Math.abs(y-k)<=O,l=Math.abs(h-C)<=O,d=Math.abs(p-S)<=O,r&&(t.position.top=n._convertPositionTo("relative",{top:f,left:0}).top),a&&(t.position.top=n._convertPositionTo("relative",{top:y-n.helperProportions.height,left:0}).top),l&&(t.position.left=n._convertPositionTo("relative",{top:0,left:h}).left),d&&(t.position.left=n._convertPositionTo("relative",{top:0,left:p-n.helperProportions.width}).left)),!n.snapElements[w].snapping&&(r||a||l||d||x)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[w].item})),n.snapElements[w].snapping=r||a||l||d||x)}}),$.ui.plugin.add("draggable","stack",{start:function(e,t,n){var r,a=n.options,l=$.makeArray($(a.stack)).sort((function(e,t){return(parseInt($(e).css("zIndex"),10)||0)-(parseInt($(t).css("zIndex"),10)||0)}));l.length&&(r=parseInt($(l[0]).css("zIndex"),10)||0,$(l).each((function(e){$(this).css("zIndex",r+e)})),this.css("zIndex",r+l.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(e,t,n){var r=$(t.helper),a=n.options;r.css("zIndex")&&(a._zIndex=r.css("zIndex")),r.css("zIndex",a.zIndex)},stop:function(e,t,n){var r=n.options;r._zIndex&&$(t.helper).css("zIndex",r._zIndex)}});var draggable=$.ui.draggable;$.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){$.ui.ddmanager.droppables[e]=$.ui.ddmanager.droppables[e]||[],$.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=$.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){if("accept"===e)this.accept=$.isFunction(t)?t:function(e){return e.is(t)};else if("scope"===e){var n=$.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var n=t||$.ui.ddmanager.current,r=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var t=$(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&$.ui.intersect(n,$.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return r=!0,!1})),!r&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),$.ui.intersect=function(){function e(e,t,n){return e>=t&&e<t+n}return function(t,n,r,a){if(!n.offset)return!1;var l=(t.positionAbs||t.position.absolute).left+t.margins.left,d=(t.positionAbs||t.position.absolute).top+t.margins.top,h=l+t.helperProportions.width,p=d+t.helperProportions.height,f=n.offset.left,y=n.offset.top,w=f+n.proportions().width,x=y+n.proportions().height;switch(r){case"fit":return f<=l&&h<=w&&y<=d&&p<=x;case"intersect":return f<l+t.helperProportions.width/2&&h-t.helperProportions.width/2<w&&y<d+t.helperProportions.height/2&&p-t.helperProportions.height/2<x;case"pointer":return e(a.pageY,y,n.proportions().height)&&e(a.pageX,f,n.proportions().width);case"touch":return(d>=y&&d<=x||p>=y&&p<=x||d<y&&p>x)&&(l>=f&&l<=w||h>=f&&h<=w||l<f&&h>w);default:return!1}}}(),$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var n,r,a=$.ui.ddmanager.droppables[e.options.scope]||[],l=t?t.type:null,d=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<a.length;n++)if(!(a[n].options.disabled||e&&!a[n].accept.call(a[n].element[0],e.currentItem||e.element))){for(r=0;r<d.length;r++)if(d[r]===a[n].element[0]){a[n].proportions().height=0;continue e}a[n].visible="none"!==a[n].element.css("display"),a[n].visible&&("mousedown"===l&&a[n]._activate.call(a[n],t),a[n].offset=a[n].element.offset(),a[n].proportions({width:a[n].element[0].offsetWidth,height:a[n].element[0].offsetHeight}))}},drop:function(e,t){var n=!1;return $.each(($.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(e,this,this.options.tolerance,t)&&(n=this._drop.call(this,t)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))})),n},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",(function(){e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}))},drag:function(e,t){e.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(e,t);var n=$.ui.ddmanager.droppables[e.options.scope]||[];$.each(n,(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,a,l=$.ui.intersect(e,this,this.options.tolerance,t),d=!l&&this.isover?"isout":l&&!this.isover?"isover":null;d&&(this.options.greedy&&(r=this.options.scope,(a=this.element.parents(":data(ui-droppable)").filter((function(){return $(this).droppable("instance").options.scope===r}))).length&&((n=$(a[0]).droppable("instance")).enteredGreedyChild=n.enteredGreedyChild||"isover"===d,n.leftGreedyChild=n.leftGreedyChild||"isout"===d)),this[d]=!0,this["isout"===d?"isover":"isout"]=!1,this.c=d)}})),$.each(n,(function(){this.enteredGreedyChild&&(this.greedyChild=!0,this.isover=!1,this.isout=!0,this.c="isout"),this.leftGreedyChild&&!this.enteredGreedyChild&&(this.greedyChild=!1,this.isover=!0,this.isout=!1,this.c="isover"),this.c&&(this["isover"===this.c?"_over":"_out"].call(this,t),this.leftGreedyChild=!1,this.enteredGreedyChild=!1,this.c=null)}))},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}};var droppable=$.ui.droppable;!function($){var min=Math.min,max=Math.max,round=Math.floor,isStr=function(e){return"string"===$.type(e)},runPluginCallbacks=function(Instance,a_fn){if($.isArray(a_fn))for(var i=0,c=a_fn.length;i<c;i++){var fn=a_fn[i];try{isStr(fn)&&(fn=eval(fn)),$.isFunction(fn)&&g(fn)(Instance)}catch(e){}}function g(e){return e}};$.layout={version:"1.3.rc30.79",revision:.033007,browser:{},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects,panes,north,south,west,east,center".split(","),allPanes:"north,south,west,east,center".split(","),borderPanes:"north,south,west,east".split(","),oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){var t=$(e),n=t.data("layout")||t.data("parentLayout");if(n){var r=n.container;if(r.data("layoutPane"))return r;var a=r.closest("."+$.layout.defaults.panes.paneClass);if(a.data("layoutPane"))return a}return null},getParentPaneInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("layoutPane"):null},getParentLayoutInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("parentLayout"):null},getEventObject:function(e){return"object"==typeof e&&e.stopPropagation?e:null},parsePaneName:function(e){var t=$.layout.getEventObject(e),n=e;return t&&(t.stopPropagation(),n=$(this).data("layoutEdge")),n&&!/^(west|east|north|south|center)$/.test(n)&&($.layout.msg('LAYOUT ERROR - Invalid pane-name: "'+n+'"'),n="error"),n},plugins:{draggable:!!$.fn.draggable,effects:{core:!!$.effects,slide:$.effects&&($.effects.slide||$.effects.effect&&$.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),n={width:t.css("width")-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),window.scrollbarWidth=n.width,window.scrollbarHeight=n.height,e.match(/^(width|height)$/)?n[e]:n},showInvisibly:function(e,t){if(e&&e.length&&(t||"none"===e.css("display"))){var n=e[0].style,r={display:n.display||"",visibility:n.visibility||""};return e.css({display:"block",visibility:"hidden"}),r}return{}},getElementDimensions:function(e,t){var n,r,a,l={css:{},inset:{}},d=l.css,h={bottom:0},p=$.layout.cssNum,f=e.offset();return l.offsetLeft=f.left,l.offsetTop=f.top,t||(t={}),$.each("Left,Right,Top,Bottom".split(","),(function(p,f){n=d["border"+f]=$.layout.borderWidth(e,f),r=d["padding"+f]=$.layout.cssNum(e,"padding"+f),a=f.toLowerCase(),l.inset[a]=t[a]>=0?t[a]:r,h[a]=l.inset[a]+n})),d.width=e.width(),d.height=e.height(),d.top=p(e,"top",!0),d.bottom=p(e,"bottom",!0),d.left=p(e,"left",!0),d.right=p(e,"right",!0),l.outerWidth=e.outerWidth(),l.outerHeight=e.outerHeight(),l.innerWidth=max(0,l.outerWidth-h.left-h.right),l.innerHeight=max(0,l.outerHeight-h.top-h.bottom),l.layoutWidth=e.innerWidth(),l.layoutHeight=e.innerHeight(),l},getElementStyles:function(e,t){var n,r,a,l,d,h,p={},f=e[0].style,y=t.split(","),w="Top,Bottom,Left,Right".split(","),x="Color,Style,Width".split(",");for(l=0;l<y.length;l++)if((n=y[l]).match(/(border|padding|margin)$/))for(d=0;d<4;d++)if(r=w[d],"border"===n)for(h=0;h<3;h++)p[n+r+(a=x[h])]=f[n+r+a];else p[n+r]=f[n+r];else p[n]=f[n];return p},cssWidth:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,a=$.layout.cssNum,l=t;return"border-box"!==n&&(l-=r(e,"Left")+r(e,"Right")),"content-box"===n&&(l-=a(e,"paddingLeft")+a(e,"paddingRight")),max(0,l)},cssHeight:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,a=$.layout.cssNum,l=t;return"border-box"!==n&&(l-=r(e,"Top")+r(e,"Bottom")),"content-box"===n&&(l-=a(e,"paddingTop")+a(e,"paddingBottom")),max(0,l)},cssNum:function(e,t,n){e.jquery||(e=$(e));var r=$.layout.showInvisibly(e),a=$.css(e[0],t,!0),l=n&&"auto"==a?a:Math.round(parseFloat(a)||0);return e.css(r),l},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===$.css(e,n+"Style",!0)?0:Math.round(parseFloat($.css(e,n+"Width",!0))||0)},isMouseOverElem:function(e,t){var n=$(t||this),r=n.offset(),a=r.top,l=r.left,d=l+n.outerWidth(),h=a+n.outerHeight(),p=e.pageX,f=e.pageY;return $.layout.browser.msie&&p<0&&f<0||p>=l&&p<=d&&f>=a&&f<=h},msg:function(e,t,n,r){if($.isPlainObject(e)&&window.debugData){"string"==typeof t?(r=n,n=t):"object"==typeof n&&(r=n,n=null);var a=n||"log( <object> )",l=$.extend({sort:!1,returnHTML:!1,display:!1},r);!0===t||l.display?debugData(e,a,l):window.console&&console.log(debugData(e,a,l))}else if(t)alert(e);else if(window.console)console.log(e);else{var d=$("#layoutLogger");d.length||(d=function(){var e=$.support.fixedPosition?"fixed":"absolute",t=$('<div id="layoutLogger" style="position: '+e+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body");t.css("left",$(window).width()-t.outerWidth()-5),$.ui.draggable&&t.draggable({handle:":first-child"});return t}()),d.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>")}}};var u=navigator.userAgent.toLowerCase(),m=/(chrome)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(u)||[],b=m[1]||"",v=m[2]||0,ie="msie"===b;$.layout.browser={version:v,safari:"webkit"===b,webkit:"chrome"===b,msie:ie,isIE6:ie&&6==v,boxModel:!ie||!1!==$.support.boxModel},b&&($.layout.browser[b]=!0),ie&&$((function(){$.layout.browser.boxModel=$.support.boxModel})),$.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button\nInvalid ",containerMissing:"UI Layout Initialization Error\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\nThe center-pane element does not exist.\nThe center-pane is a required element.",noContainerHeight:"UI Layout Initialization Warning\nThe layout-container \"CONTAINER\" has no height.\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}},$.layout.optionsMap={layout:"name,instanceKey,stateManagement,effects,inset,zIndexes,errors,zIndex,scrollToBookmarkOnLoad,showErrorMessages,maskPanesEarly,outset,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end".split(","),center:"paneClass,contentSelector,contentIgnoreSelector,findNestedContent,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,maskContents,maskObjects,liveContentResizing,containerSelector,children,initChildren,resizeChildren,destroyChildren,onresize,onresize_start,onresize_end,onsizecontent,onsizecontent_start,onsizecontent_end".split(","),noDefault:"paneSelector,resizerCursor,customHotkey".split(",")},$.layout.transformData=function(e,t){var n,r,a,l,d,h,p,f=t?{panes:{},center:{}}:{};if("object"!=typeof e)return f;for(r in e)for(n=f,d=e[r],p=(a=r.split("__")).length-1,h=0;h<=p;h++)l=a[h],h===p?$.isPlainObject(d)?n[l]=$.layout.transformData(d):n[l]=d:(n[l]||(n[l]={}),n=n[l]);return f},$.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(e){var t,n,r,a=$.layout.backwardCompatibility.map;for(var l in a)void 0!==(r=(t=d(l)).branch[t.key])&&((n=d(a[l],!0)).branch[n.key]=r,delete t.branch[t.key]);function d(t,n){for(var r,a=t.split("."),l=a.length-1,d={branch:e,key:a[l]},h=0;h<l;h++)r=a[h],null==d.branch[r]?d.branch=n?d.branch[r]={}:{}:d.branch=d.branch[r];return d}},renameAllOptions:function(e){var t=$.layout.backwardCompatibility.renameOptions;return t(e),e.defaults&&("object"!=typeof e.panes&&(e.panes={}),$.extend(!0,e.panes,e.defaults),delete e.defaults),e.panes&&t(e.panes),$.each($.layout.config.allPanes,(function(n,r){e[r]&&t(e[r])})),e}},$.fn.layout=function(opts){var browser=$.layout.browser,_c=$.layout.config,cssW=$.layout.cssWidth,cssH=$.layout.cssHeight,elDims=$.layout.getElementDimensions,styles=$.layout.getElementStyles,evtObj=$.layout.getEventObject,evtPane=$.layout.parsePaneName,options=$.extend(!0,{},$.layout.defaults),effects=options.effects=$.extend(!0,{},$.layout.effects),state={id:"layout"+$.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},children={north:null,south:null,east:null,west:null,center:null},timer={data:{},set:function(e,t,n){timer.clear(e),timer.data[e]=setTimeout(t,n)},clear:function(e){var t=timer.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},_log=function(e,t,n){var r=options;return(r.showErrorMessages&&!n||n&&r.showDebugMessages)&&$.layout.msg(r.name+" / "+e,!1!==t),!1},_runCallbacks=function(evtName,pane,skipBoundEvents){var hasPane=pane&&isStr(pane),s=hasPane?state[pane]:state,o=hasPane?options[pane]:options,lName=options.name,lng=evtName+(evtName.match(/_/)?"":"_end"),shrt=lng.match(/_end$/)?lng.substr(0,lng.length-4):"",fn=o[lng]||o[shrt],retVal="NC",args=[],$P;return hasPane||"boolean"!==$.type(pane)||(skipBoundEvents=pane,pane=""),fn&&(isStr(fn)&&(fn.match(/,/)?(args=fn.split(","),fn=eval(args[0])):fn=eval(fn)),$.isFunction(fn)&&(retVal=args.length?g(fn)(args[1]):hasPane?g(fn)(pane,$Ps[pane],s,o,lName):g(fn)(Instance,s,o,lName))),skipBoundEvents||!1===retVal||(hasPane?($P=$Ps[pane],o=options[pane],s=state[pane],$P.triggerHandler("layoutpane"+lng,[pane,$P,s,o,lName]),shrt&&$P.triggerHandler("layoutpane"+shrt,[pane,$P,s,o,lName])):($N.triggerHandler("layout"+lng,[Instance,s,o,lName]),shrt&&$N.triggerHandler("layout"+shrt,[Instance,s,o,lName]))),hasPane&&"onresize_end"===evtName&&resizeChildren(pane+"",!0),retVal;function g(e){return e}},_fixIframe=function(e){if(!browser.mozilla){var t=$Ps[e];"IFRAME"===state[e].tagName?t.css(_c.hidden).css(_c.visible):t.find("IFRAME").css(_c.hidden).css(_c.visible)}},cssSize=function(e,t){return("horz"==_c[e].dir?cssH:cssW)($Ps[e],t)},cssMinDims=function(e){var t=$Ps[e],n=_c[e].dir,r={minWidth:1001-cssW(t,1e3),minHeight:1001-cssH(t,1e3)};return"horz"===n&&(r.minSize=r.minHeight),"vert"===n&&(r.minSize=r.minWidth),r},setOuterWidth=function(e,t,n){var r,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),r=cssW(a,t),a.css({width:r}),r>0?n&&a.data("autoHidden")&&a.innerHeight()>0&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},setOuterHeight=function(e,t,n){var r,a=e;isStr(e)?a=$Ps[e]:e.jquery||(a=$(e)),r=cssH(a,t),a.css({height:r,visibility:"visible"}),r>0&&a.innerWidth()>0?n&&a.data("autoHidden")&&(a.show().data("autoHidden",!1),browser.mozilla||a.css(_c.hidden).css(_c.visible)):n&&!a.data("autoHidden")&&a.hide().data("autoHidden",!0)},_parseSize=function(e,t,n){if(n||(n=_c[e].dir),isStr(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100),0===t)return 0;if(t>=1)return parseInt(t,10);var r=options,a=0;if("horz"==n?a=sC.innerHeight-($Ps.north?r.north.spacing_open:0)-($Ps.south?r.south.spacing_open:0):"vert"==n&&(a=sC.innerWidth-($Ps.west?r.west.spacing_open:0)-($Ps.east?r.east.spacing_open:0)),-1===t)return a;if(t>0)return round(a*t);if("center"==e)return 0;var l="horz"===n?"height":"width",d=$Ps[e],h="height"===l&&$Cs[e],p=$.layout.showInvisibly(d),f=d.css(l),y=h?h.css(l):0;return d.css(l,"auto"),h&&h.css(l,"auto"),t="height"===l?d.outerHeight():d.outerWidth(),d.css(l,f).css(p),h&&h.css(l,y),t},getPaneSize=function(e,t){var n=$Ps[e],r=options[e],a=state[e],l=t?r.spacing_open:0,d=t?r.spacing_closed:0;return!n||a.isHidden?0:a.isClosed||a.isSliding&&t?d:"horz"===_c[e].dir?n.outerHeight()+l:n.outerWidth()+l},setSizeLimits=function(e,t){if(isInitialized()){var n=options[e],r=state[e],a=_c[e],l=a.dir,d=(a.sizeType.toLowerCase(),null!=t?t:r.isSliding),h=($Ps[e],n.spacing_open),p=_c.oppositeEdge[e],f=state[p],y=$Ps[p],w=!y||!1===f.isVisible||f.isSliding?0:"horz"==l?y.outerHeight():y.outerWidth(),x=(!y||f.isHidden?0:options[p][!1!==f.isClosed?"spacing_closed":"spacing_open"])||0,j="horz"==l?sC.innerHeight:sC.innerWidth,O=cssMinDims("center"),C="horz"==l?max(options.center.minHeight,O.minHeight):max(options.center.minWidth,O.minWidth),S=j-h-(d?0:_parseSize("center",C,l)+w+x),_=r.minSize=max(_parseSize(e,n.minSize),cssMinDims(e).minSize),k=r.maxSize=min(n.maxSize?_parseSize(e,n.maxSize):1e5,S),E=r.resizerPosition={},A=sC.inset.top,T=sC.inset.left,R=sC.innerWidth,I=sC.innerHeight,P=n.spacing_open;switch(e){case"north":E.min=A+_,E.max=A+k;break;case"west":E.min=T+_,E.max=T+k;break;case"south":E.min=A+I-k-P,E.max=A+I-_-P;break;case"east":E.min=T+R-k-P,E.max=T+R-_-P}}},calcNewCenterPaneDims=function(){var e={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return e.width=sC.innerWidth-e.left-e.right,e.height=sC.innerHeight-e.bottom-e.top,e.top+=sC.inset.top,e.bottom+=sC.inset.bottom,e.left+=sC.inset.left,e.right+=sC.inset.right,e},getHoverClasses=function(e,t){var n=$(e),r=n.data("layoutRole"),a=n.data("layoutEdge"),l=options[a][r+"Class"],d="-"+a,h="-hover ",p=n.hasClass(l+"-closed")?"-closed":"-open",f="-closed"===p?"-open":"-closed",y=l+h+(l+d+h)+(l+p+h)+(l+d+p+h);return t&&(y+=l+f+h+(l+d+f+h)),"resizer"==r&&n.hasClass(l+"-sliding")&&(y+=l+"-sliding"+h+(l+d)+"-sliding"+h),$.trim(y)},addHover=function(e,t){var n=$(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation(),n.addClass(getHoverClasses(n))},removeHover=function(e,t){var n=$(t||this);n.removeClass(getHoverClasses(n,!0))},onResizerEnter=function(e){var t=$(this).data("layoutEdge"),n=state[t];n.isClosed||n.isResizing||state.paneResizing||($.fn.disableSelection&&$("body").disableSelection(),options.maskPanesEarly&&showMasks(t,{resizing:!0}))},onResizerLeave=function(e,t){var n=t||this,r=$(n).data("layoutEdge"),a=r+"ResizerLeave";timer.clear(r+"_openSlider"),timer.clear(a),t?state.paneResizing||($.fn.enableSelection&&$("body").enableSelection(),options.maskPanesEarly&&hideMasks()):timer.set(a,(function(){onResizerLeave(e,n)}),200)},_create=function(){initOptions();var e=options,t=state;return t.creatingLayout=!0,runPluginCallbacks(Instance,$.layout.onCreate),!1===_runCallbacks("onload_start")?"cancel":(_initContainer(),initHotkeys(),$(window).bind("unload."+sID,unload),runPluginCallbacks(Instance,$.layout.onLoad),e.initPanes&&_initLayoutElements(),delete t.creatingLayout,state.initialized)},isInitialized=function(){return!(!state.initialized&&!state.creatingLayout)||_initLayoutElements()},_initLayoutElements=function(e){var t=options;if(!$N.is(":visible"))return!e&&browser.webkit&&"BODY"===$N[0].tagName&&setTimeout((function(){_initLayoutElements(!0)}),50),!1;if(!getPane("center").length)return _log(t.errors.centerPaneMissing);if(state.creatingLayout=!0,$.extend(sC,elDims($N,t.inset)),initPanes(),t.scrollToBookmarkOnLoad){var n=self.location;n.hash&&n.replace(n.hash)}return Instance.hasParentLayout?t.resizeWithWindow=!1:t.resizeWithWindow&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,runPluginCallbacks(Instance,$.layout.onReady),_runCallbacks("onload_end"),!0},createChildren=function(e,t){var n=evtPane.call(this,e),r=$Ps[n];if(r){var a=$Cs[n],l=state[n],d=options[n],h=options.stateManagement||{},p=t?d.children=t:d.children;if($.isPlainObject(p))p=[p];else if(!p||!$.isArray(p))return;$.each(p,(function(e,t){$.isPlainObject(t)&&(t.containerSelector?r.find(t.containerSelector):a||r).each((function(){var e=$(this),r=e.data("layout");if(!r){if(setInstanceKey({container:e,options:t},l),h.includeChildren&&state.stateData[n]){var a=(state.stateData[n].children||{})[t.instanceKey],d=t.stateManagement||(t.stateManagement={autoLoad:!0});!0===d.autoLoad&&a&&(d.autoSave=!1,d.includeChildren=!0,d.autoLoad=$.extend(!0,{},a))}(r=e.layout(t))&&refreshChildren(n,r)}}))}))}},setInstanceKey=function(e,t){var n=e.container,r=e.options,a=r.stateManagement,l=r.instanceKey||n.data("layoutInstanceKey");return l||(l=(a&&a.cookie?a.cookie.name:"")||r.name),l=l?l.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++t.childIdx,r.instanceKey=l,n.data("layoutInstanceKey",l),l},refreshChildren=function(e,t){var n,r=$Ps[e],a=children[e],l=state[e];$.isPlainObject(a)&&($.each(a,(function(e,t){t.destroyed&&delete a[e]})),$.isEmptyObject(a)&&(a=children[e]=null)),t||a||(t=r.data("layout")),t&&(t.hasParentLayout=!0,n=t.options,setInstanceKey(t,l),a||(a=children[e]={}),a[n.instanceKey]=t.container.data("layout")),Instance[e].children=children[e],t||createChildren(e)},windowResize=function(){var e=options,t=Number(e.resizeWithWindowDelay);t<10&&(t=100),timer.clear("winResize"),timer.set("winResize",(function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var t=elDims($N,e.inset);t.innerWidth===sC.innerWidth&&t.innerHeight===sC.innerHeight||resizeAll()}),t),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function(){var e=Number(options.resizeWithWindowMaxDelay);e>0&&timer.set("winResizeRepeater",(function(){setWindowResizeRepeater(),resizeAll()}),e)},unload=function(){_runCallbacks("onunload_start"),runPluginCallbacks(Instance,$.layout.onUnload),_runCallbacks("onunload_end")},_initContainer=function(){var e,t,n=$N[0],r=$("html"),a=sC.tagName=n.tagName,l=sC.id=n.id,d=sC.className=n.className,h=options,p=h.name,f="position,margin,padding,border",y="layoutCSS",w={},x="hidden",j=$N.data("parentLayout"),O=$N.data("layoutEdge"),C=j&&O,S=$.layout.cssNum;sC.selector=$N.selector.split(".slice")[0],sC.ref=(h.name?h.name+" layout / ":"")+a+(l?"#"+l:d?".["+d+"]":""),sC.isBody="BODY"===a,C||sC.isBody||(j=(e=$N.closest("."+$.layout.defaults.panes.paneClass)).data("parentLayout"),O=e.data("layoutEdge"),C=j&&O),$N.data({layout:Instance,layoutContainer:sID}).addClass(h.containerClass);var _={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(p in _)$N.bind("layout"+p.toLowerCase()+"."+sID,Instance[_[p]||p]);C&&(Instance.hasParentLayout=!0,j.refreshChildren(O,Instance)),$N.data(y)||(sC.isBody?($N.data(y,$.extend(styles($N,f),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")})),r.data(y,$.extend(styles(r,"padding"),{height:"auto",overflow:r.css("overflow"),overflowX:r.css("overflowX"),overflowY:r.css("overflowY")}))):$N.data(y,styles($N,f+",top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{if(w={overflow:x,overflowX:x,overflowY:x},$N.css(w),h.inset&&!$.isPlainObject(h.inset)&&(t=parseInt(h.inset,10)||0,h.inset={top:t,bottom:t,left:t,right:t}),sC.isBody)h.outset?$.isPlainObject(h.outset)||(t=parseInt(h.outset,10)||0,h.outset={top:t,bottom:t,left:t,right:t}):h.outset={top:S(r,"paddingTop"),bottom:S(r,"paddingBottom"),left:S(r,"paddingLeft"),right:S(r,"paddingRight")},r.css(w).css({height:"100%",border:"none",padding:0,margin:0}),browser.isIE6?($N.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),h.inset||(h.inset=elDims($N).inset)):($N.css({width:"auto",height:"auto",margin:0,position:"absolute"}),$N.css(h.outset)),$.extend(sC,elDims($N,h.inset));else{var k=$N.css("position");k&&k.match(/(fixed|absolute|relative)/)||$N.css("position","relative"),$N.is(":visible")&&($.extend(sC,elDims($N,h.inset)),sC.innerHeight<1&&_log(h.errors.noContainerHeight.replace(/CONTAINER/,sC.ref)))}S($N,"minWidth")&&$N.parent().css("overflowX","auto"),S($N,"minHeight")&&$N.parent().css("overflowY","auto")}catch(e){}},initHotkeys=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=options[t];if(n.enableCursorHotkey||n.customHotkey)return $(document).bind("keydown."+sID,keyDown),!1}))},initOptions=function(){var e,t,n,r,a,l,d;if(opts=$.layout.transformData(opts,!0),opts=$.layout.backwardCompatibility.renameAllOptions(opts),!$.isEmptyObject(opts.panes)){for(e=$.layout.optionsMap.noDefault,a=0,l=e.length;a<l;a++)n=e[a],delete opts.panes[n];for(e=$.layout.optionsMap.layout,a=0,l=e.length;a<l;a++)n=e[a],delete opts.panes[n]}e=$.layout.optionsMap.layout;var h=$.layout.config.optionRootKeys;for(n in opts)r=opts[n],$.inArray(n,h)<0&&$.inArray(n,e)<0&&(opts.panes[n]||(opts.panes[n]=$.isPlainObject(r)?$.extend(!0,{},r):r),delete opts[n]);$.extend(!0,options,opts),$.each(_c.allPanes,(function(r,a){if(_c[a]=$.extend(!0,{},_c.panes,_c[a]),t=options.panes,d=options[a],"center"===a)for(e=$.layout.optionsMap.center,r=0,l=e.length;r<l;r++)n=e[r],opts.center[n]||!opts.panes[n]&&d[n]||(d[n]=t[n]);else d=options[a]=$.extend(!0,{},t,d),function(e){var t=options[e],n=options.panes;t.fxSettings||(t.fxSettings={});n.fxSettings||(n.fxSettings={});$.each(["_open","_close","_size"],(function(r,a){var l="fxName"+a,d="fxSpeed"+a,h="fxSettings"+a,p=t[l]=t[l]||n[l]||t.fxName||n.fxName||"none",f=$.effects&&($.effects[p]||$.effects.effect&&$.effects.effect[p]);"none"!==p&&options.effects[p]&&f||(p=t[l]="none");var y=options.effects[p]||{},w=y.all||null,x=y[e]||null;t[d]=t[d]||n[d]||t.fxSpeed||n.fxSpeed||null,t[h]=$.extend(!0,{},w,x,n.fxSettings,t.fxSettings,n[h],t[h])})),delete t.fxName,delete t.fxSpeed,delete t.fxSettings}(a),d.resizerClass||(d.resizerClass="ui-layout-resizer"),d.togglerClass||(d.togglerClass="ui-layout-toggler");d.paneClass||(d.paneClass="ui-layout-pane")}));var p=opts.zIndex,f=options.zIndexes;p>0&&(f.pane_normal=p,f.content_mask=max(p+1,f.content_mask),f.resizer_normal=max(p+2,f.resizer_normal)),delete options.panes},getPane=function(e){var t=options[e].paneSelector;if("#"===t.substr(0,1))return $N.find(t).eq(0);var n=$N.children(t).eq(0);return n.length?n:$N.children("form:first").children(t).eq(0)},initPanes=function(e){evtPane(e),$.each(_c.allPanes,(function(e,t){addPane(t,!0)})),initHandles(),$.each(_c.borderPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&(setSizeLimits(t),makePaneFit(t))})),sizeMidPanes("center"),$.each(_c.allPanes,(function(e,t){afterInitPane(t)}))},addPane=function(e,t){if(t||isInitialized()){var n,r,a,l=options[e],d=state[e],h=_c[e],p=h.dir,f=(d.fx,l.spacing_open,"center"===e),y={},w=$Ps[e];if(w?removePane(e,!1,!0,!1):$Cs[e]=!1,(w=$Ps[e]=getPane(e)).length){if(!w.data("layoutCSS")){w.data("layoutCSS",styles(w,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"))}Instance[e]={name:e,pane:$Ps[e],content:$Cs[e],options:options[e],state:state[e],children:children[e]},w.data({parentLayout:Instance,layoutPane:Instance[e],layoutEdge:e,layoutRole:"pane"}).css(h.cssReq).css("zIndex",options.zIndexes.pane_normal).css(l.applyDemoStyles?h.cssDemo:{}).addClass(l.paneClass+" "+l.paneClass+"-"+e).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover);var x,j={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(x in j)w.bind("layoutpane"+x.toLowerCase()+"."+sID,Instance[j[x]||x]);initContent(e,!1),f||(n=d.size=_parseSize(e,l.size),r=_parseSize(e,l.minSize)||1,a=_parseSize(e,l.maxSize)||1e5,n>0&&(n=max(min(n,a),r)),d.autoResize=l.autoResize,d.isClosed=!1,d.isSliding=!1,d.isResizing=!1,d.isHidden=!1,d.pins||(d.pins=[])),d.tagName=w[0].tagName,d.edge=e,d.noRoom=!1,d.isVisible=!0,setPanePosition(e),"horz"===p?y.height=cssH(w,n):"vert"===p&&(y.width=cssW(w,n)),w.css(y),"horz"!=p&&sizeMidPanes(e,!0),state.initialized&&(initHandles(e),initHotkeys(e)),l.initClosed&&l.closable&&!l.initHidden?close(e,!0,!0):l.initHidden||l.initClosed?hide(e):d.noRoom||w.css("display","block"),w.css("visibility","visible"),l.showOverflowOnHover&&w.hover(allowOverflow,resetOverflow),state.initialized&&afterInitPane(e)}else $Ps[e]=!1}},afterInitPane=function(e){var t=$Ps[e],n=state[e],r=options[e];t&&(t.data("layout")&&refreshChildren(e,t.data("layout")),n.isVisible&&(state.initialized?resizeAll():sizeContent(e),r.triggerEventsOnLoad?_runCallbacks("onresize_end",e):resizeChildren(e,!0)),r.initChildren&&r.children&&createChildren(e))},setPanePosition=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t],r=$Rs[t],a=(options[t],state[t]),l=_c[t].side,d={};if(n){switch(t){case"north":d.top=sC.inset.top,d.left=sC.inset.left,d.right=sC.inset.right;break;case"south":d.bottom=sC.inset.bottom,d.left=sC.inset.left,d.right=sC.inset.right;break;case"west":d.left=sC.inset.left;break;case"east":d.right=sC.inset.right}n.css(d),r&&a.isClosed?r.css(l,sC.inset[l]):r&&!a.isHidden&&r.css(l,sC.inset[l]+getPaneSize(t))}}))},initHandles=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t];if($Rs[t]=!1,$Ts[t]=!1,n){var r=options[t],a=state[t],l=(_c[t],"#"===r.paneSelector.substr(0,1)?r.paneSelector.substr(1):""),d=r.resizerClass,h=r.togglerClass,p=(a.isVisible?r.spacing_open:r.spacing_closed,"-"+t),f=(a.isVisible,Instance[t]),y=f.resizer=$Rs[t]=$("<div></div>"),w=f.toggler=!!r.closable&&($Ts[t]=$("<div></div>"));!a.isVisible&&r.slidable&&y.attr("title",r.tips.Slide).css("cursor",r.sliderCursor),y.attr("id",l?l+"-resizer":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"resizer"}).css(_c.resizers.cssReq).css("zIndex",options.zIndexes.resizer_normal).css(r.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(d+" "+d+p).hover(addHover,removeHover).hover(onResizerEnter,onResizerLeave).appendTo($N),r.resizerDblClickToggle&&y.bind("dblclick."+sID,toggle),w&&(w.attr("id",l?l+"-toggler":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"toggler"}).css(_c.togglers.cssReq).css(r.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(h+" "+h+p).hover(addHover,removeHover).bind("mouseenter",onResizerEnter).appendTo(y),r.togglerContent_open&&$("<span>"+r.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(w),r.togglerContent_closed&&$("<span>"+r.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(w),enableClosable(t)),initResizable(t),a.isVisible?setAsOpen(t):(setAsClosed(t),bindStartSlidingEvents(t,!0))}})),sizeHandles()},initContent=function(e,t){if(isInitialized()){var n,r=options[e],a=r.contentSelector,l=Instance[e],d=$Ps[e];a&&(n=l.content=$Cs[e]=r.findNestedContent?d.find(a).eq(0):d.children(a).eq(0)),n&&n.length?(n.data("layoutRole","content"),n.data("layoutCSS")||n.data("layoutCSS",styles(n,"height")),n.css(_c.content.cssReq),r.applyDemoStyles&&(n.css(_c.content.cssDemo),d.css(_c.content.cssDemoPane)),d.css("overflowX").match(/(scroll|auto)/)&&d.css("overflow","hidden"),state[e].content={},!1!==t&&sizeContent(e)):l.content=$Cs[e]=!1}},initResizable=function(e){var t=$.layout.plugins.draggable;e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,r){var a=options[r];if(!t||!$Ps[r]||!a.resizable)return a.resizable=!1,!0;var l,d,h=state[r],p=options.zIndexes,f=_c[r],y="horz"==f.dir?"top":"left",w=($Ps[r],$Rs[r]),x=a.resizerClass,j=0,O=x+"-drag",C=x+"-"+r+"-drag",S=x+"-dragging",_=x+"-"+r+"-dragging",k=x+"-dragging-limit",E=x+"-"+r+"-dragging-limit",A=!1;h.isClosed||w.attr("title",a.tips.Resize).css("cursor",a.resizerCursor),w.draggable({containment:$N[0],axis:"horz"==f.dir?"y":"x",delay:0,distance:1,grid:a.resizingGrid,helper:"clone",opacity:a.resizerDragOpacity,addClasses:!1,zIndex:p.resizer_drag,start:function(e,t){if(a=options[r],h=state[r],d=a.livePaneResizing,!1===_runCallbacks("ondrag_start",r))return!1;h.isResizing=!0,state.paneResizing=r,timer.clear(r+"_closeSlider"),setSizeLimits(r),l=h.resizerPosition,j=t.position[y],w.addClass(O+" "+C),A=!1,$("body").disableSelection(),showMasks(r,{resizing:!0})},drag:function(e,t){A||(t.helper.addClass(S+" "+_).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),A=!0,h.isSliding&&$Ps[r].css("zIndex",p.pane_sliding));var f=0;t.position[y]<l.min?(t.position[y]=l.min,f=-1):t.position[y]>l.max&&(t.position[y]=l.max,f=1),f?(t.helper.addClass(k+" "+E),window.defaultStatus=f>0&&r.match(/(north|west)/)||f<0&&r.match(/(south|east)/)?a.tips.maxSizeWarning:a.tips.minSizeWarning):(t.helper.removeClass(k+" "+E),window.defaultStatus=""),d&&Math.abs(t.position[y]-j)>=a.liveResizingTolerance&&(j=t.position[y],n(e,t,r))},stop:function(e,t){$("body").enableSelection(),window.defaultStatus="",w.removeClass(O+" "+C),h.isResizing=!1,state.paneResizing=!1,n(e,t,r,!0)}})}));var n=function(e,t,n,r){var a,l=t.position,d=_c[n],h=options[n],p=state[n];switch(n){case"north":a=l.top;break;case"west":a=l.left;break;case"south":a=sC.layoutHeight-l.top-h.spacing_open;break;case"east":a=sC.layoutWidth-l.left-h.spacing_open}var f=a-sC.inset[d.side];if(r)!1!==_runCallbacks("ondrag_end",n)&&manualSizePane(n,f,!1,!0),hideMasks(!0),p.isSliding&&showMasks(n,{resizing:!0});else{if(Math.abs(f-p.size)<h.liveResizingTolerance)return;manualSizePane(n,f,!1,!0),sizeMasks()}}},sizeMask=function(){var e=$(this),t=e.data("layoutMask"),n=state[t];"IFRAME"==n.tagName&&n.isVisible&&e.css({top:n.offsetTop,left:n.offsetLeft,width:n.outerWidth,height:n.outerHeight})},sizeMasks=function(){$Ms.each(sizeMask)},showMasks=function(e,t){var n,r,a=_c[e],l=["center"],d=options.zIndexes,h=$.extend({objectsOnly:!1,animation:!1,resizing:!0,sliding:state[e].isSliding},t);h.resizing&&l.push(e),h.sliding&&l.push(_c.oppositeEdge[e]),"horz"===a.dir&&(l.push("west"),l.push("east")),$.each(l,(function(e,t){r=state[t],n=options[t],r.isVisible&&(n.maskObjects||!h.objectsOnly&&n.maskContents)&&getMasks(t).each((function(){sizeMask.call(this),this.style.zIndex=r.isSliding?d.pane_sliding+1:d.pane_normal+1,this.style.display="block"}))}))},hideMasks=function(e){if(e||!state.paneResizing)$Ms.hide();else if(!e&&!$.isEmptyObject(state.panesSliding))for(var t,n,r=$Ms.length-1;r>=0;r--)t=(n=$Ms.eq(r)).data("layoutMask"),options[t].maskObjects||n.hide()},getMasks=function(e){for(var t,n=$([]),r=0,a=$Ms.length;r<a;r++)(t=$Ms.eq(r)).data("layoutMask")===e&&(n=n.add(t));return n.length?n:createMasks(e)},createMasks=function(e){var t,n,r,a,l,d=$Ps[e],h=state[e],p=options[e],f=options.zIndexes,y=$([]);if(!p.maskContents&&!p.maskObjects)return y;for(l=0;l<(p.maskObjects?2:1);l++)t=p.maskObjects&&0==l,n=document.createElement(t?"iframe":"div"),r=$(n).data("layoutMask",e),n.className="ui-layout-mask ui-layout-mask-"+e,(a=n.style).display="block",a.position="absolute",a.background="#FFF",t&&(n.frameborder=0,n.src="about:blank",a.opacity=0,a.filter="Alpha(Opacity='0')",a.border=0),"IFRAME"==h.tagName?(a.zIndex=f.pane_normal+1,$N.append(n)):(r.addClass("ui-layout-mask-inside-pane"),a.zIndex=p.maskZindex||f.content_mask,a.top=0,a.left=0,a.width="100%",a.height="100%",d.append(n)),y=y.add(n),$Ms=$Ms.add(n);return y},destroy=function(e,t){$(window).unbind("."+sID),$(document).unbind("."+sID),"object"==typeof e?evtPane(e):t=e,$N.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(options.containerClass).unbind("."+sID),$Ms.remove(),$.each(_c.allPanes,(function(e,n){removePane(n,!1,!0,t)}));var n="layoutCSS";for(var r in $N.data(n)&&!$N.data("layoutRole")&&$N.css($N.data(n)).removeData(n),"BODY"===sC.tagName&&($N=$("html")).data(n)&&$N.css($N.data(n)).removeData(n),runPluginCallbacks(Instance,$.layout.onDestroy),unload(),Instance)r.match(/^(container|options)$/)||delete Instance[r];return Instance.destroyed=!0,Instance},removePane=function(e,t,n,r){if(isInitialized()){var a=evtPane.call(this,e),l=$Ps[a],d=$Cs[a],h=$Rs[a],p=$Ts[a];l&&$.isEmptyObject(l.data())&&(l=!1),d&&$.isEmptyObject(d.data())&&(d=!1),h&&$.isEmptyObject(h.data())&&(h=!1),p&&$.isEmptyObject(p.data())&&(p=!1),l&&l.stop(!0,!0);var f=options[a],y=(state[a],"layoutCSS"),w=children[a],x=$.isPlainObject(w)&&!$.isEmptyObject(w),j=void 0!==r?r:f.destroyChildren;if(x&&j&&($.each(w,(function(e,t){t.destroyed||t.destroy(!0),t.destroyed&&delete w[e]})),$.isEmptyObject(w)&&(w=children[a]=null,x=!1)),l&&t&&!x)l.remove();else if(l&&l[0]){var O=f.paneClass,C=O+"-"+a,S=[O,O+"-open",O+"-closed",O+"-sliding",C,C+"-open",C+"-closed",C+"-sliding"];$.merge(S,getHoverClasses(l,!0)),l.removeClass(S.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),x&&d?(d.width(d.width()),$.each(w,(function(e,t){t.resizeAll()}))):d&&d.css(d.data(y)).removeData(y).removeData("layoutRole"),l.data("layout")||l.css(l.data(y)).removeData(y)}p&&p.remove(),h&&h.remove(),Instance[a]=$Ps[a]=$Cs[a]=$Rs[a]=$Ts[a]=!1,{removed:!0},n||resizeAll()}},_hidePane=function(e){var t=$Ps[e],n=options[e],r=t[0].style;n.useOffscreenClose?(t.data(_c.offscreenReset)||t.data(_c.offscreenReset,{left:r.left,right:r.right}),t.css(_c.offscreenCSS)):t.hide().removeData(_c.offscreenReset)},_showPane=function(e){var t=$Ps[e],n=options[e],r=_c.offscreenCSS,a=t.data(_c.offscreenReset),l=t[0].style;t.show().removeData(_c.offscreenReset),n.useOffscreenClose&&a&&(l.left==r.left&&(l.left=a.left),l.right==r.right&&(l.right=a.right))},hide=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=options[n],a=state[n],l=$Ps[n],d=$Rs[n];l&&!a.isHidden&&(state.initialized&&!1===_runCallbacks("onhide_start",n)||(a.isSliding=!1,delete state.panesSliding[n],d&&d.hide(),!state.initialized||a.isClosed?(a.isClosed=!0,a.isHidden=!0,a.isVisible=!1,state.initialized||_hidePane(n),sizeMidPanes("horz"===_c[n].dir?"":"center"),(state.initialized||r.triggerEventsOnLoad)&&_runCallbacks("onhide_end",n)):(a.isHiding=!0,close(n,!1,t))))}},show=function(e,t,n,r){if(isInitialized()){var a=evtPane.call(this,e),l=(options[a],state[a]),d=$Ps[a];$Rs[a];d&&l.isHidden&&!1!==_runCallbacks("onshow_start",a)&&(l.isShowing=!0,l.isSliding=!1,delete state.panesSliding[a],!1===t?close(a,!0):open(a,!1,n,r))}},toggle=function(e,t){if(isInitialized()){var n=evtObj(e),r=evtPane.call(this,e),a=state[r];n&&n.stopImmediatePropagation(),a.isHidden?show(r):a.isClosed?open(r,!!t):close(r)}},_closePane=function(e,t){$Ps[e];var n=state[e];_hidePane(e),n.isClosed=!0,n.isVisible=!1,t&&setAsClosed(e)},close=function(e,t,n,r){var a=evtPane.call(this,e);if(state.initialized||!$Ps[a]){if(isInitialized()){var l,d,h,p=$Ps[a],f=($Rs[a],$Ts[a],options[a]),y=state[a];_c[a];$N.queue((function(e){if(!p||!f.closable&&!y.isShowing&&!y.isHiding||!t&&y.isClosed&&!y.isShowing)return e();var r=!y.isShowing&&!1===_runCallbacks("onclose_start",a);if(d=y.isShowing,h=y.isHiding,y.isSliding,delete y.isShowing,delete y.isHiding,r)return e();l=!n&&!y.isClosed&&"none"!=f.fxName_close,y.isMoving=!0,y.isClosed=!0,y.isVisible=!1,h?y.isHidden=!0:d&&(y.isHidden=!1),y.isSliding?bindStopSlidingEvents(a,!1):sizeMidPanes("horz"===_c[a].dir?"":"center",!1),setAsClosed(a),l?(lockPaneForFX(a,!0),p.hide(f.fxName_close,f.fxSettings_close,f.fxSpeed_close,(function(){lockPaneForFX(a,!1),y.isClosed&&w(),e()}))):(_hidePane(a),w(),e())}))}}else _closePane(a,!0);function w(){y.isMoving=!1,bindStartSlidingEvents(a,!0);var e=_c.oppositeEdge[a];state[e].noRoom&&(setSizeLimits(e),makePaneFit(e)),r||!state.initialized&&!f.triggerEventsOnLoad||(d||_runCallbacks("onclose_end",a),d&&_runCallbacks("onshow_end",a),h&&_runCallbacks("onhide_end",a))}},setAsClosed=function(e){if($Rs[e]){$Ps[e];var t=$Rs[e],n=$Ts[e],r=options[e],a=(state[e],_c[e].side),l=r.resizerClass,d=r.togglerClass,h="-"+e;t.css(a,sC.inset[a]).removeClass(l+"-open "+l+h+"-open").removeClass(l+"-sliding "+l+h+"-sliding").addClass(l+"-closed "+l+h+"-closed"),r.resizable&&$.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),n&&(n.removeClass(d+"-open "+d+h+"-open").addClass(d+"-closed "+d+h+"-closed").attr("title",r.tips.Open),n.children(".content-open").hide(),n.children(".content-closed").css("display","block")),syncPinBtns(e,!1),state.initialized&&sizeHandles()}},open=function(e,t,n,r){if(isInitialized()){var a,l,d=evtPane.call(this,e),h=$Ps[d],p=($Rs[d],$Ts[d],options[d]),f=state[d];_c[d];$N.queue((function(e){if(!h||!p.resizable&&!p.closable&&!f.isShowing||f.isVisible&&!f.isSliding)return e();if(f.isHidden&&!f.isShowing)return e(),void show(d,!0);f.autoResize&&f.size!=p.size?sizePane(d,p.size,!0,!0,!0):setSizeLimits(d,t);var w=_runCallbacks("onopen_start",d);return"abort"===w?e():("NC"!==w&&setSizeLimits(d,t),f.minSize>f.maxSize?(syncPinBtns(d,!1),!r&&p.tips.noRoomToOpen&&alert(p.tips.noRoomToOpen),e()):(t?bindStopSlidingEvents(d,!0):f.isSliding?bindStopSlidingEvents(d,!1):p.slidable&&bindStartSlidingEvents(d,!1),f.noRoom=!1,makePaneFit(d),l=f.isShowing,delete f.isShowing,a=!n&&f.isClosed&&"none"!=p.fxName_open,f.isMoving=!0,f.isVisible=!0,f.isClosed=!1,l&&(f.isHidden=!1),void(a?(lockPaneForFX(d,!0),h.show(p.fxName_open,p.fxSettings_open,p.fxSpeed_open,(function(){lockPaneForFX(d,!1),f.isVisible&&y(),e()}))):(_showPane(d),y(),e()))))}))}function y(){f.isMoving=!1,_fixIframe(d),f.isSliding||sizeMidPanes("vert"==_c[d].dir?"center":"",!1),setAsOpen(d)}},setAsOpen=function(e,t){var n=$Ps[e],r=$Rs[e],a=$Ts[e],l=options[e],d=state[e],h=_c[e].side,p=l.resizerClass,f=l.togglerClass,y="-"+e;r.css(h,sC.inset[h]+getPaneSize(e)).removeClass(p+"-closed "+p+y+"-closed").addClass(p+"-open "+p+y+"-open"),d.isSliding?r.addClass(p+"-sliding "+p+y+"-sliding"):r.removeClass(p+"-sliding "+p+y+"-sliding"),removeHover(0,r),l.resizable&&$.layout.plugins.draggable?r.draggable("enable").css("cursor",l.resizerCursor).attr("title",l.tips.Resize):d.isSliding||r.css("cursor","default"),a&&(a.removeClass(f+"-closed "+f+y+"-closed").addClass(f+"-open "+f+y+"-open").attr("title",l.tips.Close),removeHover(0,a),a.children(".content-closed").hide(),a.children(".content-open").css("display","block")),syncPinBtns(e,!d.isSliding),$.extend(d,elDims(n)),state.initialized&&(sizeHandles(),sizeContent(e,!0)),!t&&(state.initialized||l.triggerEventsOnLoad)&&n.is(":visible")&&(_runCallbacks("onopen_end",e),d.isShowing&&_runCallbacks("onshow_end",e),state.initialized&&_runCallbacks("onresize_end",e))},slideOpen=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=state[n],a=options[n].slideDelay_open;t&&t.stopImmediatePropagation(),r.isClosed&&t&&"mouseenter"===t.type&&a>0?timer.set(n+"_openSlider",l,a):l()}function l(){r.isClosed?r.isMoving||open(n,!0):bindStopSlidingEvents(n,!0)}},slideClose=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=options[n],a=state[n],l=a.isMoving?1e3:300;if(!a.isClosed&&!a.isResizing)if("click"===r.slideTrigger_close)d();else{if(r.preventQuickSlideClose&&a.isMoving)return;if(r.preventPrematureSlideClose&&t&&$.layout.isMouseOverElem(t,$Ps[n]))return;t?timer.set(n+"_closeSlider",d,max(r.slideDelay_close,l)):d()}}function d(){a.isClosed?bindStopSlidingEvents(n,!1):a.isMoving||close(n)}},slideToggle=function(e){var t=evtPane.call(this,e);toggle(t,!0)},lockPaneForFX=function(e,t){var n=$Ps[e],r=state[e],a=options[e],l=options.zIndexes;t?(showMasks(e,{animation:!0,objectsOnly:!0}),n.css({zIndex:l.pane_animate}),"south"==e?n.css({top:sC.inset.top+sC.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:sC.inset.left+sC.innerWidth-n.outerWidth()})):(hideMasks(),n.css({zIndex:r.isSliding?l.pane_sliding:l.pane_normal}),"south"==e?n.css({top:"auto"}):"east"!=e||n.css("left").match(/\-99999/)||n.css({left:"auto"}),browser.msie&&a.fxOpacityFix&&"slide"!=a.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},bindStartSlidingEvents=function(e,t){var n=options[e],r=($Ps[e],$Rs[e]),a=n.slideTrigger_open.toLowerCase();!r||t&&!n.slidable||(a.match(/mouseover/)?a=n.slideTrigger_open="mouseenter":a.match(/(click|dblclick|mouseenter)/)||(a=n.slideTrigger_open="click"),n.resizerDblClickToggle&&a.match(/click/)&&r[t?"unbind":"bind"]("dblclick."+sID,toggle),r[t?"bind":"unbind"](a+"."+sID,slideOpen).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.tips.Slide:""))},bindStopSlidingEvents=function(e,t){var n=options[e],r=state[e],a=(_c[e],options.zIndexes),l=n.slideTrigger_close.toLowerCase(),d=t?"bind":"unbind",h=$Ps[e],p=$Rs[e];function f(t){timer.clear(e+"_closeSlider"),t.stopPropagation()}timer.clear(e+"_closeSlider"),t?(r.isSliding=!0,state.panesSliding[e]=!0,bindStartSlidingEvents(e,!1)):(r.isSliding=!1,delete state.panesSliding[e]),h.css("zIndex",t?a.pane_sliding:a.pane_normal),p.css("zIndex",t?a.pane_sliding+2:a.resizer_normal),l.match(/(click|mouseleave)/)||(l=n.slideTrigger_close="mouseleave"),p[d](l,slideClose),"mouseleave"===l&&(h[d]("mouseleave."+sID,slideClose),p[d]("mouseenter."+sID,f),h[d]("mouseenter."+sID,f)),t?"click"!==l||n.resizable||(p.css("cursor",t?n.sliderCursor:"default"),p.attr("title",t?n.tips.Close:"")):timer.clear(e+"_closeSlider")},makePaneFit=function(e,t,n,r){var a=options[e],l=state[e],d=_c[e],h=$Ps[e],p=$Rs[e],f="vert"===d.dir,y=!1;if(("center"===e||f&&l.noVerticalRoom)&&((y=l.maxHeight>=0)&&l.noRoom?(_showPane(e),p&&p.show(),l.isVisible=!0,l.noRoom=!1,f&&(l.noVerticalRoom=!1),_fixIframe(e)):y||l.noRoom||(_hidePane(e),p&&p.hide(),l.isVisible=!1,l.noRoom=!0)),"center"===e);else if(l.minSize<=l.maxSize){if(y=!0,l.size>l.maxSize)sizePane(e,l.maxSize,n,!0,r);else if(l.size<l.minSize)sizePane(e,l.minSize,n,!0,r);else if(p&&l.isVisible&&h.is(":visible")){var w=l.size+sC.inset[d.side];$.layout.cssNum(p,d.side)!=w&&p.css(d.side,w)}l.noRoom&&(l.wasOpen&&a.closable?a.autoReopen?open(e,!1,!0,!0):l.noRoom=!1:show(e,l.wasOpen,!0,!0))}else l.noRoom||(l.noRoom=!0,l.wasOpen=!l.isClosed&&!l.isSliding,l.isClosed||(a.closable?close(e,!0,!0):hide(e,!0)))},manualSizePane=function(e,t,n,r,a){if(isInitialized()){var l=evtPane.call(this,e),d=options[l],h=state[l],p=a||d.livePaneResizing&&!h.isResizing;h.autoResize=!1,sizePane(l,t,n,r,p)}},sizePane=function(e,t,n,r,a){if(isInitialized()){var l,d,h=evtPane.call(this,e),p=options[h],f=state[h],y=$Ps[h],w=$Rs[h],x=_c[h].side,j=_c[h].sizeType.toLowerCase(),O=f.isResizing&&!p.triggerEventsDuringLiveResize,C=!0!==r&&p.animatePaneSizing;$N.queue((function(e){if(setSizeLimits(h),l=f.size,t=_parseSize(h,t),t=max(t,_parseSize(h,p.minSize)),(t=min(t,f.maxSize))<f.minSize)return e(),void makePaneFit(h,!1,n);if(!a&&t===l)return e();if(f.newSize=t,!n&&state.initialized&&f.isVisible&&_runCallbacks("onresize_start",h),d=cssSize(h,t),C&&y.is(":visible")){var r=$.layout.effects.size[h]||$.layout.effects.size.all,w=p.fxSettings_size.easing||r.easing,x=options.zIndexes,O={};O[j]=d+"px",f.isMoving=!0,y.css({zIndex:x.pane_animate}).show().animate(O,p.fxSpeed_size,w,(function(){y.css({zIndex:f.isSliding?x.pane_sliding:x.pane_normal}),f.isMoving=!1,delete f.newSize,S(),e()}))}else y.css(j,d),delete f.newSize,y.is(":visible")?S():(f.size=t,$.extend(f,elDims(y))),e()}))}function S(){for(var e="width"===j?y.outerWidth():y.outerHeight(),r=[{pane:h,count:1,target:t,actual:e,correct:t===e,attempt:t,cssSize:d}],p=r[0],C={},S="Inaccurate size after resizing the "+h+"-pane.";!(p.correct||(C={pane:h,count:p.count+1,target:t},p.actual>t?C.attempt=max(0,p.attempt-(p.actual-t)):C.attempt=max(0,p.attempt+(t-p.actual)),C.cssSize=cssSize(h,C.attempt),y.css(j,C.cssSize),C.actual="width"==j?y.outerWidth():y.outerHeight(),C.correct=t===C.actual,1===r.length&&(_log(S,!1,!0),_log(p,!1,!0)),_log(C,!1,!0),r.length>3));)r.push(C),p=r[r.length-1];f.size=t,$.extend(f,elDims(y)),f.isVisible&&y.is(":visible")&&(w&&w.css(x,t+sC.inset[x]),sizeContent(h)),!n&&!O&&state.initialized&&f.isVisible&&_runCallbacks("onresize_end",h),n||(f.isSliding||sizeMidPanes("horz"==_c[h].dir?"":"center",O,a),sizeHandles());var _=_c.oppositeEdge[h];t<l&&state[_].noRoom&&(setSizeLimits(_),makePaneFit(_,!1,n)),r.length>1&&_log(S+"\nSee the Error Console for details.",!0,!0)}},sizeMidPanes=function(e,t,n){e=(e||"east,west,center").split(","),$.each(e,(function(e,r){if($Ps[r]){var a=options[r],l=state[r],d=$Ps[r],h=($Rs[r],!0),p={},f=$.layout.showInvisibly(d),y=calcNewCenterPaneDims();if($.extend(l,elDims(d)),"center"===r){if(!n&&l.isVisible&&y.width===l.outerWidth&&y.height===l.outerHeight)return d.css(f),!0;if($.extend(l,cssMinDims(r),{maxWidth:y.width,maxHeight:y.height}),p=y,l.newWidth=p.width,l.newHeight=p.height,p.width=cssW(d,p.width),p.height=cssH(d,p.height),h=p.width>=0&&p.height>=0,!state.initialized&&a.minWidth>y.width){var w=a.minWidth-l.outerWidth,x=options.east.minSize||0,j=options.west.minSize||0,O=state.east.size,C=state.west.size,S=O,_=C;if(w>0&&state.east.isVisible&&O>x&&(w-=O-(S=max(O-x,O-w))),w>0&&state.west.isVisible&&C>j&&(w-=C-(_=max(C-j,C-w))),0===w)return O&&O!=x&&sizePane("east",S,!0,!0,n),C&&C!=j&&sizePane("west",_,!0,!0,n),sizeMidPanes("center",t,n),void d.css(f)}}else{if(l.isVisible&&!l.noVerticalRoom&&$.extend(l,elDims(d),cssMinDims(r)),!n&&!l.noVerticalRoom&&y.height===l.outerHeight)return d.css(f),!0;p.top=y.top,p.bottom=y.bottom,l.newSize=y.height,p.height=cssH(d,y.height),l.maxHeight=p.height,(h=l.maxHeight>=0)||(l.noVerticalRoom=!0)}if(h?(!t&&state.initialized&&_runCallbacks("onresize_start",r),d.css(p),"center"!==r&&sizeHandles(r),!l.noRoom||l.isClosed||l.isHidden||makePaneFit(r),l.isVisible&&($.extend(l,elDims(d)),state.initialized&&sizeContent(r))):!l.noRoom&&l.isVisible&&makePaneFit(r),d.css(f),delete l.newSize,delete l.newWidth,delete l.newHeight,!l.isVisible)return!0;if("center"===r){var k=browser.isIE6||!browser.boxModel;$Ps.north&&(k||"IFRAME"==state.north.tagName)&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(k||"IFRAME"==state.south.tagName)&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!t&&state.initialized&&_runCallbacks("onresize_end",r)}}))},resizeAll=function(e){var t=sC.innerWidth,n=sC.innerHeight;if(evtPane(e),$N.is(":visible"))if(state.initialized){if(!0===e&&$.isPlainObject(options.outset)&&$N.css(options.outset),$.extend(sC,elDims($N,options.inset)),sC.outerHeight){if(!0===e&&setPanePosition(),!1===_runCallbacks("onresizeall_start"))return!1;var r,a;sC.innerHeight,sC.innerWidth;$.each(["south","north","east","west"],(function(e,t){$Ps[t]&&(r=options[t],(a=state[t]).autoResize&&a.size!=r.size?sizePane(t,r.size,!0,!0,!0):(setSizeLimits(t),makePaneFit(t,!1,!0,!0)))})),sizeMidPanes("",!0,!0),sizeHandles(),$.each(_c.allPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&_runCallbacks("onresize_end",t)})),_runCallbacks("onresizeall_end")}}else _initLayoutElements()},resizeChildren=function(e,t){var n=evtPane.call(this,e);if(options[n].resizeChildren){t||refreshChildren(n);var r=children[n];$.isPlainObject(r)&&$.each(r,(function(e,t){t.destroyed||t.resizeAll()}))}},sizeContent=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);n=n?n.split(","):_c.allPanes,$.each(n,(function(e,n){var r=$Ps[n],a=$Cs[n],l=options[n],d=state[n],h=d.content;if(!r||!a||!r.is(":visible"))return!0;if((a.length||(initContent(n,!1),a))&&!1!==_runCallbacks("onsizecontent_start",n)){(!d.isMoving&&!d.isResizing||l.liveContentResizing||t||null==h.top)&&(y(),h.hiddenFooters>0&&"hidden"===r.css("overflow")&&(r.css("overflow","visible"),y(),r.css("overflow","hidden")));var p=d.innerHeight-(h.spaceAbove-d.css.paddingTop)-(h.spaceBelow-d.css.paddingBottom);a.is(":visible")&&h.height==p||(setOuterHeight(a,p,!0),h.height=p),state.initialized&&_runCallbacks("onsizecontent_end",n)}function f(e){return max(d.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function y(){var e=options[n].contentIgnoreSelector,t=a.nextAll().not(".ui-layout-mask").not(e||":lt(0)"),r=t.filter(":visible"),l=r.filter(":last");(h={top:a[0].offsetTop,height:a.outerHeight(),numFooters:t.length,hiddenFooters:t.length-r.length,spaceBelow:0}).spaceAbove=h.top,h.bottom=h.top+h.height,l.length?h.spaceBelow=l[0].offsetTop+l.outerHeight()-h.bottom+f(l):h.spaceBelow=f(a)}}))}},sizeHandles=function(e){var t=evtPane.call(this,e);t=t?t.split(","):_c.borderPanes,$.each(t,(function(e,t){var n,r=options[t],a=state[t],l=$Ps[t],d=$Rs[t],h=$Ts[t];if(l&&d){var p,f,y,w=_c[t].dir,x=a.isClosed?"_closed":"_open",j=r["spacing"+x],O=r["togglerAlign"+x],C=r["togglerLength"+x];if(0!==j){if(a.noRoom||a.isHidden||d.show(),"horz"===w?(p=sC.innerWidth,a.resizerLength=p,f=$.layout.cssNum(l,"left"),d.css({width:cssW(d,p),height:cssH(d,j),left:f>-9999?f:sC.inset.left})):(p=l.outerHeight(),a.resizerLength=p,d.css({height:cssH(d,p),width:cssW(d,j),top:sC.inset.top+getPaneSize("north",!0)})),removeHover(r,d),h){if(0===C||a.isSliding&&r.hideTogglerOnSlide)return void h.hide();if(h.show(),!(C>0)||"100%"===C||C>p)C=p,y=0;else if(isStr(O))switch(O){case"top":case"left":y=0;break;case"bottom":case"right":y=p-C;break;case"middle":case"center":default:y=round((p-C)/2)}else{var S=parseInt(O,10);y=O>=0?S:p-C+S}if("horz"===w){var _=cssW(h,C);h.css({width:_,height:cssH(h,j),left:y,top:0}),h.children(".content").each((function(){(n=$(this)).css("marginLeft",round((_-n.outerWidth())/2))}))}else{var k=cssH(h,C);h.css({height:k,width:cssW(h,j),top:y,left:0}),h.children(".content").each((function(){(n=$(this)).css("marginTop",round((k-n.outerHeight())/2))}))}removeHover(0,h)}state.initialized||!r.initHidden&&!a.isHidden||(d.hide(),h&&h.hide())}else d.hide()}}))},enableClosable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Ts[t],r=options[t];n&&(r.closable=!0,n.bind("click."+sID,(function(e){e.stopPropagation(),toggle(t)})).css("visibility","visible").css("cursor","pointer").attr("title",state[t].isClosed?r.tips.Open:r.tips.Close).show())}},disableClosable=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=$Ts[n];r&&(options[n].closable=!1,state[n].isClosed&&open(n,!1,!0),r.unbind("."+sID).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].slidable=!0,state[t].isClosed&&bindStartSlidingEvents(t,!0))}},disableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&(options[t].slidable=!1,state[t].isSliding?close(t,!1,!0):(bindStartSlidingEvents(t,!1),n.css("cursor","default").attr("title",""),removeHover(null,n[0])))}},enableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t],r=options[t];n&&n.data("draggable")&&(r.resizable=!0,n.draggable("enable"),state[t].isClosed||n.css("cursor",r.resizerCursor).attr("title",r.tips.Resize))}},disableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].resizable=!1,n.draggable("disable").css("cursor","default").attr("title",""),removeHover(null,n[0]))}},swapPanes=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);if(state[n].edge=t,state[t].edge=n,!1===_runCallbacks("onswap_start",n)||!1===_runCallbacks("onswap_start",t))return state[n].edge=n,void(state[t].edge=t);var r=d(n),a=d(t),l={};return l[n]=r?r.state.size:0,l[t]=a?a.state.size:0,$Ps[n]=!1,$Ps[t]=!1,state[n]={},state[t]={},$Ts[n]&&$Ts[n].remove(),$Ts[t]&&$Ts[t].remove(),$Rs[n]&&$Rs[n].remove(),$Rs[t]&&$Rs[t].remove(),$Rs[n]=$Rs[t]=$Ts[n]=$Ts[t]=!1,h(r,t),h(a,n),r=a=l=null,$Ps[n]&&$Ps[n].css(_c.visible),$Ps[t]&&$Ps[t].css(_c.visible),resizeAll(),_runCallbacks("onswap_end",n),void _runCallbacks("onswap_end",t)}function d(e){var t=$Ps[e],n=$Cs[e];return!!t&&{pane:e,P:!!t&&t[0],C:!!n&&n[0],state:$.extend(!0,{},state[e]),options:$.extend(!0,{},options[e])}}function h(e,t){if(e){var n,r,a=e.P,d=e.C,h=e.pane,p=_c[t],f=$.extend(!0,{},state[t]),y=options[t],w={resizerCursor:y.resizerCursor};$.each("fxName,fxSpeed,fxSettings".split(","),(function(e,t){w[t+"_open"]=y[t+"_open"],w[t+"_close"]=y[t+"_close"],w[t+"_size"]=y[t+"_size"]})),$Ps[t]=$(a).data({layoutPane:Instance[t],layoutEdge:t}).css(_c.hidden).css(p.cssReq),$Cs[t]=!!d&&$(d),options[t]=$.extend(!0,{},e.options,w),state[t]=$.extend(!0,{},e.state),n=new RegExp(y.paneClass+"-"+h,"g"),a.className=a.className.replace(n,y.paneClass+"-"+t),initHandles(t),p.dir!=_c[h].dir?(r=l[t]||0,setSizeLimits(t),r=max(r,state[t].minSize),manualSizePane(t,r,!0,!0)):$Rs[t].css(p.side,sC.inset[p.side]+(state[t].isVisible?getPaneSize(t):0)),e.state.isVisible&&!f.isVisible?setAsOpen(t,!0):(setAsClosed(t),bindStartSlidingEvents(t,!0)),e=null}}},syncPinBtns=function(e,t){$.layout.plugins.buttons&&$.each(state[e].pins,(function(n,r){$.layout.buttons.setPinState(Instance,$(r),e,t)}))};function keyDown(e){if(!e)return!0;var t=e.keyCode;if(t<33)return!0;var n,r,a,l,d={38:"north",40:"south",37:"west",39:"east"},h=(e.altKey,e.shiftKey),p=e.ctrlKey;return p&&t>=37&&t<=40&&options[d[t]].enableCursorHotkey?l=d[t]:(p||h)&&$.each(_c.borderPanes,(function(e,d){if(n=options[d],r=n.customHotkey,a=n.customHotkeyModifier,(h&&"SHIFT"==a||p&&"CTRL"==a||p&&h)&&r&&t===(isNaN(r)||r<=9?r.toUpperCase().charCodeAt(0):r))return l=d,!1})),!(l&&$Ps[l]&&options[l].closable&&!state[l].isHidden)||(toggle(l),e.stopPropagation(),e.returnValue=!1,!1)}function allowOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n];if(r.cssSaved&&resetOverflow(n),r.isSliding||r.isResizing||r.isClosed)r.cssSaved=!1;else{var a={zIndex:options.zIndexes.resizer_normal+1},l={},d=t.css("overflow"),h=t.css("overflowX"),p=t.css("overflowY");"visible"!=d&&(l.overflow=d,a.overflow="visible"),h&&!h.match(/(visible|auto)/)&&(l.overflowX=h,a.overflowX="visible"),p&&!p.match(/(visible|auto)/)&&(l.overflowY=h,a.overflowY="visible"),r.cssSaved=l,t.css(a),$.each(_c.allPanes,(function(e,t){t!=n&&resetOverflow(t)}))}}}function resetOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n],a=r.cssSaved||{};r.isSliding||r.isResizing||t.css("zIndex",options.zIndexes.pane_normal),t.css(a),r.cssSaved=!1}}try{var $N=$(this).eq(0);if(!$N.length)return _log(options.errors.containerMissing);if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout")}catch(e){console.log("eeeee",e)}var $Ps={},$Cs={},$Rs={},$Ts={},$Ms=$([]),sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,hide:hide,show:show,toggle:toggle,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,setSizeLimits:setSizeLimits,_sizePane:sizePane,sizePane:manualSizePane,sizeContent:sizeContent,swapPanes:swapPanes,showMasks:showMasks,hideMasks:hideMasks,initContent:initContent,addPane:addPane,removePane:removePane,createChildren:createChildren,refreshChildren:refreshChildren,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable,allowOverflow:allowOverflow,resetOverflow:resetOverflow,destroy:destroy,initPanes:isInitialized,resizeAll:resizeAll,runCallbacks:_runCallbacks,hasParentLayout:!1,children:children,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===_create()?null:Instance}}(jQuery),function(e){e.ui||(e.ui={}),e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){for(var n,r=document.cookie,a=r?r.split(";"):[],l=0,d=a.length;l<d;l++)if((n=e.trim(a[l]).split("="))[0]==t)return decodeURIComponent(n[1]);return null},write:function(t,n,r){var a="",l="",d=!1,h=r||{},p=h.expires||null,f=e.type(p);"date"===f?l=p:"string"===f&&p>0&&(p=parseInt(p,10),f="number"),"number"===f&&(l=new Date,p>0?l.setDate(l.getDate()+p):(l.setFullYear(1970),d=!0)),l&&(a+=";expires="+l.toUTCString()),h.path&&(a+=";path="+h.path),h.domain&&(a+=";domain="+h.domain),h.secure&&(a+=";secure"),document.cookie=t+"="+(d?"":encodeURIComponent(n))+a},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.cookie||(e.cookie=function(t,n,r){var a=e.ui.cookie;if(null===n)a.clear(t);else{if(void 0===n)return a.read(t);a.write(t,n,r)}}),e.layout.plugins.stateManagement=!0,e.layout.config.optionRootKeys.push("stateManagement"),e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,animateLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.state={saveCookie:function(t,n,r){var a=t.options,l=a.stateManagement,d=e.extend(!0,{},l.cookie,r||null),h=t.state.stateData=t.readState(n||l.stateKeys);return e.ui.cookie.write(d.name||a.name||"Layout",e.layout.state.encodeJSON(h),d),e.extend(!0,{},h)},deleteCookie:function(t){var n=t.options;e.ui.cookie.clear(n.stateManagement.cookie.name||n.name||"Layout")},readCookie:function(t){var n=t.options,r=e.ui.cookie.read(n.stateManagement.cookie.name||n.name||"Layout");return r?e.layout.state.decodeJSON(r):{}},loadCookie:function(t){var n=e.layout.state.readCookie(t);return n&&(t.state.stateData=e.extend(!0,{},n),t.loadState(n)),n},loadState:function(t,n,r){if(e.isPlainObject(n)&&!e.isEmptyObject(n)){n=t.state.stateData=e.layout.transformData(n);var a=t.options.stateManagement;if(r=e.extend({animateLoad:!1,includeChildren:a.includeChildren},r),t.state.initialized){var l,d,h,p,f,y,w=!r.animateLoad;if(e.each(e.layout.config.borderPanes,(function(r,a){x=n[a],e.isPlainObject(x)&&(s=x.size,l=x.initClosed,d=x.initHidden,ar=x.autoResize,h=t.state[a],p=h.isVisible,ar&&(h.autoResize=ar),p||t._sizePane(a,s,!1,!1,!1),!0===d?t.hide(a,w):!0===l?t.close(a,!1,w):!1===l?t.open(a,!1,w):!1===d&&t.show(a,!1,w),p&&t._sizePane(a,s,!1,!1,w))})),r.includeChildren)e.each(t.children,(function(t,r){(f=n[t]?n[t].children:0)&&r&&e.each(r,(function(e,t){y=f[e],t&&y&&t.loadState(y)}))}))}else{var x=e.extend(!0,{},n);e.each(e.layout.config.allPanes,(function(e,t){x[t]&&delete x[t].children})),e.extend(!0,t.options,x)}}},readState:function(t,n){"string"===e.type(n)&&(n={keys:n}),n||(n={});var r,a,l,d,h,p,f,y=t.options.stateManagement,w=n.includeChildren,x=void 0!==w?w:y.includeChildren,j=n.stateKeys||y.stateKeys,O={isClosed:"initClosed",isHidden:"initHidden"},C=t.state,S=e.layout.config.allPanes,_={};e.isArray(j)&&(j=j.join(","));for(var k=0,E=(j=j.replace(/__/g,".").split(",")).length;k<E;k++)a=(r=j[k].split("."))[0],l=r[1],e.inArray(a,S)<0||null!=(d=C[a][l])&&("isClosed"==l&&C[a].isSliding&&(d=!0),(_[a]||(_[a]={}))[O[l]?O[l]:l]=d);return x&&e.each(S,(function(n,r){p=t.children[r],h=C.stateData[r],e.isPlainObject(p)&&!e.isEmptyObject(p)&&((f=_[r]||(_[r]={})).children||(f.children={}),e.each(p,(function(t,n){n.state.initialized?f.children[t]=e.layout.state.readState(n):h&&h.children&&h.children[t]&&(f.children[t]=e.extend(!0,{},h.children[t]))})))})),_},encodeJSON:function(t){return function t(n){var r,a,l,d=[],h=0,p=e.isArray(n);for(r in n)a=n[r],"string"==(l=typeof a)?a='"'+a+'"':"object"==l&&(a=t(a)),d[h++]=(p?"":'"'+r+'":')+a;return(p?"[":"{")+d.join(",")+(p?"]":"}")}(t)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(e){return{}}},_create:function(t){var n=e.layout.state,r=t.options.stateManagement;if(e.extend(t,{readCookie:function(){return n.readCookie(t)},deleteCookie:function(){n.deleteCookie(t)},saveCookie:function(e,r){return n.saveCookie(t,e,r)},loadCookie:function(){return n.loadCookie(t)},loadState:function(e,r){n.loadState(t,e,r)},readState:function(e){return n.readState(t,e)},encodeJSON:n.encodeJSON,decodeJSON:n.decodeJSON}),t.state.stateData={},r.autoLoad)if(e.isPlainObject(r.autoLoad))e.isEmptyObject(r.autoLoad)||t.loadState(r.autoLoad);else if(r.enabled)if(e.isFunction(r.autoLoad)){var a={};try{a=r.autoLoad(t,t.state,t.options,t.options.name||"")}catch(e){}a&&e.isPlainObject(a)&&!e.isEmptyObject(a)&&t.loadState(a)}else t.loadCookie()},_unload:function(t){var n=t.options.stateManagement;if(n.enabled&&n.autoSave)if(e.isFunction(n.autoSave))try{n.autoSave(t,t.state,t.options,t.options.name||"")}catch(e){}else t.saveCookie()}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload),e.layout.plugins.buttons=!0,e.layout.defaults.autoBindCustomButtons=!1,e.layout.optionsMap.layout.push("autoBindCustomButtons"),e.layout.buttons={init:function(t){var n,r=t.options.name||"";e.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),(function(a,l){e.each(e.layout.config.borderPanes,(function(a,d){e(".ui-layout-button-"+l+"-"+d).each((function(){null!=(n=e(this).data("layoutName")||e(this).attr("layoutName"))&&n!==r||t.bindButton(this,l,d)}))}))}))},get:function(t,n,r,a){var l=e(n),d=t.options,h=d.errors.addButtonError;if(l.length)if(e.inArray(r,e.layout.config.borderPanes)<0)e.layout.msg(h+" "+d.errors.pane+": "+r,!0),l=e("");else{var p=d[r].buttonClass+"-"+a;l.addClass(p+" "+p+"-"+r).data("layoutName",d.name)}else e.layout.msg(h+" "+d.errors.selector+": "+n,!0);return l},bind:function(t,n,r,a){var l=e.layout.buttons;switch(r.toLowerCase()){case"toggle":l.addToggle(t,n,a);break;case"open":l.addOpen(t,n,a);break;case"close":l.addClose(t,n,a);break;case"pin":l.addPin(t,n,a);break;case"toggle-slide":l.addToggle(t,n,a,!0);break;case"open-slide":l.addOpen(t,n,a,!0)}return t},addToggle:function(t,n,r,a){return e.layout.buttons.get(t,n,r,"toggle").click((function(e){t.toggle(r,!!a),e.stopPropagation()})),t},addOpen:function(t,n,r,a){return e.layout.buttons.get(t,n,r,"open").attr("title",t.options[r].tips.Open).click((function(e){t.open(r,!!a),e.stopPropagation()})),t},addClose:function(t,n,r){return e.layout.buttons.get(t,n,r,"close").attr("title",t.options[r].tips.Close).click((function(e){t.close(r),e.stopPropagation()})),t},addPin:function(t,n,r){var a=e.layout.buttons,l=a.get(t,n,r,"pin");if(l.length){var d=t.state[r];l.click((function(n){a.setPinState(t,e(this),r,d.isSliding||d.isClosed),d.isSliding||d.isClosed?t.open(r):t.close(r),n.stopPropagation()})),a.setPinState(t,l,r,!d.isClosed&&!d.isSliding),d.pins.push(n)}return t},setPinState:function(e,t,n,r){var a=t.attr("pin");if(!a||r!==("down"==a)){var l=e.options[n],d=l.buttonClass+"-pin",h=d+"-"+n,p=d+"-up "+h+"-up",f=d+"-down "+h+"-down";t.attr("pin",r?"down":"up").attr("title",r?l.tips.Unpin:l.tips.Pin).removeClass(r?p:f).addClass(r?f:p)}},syncPinBtns:function(t,n,r){e.each(t.state[n].pins,(function(a,l){e.layout.buttons.setPinState(t,e(l),n,r)}))},_load:function(t){var n=e.layout.buttons;e.extend(t,{bindButton:function(e,r,a){return n.bind(t,e,r,a)},addToggleBtn:function(e,r,a){return n.addToggle(t,e,r,a)},addOpenBtn:function(e,r,a){return n.addOpen(t,e,r,a)},addCloseBtn:function(e,r){return n.addClose(t,e,r)},addPinBtn:function(e,r){return n.addPin(t,e,r)}});for(var r=0;r<4;r++){var a=e.layout.config.borderPanes[r];t.state[a].pins=[]}t.options.autoBindCustomButtons&&n.init(t)},_unload:function(e){}},e.layout.onLoad.push(e.layout.buttons._load),e.layout.plugins.browserZoom=!0,e.layout.defaults.browserZoomCheckInterval=1e3,e.layout.optionsMap.layout.push("browserZoomCheckInterval"),e.layout.browserZoom={_init:function(t){!1!==e.layout.browserZoom.ratio()&&e.layout.browserZoom._setTimer(t)},_setTimer:function(t){if(!t.destroyed){var n=t.options,r=t.state,a=t.hasParentLayout?5e3:Math.max(n.browserZoomCheckInterval,100);setTimeout((function(){if(!t.destroyed&&n.resizeWithWindow){var a=e.layout.browserZoom.ratio();a!==r.browserZoom&&(r.browserZoom=a,t.resizeAll()),e.layout.browserZoom._setTimer(t)}}),a)}},ratio:function(){var t,n,r,a=window,l=screen,d=document,h=d.documentElement||d.body,p=e.layout.browser,f=p.version;return!(p.msie&&f>8||!p.msie)&&(l.deviceXDPI&&l.systemXDPI?y(l.deviceXDPI,l.systemXDPI):p.webkit&&(t=d.body.getBoundingClientRect)?y(t.left-t.right,d.body.offsetWidth):p.webkit&&(n=a.outerWidth)?y(n,a.innerWidth):!(!(n=l.width)||!(r=h.clientWidth))&&y(n,r));function y(e,t){return(parseInt(e,10)/parseInt(t,10)*100).toFixed()}}},e.layout.onReady.push(e.layout.browserZoom._init)}(jQuery)},function(e,t){!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,n=e.ui.mouse.prototype,r=n._mouseInit,a=n._mouseDestroy;n._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,l(e,"mouseover"),l(e,"mousemove"),l(e,"mousedown"))},n._touchMove=function(e){t&&(this._touchMoved=!0,l(e,"mousemove"))},n._touchEnd=function(e){t&&(l(e,"mouseup"),l(e,"mouseout"),this._touchMoved||l(e,"click"),t=!1)},n._mouseInit=function(){this.element.bind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),r.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),a.call(this)}}function l(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}}(jQuery)},function(e,t,n){var r=n(41),a=n(48),l=n(379).f;r({target:"Object",stat:!0,forced:a((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:l})},function(e,t,n){"use strict";var r=n(41),a=n(633);r({target:"String",proto:!0,forced:n(634)("link")},{link:function(e){return a(this,"a","href",e)}})},function(e,t,n){n(469)},function(e,t,n){},function(e,t,n){"use strict";var r=60103,a=60106,l=60107,d=60108,h=60114,p=60109,f=60110,y=60112,w=60113,x=60120,j=60115,O=60116,C=60121,S=60122,_=60117,k=60129,E=60131;if("function"==typeof Symbol&&Symbol.for){var A=Symbol.for;r=A("react.element"),a=A("react.portal"),l=A("react.fragment"),d=A("react.strict_mode"),h=A("react.profiler"),p=A("react.provider"),f=A("react.context"),y=A("react.forward_ref"),w=A("react.suspense"),x=A("react.suspense_list"),j=A("react.memo"),O=A("react.lazy"),C=A("react.block"),S=A("react.server.block"),_=A("react.fundamental"),k=A("react.debug_trace_mode"),E=A("react.legacy_hidden")}function T(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case h:case d:case w:case x:return e;default:switch(e=e&&e.$$typeof){case f:case y:case O:case j:case p:return e;default:return t}}case a:return t}}}var R=p,I=r,P=y,D=l,M=O,L=j,F=a,q=h,N=d,B=w;t.ContextConsumer=f,t.ContextProvider=R,t.Element=I,t.ForwardRef=P,t.Fragment=D,t.Lazy=M,t.Memo=L,t.Portal=F,t.Profiler=q,t.StrictMode=N,t.Suspense=B,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return T(e)===f},t.isContextProvider=function(e){return T(e)===p},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return T(e)===y},t.isFragment=function(e){return T(e)===l},t.isLazy=function(e){return T(e)===O},t.isMemo=function(e){return T(e)===j},t.isPortal=function(e){return T(e)===a},t.isProfiler=function(e){return T(e)===h},t.isStrictMode=function(e){return T(e)===d},t.isSuspense=function(e){return T(e)===w},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===l||e===h||e===k||e===d||e===w||e===x||e===E||"object"==typeof e&&null!==e&&(e.$$typeof===O||e.$$typeof===j||e.$$typeof===p||e.$$typeof===f||e.$$typeof===y||e.$$typeof===_||e.$$typeof===C||e[0]===S)},t.typeOf=T},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"FILE",(function(){return Mn})),n.d(r,"URL",(function(){return Ln})),n.d(r,"TEXT",(function(){return Fn}));var a={};n.r(a),n.d(a,"CreateFileMode",(function(){return Ca})),n.d(a,"CreateFilePane",(function(){return Sa}));var l={};n.r(l),n.d(l,"CreateFileMode",(function(){return _a})),n.d(l,"CreateFilePane",(function(){return ka}));var d={};n.r(d),n.d(d,"LinkedFileRefreshError",(function(){return linked_file_refresh_error_LinkedFileRefreshError}));var h={};n.r(h),n.d(h,"LinkedFileInfo",(function(){return Uh}));var p={};n.r(p),n.d(p,"default",(function(){return Nf}));var f={};n.r(f),n.d(f,"default",(function(){return my}));n(7),n(72),n(65),n(45),n(81),n(13),n(8),n(17),n(46);var y=n(3);n(10),n(60),n(16),n(29),n(77),n(26),n(4),n(24),n(83),n(87),y.a.directive("fileEntity",["RecursionHelper",function(e){return{restrict:"E",scope:{entity:"=",permissions:"=",depth:"=?"},templateUrl:"entityListItemTemplate",compile:function(t){return e.compile(t,(function(e,t,n,r){return e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)}}))}}}]);y.a.controller("FileTreeController",["$scope",function(e){e.openNewDocModal=function(){window.dispatchEvent(new CustomEvent("file-tree.start-creating",{detail:{mode:"doc"}}))},e.orderByFoldersFirst=function(e){return"folder"===(null!=e?e.type:void 0)?"0":"1"}}]);var w=function(e){var t,n,r=(t=e.split(".").pop(),n=function(e){return e.toLowerCase()},null!=t?n(t):void 0);return["png","pdf","jpg","jpeg","gif"].includes(r)?"image":["csv","xls","xlsx"].includes(r)?"table":["py","r"].includes(r)?"file-text":["bib"].includes(r)?"book":"file"};y.a.controller("FileTreeEntityController",["$scope","ide","$modal","$element",function(e,t,n,r){e.MAX_DEPTH=8,e.select=function(n){if(!n.ctrlKey&&!n.metaKey)return t.fileTreeManager.selectEntity(e.entity),e.$emit("entity:selected",e.entity);n.stopPropagation();var r=t.fileTreeManager.multiSelectedCount();return t.fileTreeManager.toggleMultiSelectEntity(e.entity),0===r?t.fileTreeManager.multiSelectSelectedEntity():void 0},"doc"===e.entity.type&&e.$watch("entity.selected",(function(t){var n,a,l,d,h,p;t&&(e.$emit("entity-file:selected",e.entity),n=r,a=$(".file-tree-list"),l=n.offset().top,d=l+n.outerHeight(),h=a.offset().top,p=h+a.height(),l>=h&&d<=p||e.$applyAsync((function(){r[0].scrollIntoView()})))})),e.iconTypeFromName=w}]);y.a.controller("FileTreeFolderController",["$scope","ide","$modal","localStorage",function(e,t,n,r){e.expanded=r("folder.".concat(e.entity.id,".expanded"))||!1,e.toggleExpanded=function(){e.expanded=!e.expanded,e._storeCurrentStateInLocalStorage()},e.$on("entity-file:selected",(function(){e.expanded=!0,e._storeCurrentStateInLocalStorage()})),e._storeCurrentStateInLocalStorage=function(){r("folder.".concat(e.entity.id,".expanded"),e.expanded)}}]),n(43),n(11),n(30),n(57),n(18),n(58);var x=n(54),j=n(5),O=n.n(j),C=n(2),S=n.n(C),_=n(1),k=n.n(_),E=n(115),A=n(38),T=n(110),R=(n(12),n(14),n(6),n(9),n(0));function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=Object(C.createContext)();function M(){var e=Object(C.useContext)(D);if(!e)throw new Error("useFileTreeMainContext is only available inside FileTreeMainProvider");return e}var L=function(e){var t=e.refProviders,n=e.reindexReferences,r=e.setRefProviderEnabled,a=e.setStartedFreeTrial,l=e.children,d=I(Object(C.useState)(),2),h=d[0],p=d[1];return Object(R.jsx)(D.Provider,{value:{refProviders:t,reindexReferences:n,setRefProviderEnabled:r,setStartedFreeTrial:a,contextMenuCoords:h,setContextMenuCoords:p},children:l})};L.propTypes={reindexReferences:k.a.func.isRequired,refProviders:k.a.object.isRequired,setRefProviderEnabled:k.a.func.isRequired,setStartedFreeTrial:k.a.func.isRequired,children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired};n(52);function F(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){return e.reduce((function(e,n){return e.then((function(e){return t(n).then((function(t){return[].concat(F(e),[t])}))}))}),Promise.resolve([]))}var B=n(20),U=["endpoint"];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function K(e){return"fileRef"===e?"file":e}var G=n(109);function Y(e,t,n){return e._id!==t&&(e=Object(G.c)(e,t).entity),!e.docs.some((function(e){return e.name===n}))&&(!e.fileRefs.some((function(e){return e.name===n}))&&!e.folders.some((function(e){return e.name===n})))}n(98),n(99),n(55),n(53);var X=new RegExp("[\\/\\\\\\*\\u0000-\\u001F\\u007F\\u0080-\\u009F\\uD800-\\uDFFF]","g"),J=new RegExp("(^\\.$)|(^\\.\\.$)|(^\\s+)|(\\s+$)","g"),Q=new RegExp("^(prototype|constructor|toString|toLocaleString|valueOf|hasOwnProperty|isPrototypeOf|propertyIsEnumerable|__defineGetter__|__lookupGetter__|__defineSetter__|__lookupSetter__|__proto__)$");function Z(e){return(t=e).length>0&&t.length<=1024&&!e.match(X)&&!e.match(J);var t}function ee(e){return Q.test(e)}var te=n(70),ne=(n(227),n(19)),re=n.n(ne),oe=n(62),ae=n(306),se=n.n(ae),le=n(21);n(192),n(93);function ce(e){var t=new URL(window.location),n=t.pathname.replace(/\/(detached|detacher)\/?$/,"").replace(/\/$/,"");return e&&(n+="/".concat(e)),t.pathname=n,t}function ue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=he(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||he(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=Object(C.createContext)();me.Provider.propTypes={value:k.a.shape({role:k.a.oneOf(["detacher","detached",null]),setRole:k.a.func.isRequired,broadcastEvent:k.a.func.isRequired,addEventHandler:k.a.func.isRequired,deleteEventHandler:k.a.func.isRequired}).isRequired};var ve=Object(le.a)("ol-debugPdfDetach"),be="detach-".concat(Object(le.a)("ol-project_id"));function ye(e){var t=e.children,n=fe(Object(C.useState)((function(){return Object(le.a)("ol-detachRole")||null})),2),r=n[0],a=n[1],l=function(){var e=de(Object(C.useState)(new Set),2),t=e[0],n=e[1];return{addHandler:Object(C.useCallback)((function(e){n((function(t){return new Set(t.add(e))}))}),[n]),deleteHandler:Object(C.useCallback)((function(e){n((function(t){return t.delete(e),new Set(t)}))}),[n]),callHandlers:Object(C.useCallback)((function(){var e,n=ue(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.apply(void 0,arguments)}}catch(e){n.e(e)}finally{n.f()}}),[t])}}(),d=l.addHandler,h=l.deleteHandler,p=l.callHandlers;Object(C.useEffect)((function(){ve&&console.log("Effect",{role:r}),window.history.replaceState({},"",ce(r).toString())}),[r]),Object(C.useEffect)((function(){return se.a.on(be,(function(e){ve&&console.log("Receiving:",e),p(e)})),function(){return se.a.off(be)}}),[p]);var f=Object(C.useCallback)((function(e,t){if(r){ve&&console.log("Broadcasting",{role:r,event:e,data:t});var n={role:r,event:e};t&&(n.data=t),se.a.broadcast(be,n)}else ve&&console.log("Not Broadcasting (no role)",{role:r,event:e,data:t})}),[r]);Object(C.useEffect)((function(){f("connected")}),[f]),Object(C.useEffect)((function(){var e=function(){return f("closed")};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}}),[f]);var y=Object(C.useMemo)((function(){return{role:r,setRole:a,broadcastEvent:f,addEventHandler:d,deleteEventHandler:h}}),[r,a,f,d,h]);return Object(R.jsx)(me.Provider,{value:y,children:t})}function we(e){var t=Object(C.useContext)(me);return k.a.checkPropTypes(e,t,"data","DetachContext.Provider"),t}ye.propTypes={children:k.a.any};var xe=n(22);function je(e){var t=Object(C.useRef)();return Object(C.useEffect)((function(){t.current=e})),t.current}function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Se=Object(le.a)("ol-debugPdfDetach");var _e=n(114),ke=n(128);function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $e=Object(le.a)("ol-debugPdfDetach"),Te=Object(C.createContext)();function Re(e){ke.a.setItem("pdf.layout","sideBySide"===e?"split":"flat")}function Ie(e){var t=e.children,n=Object(_e.b)().$scope,r=Ee(Object(oe.a)("ui.view"),2),a=r[0],l=r[1],d=Object(C.useCallback)((function(e){l((function(t){return"history"!==e&&"history"!==t||n.toggleHistory(),"editor"===e&&n.openFile?"file":e}))}),[n,l]),h=Ee(Object(oe.a)("ui.chatOpen"),2),p=h[0],f=h[1],y=Ee(Object(oe.a)("ui.reviewPanelOpen"),2),w=y[0],x=y[1],j=Ee(Object(oe.a)("ui.leftMenuShown"),2),O=j[0],S=j[1],_=Ee(Object(oe.a)("ui.pdfLayout"),2),k=_[0],E=_[1],A=Object(C.useCallback)((function(){E((function(e){var t="sideBySide"===e?"flat":"sideBySide";d("sideBySide"===t?"editor":"pdf"),E(t),Re(t)}))}),[E,d]),T=Object(C.useCallback)((function(e,t){E(e),d("sideBySide"===e?"editor":t),Re(e)}),[E,d]),I=function(){var e=we(),t=e.role,n=e.setRole,r=e.broadcastEvent,a=e.addEventHandler,l=e.deleteEventHandler,d=Oe(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Oe(Object(C.useState)(!1),2),y=f[0],w=f[1],x=Object(C.useRef)();Object(C.useEffect)((function(){Se&&console.log("Effect",{isLinked:y}),p(!1)}),[y,p]),Object(C.useEffect)((function(){Se&&console.log("Effect",{role:t,isLinked:y}),"detached"===t&&y&&xe.b("project-layout-detached")}),[t,y]),Object(C.useEffect)((function(){x.current&&clearTimeout(x.current),"detacher"===t&&!1===y&&(x.current=setTimeout((function(){n(null)}),h?6e4:1e4))}),[t,h,y,n]),Object(C.useEffect)((function(){Se&&console.log("Effect",{isLinking:h})}),[h]);var j=je(t);Object(C.useEffect)((function(){j&&!t&&xe.b("project-layout-reattached")}),[j,t]);var O=Object(C.useCallback)((function(){r("reattach"),n(null),w(!1)}),[n,w,r]),S=Object(C.useCallback)((function(){n("detacher"),p(!0),window.open(ce("detached").toString(),"_blank")}),[n,p]),_=Object(C.useCallback)((function(e){switch(e.event){case"connected":r("up"),w(!0);break;case"up":w(!0);break;case"closed":w(!1)}}),[w,r]),k=Object(C.useCallback)((function(e){switch(e.event){case"connected":r("up"),w(!0);break;case"up":w(!0);break;case"closed":w(!1);break;case"reattach":w(!1),window.close()}}),[w,r]),E=Object(C.useCallback)((function(e){switch(e.event){case"closed":r("up")}}),[r]),A=Object(C.useCallback)((function(e){"detacher"===t?"detacher"===e.role?E(e):"detached"===e.role&&_(e):"detached"===t&&("detacher"===e.role?k(e):"detached"===e.role&&E(e))}),[t,_,k,E]);return Object(C.useEffect)((function(){return a(A),function(){return l(A)}}),[a,l,A]),{reattach:O,detach:S,isLinked:y,isLinking:h,role:t}}(),P=I.reattach,D=I.detach,M=I.isLinking,L=I.isLinked,F=I.role;Object(C.useEffect)((function(){$e&&console.log("Layout Effect",{detachRole:F,detachIsLinking:M,detachIsLinked:L}),"detacher"===F&&(M||L)&&T("flat","editor")}),[F,M,L,T]);var q=Object(C.useMemo)((function(){return{reattach:P,detach:D,detachIsLinked:L,detachRole:F,changeLayout:T,chatIsOpen:p,leftMenuShown:O,pdfLayout:k,reviewPanelOpen:w,setChatIsOpen:f,setLeftMenuShown:S,setPdfLayout:E,setReviewPanelOpen:x,setView:d,switchLayout:A,view:a}}),[P,D,L,F,T,p,O,k,w,f,S,E,x,d,A,a]);return Object(R.jsx)(Te.Provider,{value:q,children:t})}function Pe(e){var t=Object(C.useContext)(Te);return k.a.checkPropTypes(e,t,"data","LayoutContext.Provider"),t}Te.Provider.propTypes={value:k.a.shape({reattach:k.a.func.isRequired,detach:k.a.func.isRequired,detachIsLinked:k.a.bool,detachRole:k.a.string,changeLayout:k.a.func.isRequired,view:k.a.oneOf(["editor","file","pdf","history"]),setView:k.a.func.isRequired,chatIsOpen:k.a.bool,setChatIsOpen:k.a.func.isRequired,reviewPanelOpen:k.a.bool,setReviewPanelOpen:k.a.func.isRequired,leftMenuShown:k.a.bool,setLeftMenuShown:k.a.func.isRequired,pdfLayout:k.a.oneOf(["sideBySide","flat"]).isRequired}).isRequired},Ie.propTypes={children:k.a.any};var De=n(156);function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fe=Object(C.createContext)(),qe="SELECT",Ne="MULTI_SELECT",Be="UNSELECT";function Ue(e,t){switch(t.type){case qe:return new Set([t.id]);case Ne:var n=new Set(e);return n.has(t.id)?n.size>1&&n.delete(t.id):n.add(t.id),n;case Be:var r=new Set(e);return r.delete(t.id),r;default:throw new Error("Unknown selectable action type: ".concat(t.type))}}function He(e,t){switch(t.type){case qe:return new Set([t.id]);case Ne:case Be:return e;default:throw new Error("Unknown selectable action type: ".concat(t.type))}}function ze(e){var t=e.onSelect,n=e.children,r=Object(A.c)(Ve),a=r._id,l=r.rootDocId,d=Object(te.b)(We).permissionsLevel,h=Me(Object(De.a)("doc.open_id.".concat(a),l),1)[0],p=Object(T.b)().fileTreeData,f=Me(Object(C.useReducer)("readOnly"===d?He:Ue,null,(function(){return h&&Object(G.c)(p,h)?new Set([h]):new Set})),2),y=f[0],w=f[1],x=Me(Object(C.useState)(new Set),2),j=x[0],S=x[1];Object(C.useEffect)((function(){var e=new Set;y.forEach((function(t){var n=Object(G.c)(p,t);n&&n.path.forEach((function(t){return e.add(t)}))})),S(e)}),[p,y]);var _=je(y);Object(C.useEffect)((function(){if(!O.a.isEqual(y,_)){var e=Array.from(y).map((function(e){return Object(G.c)(p,e)})).filter(Boolean);t(e)}}),[p,y,_,t]),Object(C.useEffect)((function(){function e(e){var t=Object(G.c)(p,e.detail);t&&w({type:qe,id:t.entity._id})}return window.addEventListener("editor.openDoc",e),function(){return window.removeEventListener("editor.openDoc",e)}}),[p]);var k=Object(C.useCallback)((function(e){w({type:qe,id:e})}),[]),E=Object(C.useCallback)((function(e){w({type:Be,id:e})}),[]),I=Object(C.useCallback)((function(e,t){w({type:t?Ne:qe,id:e})}),[]),P={selectedEntityIds:y,selectedEntityParentIds:j,select:k,unselect:E,selectOrMultiSelectEntity:I};return Object(R.jsx)(Fe.Provider,{value:P,children:n})}ze.propTypes={onSelect:k.a.func.isRequired,children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired};var Ve={_id:k.a.string.isRequired,rootDocId:k.a.string},We={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])};function Ke(e,t){var n=Pe(Ge),r=n.view,a=n.setView,l=Object(C.useContext)(Fe),d=l.selectedEntityIds,h=l.selectOrMultiSelectEntity,p=d.has(e),f=Object(C.useCallback)((function(n){h(e,n.ctrlKey||n.metaKey),a(t?"file":"editor")}),[e,h,a,t]),y=Object(C.useCallback)((function(e){f(e)}),[f]),w=Object(C.useCallback)((function(e){"Enter"!==e.key&&" "!==e.key||f(e)}),[f]),x=Object(C.useCallback)((function(t){d.has(e)||f(t)}),[e,f,d]),j=p&&"pdf"!==r;return{isSelected:p,props:Object(C.useMemo)((function(){return{className:re()({selected:j}),"aria-selected":j,onClick:y,onContextMenu:x,onKeyPress:w}}),[y,x,w,j])}}var Ge={view:k.a.string,setView:k.a.func.isRequired};function Ye(){var e=Object(C.useContext)(Fe);if(!e)throw new Error("useFileTreeSelectable is only available inside FileTreeSelectableProvider");return e}n(63),n(64),n(117);function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t,n){return t&&Je(e.prototype,t),n&&Je(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}function tt(e){var t=ot();return function(){var n,r=st(e);if(t){var a=st(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return nt(this,n)}}function nt(e,t){if(t&&("object"===Xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function rt(e){var t="function"==typeof Map?new Map:void 0;return(rt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return it(e,arguments,st(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),at(r,e)})(e)}function it(e,t,n){return(it=ot()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&at(a,n.prototype),a}).apply(null,arguments)}function ot(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lt=function(e){et(InvalidFilenameError,e);var t=tt(InvalidFilenameError);function InvalidFilenameError(){return Ze(this,InvalidFilenameError),t.call(this,"invalid filename")}return Qe(InvalidFilenameError)}(rt(Error)),ct=function(e){et(BlockedFilenameError,e);var t=tt(BlockedFilenameError);function BlockedFilenameError(){return Ze(this,BlockedFilenameError),t.call(this,"blocked filename")}return Qe(BlockedFilenameError)}(rt(Error)),ut=function(e){et(DuplicateFilenameError,e);var t=tt(DuplicateFilenameError);function DuplicateFilenameError(){return Ze(this,DuplicateFilenameError),t.call(this,"duplicate filename")}return Qe(DuplicateFilenameError)}(rt(Error)),dt=function(e){et(DuplicateFilenameMoveError,e);var t=tt(DuplicateFilenameMoveError);function DuplicateFilenameMoveError(){return Ze(this,DuplicateFilenameMoveError),t.call(this,"duplicate filename on move")}return Qe(DuplicateFilenameMoveError)}(rt(Error));function ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=Object(C.createContext)(),bt="START_RENAME",yt="START_DELETE",wt="DELETING",xt="START_CREATE_FILE",jt="START_CREATE_FOLDER",Ot="CREATING_FILE",Ct="CREATING_FOLDER",St="MOVING",_t="CANCEL",kt="CLEAR",Et="ERROR",At={isDeleting:!1,isRenaming:!1,isCreatingFile:!1,isCreatingFolder:!1,isMoving:!1,inFlight:!1,actionedEntities:null,newFileCreateMode:null,error:null};function $t(e){return e}function Tt(e,t){switch(t.type){case bt:return gt(gt({},At),{},{isRenaming:!0});case yt:return gt(gt({},At),{},{isDeleting:!0,actionedEntities:t.actionedEntities});case xt:return gt(gt({},At),{},{isCreatingFile:!0,newFileCreateMode:t.newFileCreateMode});case jt:return gt(gt({},At),{},{isCreatingFolder:!0});case Ot:return gt(gt({},At),{},{isCreatingFile:!0,newFileCreateMode:e.newFileCreateMode,inFlight:!0});case Ct:return gt(gt({},At),{},{isCreatingFolder:!0,inFlight:!0});case wt:return gt(gt({},At),{},{isDeleting:!0,inFlight:!0,actionedEntities:e.actionedEntities});case St:return gt(gt({},At),{},{isMoving:!0,inFlight:!0});case kt:return gt({},At);case _t:return e.inFlight?e:gt({},At);case Et:return gt(gt({},e),{},{inFlight:!1,error:t.error});default:throw new Error("Unknown user action type: ".concat(t.type))}}function Rt(e){var t=e.children,n=Object(A.c)(It)._id,r=Object(te.b)(Pt).permissionsLevel,a=ht(Object(C.useReducer)("readOnly"===r?$t:Tt,At),2),l=a[0],d=a[1],h=Object(T.b)(),p=h.fileTreeData,f=h.dispatchRename,y=h.dispatchMove,w=Ye().selectedEntityIds,x=Object(C.useCallback)((function(){d({type:bt})}),[]),j=Object(C.useCallback)((function(e){var t=Array.from(w)[0],r=Object(G.d)(p,t),a=r.entity.name;if(e===a)return d({type:kt});var l=function(e,t,n){if(!Z(n))return new lt;if(!Y(e,t.parentFolderId,n))return new ut;var r=1===t.path.length,a="folder"===t.type;if(r&&!a&&ee(n))return new ct}(p,r,e);return l?d({type:Et,error:l}):(d({type:kt}),f(t,e),function(e,t,n,r){return Object(B.d)("/project/".concat(e,"/").concat(K(t),"/").concat(n,"/rename"),{body:{name:r}})}(n,r.type,r.entity._id,e).catch((function(e){f(t,a),d({type:Et,error:e})})))}),[f,p,n,w]),O=Object(C.useCallback)((function(e,t){return!Y(p,e,t)}),[p]),S=Object(C.useCallback)((function(){var e=Array.from(w).map((function(e){return Object(G.d)(p,e).entity}));d({type:yt,actionedEntities:e})}),[p,w]),_=Object(C.useCallback)((function(){return d({type:wt}),N(Array.from(w),(function(e){var t=Object(G.d)(p,e);return function(e,t,n){return Object(B.b)("/project/".concat(e,"/").concat(K(t),"/").concat(n))}(n,t.type,t.entity._id).catch((function(e){if(404!==e.info.statusCode)throw e}))})).then((function(){d({type:kt})})).catch((function(e){d({type:Et,error:e})}))}),[p,n,w]),k=Object(C.useCallback)((function(e,t){d({type:St});var r=Array.from(t).map((function(e){return Object(G.d)(p,e)})).filter((function(t){return t.parentFolderId!==e})),a=e===p._id,l=r.map((function(t){return function(e,t,n,r){if(!Y(e,t,n.entity.name)){var a=new dt;return a.entityName=n.entity.name,a}var l="folder"===n.type;if(r&&!l&&ee(n.entity.name))return new ct}(p,e,t,a)})).find((function(e){return e}));return l?d({type:Et,error:l}):(r.forEach((function(t){return y(t.entity._id,e)})),N(r,(function(t){return function(e,t,n,r){return Object(B.d)("/project/".concat(e,"/").concat(K(t),"/").concat(n,"/move"),{body:{folder_id:r}})}(n,t.type,t.entity._id,e)})).then((function(){d({type:kt})})).catch((function(e){d({type:Et,error:e})})))}),[y,p,n]),E=Object(C.useCallback)((function(){d({type:jt})}),[]),I=Object(C.useMemo)((function(){return function(e,t){var n=Array.from(t)[0];if(!n)return e._id;var r=Object(G.c)(e,n);if(!r)return e._id;return"folder"===r.type?r.entity._id:r.parentFolderId}(p,w)}),[p,w]),P=Object(C.useCallback)((function(e){var t=function(e,t,n){if(!Z(n.name))return new lt;if(!Y(e,t,n.name))return new ut;var r=t===e._id,a="folder"===n.endpoint;if(r&&!a&&ee(n.name))return new ct}(p,I,e);return t?Promise.reject(t):function(e,t,n){var r=n.endpoint,a=W(n,U);return Object(B.d)("/project/".concat(e,"/").concat(r),{body:z({parent_folder_id:t},a)})}(n,I,e)}),[p,I,n]),D=Object(C.useCallback)((function(e){return d({type:Ct}),P({endpoint:"folder",name:e}).then((function(){d({type:kt})})).catch((function(e){d({type:Et,error:e})}))}),[P]),M=Object(C.useCallback)((function(e){d({type:xt,newFileCreateMode:e})}),[]),L=Object(C.useCallback)((function(){M("doc")}),[M]),F=Object(C.useCallback)((function(){M("upload")}),[M]),q=Object(C.useCallback)((function(e){return d({type:Ot}),P(e).then((function(){d({type:kt})})).catch((function(e){d({type:Et,error:e})}))}),[P]),H=Object(C.useCallback)((function(e){return e.endpoint="doc",q(e)}),[q]),V=Object(C.useCallback)((function(e){return e.endpoint="linked_file",q(e)}),[q]),X=Object(C.useCallback)((function(){d({type:_t})}),[]);Object(C.useEffect)((function(){function e(e){d({type:xt,newFileCreateMode:e.detail.mode})}return window.addEventListener("file-tree.start-creating",e),function(){window.removeEventListener("file-tree.start-creating",e)}}),[]);var J=gt(gt({canDelete:w.size>0,canRename:1===w.size,canCreate:w.size<2},l),{},{parentFolderId:I,isDuplicate:O,startRenaming:x,finishRenaming:j,startDeleting:S,finishDeleting:_,finishMoving:k,startCreatingFile:M,startCreatingFolder:E,finishCreatingFolder:D,startCreatingDocOrFile:L,startUploadingDocOrFile:F,finishCreatingDoc:H,finishCreatingLinkedFile:V,cancel:X});return Object(R.jsx)(vt.Provider,{value:J,children:t})}Rt.propTypes={children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired};var It={_id:k.a.string.isRequired},Pt={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])};function Dt(){var e=Object(C.useContext)(vt);if(!e)throw new Error("useFileTreeActionable is only available inside FileTreeActionableProvider");return e}var Mt=n(309),Lt=n(308),Ft=n(1027),qt=n(44),Nt="undefined"!=typeof window?C.useLayoutEffect:C.useEffect;function Bt(e,t,n,r){var a=n?n.call(r,e,t):void 0;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var l=Object.keys(e),d=Object.keys(t);if(l.length!==d.length)return!1;for(var h=Object.prototype.hasOwnProperty.bind(t),p=0;p<l.length;p++){var f=l[p];if(!h(f))return!1;var y=e[f],w=t[f];if(!1===(a=n?n.call(r,y,w,f):void 0)||void 0===a&&y!==w)return!1}return!0}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zt(e,t,n){var r=Ut(Object(C.useState)((function(){return t(e)})),2),a=r[0],l=r[1],d=Object(C.useCallback)((function(){var r=t(e);Bt(a,r)||(l(r),n&&n())}),[a,e,n]);return Nt(d,[]),[a,d]}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kt(e,t,n){var r=Vt(zt(e,t,n),2),a=r[0],l=r[1];return Nt((function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(l,{handlerIds:[t]})}),[e,l]),a}function Gt(){var e=Object(C.useContext)(Lt.a).dragDropManager;return Object(qt.a)(null!=e,"Expected drag drop context"),e}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xt=!1,Jt=!1,Qt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sourceId=null,this.internalMonitor=t.getMonitor()}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){Object(qt.a)(!Xt,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Xt=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Xt=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;Object(qt.a)(!Jt,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Jt=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Jt=!1}}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"isDraggingSource",value:function(e){return this.internalMonitor.isDraggingSource(e)}},{key:"isOverTarget",value:function(e,t){return this.internalMonitor.isOverTarget(e,t)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(e){return this.internalMonitor.subscribeToOffsetChange(e)}},{key:"canDragSource",value:function(e){return this.internalMonitor.canDragSource(e)}},{key:"canDropOnTarget",value:function(e){return this.internalMonitor.canDropOnTarget(e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&Yt(t.prototype,n),r&&Yt(t,r),e}();n(628);function Zt(e,t){"function"==typeof e?e(t):e.current=t}function en(e,t){var n=e.ref;return Object(qt.a)("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),n?Object(C.cloneElement)(e,{ref:function(e){Zt(n,e),Zt(t,e)}}):Object(C.cloneElement)(e,{ref:t})}function tn(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}function nn(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{var a=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Object(C.isValidElement)(t)){var r=t;return e(r,n),r}var a=t;tn(a);var l=n?function(t){return e(t,n)}:e;return en(a,l)}}(r);t[n]=function(){return a}}})),t}function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(e){return null!==e&&"object"===rn(e)&&Object.prototype.hasOwnProperty.call(e,"current")}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sn=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hooks=nn({dragSource:function(e,t){n.clearDragSource(),n.dragSourceOptions=t||null,on(e)?n.dragSourceRef=e:n.dragSourceNode=e,n.reconnectDragSource()},dragPreview:function(e,t){n.clearDragPreview(),n.dragPreviewOptions=t||null,on(e)?n.dragPreviewRef=e:n.dragPreviewNode=e,n.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e)}},{key:"reconnectDragPreview",value:function(){var e=this.dragPreview,t=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();t&&this.disconnectDragPreview(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=e,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,e,this.dragPreviewOptions)):this.lastConnectedDragPreview=e)}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!Bt(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!Bt(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}}])&&an(t.prototype,n),r&&an(t,r),e}();function ln(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pn(e){var t=Object(C.useRef)(e);t.current=e,Object(qt.a)(null!=e.item,"item must be defined"),Object(qt.a)(null!=e.item.type,"item type must be defined");var n,r=dn((n=Gt(),[Object(C.useMemo)((function(){return new Qt(n)}),[n]),Object(C.useMemo)((function(){return new sn(n.getBackend())}),[n])]),2),a=r[0],l=r[1];!function(e,t,n){var r=Gt(),a=Object(C.useMemo)((function(){return{beginDrag:function(){var n=e.current,r=n.begin,a=n.item;if(r){var l=r(t);return Object(qt.a)(null==l||"object"===un(l),"dragSpec.begin() must either return an object, undefined, or null"),l||a||{}}return a||{}},canDrag:function(){return"boolean"==typeof e.current.canDrag?e.current.canDrag:"function"!=typeof e.current.canDrag||e.current.canDrag(t)},isDragging:function(n,r){var a=e.current.isDragging;return a?a(t):r===n.getSourceId()},endDrag:function(){var r=e.current.end;r&&r(t.getItem(),t),n.reconnect()}}}),[]);Nt((function(){var l=ln(function(e,t,n){var r=n.getRegistry(),a=r.addSource(e,t);return[a,function(){return r.removeSource(a)}]}(e.current.item.type,a,r),2),d=l[0],h=l[1];return t.receiveHandlerId(d),n.receiveHandlerId(d),h}),[])}(t,a,l);var d=Kt(a,t.current.collect||function(){return{}},(function(){return l.reconnect()})),h=Object(C.useMemo)((function(){return l.hooks.dragSource()}),[l]),p=Object(C.useMemo)((function(){return l.hooks.dragPreview()}),[l]);return Nt((function(){l.dragSourceOptions=t.current.options||null,l.reconnect()}),[l]),Nt((function(){l.dragPreviewOptions=t.current.previewOptions||null,l.reconnect()}),[l]),[d,h,p]}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mn=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hooks=nn({dropTarget:function(e,t){n.clearDropTarget(),n.dropTargetOptions=t,on(e)?n.dropTargetRef=e:n.dropTargetNode=e,n.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}var t,n,r;return t=e,(n=[{key:"reconnect",value:function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}},{key:"receiveHandlerId",value:function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!Bt(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}},{key:"connectTarget",get:function(){return this.dropTarget}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}}])&&gn(t.prototype,n),r&&gn(t,r),e}();function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bn=!1,yn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetId=null,this.internalMonitor=t.getMonitor()}var t,n,r;return t=e,(n=[{key:"receiveHandlerId",value:function(e){this.targetId=e}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;Object(qt.a)(!bn,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return bn=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{bn=!1}}},{key:"isOver",value:function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&vn(t.prototype,n),r&&vn(t,r),e}();function wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return On(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return On(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function On(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cn(e){var t=Object(C.useRef)(e);t.current=e,Object(qt.a)(null!=e.accept,"accept must be defined");var n,r=jn((n=Gt(),[Object(C.useMemo)((function(){return new yn(n)}),[n]),Object(C.useMemo)((function(){return new mn(n.getBackend())}),[n])]),2),a=r[0],l=r[1];!function(e,t,n){var r=Gt(),a=Object(C.useMemo)((function(){return{canDrop:function(){var n=e.current.canDrop;return!n||n(t.getItem(),t)},hover:function(){var n=e.current.hover;n&&n(t.getItem(),t)},drop:function(){var n=e.current.drop;if(n)return n(t.getItem(),t)}}}),[t]);Nt((function(){var l=wn(function(e,t,n){var r=n.getRegistry(),a=r.addTarget(e,t);return[a,function(){return r.removeTarget(a)}]}(e.current.accept,a,r),2),d=l[0],h=l[1];return t.receiveHandlerId(d),n.receiveHandlerId(d),h}),[t,n])}(t,a,l);var d=Kt(a,t.current.collect||function(){return{}},(function(){return l.reconnect()})),h=Object(C.useMemo)((function(){return l.hooks.dropTarget()}),[l]);return Nt((function(){l.dropTargetOptions=e.options||null,l.reconnect()}),[e.options]),[d,h]}function Sn(e){var t=null;return function(){return null==t&&(t=e()),t}}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var kn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entered=[],this.isNodeInDocument=t}var t,n,r;return t=e,(n=[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var a=[];return n.forEach((function(e){return a.push(e)})),a}(this.entered.filter((function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))})),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter((function(e){return e!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])&&_n(t.prototype,n),r&&_n(t,r),e}(),En=Sn((function(){return/firefox/i.test(navigator.userAgent)})),An=Sn((function(){return Boolean(window.safari)}));function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Tn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=t.length,a=[],l=0;l<r;l++)a.push(l);a.sort((function(e,n){return t[e]<t[n]?-1:1}));for(var d,h,p=[],f=[],y=[],w=0;w<r-1;w++)d=t[w+1]-t[w],h=n[w+1]-n[w],f.push(d),p.push(h),y.push(h/d);for(var x=[y[0]],j=0;j<f.length-1;j++){var O=y[j],C=y[j+1];if(O*C<=0)x.push(0);else{d=f[j];var S=f[j+1],_=d+S;x.push(3*_/((_+S)/O+(_+d)/C))}}x.push(y[y.length-1]);for(var k,E=[],A=[],T=0;T<x.length-1;T++){k=y[T];var R=x[T],I=1/f[T],P=R+x[T+1]-k-k;E.push((k-R-P)*I),A.push(P*I*I)}this.xs=t,this.ys=n,this.c1s=x,this.c2s=E,this.c3s=A}var t,n,r;return t=e,(n=[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,a=this.c2s,l=this.c3s,d=t.length-1;if(e===t[d])return n[d];for(var h,p=0,f=l.length-1;p<=f;){var y=t[h=Math.floor(.5*(p+f))];if(y<e)p=h+1;else{if(!(y>e))return n[h];f=h-1}}var w=e-t[d=Math.max(0,f)],x=w*w;return n[d]+r[d]*w+a[d]*x+l[d]*w*x}}])&&$n(t.prototype,n),r&&$n(t,r),e}();function Rn(e){var t=1===e.nodeType?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function In(e){return{x:e.clientX,y:e.clientY}}function Pn(e,t,n,r,a){var l,d,h,p="IMG"===(l=t).nodeName&&(En()||!(null===(d=document.documentElement)||void 0===d?void 0:d.contains(l))),f=Rn(p?e:t),y={x:n.x-f.x,y:n.y-f.y},w=e.offsetWidth,x=e.offsetHeight,j=r.anchorX,O=r.anchorY,C=function(e,t,n,r){var a=e?t.width:n,l=e?t.height:r;return An()&&e&&(l/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:l}}(p,t,w,x),S=C.dragPreviewWidth,_=C.dragPreviewHeight,k=a.offsetX,E=a.offsetY,A=0===E||E;return{x:0===k||k?k:new Tn([0,.5,1],[y.x,y.x/w*S,y.x+S-w]).interpolate(j),y:A?E:(h=new Tn([0,.5,1],[y.y,y.y/x*_,y.y+_-x]).interpolate(O),An()&&p&&(h+=(window.devicePixelRatio-1)*_),h)}}var Dn,Mn="__NATIVE_FILE__",Ln="__NATIVE_URL__",Fn="__NATIVE_TEXT__";function qn(e,t,n){var r=t.reduce((function(t,n){return t||e.getData(n)}),"");return null!=r?r:n}function Nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bn=(Nn(Dn={},Mn,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items}},matchesTypes:["Files"]}),Nn(Dn,Ln,{exposeProperties:{urls:function(e,t){return qn(e,t,"").split("\n")}},matchesTypes:["Url","text/uri-list"]}),Nn(Dn,Fn,{exposeProperties:{text:function(e,t){return qn(e,t,"")}},matchesTypes:["Text","text/plain"]}),Dn);function Un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Hn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.item={},this.initializeExposedProperties()}var t,n,r;return t=e,(n=[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach((function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])&&Un(t.prototype,n),r&&Un(t,r),e}();function zn(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(Bn).filter((function(e){return Bn[e].matchesTypes.some((function(e){return t.indexOf(e)>-1}))}))[0]||null}function Vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalContext=t}var t,n,r;return t=e,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}},{key:"document",get:function(){if(this.window)return this.window.document}}])&&Vn(t.prototype,n),r&&Vn(t,r),e}();function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){Yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jn,Qn=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.getSourceClientOffset=function(e){var t=r.sourceNodes.get(e);return t&&Rn(t)||null},this.endDragNativeItem=function(){r.isDraggingNativeItem()&&(r.actions.endDrag(),r.currentNativeHandle&&r.registry.removeSource(r.currentNativeHandle),r.currentNativeHandle=null,r.currentNativeSource=null)},this.isNodeInDocument=function(e){return Boolean(e&&r.document&&r.document.body&&document.body.contains(e))},this.endDragIfSourceWasRemovedFromDOM=function(){var e=r.currentDragSourceNode;r.isNodeInDocument(e)||r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragStartCapture=function(){r.clearCurrentDragSourceNode(),r.dragStartSourceIds=[]},this.handleTopDragStart=function(e){if(!e.defaultPrevented){var t=r.dragStartSourceIds;r.dragStartSourceIds=null;var n=In(e);r.monitor.isDragging()&&r.actions.endDrag(),r.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:r.getSourceClientOffset,clientOffset:n});var a=e.dataTransfer,l=zn(a);if(r.monitor.isDragging()){if(a&&"function"==typeof a.setDragImage){var d=r.monitor.getSourceId(),h=r.sourceNodes.get(d),p=r.sourcePreviewNodes.get(d)||h;if(p){var f=r.getCurrentSourcePreviewNodeOptions(),y=Pn(h,p,n,{anchorX:f.anchorX,anchorY:f.anchorY},{offsetX:f.offsetX,offsetY:f.offsetY});a.setDragImage(p,y.x,y.y)}}try{null==a||a.setData("application/json",{})}catch(e){}r.setCurrentDragSourceNode(e.target),r.getCurrentSourcePreviewNodeOptions().captureDraggingState?r.actions.publishDragSource():setTimeout((function(){return r.actions.publishDragSource()}),0)}else if(l)r.beginDragNativeItem(l);else{if(a&&!a.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}},this.handleTopDragEndCapture=function(){r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragEnterCapture=function(e){if(r.dragEnterTargetIds=[],r.enterLeaveCounter.enter(e.target)&&!r.monitor.isDragging()){var t=e.dataTransfer,n=zn(t);n&&r.beginDragNativeItem(n,t)}},this.handleTopDragEnter=function(e){var t=r.dragEnterTargetIds;(r.dragEnterTargetIds=[],r.monitor.isDragging())&&(r.altKeyPressed=e.altKey,En()||r.actions.hover(t,{clientOffset:In(e)}),t.some((function(e){return r.monitor.canDropOnTarget(e)}))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(){r.dragOverTargetIds=[]},this.handleTopDragOver=function(e){var t=r.dragOverTargetIds;if(r.dragOverTargetIds=[],!r.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));r.altKeyPressed=e.altKey,r.actions.hover(t||[],{clientOffset:In(e)}),(t||[]).some((function(e){return r.monitor.canDropOnTarget(e)}))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())):r.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(e){r.isDraggingNativeItem()&&e.preventDefault(),r.enterLeaveCounter.leave(e.target)&&r.isDraggingNativeItem()&&r.endDragNativeItem()},this.handleTopDropCapture=function(e){var t;(r.dropTargetIds=[],e.preventDefault(),r.isDraggingNativeItem())&&(null===(t=r.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));r.enterLeaveCounter.reset()},this.handleTopDrop=function(e){var t=r.dropTargetIds;r.dropTargetIds=[],r.actions.hover(t,{clientOffset:In(e)}),r.actions.drop({dropEffect:r.getCurrentDropEffect()}),r.isDraggingNativeItem()?r.endDragNativeItem():r.endDragIfSourceWasRemovedFromDOM()},this.handleSelectStart=function(e){var t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new Wn(n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new kn(this.isNodeInDocument)}var t,n,a;return t=e,(n=[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"setup",value:function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}}},{key:"teardown",value:function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var a=function(t){return r.handleDragStart(t,e)},l=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",a),t.addEventListener("selectstart",l),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",a),t.removeEventListener("selectstart",l),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},a=function(t){return n.handleDragOver(t,e)},l=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",a),t.addEventListener("drop",l),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",a),t.removeEventListener("drop",l)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return Gn({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return Gn({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(r).some((function(t){return r[t]===e}))}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new Hn(Bn[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout((function(){return t.window&&t.window.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.window&&(this.window.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}}])&&Xn(t.prototype,n),a&&Xn(t,a),e}(),Zn=function(e,t){return new Qn(e,t)};function er(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?er(Object(n),!0).forEach((function(t){nr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ir(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function or(e,t,n){return(or=ar()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&sr(a,n.prototype),a}).apply(null,arguments)}function ar(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function sr(e,t){return(sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lr=Object(Lt.b)((function(){function e(t){return!(!t.getAttribute||!t.getAttribute("dnd-container"))||!!t.parentNode&&e(t.parentNode)}for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=or(Zn,n),l=["handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture"];return l.forEach((function(t){var n=a[t];a[t]=function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];e(t.target)&&n.apply(void 0,[t].concat(a))}})),a}));function cr(e){var t=e.children,n=Object(C.useRef)(lr);return Object(R.jsx)(Ft.a,{manager:n.current.dragDropManager,children:t})}function ur(e){var t=Object(Mt.a)().t,n=Object(te.b)(dr).permissionsLevel,r=Object(T.b)().fileTreeData,a=Ye().selectedEntityIds,l=rr(Object(C.useState)(!0),2),d=l[0],h=l[1],p={type:"ENTITY"},f=rr(pn({item:p,begin:function(){var n=function(e,t){return e.size>1&&e.has(t)?new Set(e):new Set([t])}(a,e),l=Object(G.b)(r,n),d=function(e,t){if(1===e.size){return Array.from(e)[0].entity.name}return t("n_items",{count:e.size})}(l,t),h=function(e){var t=Array.from(e).filter((function(e){return"folder"===e.type})).map((function(e){return e.entity})),n=new Set(t);return Object(G.a)(n)}(l);return tr(tr({},p),{},{title:d,forbiddenFolderIds:h,draggedEntityIds:n})},collect:function(e){return{isDragging:!!e.isDragging()}},canDrag:function(){return"readOnly"!==n&&d}}),3),y=f[0].isDragging,w=f[1],x=f[2];return Object(C.useEffect)((function(){x((Jn||((Jn=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Jn))}),[x]),{dragRef:w,isDragging:y,setIsDraggable:h}}cr.propTypes={children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired};var dr={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])};function hr(e){var t=Dt().finishMoving,n=rr(Cn({accept:"ENTITY",canDrop:function(t,n){return!!n.isOver({shallow:!0})&&!t.forbiddenFolderIds.has(e)},drop:function(n,r){r.didDrop()||t(e,n.draggedEntityIds)},collect:function(e){return{isOver:e.canDrop()}}}),2),r=n[0].isOver;return{dropRef:n[1],isOver:r}}function pr(e){var t=e.refProviders,n=e.reindexReferences,r=e.setRefProviderEnabled,a=e.setStartedFreeTrial,l=e.onSelect,d=e.children;return Object(R.jsx)(L,{refProviders:t,setRefProviderEnabled:r,setStartedFreeTrial:a,reindexReferences:n,children:Object(R.jsx)(ze,{onSelect:l,children:Object(R.jsx)(Rt,{children:Object(R.jsx)(cr,{children:d})})})})}pr.propTypes={reindexReferences:k.a.func.isRequired,refProviders:k.a.object.isRequired,setRefProviderEnabled:k.a.func.isRequired,setStartedFreeTrial:k.a.func.isRequired,onSelect:k.a.func.isRequired,children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired};var fr=pr;function gr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vr(e){var t=e.isOver,n=function(e){var t=Gt().getMonitor(),n=gr(zt(t,e),2),r=n[0],a=n[1];return Object(C.useEffect)((function(){return t.subscribeToOffsetChange(a)})),Object(C.useEffect)((function(){return t.subscribeToStateChange(a)})),r}((function(e){return{isDragging:e.isDragging(),item:e.getItem(),clientOffset:e.getClientOffset()}})),r=n.isDragging,a=n.item,l=n.clientOffset,d=Object(C.useRef)(),h=d.current?d.current.getBoundingClientRect():null;return r?Object(R.jsx)("div",{ref:d,className:re()("dnd-draggable-preview-layer",{"dnd-droppable-hover":t}),children:Object(R.jsx)("div",{style:yr(l,h),children:Object(R.jsx)(br,{title:a.title})})}):null}function br(e){var t=e.title;return Object(R.jsx)("div",{className:"dnd-draggable-preview-item",children:t})}function yr(e,t){if(!t||!e)return{display:"none"};var n=t.x,r=t.y,a=e.x,l=e.y-r-15,d="translate(".concat(a-n-15,"px, ").concat(l,"px)");return{transform:d,WebkitTransform:d}}vr.propTypes={isOver:k.a.bool.isRequired},br.propTypes={title:k.a.string.isRequired};var wr=vr,xr=n(307);function jr(e){return e===Object(e)&&0!==Object.keys(e).length}var Or=function(e,t){var n=!e.ownerDocument.documentElement.contains(e);if(jr(t)&&"function"==typeof t.behavior)return t.behavior(n?[]:Object(xr.a)(e,t));if(!n){var r=function(e){return!1===e?{block:"end",inline:"nearest"}:jr(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var r=e.el,a=e.top,l=e.left;r.scroll&&n?r.scroll({top:a,left:l,behavior:t}):(r.scrollTop=a,r.scrollLeft=l)}))}(Object(xr.a)(e,r),r.behavior)}};function Cr(){var e=Object(C.useRef)();return Object(C.useEffect)((function(){e.current&&window.requestAnimationFrame((function(){e.current&&e.current.focus()}))}),[e]),{autoFocusedRef:e}}function Sr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kr(e){var t=e.name,n=e.isSelected,r=e.setIsDraggable,a=Dt(),l=a.isRenaming,d=a.startRenaming,h=a.finishRenaming,p=a.error,f=a.cancel,y=l&&n&&!p;return Object(C.useEffect)((function(){r(!y)}),[r,y]),y?Object(R.jsx)(Ar,{initialValue:t,finishRenaming:h,cancel:f}):Object(R.jsx)(Er,{name:t,isSelected:n,startRenaming:d})}function Er(e){var t=e.name,n=e.isSelected,r=e.startRenaming,a=Sr(Object(C.useState)(0),2),l=a[0],d=a[1];return Object(R.jsx)("button",{className:"item-name-button",onClick:function(){d(l+1),n||d(0)},onDoubleClick:function(){l<2||r()},children:Object(R.jsx)("span",{children:t})})}function Ar(e){var t=e.initialValue,n=e.finishRenaming,r=e.cancel,a=Sr(Object(C.useState)(t),2),l=a[0],d=a[1],h=Cr().autoFocusedRef;return Object(R.jsx)("span",{className:"rename-input",children:Object(R.jsx)("input",{type:"text",value:l,onKeyDown:function(e){"Enter"===e.key&&n(l),"Escape"===e.key&&r()},onChange:function(e){d(e.target.value)},onBlur:function(){n(l)},onFocus:function(e){var t=e.target.value.lastIndexOf(".");e.target.setSelectionRange(0,t)},ref:h})})}kr.propTypes={name:k.a.string.isRequired,isSelected:k.a.bool.isRequired,setIsDraggable:k.a.func.isRequired},Er.propTypes={name:k.a.string.isRequired,startRenaming:k.a.func.isRequired,isSelected:k.a.bool.isRequired},Ar.propTypes={initialValue:k.a.string.isRequired,finishRenaming:k.a.func.isRequired,cancel:k.a.func.isRequired};var $r=kr,Tr=n(59),Rr=n.n(Tr);var Ir=n(305),Pr=n(15);function Dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lr(e){var t=e.id,n=Object(Mt.a)().t,r=M(),a=r.contextMenuCoords,l=r.setContextMenuCoords,d=Dr(Object(C.useState)(),2),h=d[0],p=d[1];var f;return Object(R.jsx)("div",{className:"menu-button btn-group",children:Object(R.jsx)(Ir.a,{className:"entity-menu-toggle btn btn-default",id:"menu-button-".concat(t),onClick:(f=function(e){var t=h.getBoundingClientRect();l(a?null:{top:t.top+t.height/2,left:t.right})},function(e){e.stopPropagation(),f&&f(e)}),ref:function(e){e&&p(Object(Tr.findDOMNode)(e))},children:Object(R.jsx)(Pr.a,{type:"ellipsis-v",accessibilityLabel:n("menu")})})})}Lr.propTypes={id:k.a.string.isRequired};var Fr=Lr;function qr(e){var t=e.id,n=e.name,r=e.isSelected,a=e.icons,l=Object(te.b)(Nr).permissionsLevel,d=M().setContextMenuCoords,h=Ye().selectedEntityIds,p="readOnly"!==l&&r&&1===h.size,f=ur(t),y=f.isDragging,w=f.dragRef,x=f.setIsDraggable,j=Object(C.createRef)();return Object(C.useEffect)((function(){var e=j.current;r&&e&&setTimeout((function(){e&&Or(e,{scrollMode:"if-needed"})}),100)}),[r,j]),Object(R.jsx)("div",{className:re()("entity",{"dnd-draggable-dragging":y}),role:"presentation",ref:w,onContextMenu:function(e){e.preventDefault(),d({top:e.pageY,left:e.pageX})},children:Object(R.jsxs)("div",{className:"entity-name entity-name-react",role:"presentation",ref:j,children:[a,Object(R.jsx)($r,{name:n,isSelected:r,setIsDraggable:x}),p?Object(R.jsx)(Fr,{id:t}):null]})})}qr.propTypes={id:k.a.string.isRequired,name:k.a.string.isRequired,isSelected:k.a.bool.isRequired,icons:k.a.node};var Nr={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])},Br=qr;function Ur(e){var t=e.split(".").pop();return t=t?t.toLowerCase():t,["png","pdf","jpg","jpeg","gif"].includes(t)?"image":["csv","xls","xlsx"].includes(t)?"table":["py","r"].includes(t)?"file-text":["bib"].includes(t)?"book":"file"}function Hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(n),!0).forEach((function(t){Vr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wr(e){var t=e.name,n=e.id,r=e.isFile,a=e.isLinkedFile,l=Ke(n,r),d=l.isSelected,h=l.props;return Object(R.jsx)("li",zr(zr({role:"treeitem"},h),{},{"aria-label":t,tabIndex:"0",children:Object(R.jsx)(Br,{id:n,name:t,isSelected:d,icons:Object(R.jsx)(Kr,{isLinkedFile:a,name:t})})}))}Wr.propTypes={name:k.a.string.isRequired,id:k.a.string.isRequired,isFile:k.a.bool,isLinkedFile:k.a.bool};var Kr=function(e){var t=e.isLinkedFile,n=e.name,r=Object(Mt.a)().t,a=re()("spaced",{"linked-file-icon":t});return Object(R.jsxs)(R.Fragment,{children:[" ",Object(R.jsx)(Pr.a,{type:Ur(n),fw:!0,className:a}),t&&Object(R.jsx)(Pr.a,{type:"external-link-square",modifier:"rotate-180",className:"linked-file-highlight",accessibilityLabel:r("linked_file")})]})};Kr.propTypes={name:k.a.string.isRequired,isLinkedFile:k.a.bool};var Gr=Wr;function Yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yr(Object(n),!0).forEach((function(t){Jr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ei(e){var t=e.name,n=e.id,r=e.folders,a=e.docs,l=e.files,d=Object(Mt.a)().t,h=Ke(n),p=h.isSelected,f=h.props,y=Ye().selectedEntityParentIds,w=Qr(Object(De.a)("folder.".concat(n,".expanded"),!1),2),x=w[0],j=w[1];Object(C.useEffect)((function(){y.has(n)&&j(!0)}),[n,y,j]);var O=hr(n),S=O.isOver,_=O.dropRef,k=hr(n),E=k.isOver,A=k.dropRef,T=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("button",{onClick:function(){j(!x)},"aria-label":d(x?"collapse":"expand"),children:Object(R.jsx)(Pr.a,{type:x?"angle-down":"angle-right",fw:!0})}),Object(R.jsx)(Pr.a,{type:x?"folder-open":"folder",fw:!0})]});return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("li",Xr(Xr({role:"treeitem"},f),{},{"aria-expanded":x,"aria-label":t,tabIndex:"0",ref:_,className:re()(f.className,{"dnd-droppable-hover":S||E}),children:Object(R.jsx)(Br,{id:n,name:t,isSelected:p,icons:T})})),x?Object(R.jsx)(ui,{folders:r,docs:a,files:l,dropRef:A}):null]})}ei.propTypes={name:k.a.string.isRequired,id:k.a.string.isRequired,folders:k.a.array.isRequired,docs:k.a.array.isRequired,files:k.a.array.isRequired};var ti=ei,ni=new Intl.Collator("en",{numeric:!0,sensitivity:"variant",caseFirst:"upper"});function ri(e){return function(e){if(Array.isArray(e))return ii(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ii(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ii(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(n),!0).forEach((function(t){si(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function li(e){var t=e.folders,n=e.docs,r=e.files,a=e.classes,l=void 0===a?{}:a,d=e.dropRef,h=void 0===d?null:d,p=e.children;r=r.map((function(e){return ai(ai({},e),{},{isFile:!0})}));var f=[].concat(ri(n),ri(r));return Object(R.jsxs)("ul",{className:re()("list-unstyled",l.root),role:"tree",ref:h,"dnd-container":"true",children:[t.sort(ci).map((function(e){return Object(R.jsx)(ti,{name:e.name,id:e._id,folders:e.folders,docs:e.docs,files:e.fileRefs},e._id)})),f.sort(ci).map((function(e){return Object(R.jsx)(Gr,{name:e.name,id:e._id,isFile:e.isFile,isLinkedFile:e.linkedFileData&&!!e.linkedFileData.provider},e._id)})),p]})}function ci(e,t){return ni.compare(e.name,t.name)}li.propTypes={folders:k.a.array.isRequired,docs:k.a.array.isRequired,files:k.a.array.isRequired,classes:k.a.exact({root:k.a.string}),dropRef:k.a.func,children:k.a.node};var ui=li,di=n(792),hi=n(1017);function pi(e){var t=e.id,n=e.description,r=e.onClick,a=e.children,l=Object(R.jsx)(di.a,{id:"".concat(t,"_tooltip"),children:n});return Object(R.jsx)(hi.a,{placement:"bottom",overlay:l,children:Object(R.jsx)(Ir.a,{onClick:r,children:a})})}pi.propTypes={id:k.a.string.isRequired,description:k.a.string.isRequired,onClick:k.a.func,children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node])};var fi=pi;var gi={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])};function mi(){var e=Object(Mt.a)().t,t=Dt(),n=t.canCreate,r=t.startCreatingFolder,a=t.startCreatingDocOrFile,l=t.startUploadingDocOrFile;return n?Object(R.jsxs)("div",{className:"toolbar-left",children:[Object(R.jsx)(fi,{id:"new_file",description:e("new_file"),onClick:a,children:Object(R.jsx)(Pr.a,{type:"file",fw:!0,accessibilityLabel:e("new_file")})}),Object(R.jsx)(fi,{id:"new_folder",description:e("new_folder"),onClick:r,children:Object(R.jsx)(Pr.a,{type:"folder",fw:!0,accessibilityLabel:e("new_folder")})}),Object(R.jsx)(fi,{id:"upload",description:e("upload"),onClick:l,children:Object(R.jsx)(Pr.a,{type:"upload",fw:!0,accessibilityLabel:e("upload")})})]}):null}function vi(){var e=Object(Mt.a)().t,t=Dt(),n=t.canRename,r=t.canDelete,a=t.startRenaming,l=t.startDeleting;return n||r?Object(R.jsxs)("div",{className:"toolbar-right",children:[n?Object(R.jsx)(fi,{id:"rename",description:e("rename"),onClick:a,children:Object(R.jsx)(Pr.a,{type:"pencil",fw:!0,accessibilityLabel:e("rename")})}):null,r?Object(R.jsx)(fi,{id:"delete",description:e("delete"),onClick:l,children:Object(R.jsx)(Pr.a,{type:"trash-o",fw:!0,accessibilityLabel:e("delete")})}):null]}):null}var bi=function(){return"readOnly"===Object(te.b)(gi).permissionsLevel?null:Object(R.jsxs)("div",{className:"toolbar toolbar-filetree",children:[Object(R.jsx)(mi,{}),Object(R.jsx)(vi,{})]})},yi=n(1018),wi=n(86);var xi=function(){var e=Object(Mt.a)().t,t=Dt(),n=t.isDeleting,r=t.inFlight,a=t.finishDeleting,l=t.actionedEntities,d=t.cancel,h=t.error;if(!n)return null;function p(){d()}return Object(R.jsxs)(wi.a,{show:!0,onHide:p,children:[Object(R.jsx)(yi.a.Header,{children:Object(R.jsx)(yi.a.Title,{children:e("delete")})}),Object(R.jsxs)(yi.a.Body,{children:[Object(R.jsx)("p",{children:e("sure_you_want_to_delete")}),Object(R.jsx)("ul",{children:l.map((function(e){return Object(R.jsx)("li",{children:e.name},e._id)}))}),h&&Object(R.jsx)("div",{className:"alert alert-danger file-tree-modal-alert",children:e("generic_something_went_wrong")})]}),Object(R.jsx)(yi.a.Footer,{children:r?Object(R.jsxs)(Ir.a,{bsStyle:"danger",disabled:!0,children:[e("deleting"),"…"]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Ir.a,{onClick:p,children:e("cancel")}),Object(R.jsx)(Ir.a,{bsStyle:"danger",onClick:function(){a()},children:e("delete")})]})})]})};n(113);function ji(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ci(e){var t=e.name,n=e.setName,r=e.validName,a=e.setValidName,l=e.handleCreateFolder,d=Cr().autoFocusedRef;return Object(R.jsx)("input",{ref:d,className:"form-control",type:"text",value:t,onKeyDown:function(e){"Enter"===e.key&&r&&l()},onChange:function(e){a(Z(e.target.value.trim())),n(e.target.value)},onFocus:function(e){e.target.setSelectionRange(0,-1)}})}Ci.propTypes={name:k.a.string.isRequired,setName:k.a.func.isRequired,validName:k.a.bool.isRequired,setValidName:k.a.func.isRequired,handleCreateFolder:k.a.func.isRequired};var Si=function(){var e=Object(Mt.a)().t,t=ji(Object(C.useState)(""),2),n=t[0],r=t[1],a=ji(Object(C.useState)(!0),2),l=a[0],d=a[1],h=Dt(),p=h.isCreatingFolder,f=h.inFlight,y=h.finishCreatingFolder,w=h.cancel,x=h.error;if(!p)return null;function j(){w()}function O(){y(n)}function S(){switch(x.constructor){case ut:return e("file_already_exists");default:return e("generic_something_went_wrong")}}return Object(R.jsxs)(wi.a,{show:!0,onHide:j,children:[Object(R.jsx)(yi.a.Header,{children:Object(R.jsx)(yi.a.Title,{children:e("new_folder")})}),Object(R.jsxs)(yi.a.Body,{children:[Object(R.jsx)(Ci,{name:n,setName:r,validName:l,setValidName:d,handleCreateFolder:O}),l?null:Object(R.jsx)("div",{role:"alert","aria-label":e("files_cannot_include_invalid_characters"),className:"alert alert-danger file-tree-modal-alert",children:e("files_cannot_include_invalid_characters")}),x?Object(R.jsx)("div",{role:"alert","aria-label":S(),className:"alert alert-danger file-tree-modal-alert",children:S()}):null]}),Object(R.jsx)(yi.a.Footer,{children:f?Object(R.jsxs)(Ir.a,{bsStyle:"primary",disabled:!0,children:[e("creating"),"…"]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Ir.a,{onClick:j,children:e("cancel")}),Object(R.jsx)(Ir.a,{bsStyle:"primary",onClick:O,disabled:!l,children:e("create")})]})})]})},_i=n(1031);var ki=function FileTreeModalError(){var e=Object(Mt.a)().t,t=Dt(),n=t.isRenaming,r=t.isMoving,a=t.cancel,l=t.error;if(!l)return null;if(!n&&!r)return null;function d(){a()}function h(){switch(l.constructor){case ut:return e("file_already_exists");case dt:return Object(R.jsx)(_i.a,{i18nKey:"file_already_exists_in_this_location",components:[Object(R.jsx)("strong",{})],values:{fileName:l.entityName}});case lt:return e("files_cannot_include_invalid_characters");case ct:return e("blocked_filename");default:return e("generic_something_went_wrong")}}return Object(R.jsxs)(yi.a,{show:!0,onHide:d,children:[Object(R.jsx)(yi.a.Header,{children:Object(R.jsx)(yi.a.Title,{children:function(){switch(l.constructor){case ut:case dt:return e("duplicate_file");case lt:case ct:return e("invalid_file_name");default:return e("error")}}()})}),Object(R.jsx)(yi.a.Body,{children:Object(R.jsx)("div",{role:"alert","aria-label":h(),children:h()})}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{onClick:d,children:e("ok")})})]})},Ei=n(27),Ai=n(35),$i=n(34),Ti=n(51),Ri=n(484),Ii=n.n(Ri),Pi=n(139),Di=n.n(Pi),Mi=n(183),Li=n.n(Mi),Fi=n(255),qi=n.n(Fi),Ni=n(68),Bi=n.n(Ni),Ui=n(218),Hi=n.n(Ui),zi=n(39),Vi=n(105),Wi=n(179),Ki=n.n(Wi),Gi=function(){};function Yi(e,t){return void 0!==e[t]}function Xi(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}var Ji=n(363),Qi=n(297);n(177);var Zi=n(612),eo=n(611),to=n.n(eo),no=n(296),ro=n.n(no),oo=n(23),ao=n(69),so=n(180),lo={open:k.a.bool,pullRight:k.a.bool,onClose:k.a.func,labelledBy:k.a.oneOfType([k.a.string,k.a.number]),onSelect:k.a.func,rootCloseEvent:k.a.oneOf(["click","mousedown"])},co=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleRootClose=n.handleRootClose.bind(Object(Ti.a)(Object(Ti.a)(n))),n.handleKeyDown=n.handleKeyDown.bind(Object(Ti.a)(Object(Ti.a)(n))),n}Object($i.a)(t,e);var n=t.prototype;return n.getFocusableMenuItems=function(){var e=Rr.a.findDOMNode(this);return e?to()(e.querySelectorAll('[tabIndex="-1"]')):[]},n.getItemsAndActiveIndex=function(){var e=this.getFocusableMenuItems(),t=e.indexOf(document.activeElement);return{items:e,activeIndex:t}},n.focusNext=function(){var e=this.getItemsAndActiveIndex(),t=e.items,n=e.activeIndex;0!==t.length&&t[n===t.length-1?0:n+1].focus()},n.focusPrevious=function(){var e=this.getItemsAndActiveIndex(),t=e.items,n=e.activeIndex;0!==t.length&&t[0===n?t.length-1:n-1].focus()},n.handleKeyDown=function(e){switch(e.keyCode){case Li.a.codes.down:this.focusNext(),e.preventDefault();break;case Li.a.codes.up:this.focusPrevious(),e.preventDefault();break;case Li.a.codes.esc:case Li.a.codes.tab:this.props.onClose(e,{source:"keydown"})}},n.handleRootClose=function(e){this.props.onClose(e,{source:"rootClose"})},n.render=function(){var e,t=this,n=this.props,r=n.open,a=n.pullRight,l=n.labelledBy,d=n.onSelect,h=n.className,p=n.rootCloseEvent,f=n.children,y=Object(Ai.a)(n,["open","pullRight","labelledBy","onSelect","className","rootCloseEvent","children"]),w=Object(oo.g)(y,["onClose"]),x=w[0],j=w[1],O=Object(Ei.a)({},Object(oo.d)(x),((e={})[Object(oo.e)(x,"right")]=a,e));return S.a.createElement(ro.a,{disabled:!r,onRootClose:this.handleRootClose,event:p},S.a.createElement("ul",Object(Ei.a)({},j,{role:"menu",className:re()(h,O),"aria-labelledby":l}),so.a.map(f,(function(e){return S.a.cloneElement(e,{onKeyDown:Object(ao.a)(e.props.onKeyDown,t.handleKeyDown),onSelect:Object(ao.a)(e.props.onSelect,d)})}))))},t}(S.a.Component);co.propTypes=lo,co.defaultProps={bsRole:"menu",pullRight:!1};var uo=Object(oo.a)("dropdown-menu",co),ho=n(254),po={noCaret:k.a.bool,open:k.a.bool,title:k.a.string,useAnchor:k.a.bool},fo=function(e){function t(){return e.apply(this,arguments)||this}return Object($i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.noCaret,n=e.open,r=e.useAnchor,a=e.bsClass,l=e.className,d=e.children,h=Object(Ai.a)(e,["noCaret","open","useAnchor","bsClass","className","children"]);delete h.bsRole;var p=r?ho.a:Ir.a,f=!t;return S.a.createElement(p,Object(Ei.a)({},h,{role:"button",className:re()(l,a),"aria-haspopup":!0,"aria-expanded":n}),d||h.title,f&&" ",f&&S.a.createElement("span",{className:"caret"}))},t}(S.a.Component);fo.propTypes=po,fo.defaultProps={open:!1,useAnchor:!1,bsRole:"toggle"};var go=Object(oo.a)("dropdown-toggle",fo),mo=n(178),vo=n.n(mo);k.a.oneOfType([k.a.string,k.a.number]);var bo=go.defaultProps.bsRole,yo=uo.defaultProps.bsRole,wo={dropup:k.a.bool,id:Hi()(k.a.oneOfType([k.a.string,k.a.number])),componentClass:Bi.a,children:qi()(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vo()((function(e,n,r){var a;return t.every((function(t){return!!so.a.some(e.children,(function(e){return e.props.bsRole===t}))||(a=t,!1)})),a?new Error("(children) "+r+" - Missing a required child with bsRole: "+a+". "+r+" must have at least one child of each of the following bsRoles: "+t.join(", ")):null}))}(bo,yo),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vo()((function(e,n,r){var a;return t.every((function(t){return!(so.a.filter(e.children,(function(e){return e.props.bsRole===t})).length>1)||(a=t,!1)})),a?new Error("(children) "+r+" - Duplicate children detected of bsRole: "+a+". Only one child each allowed with the following bsRoles: "+t.join(", ")):null}))}(yo)),disabled:k.a.bool,pullRight:k.a.bool,open:k.a.bool,defaultOpen:k.a.bool,onToggle:k.a.func,onSelect:k.a.func,role:k.a.string,rootCloseEvent:k.a.oneOf(["click","mousedown"]),onMouseEnter:k.a.func,onMouseLeave:k.a.func},xo={componentClass:Zi.a},jo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleClick=r.handleClick.bind(Object(Ti.a)(Object(Ti.a)(r))),r.handleKeyDown=r.handleKeyDown.bind(Object(Ti.a)(Object(Ti.a)(r))),r.handleClose=r.handleClose.bind(Object(Ti.a)(Object(Ti.a)(r))),r._focusInDropdown=!1,r.lastOpenEventType=null,r}Object($i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.focusNextOnOpen()},n.UNSAFE_componentWillUpdate=function(e){!e.open&&this.props.open&&(this._focusInDropdown=Di()(Rr.a.findDOMNode(this.menu),Ii()(document)))},n.componentDidUpdate=function(e){var t=this.props.open,n=e.open;t&&!n&&this.focusNextOnOpen(),!t&&n&&this._focusInDropdown&&(this._focusInDropdown=!1,this.focus())},n.focus=function(){var e=Rr.a.findDOMNode(this.toggle);e&&e.focus&&e.focus()},n.focusNextOnOpen=function(){var e=this.menu;e&&e.focusNext&&("keydown"!==this.lastOpenEventType&&"menuitem"!==this.props.role||e.focusNext())},n.handleClick=function(e){this.props.disabled||this.toggleOpen(e,{source:"click"})},n.handleClose=function(e,t){this.props.open&&this.toggleOpen(e,t)},n.handleKeyDown=function(e){if(!this.props.disabled)switch(e.keyCode){case Li.a.codes.down:this.props.open?this.menu.focusNext&&this.menu.focusNext():this.toggleOpen(e,{source:"keydown"}),e.preventDefault();break;case Li.a.codes.esc:case Li.a.codes.tab:this.handleClose(e,{source:"keydown"})}},n.toggleOpen=function(e,t){var n=!this.props.open;n&&(this.lastOpenEventType=t.source),this.props.onToggle&&this.props.onToggle(n,e,t)},n.renderMenu=function(e,t){var n=this,r=t.id,a=t.onSelect,l=t.rootCloseEvent,d=Object(Ai.a)(t,["id","onSelect","rootCloseEvent"]),h=function(e){n.menu=e};return"string"==typeof e.ref||(h=Object(ao.a)(e.ref,h)),Object(C.cloneElement)(e,Object(Ei.a)({},d,{ref:h,labelledBy:r,bsClass:Object(oo.e)(d,"menu"),onClose:Object(ao.a)(e.props.onClose,this.handleClose),onSelect:Object(ao.a)(e.props.onSelect,a,(function(e,t){return n.handleClose(t,{source:"select"})})),rootCloseEvent:l}))},n.renderToggle=function(e,t){var n=this,r=function(e){n.toggle=e};return"string"==typeof e.ref||(r=Object(ao.a)(e.ref,r)),Object(C.cloneElement)(e,Object(Ei.a)({},t,{ref:r,bsClass:Object(oo.e)(t,"toggle"),onClick:Object(ao.a)(e.props.onClick,this.handleClick),onKeyDown:Object(ao.a)(e.props.onKeyDown,this.handleKeyDown)}))},n.render=function(){var e,t=this,n=this.props,r=n.componentClass,a=n.id,l=n.dropup,d=n.disabled,h=n.pullRight,p=n.open,f=n.onSelect,y=n.role,w=n.bsClass,x=n.className,j=n.rootCloseEvent,O=n.children,C=Object(Ai.a)(n,["componentClass","id","dropup","disabled","pullRight","open","onSelect","role","bsClass","className","rootCloseEvent","children"]);delete C.onToggle;var _=((e={})[w]=!0,e.open=p,e.disabled=d,e);return l&&(_[w]=!1,_.dropup=!0),S.a.createElement(r,Object(Ei.a)({},C,{className:re()(x,_)}),so.a.map(O,(function(e){switch(e.props.bsRole){case bo:return t.renderToggle(e,{id:a,disabled:d,open:p,role:y,bsClass:w});case yo:return t.renderMenu(e,{id:a,open:p,pullRight:h,bsClass:w,onSelect:f,rootCloseEvent:j});default:return e}})))},t}(S.a.Component);jo.propTypes=wo,jo.defaultProps=xo,Object(oo.a)("dropdown",jo);var Oo=function e(t,n,r){void 0===r&&(r=[]);var a,l=t.displayName||t.name||"Component",d=!!(a=t)&&("function"!=typeof a||a.prototype&&a.prototype.isReactComponent),h=Object.keys(n),p=h.map(Xi);!d&&r.length&&Ki()(!1);var f=function(e){function a(){for(var t,a=arguments.length,l=new Array(a),d=0;d<a;d++)l[d]=arguments[d];(t=e.call.apply(e,[this].concat(l))||this).handlers=Object.create(null),h.forEach((function(e){var r=n[e];t.handlers[r]=function(n){if(t.props[r]){var a;t._notifying=!0;for(var l=arguments.length,d=new Array(l>1?l-1:0),h=1;h<l;h++)d[h-1]=arguments[h];(a=t.props)[r].apply(a,[n].concat(d)),t._notifying=!1}t.unmounted||t.setState((function(t){var r,a=t.values;return{values:Object(zi.a)(Object.create(null),a,(r={},r[e]=n,r))}}))}})),r.length&&(t.attachRef=function(e){t.inner=e});var p=Object.create(null);return h.forEach((function(e){p[e]=t.props[Xi(e)]})),t.state={values:p,prevProps:{}},t}Object(Ji.a)(a,e);var l=a.prototype;return l.shouldComponentUpdate=function(){return!this._notifying},a.getDerivedStateFromProps=function(e,t){var n=t.values,r=t.prevProps,a={values:Object(zi.a)(Object.create(null),n),prevProps:{}};return h.forEach((function(t){a.prevProps[t]=e[t],!Yi(e,t)&&Yi(r,t)&&(a.values[t]=e[Xi(t)])})),a},l.componentWillUnmount=function(){this.unmounted=!0},l.render=function(){var e=this,n=this.props,r=n.innerRef,a=Object(Vi.a)(n,["innerRef"]);p.forEach((function(e){delete a[e]}));var l={};return h.forEach((function(t){var n=e.props[t];l[t]=void 0!==n?n:e.state.values[t]})),S.a.createElement(t,Object(zi.a)({},a,l,this.handlers,{ref:r||this.attachRef}))},a}(S.a.Component);Object(Qi.polyfill)(f),f.displayName="Uncontrolled("+l+")",f.propTypes=Object(zi.a)({innerRef:function(){}},function(e,t){var n={};return Object.keys(e).forEach((function(e){n[Xi(e)]=Gi})),n}(n)),r.forEach((function(e){f.prototype[e]=function(){var t;return(t=this.inner)[e].apply(t,arguments)}}));var y=f;return S.a.forwardRef&&((y=S.a.forwardRef((function(e,t){return S.a.createElement(f,Object(zi.a)({},e,{innerRef:t,__source:{fileName:"/Users/jquense/src/uncontrollable/src/uncontrollable.js",lineNumber:128},__self:this}))}))).propTypes=f.propTypes),y.ControlledComponent=t,y.deferControlTo=function(t,r,a){return void 0===r&&(r={}),e(t,Object(zi.a)({},n,r),a)},y}(jo,{open:"onToggle"});Oo.Toggle=go,Oo.Menu=uo;var Co=Oo,So={active:k.a.bool,disabled:k.a.bool,divider:qi()(k.a.bool,(function(e){var t=e.divider,n=e.children;return t&&n?new Error("Children will not be rendered for dividers"):null})),eventKey:k.a.any,header:k.a.bool,href:k.a.string,onClick:k.a.func,onSelect:k.a.func},_o=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleClick=r.handleClick.bind(Object(Ti.a)(Object(Ti.a)(r))),r}Object($i.a)(t,e);var n=t.prototype;return n.handleClick=function(e){var t=this.props,n=t.href,r=t.disabled,a=t.onSelect,l=t.eventKey;n&&!r||e.preventDefault(),r||a&&a(l,e)},n.render=function(){var e=this.props,t=e.active,n=e.disabled,r=e.divider,a=e.header,l=e.onClick,d=e.className,h=e.style,p=Object(Ai.a)(e,["active","disabled","divider","header","onClick","className","style"]),f=Object(oo.g)(p,["eventKey","onSelect"]),y=f[0],w=f[1];return r?(w.children=void 0,S.a.createElement("li",Object(Ei.a)({},w,{role:"separator",className:re()(d,"divider"),style:h}))):a?S.a.createElement("li",Object(Ei.a)({},w,{role:"heading",className:re()(d,Object(oo.e)(y,"header")),style:h})):S.a.createElement("li",{role:"presentation",className:re()(d,{active:t,disabled:n}),style:h},S.a.createElement(ho.a,Object(Ei.a)({},w,{role:"menuitem",tabIndex:"-1",onClick:Object(ao.a)(l,this.handleClick)})))},t}(S.a.Component);_o.propTypes=So,_o.defaultProps={divider:!1,disabled:!1,header:!1};var ko=Object(oo.a)("dropdown",_o);var Eo=function(){var e=Object(Mt.a)().t,t=Dt(),n=t.canRename,r=t.canDelete,a=t.canCreate,l=t.startRenaming,d=t.startDeleting,h=t.startCreatingFolder,p=t.startCreatingDocOrFile,f=t.startUploadingDocOrFile;return Object(R.jsxs)(R.Fragment,{children:[n?Object(R.jsx)(ko,{onClick:l,children:e("rename")}):null,r?Object(R.jsx)(ko,{onClick:d,children:e("delete")}):null,a?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(ko,{divider:!0}),Object(R.jsx)(ko,{onClick:p,children:e("new_file")}),Object(R.jsx)(ko,{onClick:h,children:e("new_folder")}),Object(R.jsx)(ko,{onClick:f,children:e("upload")})]}):null]})};var Ao={permissionsLevel:k.a.oneOf(["readOnly","readAndWrite","owner"])},$o=S.a.forwardRef((function(e,t){return null}));$o.displayName="FakeDropDownToggle";var To=function(){var e=Object(te.b)(Ao).permissionsLevel,t=M(),n=t.contextMenuCoords,r=t.setContextMenuCoords;if("readOnly"===e||!n)return null;function a(e){e||r(null)}return Rr.a.createPortal(Object(R.jsxs)(Co,{onClick:function(){a(!1)},open:!0,id:"dropdown-file-tree-context-menu",onToggle:a,children:[Object(R.jsx)($o,{bsRole:"toggle"}),Object(R.jsx)(Co.Menu,{className:"context-menu",style:n,children:Object(R.jsx)(Eo,{})})]}),document.querySelector("body"))};var Ro=function FileTreeError(){var e=Object(Mt.a)().t;return Object(R.jsxs)("div",{className:"file-tree-error",children:[Object(R.jsx)("p",{children:e("generic_something_went_wrong")}),Object(R.jsx)("p",{children:e("please_refresh")}),Object(R.jsx)(Ir.a,{bsStyle:"primary",onClick:function(){location.reload()},children:e("refresh")})]})},Io=n(133);function Po(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Do(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Do(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Do(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fo=Object(C.createContext)(),qo=function(){var e=Object(C.useContext)(Fo);if(!e)throw new Error("useFileTreeCreateForm is only available inside FileTreeCreateFormProvider");return e};function No(e){var t=e.children,n=Mo(Object(C.useState)(!1),2),r=n[0],a=n[1];return Object(R.jsx)(Fo.Provider,{value:{valid:r,setValid:a},children:t})}function Bo(e){var t=e.mode,n=e.icon,r=e.label,a=Dt(),l=a.newFileCreateMode,d=a.startCreatingFile;return Object(R.jsx)("li",{className:re()({active:l===t}),children:Object(R.jsxs)(Ir.a,{bsStyle:"link",block:!0,onClick:function(){d(t)},className:"modal-new-file-mode",children:[Object(R.jsx)(Pr.a,{type:n,fw:!0})," ",r]})})}function Uo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uo(Object(n),!0).forEach((function(t){zo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}No.propTypes={children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired},Bo.propTypes={mode:k.a.string.isRequired,icon:k.a.string.isRequired,label:k.a.string.isRequired};var Ko=Object(C.createContext)(),Go=function(){var e=Object(C.useContext)(Ko);if(!e)throw new Error("useFileTreeCreateName is only available inside FileTreeCreateNameProvider");return e};function Yo(e){var t=e.children,n=e.initialName,r=void 0===n?"":n,a=Vo(Object(C.useReducer)((function(e,t){return{name:t,touchedName:!0}}),{name:r,touchedName:!1}),2),l=a[0],d=a[1],h=Object(C.useMemo)((function(){return Z(l.name.trim())}),[l]);return Object(R.jsx)(Ko.Provider,{value:Ho(Ho({},l),{},{setName:d,validName:h}),children:t})}Yo.propTypes={children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]).isRequired,initialName:k.a.string};var Xo=n(1028),Jo=n(1025),Qo=n(1026),Zo=n(1030),ea=n(102);function ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return na(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return na(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ra=n(614),ia=n.n(ra),oa=n(613),aa=n.n(oa);function sa(e){var t=e.label,n=e.focusName,r=void 0!==n&&n,a=e.classes,l=void 0===a?{}:a,d=e.placeholder,h=e.error,p=Object(Mt.a)().t,f=Go(),y=f.name,w=f.setName,x=f.touchedName,j=f.validName,O=Object(C.useCallback)((function(e){e&&r&&window.requestAnimationFrame((function(){e.focus(),e.setSelectionRange(0,e.value.lastIndexOf("."))}))}),[r]);return Object(R.jsxs)(aa.a,{controlId:"new-doc-name",className:l.formGroup,children:[Object(R.jsx)(ia.a,{children:t||p("file_name")}),Object(R.jsx)(Zo.a,{type:"text",placeholder:d||p("file_name"),required:!0,value:y,onChange:function(e){return w(e.target.value)},inputRef:O}),Object(R.jsx)(Zo.a.Feedback,{}),x&&!j&&Object(R.jsx)(Xo.a,{bsStyle:"danger",className:"row-spaced-small",children:Object(R.jsx)(_i.a,{i18nKey:"files_cannot_include_invalid_characters"})}),h&&Object(R.jsx)(la,{error:h})]})}function la(e){switch(e.error.constructor){case ut:return Object(R.jsx)(Xo.a,{bsStyle:"danger",className:"row-spaced-small",children:Object(R.jsx)(_i.a,{i18nKey:"file_already_exists"})});case lt:return Object(R.jsx)(Xo.a,{bsStyle:"danger",className:"row-spaced-small",children:Object(R.jsx)(_i.a,{i18nKey:"files_cannot_include_invalid_characters"})});case ct:return Object(R.jsx)(Xo.a,{bsStyle:"danger",className:"row-spaced-small",children:Object(R.jsx)(_i.a,{i18nKey:"blocked_filename"})});default:return null}}function ca(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ua(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ua(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function da(){var e=Object(A.c)(ha)._id,t=ca(Object(C.useState)(10),2),n=t[0],r=t[1];return Object(C.useEffect)((function(){r(10);var t=window.setInterval((function(){r((function(n){return 0===n?(window.clearInterval(t),window.location.assign("/login?redir=/project/".concat(e)),0):n-1}))}),1e3);return function(){window.clearInterval(t)}}),[e]),Object(R.jsx)(_i.a,{i18nKey:"session_expired_redirecting_to_login",values:{seconds:n}})}sa.propTypes={focusName:k.a.bool,label:k.a.string,classes:k.a.shape({formGroup:k.a.string}),placeholder:k.a.string,error:k.a.oneOfType([k.a.object,k.a.string])},la.propTypes={error:k.a.oneOfType([k.a.object,k.a.string]).isRequired};var ha={_id:k.a.string.isRequired};function pa(e){var t=e.children;return Object(R.jsx)(Xo.a,{bsStyle:"danger",children:t})}function fa(e){var t,n=e.error,r=Object(Mt.a)().t;if("string"==typeof n)switch(n){case"name-exists":return Object(R.jsx)(pa,{children:r("file_already_exists")});case"too-many-files":return Object(R.jsx)(pa,{children:r("project_has_too_many_files")});case"remote-service-error":return Object(R.jsx)(pa,{children:r("remote_service_error")});case"invalid_filename":return Object(R.jsx)(pa,{children:Object(R.jsx)(_i.a,{i18nKey:"invalid_filename",values:{nameLimit:150}})});case"rate-limit-hit":return Object(R.jsx)(pa,{children:r("too_many_files_uploaded_throttled_short_period")});case"not-logged-in":return Object(R.jsx)(pa,{children:Object(R.jsx)(da,{})});case"linked-project-compile-error":return Object(R.jsx)(pa,{children:r("generic_linked_file_compile_error")});default:return Object(R.jsx)(pa,{children:r("generic_something_went_wrong")})}switch(n.constructor){case B.a:var a,l=null===(a=n.data)||void 0===a?void 0:a.message;if(l)return Object(R.jsx)(pa,{children:l.text||l});switch(null===(t=n.response)||void 0===t?void 0:t.status){case 400:return Object(R.jsx)(pa,{children:r("invalid_request")});case 403:return Object(R.jsx)(pa,{children:r("session_error")});case 429:return Object(R.jsx)(pa,{children:r("too_many_attempts")});default:return Object(R.jsx)(pa,{children:r("something_went_wrong_server")})}case ut:case lt:case ct:return null;default:return Object(R.jsx)(pa,{children:r("generic_something_went_wrong")})}}pa.propTypes={children:k.a.any.isRequired},fa.propTypes={error:k.a.oneOfType([k.a.string,k.a.object]).isRequired};var ma=n(132);function va(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ba(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ya(e){var t=e.provider,n=e.providerName,r=e.supportsGroups,a=void 0!==r&&r,l=e.supportsFormat,d=void 0!==l&&l,h=Object(Mt.a)().t,p=Go(),f=p.name,y=p.validName,w=qo().setValid,x=Object(A.c)(wa).features,j=M(),O=j.refProviders,S=j.setStartedFreeTrial,_=j.setRefProviderEnabled,k=Dt().inFlight,E=M().reindexReferences,T=va(Object(C.useState)(),2),I=T[0],P=T[1],D=va(Object(C.useState)("bibtex"),2),L=D[0],F=D[1],q=x.references||x[t],N=q&&O[t],U=Object(C.useCallback)((function(){var e=window.open("/".concat(t,"/oauth"),"reference-auth","width=700,height=500"),n=window.setInterval((function(){var r;"/user/settings"===((null==e||null===(r=e.location)||void 0===r?void 0:r.pathname)||null)&&(e.close(),_(t),window.clearInterval(n))}),1e3)}),[t,_]),H=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(C.useState)(!1),r=ta(n,2),a=r[0],l=r[1],d=Object(C.useState)(null),h=ta(d,2),p=h[0],f=h[1],y=Object(C.useState)(!1),w=ta(y,2),x=w[0],j=w[1],O=Object(ea.a)(),S=O.signal;return Object(C.useEffect)((function(){t&&(l(!0),j(!1),f(null),Object(B.c)("/".concat(e,"/groups"),{signal:S}).then((function(e){f(e.groups)})).catch((function(e){j(e)})).finally((function(){l(!1)})))}),[t,e,S]),{loading:a,data:p,error:x}}(t,a&&N),z=Dt(),V=z.error,W=z.finishCreatingLinkedFile;Object(C.useEffect)((function(){w(y&&N)}),[w,y,N]);var K=Object(C.useCallback)((function(e){e.preventDefault();var n={};I&&(n.group_id=I),d&&(n.format=L),W({name:f,provider:t,data:n}).then(E)}),[f,I,t,W,L,E,d]);return q?Object(R.jsxs)("div",{className:"referencesImportModal",children:[N?Object(R.jsxs)("div",{children:[H.loading?Object(R.jsx)("div",{children:Object(R.jsx)("h2",{className:"text-center",children:Object(R.jsxs)("small",{children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:!0,fw:!0})," Loading…"]})})}):Object(R.jsxs)("div",{children:[Object(R.jsxs)("p",{children:["Import a BibTeX file from your ",n," account"]}),Object(R.jsxs)("form",{noValidate:!0,id:"create-file",onSubmit:K,children:[H.error&&Object(R.jsx)(ja,{provider:t,error:"loading_groups"}),H.data&&H.data.length>0&&Object(R.jsx)("div",{className:"row-spaced-small",children:Object(R.jsxs)(Jo.a,{controlId:"group-select",children:[Object(R.jsx)(Qo.a,{children:"Select a Group (optional)"}),Object(R.jsxs)(Zo.a,{className:"form-control",componentClass:"select",placeholder:"Select a Group (optional)",value:I||"",onChange:function(e){return P(e.target.value)},children:[Object(R.jsx)("option",{disabled:!0,value:"",children:"- Select a Group (optional)"}),H.data.map((function(e){return Object(R.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})}),Object(R.jsx)("div",{className:"row-spaced-small",children:Object(R.jsx)(sa,{label:h("file_name_in_this_project"),focusName:!0,error:V})}),d&&Object(R.jsx)("div",{className:"row-spaced-small",children:Object(R.jsxs)(Jo.a,{controlId:"format",children:[Object(R.jsx)(Qo.a,{children:"Format"}),Object(R.jsxs)(Zo.a,{className:"form-control",componentClass:"select",value:L,onChange:function(e){return F(e.target.value)},children:[Object(R.jsx)("option",{value:"bibtex",children:"BibTeX"}),Object(R.jsx)("option",{value:"biblatex",children:"BibLaTeX"})]})]})})]})]}),k&&Object(R.jsx)("h3",{className:"text-center",children:Object(R.jsxs)("small",{children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:!0,fw:!0})," Importing…"]})})]}):Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{children:xa[t].sync_description}),Object(R.jsx)("p",{children:Object(R.jsx)(Ir.a,{bsStyle:"info",type:"button",onClick:U,children:xa[t].link_to})})]}),V&&Object(R.jsx)(R.Fragment,{children:"string"==typeof V?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"text-center",children:[Object(R.jsx)("hr",{}),Object(R.jsx)(ja,{error:V,provider:t})]}),Object(R.jsx)(Oa,{error:V,provider:t,linkAccount:U})]}):Object(R.jsx)(fa,{error:V})})]}):Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{className:"small",children:xa[t].sync_description}),Object(R.jsxs)(Xo.a,{bsStyle:"info",children:[Object(R.jsx)("p",{children:xa[t].is_premium}),Object(R.jsx)("p",{children:Object(R.jsx)(ma.a,{source:t,buttonStyle:"info",setStartedFreeTrial:S})})]})]})}ya.propTypes={provider:k.a.string.isRequired,providerName:k.a.string.isRequired,supportsGroups:k.a.bool,supportsFormat:k.a.bool};var wa={features:k.a.shape({references:k.a.bool,mendeley:k.a.bool,zotero:k.a.bool})},xa={mendeley:{default:Object(R.jsx)(_i.a,{i18nKey:"mendeley_reference_loading_error"}),expired:Object(R.jsx)(_i.a,{i18nKey:"mendeley_reference_loading_error_expired"}),forbidden:Object(R.jsx)(_i.a,{i18nKey:"mendeley_reference_loading_error_forbidden"}),"refresh-failed":Object(R.jsx)(_i.a,{i18nKey:"mendeley_reference_loading_error_expired"}),sync_description:Object(R.jsx)(_i.a,{i18nKey:"mendeley_sync_description"}),link_to:Object(R.jsx)(_i.a,{i18nKey:"link_to_mendeley"}),is_premium:Object(R.jsx)(_i.a,{i18nKey:"mendeley_is_premium"}),loading_groups:Object(R.jsx)(_i.a,{i18nKey:"mendeley_groups_loading_error"})},zotero:{default:Object(R.jsx)(_i.a,{i18nKey:"zotero_reference_loading_error"}),expired:Object(R.jsx)(_i.a,{i18nKey:"zotero_reference_loading_error_expired"}),forbidden:Object(R.jsx)(_i.a,{i18nKey:"zotero_reference_loading_error_forbidden"}),"refresh-failed":Object(R.jsx)(_i.a,{i18nKey:"zotero_reference_loading_error_expired"}),sync_description:Object(R.jsx)(_i.a,{i18nKey:"zotero_sync_description"}),link_to:Object(R.jsx)(_i.a,{i18nKey:"link_to_zotero"}),is_premium:Object(R.jsx)(_i.a,{i18nKey:"zotero_is_premium"}),loading_groups:Object(R.jsx)(_i.a,{i18nKey:"zotero_groups_loading_error"})}};function ja(e){var t=e.provider,n=e.error;return n in xa[t]?Object(R.jsx)(pa,{children:xa[t][n]}):Object(R.jsx)(fa,{error:n})}function Oa(e){var t=e.error,n=e.provider,r=e.linkAccount,a=Object(Mt.a)().t;switch(t){case"refresh-failed":return Object(R.jsxs)("div",{children:[Object(R.jsx)("p",{children:xa[n].sync_description}),Object(R.jsx)("p",{children:Object(R.jsx)(Ir.a,{bsStyle:"info",type:"button",onClick:r,children:xa[n].link_to})})]});case"default":case"expired":case"forbidden":return Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{children:[a("reference_error_relink_hint"),"  "]}),Object(R.jsx)("div",{children:Object(R.jsx)("a",{href:"/user/settings",target:"_blank",rel:"noopener",style:{fontWeight:"bold"},children:a("account_settings")})})]})}}function Ca(){var e=Object(Mt.a)().t;return Object(R.jsx)(Bo,{mode:"mendeley",icon:"book",label:e("from_provider",{provider:"Mendeley"})})}function Sa(){return"mendeley"!==Dt().newFileCreateMode?null:Object(R.jsx)(Yo,{initialName:"references.bib",children:Object(R.jsx)(ya,{provider:"mendeley",providerName:"Mendeley",supportsGroups:!0})})}function _a(){var e=Object(Mt.a)().t;return Object(R.jsx)(Bo,{mode:"zotero",icon:"book",label:e("from_provider",{provider:"Zotero"})})}function ka(){return"zotero"!==Dt().newFileCreateMode?null:Object(R.jsx)(Yo,{initialName:"references.bib",children:Object(R.jsx)(ya,{provider:"zotero",providerName:"Zotero",supportsFormat:!0})})}function Ea(){var e=Go(),t=e.name,n=e.validName,r=qo().setValid,a=Dt(),l=a.error,d=a.finishCreatingDoc;Object(C.useEffect)((function(){r(n)}),[r,n]);var h=Object(C.useCallback)((function(e){e.preventDefault(),d({name:t})}),[d,t]);return Object(R.jsxs)("form",{noValidate:!0,id:"create-file",onSubmit:h,children:[Object(R.jsx)(sa,{focusName:!0,error:l}),l&&Object(R.jsx)(fa,{error:l})]})}function Aa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ta(){var e=Object(Mt.a)().t,t=Go(),n=t.name,r=t.setName,a=t.validName,l=qo().setValid,d=Dt(),h=d.finishCreatingLinkedFile,p=d.error,f=Aa(Object(C.useState)(""),2),y=f[0],w=f[1],x=Object(C.useCallback)((function(e){w(e.target.value)}),[]);Object(C.useEffect)((function(){if(y){var e=y.match(/^\s*https?:\/\/.+\/([^/]+\.(\w+))\s*$/);r(e?e[1]:"")}}),[r,y]),Object(C.useEffect)((function(){l(a&&!!y)}),[l,a,y]);return Object(R.jsxs)("form",{className:"form-controls",id:"create-file",noValidate:!0,onSubmit:function(e){e.preventDefault(),h({name:n,provider:"url",data:{url:y.trim()}})},children:[Object(R.jsxs)(Jo.a,{controlId:"import-from-url",children:[Object(R.jsx)(Qo.a,{children:e("url_to_fetch_the_file_from")}),Object(R.jsx)(Zo.a,{type:"url",placeholder:"https://example.com/my-file.png",required:!0,value:y,onChange:x})]}),Object(R.jsx)(sa,{label:e("file_name_in_this_project"),placeholder:"my_file",error:p}),p&&Object(R.jsx)(fa,{error:p})]})}function Ra(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ia(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ia(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ja.propTypes={error:k.a.string.isRequired,provider:k.a.string.isRequired},Oa.propTypes={error:k.a.string.isRequired,provider:k.a.string.isRequired,linkAccount:k.a.func.isRequired};var Pa=function(e,t){return ni.compare(e.name,t.name)};function Da(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ma(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ma(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ma(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var La=function(e,t){return ni.compare(e.path,t.path)};function Fa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Na=function(e,t){return ni.compare(e.path,t.path)};function Ba(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ua(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ua(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ha(){var e=Object(Mt.a)().t,t=window.ExposedSettings,n=t.hasLinkedProjectFileFeature,r=t.hasLinkedProjectOutputFileFeature,a=n&&r,l=Go(),d=l.name,h=l.setName,p=l.validName,f=qo().setValid,y=Dt(),w=y.error,x=y.finishCreatingLinkedFile,j=Ba(Object(C.useState)(),2),O=j[0],S=j[1],_=Ba(Object(C.useState)(),2),k=_[0],E=_[1],A=Ba(Object(C.useState)(),2),T=A[0],I=A[1],P=Ba(Object(C.useState)(!n),2),D=P[0],M=P[1],L=Object(C.useCallback)((function(e){var t=e.split("/").pop();t&&h(t)}),[h]);Object(C.useEffect)((function(){T&&("output.pdf"===T.path&&O.name?h("".concat(O.name,".pdf")):L(T.path))}),[O,T,h,L]),Object(C.useEffect)((function(){k&&L(k.path)}),[k,L]),Object(C.useEffect)((function(){var e=Boolean(D?T:k);f(p&&e)}),[f,p,D,k,T]);return Object(R.jsxs)("form",{className:"form-controls",id:"create-file",onSubmit:function(e){e.preventDefault(),x(D?{name:d,provider:"project_output_file",data:{source_project_id:O._id,source_output_file_path:T.path,build_id:T.build}}:{name:d,provider:"project_file",data:{source_project_id:O._id,source_entity_path:k.path}})},children:[Object(R.jsx)(za,{selectedProject:O,setSelectedProject:S}),D?Object(R.jsx)(Wa,{selectedProjectId:null==O?void 0:O._id,selectedProjectOutputFile:T,setSelectedProjectOutputFile:I}):Object(R.jsx)(Ka,{selectedProjectId:null==O?void 0:O._id,selectedProjectEntity:k,setSelectedProjectEntity:E}),a&&Object(R.jsxs)("div",{className:"toggle-file-type-button",children:["or ",Object(R.jsx)(Ir.a,{bsStyle:"link",type:"button",onClick:function(){return M((function(e){return!e}))},children:Object(R.jsx)("span",{children:e(D?"select_from_source_files":"select_from_output_files")})})]}),Object(R.jsx)(sa,{label:e("file_name_in_this_project"),classes:{formGroup:"form-controls row-spaced-small"},placeholder:"example.tex",error:w}),w&&Object(R.jsx)(fa,{error:w})]})}function za(e){var t=e.selectedProject,n=e.setSelectedProject,r=Object(Mt.a)().t,a=Object(A.c)(Va)._id,l=function(){var e=Ra(Object(C.useState)(!0),2),t=e[0],n=e[1],r=Ra(Object(C.useState)(null),2),a=r[0],l=r[1],d=Ra(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Object(ea.a)().signal;return Object(C.useEffect)((function(){Object(B.c)("/user/projects",{signal:f}).then((function(e){l(e.projects.sort(Pa))})).catch((function(e){return p(e)})).finally((function(){return n(!1)}))}),[f]),{loading:t,data:a,error:h}}(),d=l.data,h=l.error,p=l.loading,f=Object(C.useMemo)((function(){return d?d.filter((function(e){return e._id!==a})):null}),[d,a]);return h?Object(R.jsx)(fa,{error:h}):Object(R.jsxs)(Jo.a,{className:"form-controls",controlId:"project-select",children:[Object(R.jsx)(Qo.a,{children:r("select_a_project")}),p&&Object(R.jsxs)("span",{children:[" ",Object(R.jsx)(Pr.a,{type:"spinner",spin:!0})]}),Object(R.jsxs)(Zo.a,{componentClass:"select",disabled:!d,value:t?t._id:"",onChange:function(e){var t=e.target.value,r=d.find((function(e){return e._id===t}));n(r)},children:[Object(R.jsxs)("option",{disabled:!0,value:"",children:["- ",r("please_select_a_project")]}),f&&f.map((function(e){return Object(R.jsx)("option",{value:e._id,children:e.name},e._id)}))]}),f&&!f.length&&Object(R.jsx)("small",{children:r("no_other_projects_found")})]})}za.propTypes={selectedProject:k.a.object,setSelectedProject:k.a.func.isRequired};var Va={_id:k.a.string.isRequired};function Wa(e){var t=e.selectedProjectId,n=e.selectedProjectOutputFile,r=e.setSelectedProjectOutputFile,a=Object(Mt.a)().t,l=function(e){var t=Fa(Object(C.useState)(!1),2),n=t[0],r=t[1],a=Fa(Object(C.useState)(null),2),l=a[0],d=a[1],h=Fa(Object(C.useState)(!1),2),p=h[0],f=h[1],y=Object(ea.a)().signal;return Object(C.useEffect)((function(){e&&(r(!0),f(!1),d(null),Object(B.d)("/project/".concat(e,"/compile"),{body:{check:"silent",draft:!1,incrementalCompilesEnabled:!1},signal:y}).then((function(e){if("success"===e.status){var t=e.outputFiles.filter((function(e){return e.path.match(/.*\.(pdf|png|jpeg|jpg|gif)/)}));d(t.sort(Na))}else f("linked-project-compile-error")})).catch((function(e){return f(e)})).finally((function(){return r(!1)})))}),[e,y]),{loading:n,data:l,error:p}}(t),d=l.data,h=l.error,p=l.loading;return h?Object(R.jsx)(fa,{error:h}):Object(R.jsxs)(Jo.a,{className:"form-controls row-spaced-small",controlId:"project-output-file-select",children:[Object(R.jsx)(Qo.a,{children:a("select_an_output_file")}),p&&Object(R.jsxs)("span",{children:[" ",Object(R.jsx)(Pr.a,{type:"spinner",spin:!0})]}),Object(R.jsxs)(Zo.a,{componentClass:"select",disabled:!d,value:(null==n?void 0:n.path)||"",onChange:function(e){var t=e.target.value,n=d.find((function(e){return e.path===t}));r(n)},children:[Object(R.jsxs)("option",{disabled:!0,value:"",children:["- ",a("please_select_an_output_file")]}),d&&d.map((function(e){return Object(R.jsx)("option",{value:e.path,children:e.path},e.path)}))]})]})}function Ka(e){var t=e.selectedProjectId,n=e.selectedProjectEntity,r=e.setSelectedProjectEntity,a=Object(Mt.a)().t,l=function(e){var t=Da(Object(C.useState)(!1),2),n=t[0],r=t[1],a=Da(Object(C.useState)(null),2),l=a[0],d=a[1],h=Da(Object(C.useState)(!1),2),p=h[0],f=h[1],y=Object(ea.a)().signal;return Object(C.useEffect)((function(){e&&(r(!0),f(!1),d(null),Object(B.c)("/project/".concat(e,"/entities"),{signal:y}).then((function(e){d(e.entities.sort(La))})).catch((function(e){return f(e)})).finally((function(){return r(!1)})))}),[e,y]),{loading:n,data:l,error:p}}(t),d=l.data,h=l.error,p=l.loading;return h?Object(R.jsx)(fa,{error:h}):Object(R.jsxs)(Jo.a,{className:"form-controls row-spaced-small",controlId:"project-entity-select",children:[Object(R.jsx)(Qo.a,{children:a("select_a_file")}),p&&Object(R.jsxs)("span",{children:[" ",Object(R.jsx)(Pr.a,{type:"spinner",spin:!0})]}),Object(R.jsxs)(Zo.a,{componentClass:"select",disabled:!d,value:(null==n?void 0:n.path)||"",onChange:function(e){var t=e.target.value,n=d.find((function(e){return e.path===t}));r(n)},children:[Object(R.jsxs)("option",{disabled:!0,value:"",children:["- ",a("please_select_a_file")]}),d&&d.map((function(e){return Object(R.jsx)("option",{value:e.path,children:e.path.slice(1)},e.path)}))]})]})}Wa.propTypes={selectedProjectId:k.a.string,selectedProjectOutputFile:k.a.object,setSelectedProjectOutputFile:k.a.func.isRequired},Ka.propTypes={selectedProjectId:k.a.string,selectedProjectEntity:k.a.object,setSelectedProjectEntity:k.a.func.isRequired};n(623);var Ga=n(145),Ya=n.n(Ga),Xa=n(615),Ja=n.n(Xa),Qa=n(569),Za=n.n(Qa),es=(n(582),n(583),n(584),n(585),n(586),n(587)),ts=n.n(es);n(923),n(924);function ns(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function is(){var e=Dt(),t=e.parentFolderId,n=e.cancel,r=e.isDuplicate,a=Object(A.c)(os)._id,l=ns(Object(C.useState)(),2),d=l[0],h=l[1],p=ns(Object(C.useState)([]),2),f=p[0],y=p[1],w=ns(Object(C.useState)(!1),2),x=w[0],j=w[1],O=window.ExposedSettings.maxUploadSize,S=ts()((function(){var e="/project/".concat(a,"/upload");return t&&(e+="?folder_id=".concat(t)),new Ya.a({allowMultipleUploads:!1,restrictions:{maxNumberOfFiles:40,maxFileSize:O||null},onBeforeUpload:function(e){var n=!0;return j((function(a){return a||y((function(){var a=function(e){return Object.values(e).filter((function(e){return r(t,e.meta.name)}))}(e);return n=0===a.length,a})),a})),n},autoProceed:!0}).use(Ja.a,{endpoint:e,headers:{"X-CSRF-TOKEN":window.csrfToken},limit:1,fieldName:"qqfile"}).on("complete",(function(e){e.failed.length||n()})).on("upload-success",(function(e,t){"doc"===t.body.entity_type&&window.setTimeout((function(){!function(e,t){Object(B.d)("/project/".concat(e,"/doc/").concat(t,"/metadata"))}(a,t.body.entity_id)}),250)})).on("upload-error",(function(e,t,n){switch(null==n?void 0:n.status){case 429:h("rate-limit-hit");break;case 403:h("not-logged-in");break;default:h(n.body.error)}}))})),_=Object(C.useCallback)((function(){j(!0),window.setTimeout((function(){S.upload()}),10)}),[S]),k=!x&&f.length>0;return Object(R.jsxs)(R.Fragment,{children:[d&&Object(R.jsx)(as,{error:d,maxNumberOfFiles:40}),k?Object(R.jsx)(ss,{cancel:n,conflicts:f,handleOverwrite:_}):Object(R.jsx)(Za.a,{uppy:S,showProgressDetails:!0,height:400,width:"100%",showLinkToFileUploadResult:!1,proudlyDisplayPoweredByUppy:!1,locale:{strings:{dropPasteFiles:"Drag here or %{browseFiles}",browseFiles:"select from your computer"}}})]})}var os={_id:k.a.string.isRequired};function as(e){var t=e.error,n=e.maxNumberOfFiles;switch(t){case"too-many-files":return Object(R.jsx)(_i.a,{i18nKey:"maximum_files_uploaded_together",values:{max:n}});default:return Object(R.jsx)(fa,{error:t})}}function ss(e){var t=e.cancel,n=e.conflicts,r=e.handleOverwrite;return Object(R.jsxs)(Xo.a,{bsStyle:"warning",className:"small",children:[Object(R.jsx)("p",{className:"text-center",children:"The following files already exist in this project:"}),Object(R.jsx)("ul",{className:"text-center list-unstyled row-spaced-small",children:n.map((function(e,t){return Object(R.jsx)("li",{children:Object(R.jsx)("strong",{children:e.meta.name})},t)}))}),Object(R.jsx)("p",{className:"text-center row-spaced-small",children:"Do you want to overwrite them?"}),Object(R.jsxs)("p",{className:"text-center",children:[Object(R.jsx)(Ir.a,{bsStyle:"primary",onClick:r,children:"Overwrite"})," ",Object(R.jsx)(Ir.a,{bsStyle:"primary",onClick:t,children:"Cancel"})]})]})}as.propTypes={error:k.a.string.isRequired,maxNumberOfFiles:k.a.number.isRequired},ss.propTypes={cancel:k.a.func.isRequired,conflicts:k.a.array.isRequired,handleOverwrite:k.a.func.isRequired};var ls=[{import:a,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/create-file-mode-mendeley.js"},{import:l,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/create-file-mode-zotero.js"}];function cs(){var e=Object(Mt.a)().t,t=Dt().newFileCreateMode,n=Object(T.b)().fileCount;return n&&"error"!==n.status?Object(R.jsx)("table",{children:Object(R.jsx)("tbody",{children:Object(R.jsxs)("tr",{children:[Object(R.jsx)("td",{className:"modal-new-file--list",children:Object(R.jsxs)("ul",{className:"list-unstyled",children:[Object(R.jsx)(Bo,{mode:"doc",icon:"file",label:e("new_file")}),Object(R.jsx)(Bo,{mode:"upload",icon:"upload",label:e("upload")}),(window.ExposedSettings.hasLinkedProjectFileFeature||window.ExposedSettings.hasLinkedProjectOutputFileFeature)&&Object(R.jsx)(Bo,{mode:"project",icon:"folder-open",label:e("from_another_project")}),window.ExposedSettings.hasLinkUrlFeature&&Object(R.jsx)(Bo,{mode:"url",icon:"globe",label:e("from_external_url")}),ls.map((function(e){var t=e.import.CreateFileMode,n=e.path;return Object(R.jsx)(t,{},n)}))]})}),Object(R.jsxs)("td",{className:"modal-new-file--body modal-new-file--body-".concat(t),children:["doc"===t&&Object(R.jsx)(Yo,{initialName:"name.tex",children:Object(R.jsx)(Ea,{})}),"url"===t&&Object(R.jsx)(Yo,{children:Object(R.jsx)(Ta,{})}),"project"===t&&Object(R.jsx)(Yo,{children:Object(R.jsx)(Ha,{})}),"upload"===t&&Object(R.jsx)(is,{}),ls.map((function(e){var t=e.import.CreateFilePane,n=e.path;return Object(R.jsx)(t,{},n)}))]})]})})}):null}function us(){var e=qo().valid,t=Dt(),n=t.newFileCreateMode,r=t.inFlight,a=t.cancel,l=Object(T.b)().fileCount;return Object(R.jsx)(ds,{valid:e,cancel:a,newFileCreateMode:n,inFlight:r,fileCount:l})}function ds(e){var t=e.valid,n=e.fileCount,r=e.inFlight,a=e.newFileCreateMode,l=e.cancel,d=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:["warning"===n.status&&Object(R.jsxs)("div",{className:"modal-footer-left approaching-file-limit",children:[d("project_approaching_file_limit")," (",n.value,"/",n.limit,")"]}),"error"===n.status&&Object(R.jsx)(Xo.a,{bsStyle:"warning",className:"at-file-limit",children:d("project_has_too_many_files")}),Object(R.jsx)(Ir.a,{bsStyle:"default",type:"button",disabled:r,onClick:l,children:d("cancel")}),"upload"!==a&&Object(R.jsx)(Ir.a,{bsStyle:"primary",type:"submit",form:"create-file",disabled:r||!t,children:Object(R.jsx)("span",{children:r?"".concat(d("creating"),"…"):d("create")})})]})}function hs(){var e=Object(Mt.a)().t,t=Dt(),n=t.isCreatingFile,r=t.cancel;return n?Object(R.jsx)(No,{children:Object(R.jsxs)(wi.a,{bsSize:"large",onHide:r,show:!0,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:e("add_files")})}),Object(R.jsx)(yi.a.Body,{className:"modal-new-file",children:Object(R.jsx)(cs,{})}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(us,{})})]})}):null}ds.propTypes={cancel:k.a.func.isRequired,fileCount:k.a.shape({limit:k.a.number.isRequired,status:k.a.string.isRequired,value:k.a.number.isRequired}).isRequired,inFlight:k.a.bool.isRequired,newFileCreateMode:k.a.string,valid:k.a.bool.isRequired};var ps=S.a.memo((function(e){var t=e.refProviders,n=e.reindexReferences,r=e.setRefProviderEnabled,a=e.setStartedFreeTrial,l=e.onSelect,d=e.onInit,h=e.isConnected,p=Object(A.c)(ms)._id,f=Object(T.b)().fileTreeData,y=p&&f;return Object(C.useEffect)((function(){y&&d()}),[y,d]),y?Object(R.jsxs)(fr,{refProviders:t,setRefProviderEnabled:r,setStartedFreeTrial:a,reindexReferences:n,onSelect:l,children:[h?null:Object(R.jsx)("div",{className:"disconnected-overlay"}),Object(R.jsx)(bi,{}),Object(R.jsx)(To,{}),Object(R.jsx)("div",{className:"file-tree-inner",children:Object(R.jsx)(fs,{})}),Object(R.jsx)(xi,{}),Object(R.jsx)(hs,{}),Object(R.jsx)(Si,{}),Object(R.jsx)(ki,{})]}):null}));function fs(){!function(){var e=Object(Io.b)({id:k.a.string.isRequired}),t=Object(T.b)(),n=t.dispatchRename,r=t.dispatchDelete,a=t.dispatchMove,l=t.dispatchCreateFolder,d=t.dispatchCreateDoc,h=t.dispatchCreateFile,p=t.fileTreeData,f=Ye(),y=f.selectedEntityIds,w=f.selectedEntityParentIds,x=f.select,j=f.unselect,O=window._ide&&window._ide.socket,S=Object(C.useCallback)((function(t,n,r){r&&(null==e?void 0:e.id)===r&&window.expectingLinkedFileRefreshedSocketFor===n&&(x(t),window.expectingLinkedFileRefreshedSocketFor=null)}),[e,x]);Object(C.useEffect)((function(){function e(e,t){n(e,t)}return O&&O.on("reciveEntityRename",e),function(){O&&O.removeListener("reciveEntityRename",e)}}),[O,n]),Object(C.useEffect)((function(){function e(e){if(j(e),w.has(e)){var t,n=Po(y);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object(G.d)(p,a).path.includes(e)&&j(a)}}catch(e){n.e(e)}finally{n.f()}}r(e)}return O&&O.on("removeEntity",e),function(){O&&O.removeListener("removeEntity",e)}}),[O,j,r,p,y,w]),Object(C.useEffect)((function(){function e(e,t){a(e,t)}return O&&O.on("reciveEntityMove",e),function(){O&&O.removeListener("reciveEntityMove",e)}}),[O,a]),Object(C.useEffect)((function(){function e(e,t,n){l(e,t)}return O&&O.on("reciveNewFolder",e),function(){O&&O.removeListener("reciveNewFolder",e)}}),[O,l]),Object(C.useEffect)((function(){function e(e,t,n,r){d(e,t)}return O&&O.on("reciveNewDoc",e),function(){O&&O.removeListener("reciveNewDoc",e)}}),[O,d]),Object(C.useEffect)((function(){function e(e,t,n,r,a){h(e,t),r&&S(t._id,t.name,a)}return O&&O.on("reciveNewFile",e),function(){O&&O.removeListener("reciveNewFile",e)}}),[O,h,S])}();var e=Object(T.b)().fileTreeData,t=hr(e._id),n=t.isOver,r=t.dropRef;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(wr,{isOver:n}),Object(R.jsx)(ui,{folders:e.folders,docs:e.docs,files:e.fileRefs,classes:{root:"file-tree-list"},dropRef:r,isOver:n,children:Object(R.jsx)("li",{className:"bottom-buffer"})})]})}ps.propTypes={onSelect:k.a.func.isRequired,onInit:k.a.func.isRequired,isConnected:k.a.bool.isRequired,setRefProviderEnabled:k.a.func.isRequired,setStartedFreeTrial:k.a.func.isRequired,reindexReferences:k.a.func.isRequired,refProviders:k.a.object.isRequired};var gs,ms={_id:k.a.string.isRequired},vs=Object(E.a)(ps,Ro),bs=new Uint8Array(16);function ys(){if(!gs&&!(gs="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gs(bs)}var ws=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var xs=function(e){return"string"==typeof e&&ws.test(e)},js=[],Os=0;Os<256;++Os)js.push((Os+256).toString(16).substr(1));var Cs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(js[e[t+0]]+js[e[t+1]]+js[e[t+2]]+js[e[t+3]]+"-"+js[e[t+4]]+js[e[t+5]]+"-"+js[e[t+6]]+js[e[t+7]]+"-"+js[e[t+8]]+js[e[t+9]]+"-"+js[e[t+10]]+js[e[t+11]]+js[e[t+12]]+js[e[t+13]]+js[e[t+14]]+js[e[t+15]]).toLowerCase();if(!xs(n))throw TypeError("Stringified UUID is invalid");return n};var Ss=function(e,t,n){var r=(e=e||{}).random||(e.rng||ys)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return Cs(r)},_s=function(e){var t;void 0===e&&(e=C.Fragment);return{component:function(n){var r=Object(C.useState)([]),a=r[0],l=r[1];return Object(C.useEffect)((function(){t=function(e){return l((function(t){return t.push(e),[].concat(t)})),{update:function(t){l((function(n){var r=n.find((function(t){return(null==t?void 0:t.key)===e.key}));return r?(r.props=t,[].concat(n)):n}))},remove:function(){l((function(t){var n=t.findIndex((function(t){return(null==t?void 0:t.key)===e.key}));return-1===n?t:(t[n]=void 0,[].concat(t))}))}}}}),[]),S.a.createElement(e,Object.assign({},n),a.map((function(e){if(!e)return null;var t=e.key,n=e.node,r=e.component,a=e.props;return Object(Tr.createPortal)(S.a.createElement(r,Object.assign({key:t},a)),n)})))},use:function(e){return function(n){var r=Object(C.useRef)(Ss()),a=Object(C.useRef)(null),l=Object(C.useRef)();return Object(C.useEffect)((function(){l.current&&l.current.update(n)}),[n]),Object(C.useEffect)((function(){if(a.current&&a.current.parentElement)return l.current=t({key:r.current,node:a.current.parentElement,component:e,props:n}),l.current.remove}),[]),S.a.createElement("div",{ref:a,style:{display:"none"}})}}}},ks=n(71),Es=n(223);function As(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?As(Object(n),!0).forEach((function(t){Ts(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):As(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ts(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rs(e,t){var n=e[e.length-1];return n&&t&&t.user&&t.user.id&&t.user.id===n.user.id&&t.timestamp-n.timestamp<3e5?e.slice(0,e.length-1).concat($s($s({},n),{},{id:t.id,timestamp:t.timestamp,contents:n.contents.concat(t.content)})):e.slice(0).concat({id:t.id,user:t.user,timestamp:t.timestamp,contents:[t.content]})}var Is=n(362);function Ps(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ds(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ds(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ds(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ms(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ls(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ms(Object(n),!0).forEach((function(t){Fs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ms(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qs=Object(Es.v4)();function Ns(e,t){switch(t.type){case"INITIAL_FETCH_MESSAGES":return Ls(Ls({},e),{},{status:"pending",initialMessagesLoaded:!0});case"FETCH_MESSAGES":return Ls(Ls({},e),{},{status:"pending"});case"FETCH_MESSAGES_SUCCESS":return Ls(Ls({},e),{},{status:"idle",messages:(n=e.messages,r=t.messages,a=n.slice(0),r.slice(0).reverse().forEach((function(e){var t=a[0];t&&e&&e.user&&e.user.id===t.user.id&&t.timestamp-e.timestamp<3e5?(t.id=e.id,t.timestamp=e.timestamp,t.contents=[e.content].concat(t.contents)):a.unshift({id:e.id,user:e.user,timestamp:e.timestamp,contents:[e.content]})})),a),lastTimestamp:t.messages[0]?t.messages[0].timestamp:null,atEnd:t.messages.length<50});case"SEND_MESSAGE":return Ls(Ls({},e),{},{messages:Rs(e.messages,{id:Object(Es.v4)(),user:t.user,content:t.content,timestamp:Date.now()})});case"RECEIVE_MESSAGE":return Ls(Ls({},e),{},{messages:Rs(e.messages,t.message),unreadMessageCount:e.unreadMessageCount+1});case"MARK_MESSAGES_AS_READ":return Ls(Ls({},e),{},{unreadMessageCount:0});case"CLEAR":return Ls({},Bs);case"ERROR":return Ls(Ls({},e),{},{status:"error",error:t.error});default:throw new Error("Unknown action")}var n,r,a}var Bs={status:"idle",messages:[],initialMessagesLoaded:!1,lastTimestamp:null,atEnd:!1,unreadMessageCount:0,error:null},Us=Object(C.createContext)();function Hs(e){var t,n=e.children,r=Object(Io.b)({id:k.a.string.isRequired}),a=Object(A.c)({_id:k.a.string.isRequired})._id,l=Pe({chatIsOpen:k.a.bool}).chatIsOpen,d=Object(Is.a)(),h=d.hasFocus,p=d.flashTitle,f=d.stopFlashingTitle,y=Ps(Object(C.useReducer)(Ns,Bs),2),w=y[0],x=y[1],j=Object(C.useMemo)((function(){function e(){if(!w.atEnd){var e={limit:50};w.lastTimestamp&&(e.before=w.lastTimestamp);var t=new URLSearchParams(e),n="/project/".concat(a,"/messages?").concat(t.toString());Object(B.c)(n).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];x({type:"FETCH_MESSAGES_SUCCESS",messages:e.reverse()})})).catch((function(e){x({type:"ERROR",error:e})}))}}return{loadInitialMessages:function(){w.initialMessagesLoaded||(x({type:"INITIAL_FETCH_MESSAGES"}),e())},loadMoreMessages:function(){x({type:"FETCH_MESSAGES"}),e()},reset:function(){x({type:"CLEAR"}),e()}}}),[a,w.atEnd,w.initialMessagesLoaded,w.lastTimestamp]),O=j.loadInitialMessages,S=j.loadMoreMessages,_=j.reset,E=Object(C.useCallback)((function(e){if(e){x({type:"SEND_MESSAGE",user:r,content:e});var t="/project/".concat(a,"/messages");Object(B.d)(t,{body:{content:e,client_id:qs}}).catch((function(e){x({type:"ERROR",error:e})}))}}),[a,r]),T=Object(C.useCallback)((function(){x({type:"MARK_MESSAGES_AS_READ"})}),[]),I=null===(t=window._ide)||void 0===t?void 0:t.socket;Object(C.useEffect)((function(){if(I)return I.on("new-chat-message",e),function(){I&&I.removeListener("new-chat-message",e)};function e(e){e.clientId!==qs&&(x({type:"RECEIVE_MESSAGE",message:e}),window.dispatchEvent(new CustomEvent("Chat.MessageReceived",{detail:{message:e}})))}}),[I]),Object(C.useEffect)((function(){h&&(f(),l&&T()),!h&&w.unreadMessageCount>0&&p("New Message")}),[h,l,w.unreadMessageCount,p,f,T]);var P=Object(C.useMemo)((function(){return{status:w.status,messages:w.messages,initialMessagesLoaded:w.initialMessagesLoaded,atEnd:w.atEnd,unreadMessageCount:w.unreadMessageCount,loadInitialMessages:O,loadMoreMessages:S,reset:_,sendMessage:E,markMessagesAsRead:T,error:w.error}}),[O,S,T,_,E,w.atEnd,w.error,w.initialMessagesLoaded,w.messages,w.status,w.unreadMessageCount]);return Object(R.jsx)(Us.Provider,{value:P,children:n})}function zs(e){var t=Object(C.useContext)(Us);return k.a.checkPropTypes(e,t,"data","ChatContext.Provider"),t}Us.Provider.propTypes={value:k.a.shape({status:k.a.string.isRequired,messages:k.a.array.isRequired,initialMessagesLoaded:k.a.bool.isRequired,atEnd:k.a.bool.isRequired,unreadMessageCount:k.a.number.isRequired,loadInitialMessages:k.a.func.isRequired,loadMoreMessages:k.a.func.isRequired,sendMessage:k.a.func.isRequired,markMessagesAsRead:k.a.func.isRequired,reset:k.a.func.isRequired,error:k.a.object}).isRequired},Hs.propTypes={children:k.a.any};var Vs=Object(C.createContext)();function Ws(e){var t=e.children,n=Object(C.useMemo)((function(){return{splitTestVariants:Object(le.a)("ol-splitTestVariants")||{}}}),[]);return Object(R.jsx)(Vs.Provider,{value:n,children:t})}function Ks(e){var t=Object(C.useContext)(Vs);return k.a.checkPropTypes(e,t,"data","SplitTestContext.Provider"),t}function Gs(e){var t=e.children,n=e.ide,r=e.settings;return Object(R.jsx)(Ws,{children:Object(R.jsx)(_e.a,{ide:n,children:Object(R.jsx)(Io.a,{children:Object(R.jsx)(A.a,{children:Object(R.jsx)(T.a,{children:Object(R.jsx)(te.a,{settings:r,children:Object(R.jsx)(ye,{children:Object(R.jsx)(Ie,{children:Object(R.jsx)(ks.a,{children:Object(R.jsx)(Hs,{children:t})})})})})})})})})})}Vs.Provider.propTypes={value:k.a.shape({splitTestVariants:k.a.object.isRequired})},Ws.propTypes={children:k.a.any},Gs.propTypes={children:k.a.any,ide:k.a.any.isRequired,settings:k.a.any.isRequired};var Ys=_s(Gs);function Xs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Js(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xs(Object(n),!0).forEach((function(t){Qs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}y.a.controller("ReactFileTreeController",["$scope","$timeout","ide",function(e,t,n){function r(){var t="ready"===e.connection.state,n="waitingCountdown"===e.connection.state&&null===e.connection.reconnection_countdown;e.isConnected=t||n}e.isConnected=!0,e.$on("project:joined",(function(){e.$emit("file-tree:initialized")})),e.$watch("editor.open_doc_id",(function(e){window.dispatchEvent(new CustomEvent("editor.openDoc",{detail:e}))})),e.$watch("connection.state",r),e.$watch("connection.reconnection_countdown",r),e.onInit=function(){t((function(){e.$emit("left-pane-resize-all")}))},e.onSelect=function(t){if(1===t.length){var n=t[0],r="fileRef"===n.type?"file":n.type;e.$emit("entity:selected",Js(Js({},n.entity),{},{id:n.entity._id,type:r})),e.$emit("entities:multiSelected",{count:0})}else t.length>1?e.$emit("entities:multiSelected",{count:t.length}):e.$emit("entity:no-selection")},e.refProviders=n.$scope.user.refProviders||{},n.$scope.$watch("user.refProviders",(function(t){e.refProviders=Object(j.cloneDeep)(t)}),!0),e.setRefProviderEnabled=function(e){n.$scope.$applyAsync((function(){n.$scope.user.refProviders[e]=!0}))},e.setStartedFreeTrial=function(t){e.$applyAsync((function(){e.startedFreeTrial=t}))},e.reindexReferences=function(){n.$scope.$emit("references:should-reindex",{})}}]),y.a.component("fileTreeRoot",Object(x.react2angular)(Ys.use(vs),Object.keys(vs.propTypes)));var el=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("project:joined",(function(){return r.loadRootFolder(),r.loadDeletedDocs(),r.$scope.$emit("file-tree:initialized")})),this.$scope.$on("entities:multiSelected",(function(e,t){r.$scope.$apply((function(){r.$scope.multiSelectedCount=t.count}))})),this.$scope.$watch("rootFolder",(function(e){if(null!=e)return r.recalculateDocList()})),this._bindToSocketEvents(),this.$scope.multiSelectedCount=0,$(document).on("click",(function(){return r.clearMultiSelectedEntities(),r.$scope.$digest()}))}var t,n,r;return t=e,(n=[{key:"_bindToSocketEvents",value:function(){var e=this;return this.ide.socket.on("reciveNewDoc",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"doc"}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFile",(function(t,n,r,a){var l=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return l.children.push({name:n.name,id:n._id,type:"file",linkedFileData:a,created:n.created}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFolder",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"folder",children:[]}),e.recalculateDocList()}))})),this.ide.socket.on("reciveEntityRename",(function(t,n){var r=e.findEntityById(t);if(null!=r)return e.$scope.$apply((function(){return r.name=n,e.recalculateDocList()}))})),this.ide.socket.on("removeEntity",(function(t){var n=e.findEntityById(t);if(null!=n)return e.$scope.$apply((function(){return e._deleteEntityFromScope(n),e.recalculateDocList()})),e.$scope.$broadcast("entity:deleted",n)})),this.ide.socket.on("reciveEntityMove",(function(t,n){var r=e.findEntityById(t),a=e.findEntityById(n);return e.$scope.$apply((function(){return e._moveEntityInScope(r,a),e.recalculateDocList()}))}))}},{key:"selectEntity",value:function(e){return this.selected_entity_id=e.id,this.ide.fileTreeManager.forEachEntity((function(e){return e.selected=!1})),e.selected=!0}},{key:"toggleMultiSelectEntity",value:function(e){return e.multiSelected=!e.multiSelected,this.$scope.multiSelectedCount=this.multiSelectedCount()}},{key:"multiSelectedCount",value:function(){var e=0;return this.forEachEntity((function(t){if(t.multiSelected)return e++})),e}},{key:"getMultiSelectedEntities",value:function(){var e=[];return this.forEachEntity((function(t){if(t.multiSelected)return e.push(t)})),e}},{key:"getFullCount",value:function(){var e=[];return this.forEachEntity((function(t){t.deleted||e.push(t)})),e.length}},{key:"getMultiSelectedEntityChildNodes",value:function(){for(var e=this.getMultiSelectedEntities(),t={},n=0,r=Array.from(e);n<r.length;n++){var a=r[n];t["/"+this.getEntityPath(a)]=a}var l={};for(var d in t){t[d];var h=d.split("/");if(!(h.length<=2))for(var p=1,f=h.length-1,y=f>=1;y?p<=f:p>=f;y?p++:p--)l["/"+h.slice(0,p).join("/")]=!0}var w=[];for(var x in t){var j=t[x];null==l[x]&&w.push(j)}return w}},{key:"clearMultiSelectedEntities",value:function(){if(0!==this.$scope.multiSelectedCount)return this.forEachEntity((function(e){return e.multiSelected=!1})),this.$scope.multiSelectedCount=0}},{key:"multiSelectSelectedEntity",value:function(){var e=this.findSelectedEntity();e&&(e.multiSelected=!0),this.$scope.multiSelectedCount=this.multiSelectedCount()}},{key:"existsInFolder",value:function(e,t){var n=this.findEntityById(e);return null!=n&&null!=this._findEntityByPathInFolder(n,t)}},{key:"findSelectedEntity",value:function(){var e=null;return this.forEachEntity((function(t){if(t.selected)return e=t})),e}},{key:"findEntityById",value:function(e,t){if(null==t&&(t={}),this.$scope.rootFolder.id===e)return this.$scope.rootFolder;var n=this._findEntityByIdInFolder(this.$scope.rootFolder,e);if(null!=n)return n;if(t.includeDeleted)for(var r=0,a=Array.from(this.$scope.deletedDocs);r<a.length;r++)if((n=a[r]).id===e)return n;return null}},{key:"_findEntityByIdInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var a=r[n];if(a.id===t)return a;if(null!=a.children){var l=this._findEntityByIdInFolder(a,t);if(null!=l)return l}}return null}},{key:"findEntityByPath",value:function(e){return this._findEntityByPathInFolder(this.$scope.rootFolder,e)}},{key:"_findEntityByPathInFolder",value:function(e,t){if(null==t||null==e)return null;if(""===t)return e;var n=t.split("/"),r=n.shift(),a=n.join("/");if("."===r)return this._findEntityByPathInFolder(e,a);for(var l=0,d=Array.from(e.children);l<d.length;l++){var h=d[l];if(h.name===r){if(""===a)return h;if("folder"===h.type)return this._findEntityByPathInFolder(h,a)}}return null}},{key:"forEachEntity",value:function(e){var t=this;return null==e&&(e=function(){}),this._forEachEntityInFolder(this.$scope.rootFolder,null,e),function(){for(var n=[],r=0,a=Array.from(t.$scope.deletedDocs||[]);r<a.length;r++){var l=a[r];n.push(e(l))}return n}()}},{key:"_forEachEntityInFolder",value:function(e,t,n){var r=this;return function(){for(var a=[],l=0,d=Array.from(e.children||[]);l<d.length;l++){var h=d[l],p=void 0;p=null!=t?t+"/"+h.name:h.name,n(h,e,p),null!=h.children?a.push(r._forEachEntityInFolder(h,p,n)):a.push(void 0)}return a}()}},{key:"getEntityPath",value:function(e){return this._getEntityPathInFolder(this.$scope.rootFolder,e)}},{key:"_getEntityPathInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var a=r[n];if(a===t)return t.name;if("folder"===a.type){var l=this._getEntityPathInFolder(a,t);if(null!=l)return a.name+"/"+l}}return null}},{key:"getRootDocDirname",value:function(){var e=this.findEntityById(this.$scope.project.rootDoc_id);if(null!=e)return this._getEntityDirname(e)}},{key:"_getEntityDirname",value:function(e){var t=this.getEntityPath(e);if(null!=t)return t.split("/").slice(0,-1).join("/")}},{key:"_findParentFolder",value:function(e){var t=this._getEntityDirname(e);if(null!=t)return this.findEntityByPath(t)}},{key:"loadRootFolder",value:function(){return this.$scope.rootFolder=this._parseFolder((e=null!=this.$scope?this.$scope.project:void 0,t=function(e){return e.rootFolder[0]},null!=e?t(e):void 0));var e,t}},{key:"_parseFolder",value:function(e){for(var t={name:e.name,id:e._id,type:"folder",children:[],selected:e._id===this.selected_entity_id},n=0,r=Array.from(e.docs||[]);n<r.length;n++){var a=r[n];t.children.push({name:a.name,id:a._id,type:"doc",selected:a._id===this.selected_entity_id})}for(var l=0,d=Array.from(e.fileRefs||[]);l<d.length;l++){var h=d[l];t.children.push({name:h.name,id:h._id,type:"file",selected:h._id===this.selected_entity_id,linkedFileData:h.linkedFileData,created:h.created})}for(var p=0,f=Array.from(e.folders||[]);p<f.length;p++){var y=f[p];t.children.push(this._parseFolder(y))}return t}},{key:"loadDeletedDocs",value:function(){var e=this;return this.$scope.deletedDocs=[],Array.from(this.$scope.project.deletedDocs||[]).map((function(t){return e.$scope.deletedDocs.push({name:t.name,id:t._id,type:"doc",deleted:!0})}))}},{key:"recalculateDocList",value:function(){var e=this;return this.$scope.docs=[],this.forEachEntity((function(t,n,r){if("doc"===t.type&&!t.deleted)return e.$scope.docs.push({doc:t,path:r})})),this.$scope.docs.sort((function(e,t){var n=(e.path.match(/\//g)||[]).length,r=(t.path.match(/\//g)||[]).length;return n-r!=0?-(n-r):e.path<t.path?-1:e.path>t.path?1:0}))}},{key:"getCurrentFolder",value:function(){return this._getCurrentFolder(this.$scope.rootFolder)||this.$scope.rootFolder}},{key:"_getCurrentFolder",value:function(e){null==e&&(e=this.$scope.rootFolder);for(var t=0,n=Array.from(e.children||[]);t<n.length;t++){var r=n[t];if(r.selected)return"folder"===r.type?r:e;if("folder"===r.type){var a=this._getCurrentFolder(r);if(null!=a)return a}}return null}},{key:"projectContainsFolder",value:function(){for(var e=0,t=Array.from(this.$scope.rootFolder.children);e<t.length;e++)if("folder"===t[e].type)return!0;return!1}},{key:"existsInThisFolder",value:function(e,t){for(var n=0,r=Array.from((null!=e?e.children:void 0)||[]);n<r.length;n++)if(r[n].name===t)return!0;return!1}},{key:"nameExistsError",value:function nameExistsError(e){null==e&&(e="already exists");var t=this.ide.$q.defer();return t.reject({data:e}),t.promise}},{key:"createDoc",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/doc"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createFolder",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/folder"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createLinkedFile",value:function(e,t,n,r){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file"),{name:e,parent_folder_id:null!=t?t.id:void 0,provider:n,data:r,_csrf:window.csrfToken},{disableAutoLoginRedirect:!0})}},{key:"refreshLinkedFile",value:function(e){if(this._findParentFolder(e),null!=(null!=e.linkedFileData?e.linkedFileData.provider:void 0))return this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file/").concat(e.id,"/refresh"),{_csrf:window.csrfToken},{disableAutoLoginRedirect:!0});console.warn(">> no provider for ".concat(e.name),e)}},{key:"renameEntity",value:function(e,t,n){if(null==n&&(n=function(){}),e.name!==t&&!(t.length>=150)){var r=this.getCurrentFolder();return this.existsInThisFolder(r,t)?this.nameExistsError():(e.renamingToName=t,this.ide.$http.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/rename"),{name:t,_csrf:window.csrfToken}).then((function(){return e.name=t})).finally((function(){return e.renamingToName=null})))}}},{key:"deleteEntity",value:function(e,t){return null==t&&(t=function(){}),this.ide.queuedHttp({method:"DELETE",url:"/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id),headers:{"X-Csrf-Token":window.csrfToken}})}},{key:"moveEntity",value:function(e,t){var n=this;if(!this._isChildFolder(e,t)){if(this.existsInThisFolder(t,e.name))throw new Error("file exists in this location");this.ide.queuedHttp.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/move"),{folder_id:t.id,_csrf:window.csrfToken}).then((function(){n._moveEntityInScope(e,t)}))}}},{key:"_isChildFolder",value:function(e,t){var n=this.getEntityPath(e)||"";return(this.getEntityPath(t)||"").slice(0,n.length)===n}},{key:"_deleteEntityFromScope",value:function(e,t){if(null==t&&(t={moveToDeleted:!0}),null!=e){var n=null;if(this.forEachEntity((function(t,r){if(t===e)return n=r})),null!=n){var r=n.children.indexOf(e);r>-1&&n.children.splice(r,1)}return"folder"!==e.type&&e.selected&&(this.$scope.ui.view=null),"doc"===e.type&&t.moveToDeleted?(e.deleted=!0,this.$scope.deletedDocs.push(e)):void 0}}},{key:"_moveEntityInScope",value:function(e,t){if(!Array.from(t.children).includes(e))return this._deleteEntityFromScope(e,{moveToDeleted:!1}),t.children.push(e)}}])&&Zs(t.prototype,n),r&&Zs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var tl=n(355);function nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rl=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t;var r=new Promise((function(e){n.resolveSocketPromise=e}));Promise.all([r,tl.a]).then((function(){n.$scope.$apply((function(){n.$scope.state.load_progress=100,n.$scope.state.loading=!1}))})).catch((function(){n.$scope.$apply((function(){n.$scope.state.error="Could not load translations."}))}))}var t,n,r;return t=e,(n=[{key:"socketLoaded",value:function(){this.resolveSocketPromise()}}])&&nl(t.prototype,n),r&&nl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function il(e){return(il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ol(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return al(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return al(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function al(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ll(e,t)}function ll(e,t){return(ll=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hl(e);if(t){var a=hl(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ul(this,n)}}function ul(e,t){if(t&&("object"===il(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return dl(e)}function dl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hl(e){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gl(e,t,n){return t&&fl(e.prototype,t),n&&fl(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}for(var ml=function(){function e(t){pl(this,e),this._socket=t}return gl(e,null,[{key:"connect",value:function(t,n){return new e}}]),e}(),vl=function(){var e=yl[bl];ml.prototype[e]=function(){this._socket[e].apply(this._socket,arguments)}},bl=0,yl=["connect","disconnect","emit","on","removeListener"];bl<yl.length;bl++)vl();var wl,xl=function(e){sl(n,e);var t=cl(n);function n(e){var r;return pl(this,n),(r=t.call(this,e)).socket={get connected(){return!1},get sessionid(){},get transport(){return{}},connect:function(){},disconnect:function(e){}},r}return gl(n,[{key:"connect",value:function(){}},{key:"disconnect",value:function(e){}},{key:"emit",value:function(){}},{key:"on",value:function(){}},{key:"removeListener",value:function(){}}],[{key:"connect",value:function(){return new n}}]),n}(ml),jl=function(e){sl(n,e);var t=cl(n);function n(e){var r;return pl(this,n),(r=t.call(this,e)).socket=r._socket.socket,r}return gl(n,null,[{key:"connect",value:function(e,t){return new n(io.connect(e,t))}}]),n}(ml),Ol=function(e){sl(n,e);var t=cl(n);function n(e,r){var a;pl(this,n),(a=t.call(this,n.createNewSocket(e,r)))._url=e,a._options=r,a._events=new Map;var l=dl(a);function d(){return l._socket.io&&l._socket.io.engine||{}}return a.socket={get connected(){return l._socket.connected},get sessionid(){return l._socket.id?l._socket.id:d().id},get transport(){return d().transport},connect:function(){l._replaceSocketWithNewInstance()},disconnect:function(e){return l._socket.disconnect(e)}},a}return gl(n,[{key:"_on",value:function(e,t){this._events.has(e)?this._events.get(e).push(t):this._events.set(e,[t]),this._socket.on(e,t)}},{key:"on",value:function(e,t){if(n.EVENT_MAP.has(e)){var r,a=ol(n.EVENT_MAP.get(e));try{for(a.s();!(r=a.n()).done;){var l=r.value;this._on(l,t)}}catch(e){a.e(e)}finally{a.f()}}else this._on(e,t)}},{key:"_removeListener",value:function(e,t){if(this._events.has(e)){var n=this._events.get(e),r=n.indexOf(t);-1!==r&&n.splice(r,1)}this._socket.removeListener(e,t)}},{key:"removeListener",value:function(e,t){if(n.EVENT_MAP.has(e)){var r,a=ol(n.EVENT_MAP.get(e));try{for(a.s();!(r=a.n()).done;){var l=r.value;this._removeListener(l,t)}}catch(e){a.e(e)}finally{a.f()}}else this._removeListener(e,t)}},{key:"_replaceSocketWithNewInstance",value:function(){var e=this._socket,t=n.createNewSocket(this._url,this._options);this._events.forEach((function(n,r){var a,l=ol(n);try{for(l.s();!(a=l.n()).done;){var d=a.value;e.removeListener(r,d),t.on(r,d)}}catch(e){l.e(e)}finally{l.f()}})),e.connected&&e.disconnect(),this._socket=t}},{key:"connect",value:function(){this._replaceSocketWithNewInstance()}}],[{key:"connect",value:function(e,t){return t.forceNew=t["force new connection"],t.path="/"+t.resource,t.reconnection=t.reconnect,t.timeout=t["connect timeout"],new n(e,t)}},{key:"EVENT_MAP",get:function(){var e=["connect_error","connect_timeout","error"];return new Map([["connect_failed",e],["error",e]])}},{key:"createNewSocket",value:function(e,t){return io.Manager(e,t).socket("/",t)}}]),n}(ml);"undefined"!=typeof io&&io?"string"==typeof io.version&&"0"===io.version.slice(0,1)?(sl_console.log("[socket.io] Shim: detected v0"),wl=jl):(sl_console.log("[socket.io] Shim: detected v2"),wl=Ol):(sl_console.log("[socket.io] Shim: socket.io is not loaded, returning noop"),wl=xl);var Cl,Sl={SocketShimNoop:xl,SocketShimV0:jl,SocketShimV2:Ol,current:wl,connect:wl.connect,stub:function(){return new xl}};function _l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_l(Object(n),!0).forEach((function(t){El(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function El(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $l=((Cl=function(){function e(t,n){var r,a=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.wsUrl=t.wsUrl||null,"undefined"==typeof io||null===io)return this.wsUrl&&!window.location.href.match(/ws=fallback/)&&(window.location=window.location.href+"?ws=fallback"),console.error("Socket.io javascript not loaded. Please check that the real-time service is running and accessible."),this.ide.socket=Sl.stub(),void this.$scope.$apply((function(){return a.$scope.state.error="Could not connect to websocket server :("}));setInterval((function(){return a.disconnectIfInactive()}),36e5),window.addEventListener("online",(function(){if(sl_console.log("[online] browser notified online"),!a.connected)return a.tryReconnectWithRateLimit({force:!0})})),this.userIsLeavingPage=!1,window.addEventListener("beforeunload",(function(){a.userIsLeavingPage=!0})),this.connected=!1,this.userIsInactive=!1,this.gracefullyReconnecting=!1,this.shuttingDown=!1,this.joinProjectRetryInterval=this.JOIN_PROJECT_RETRY_INTERVAL,this.$scope.connection={debug:sl_debugging,reconnecting:!1,stillReconnecting:!1,forced_disconnect:!1,inactive_disconnect:!1,jobId:0},this.$scope.tryReconnectNow=function(){return a.tryReconnectWithRateLimit({force:!0})},this.$scope.$on("cursor:editor:update",(function(){if(a.lastUserAction=new Date,!a.connected)return a.tryReconnectWithRateLimit()})),document.querySelector("body").addEventListener("click",(function(e){if(!a.shuttingDown&&!a.connected&&"try-reconnect-now-button"!==e.target.id)return a.tryReconnectWithRateLimit()})),this.updateConnectionManagerState("connecting");try{r=new URL(this.wsUrl||"/socket.io",window.location)}catch(e){this.wsUrl&&0!==this.wsUrl.indexOf("/")&&!window.location.href.match(/ws=fallback/)&&(window.location=window.location.href+"?ws=fallback"),r={origin:null,pathname:this.wsUrl||"/socket.io"}}this.ide.socket=Sl.connect(r.origin,{resource:r.pathname.slice(1),reconnect:!1,"connect timeout":3e4,"force new connection":!0});var l=1,d=function(e){return window.wsRetryHandshake&&l++<window.wsRetryHandshake?setTimeout((function(){return a.ide.socket.socket.connect()}),100):(a.updateConnectionManagerState("error"),sl_console.log("socket.io error",e),!a.wsUrl||window.location.href.match(/ws=fallback/)?(a.connected=!1,a.$scope.$apply((function(){return a.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}))):void(window.location=window.location.href+"?ws=fallback"))};this.ide.socket.on("error",d),this.ide.socket.on("connect",(function(){a.ide.socket.removeListener("error",d),sl_console.log("[socket.io connect] Connected"),a.updateConnectionManagerState("authenticating")})),this.ide.socket.on("connectionAccepted",(function(e,t){a.ide.socket.publicId=t||a.ide.socket.socket.sessionid,sl_console.log("[socket.io connectionAccepted] allowed to connect"),a.connected=!0,a.gracefullyReconnecting=!1,a.ide.pushEvent("connected"),a.updateConnectionManagerState("joining"),a.$scope.$apply((function(){a.$scope.state.loading&&(a.$scope.state.load_progress=70)}));var n=a.$scope.connection.jobId;setTimeout((function(){a.joinProject(n)}),100)})),this.ide.socket.on("connectionRejected",(function(e){return sl_console.log("[socket.io connectionRejected] session not valid or other connection error"),e&&"retry"===e.message?a.tryReconnectWithRateLimit():a.reportConnectionError(e)})),this.ide.socket.on("connect_failed",(function(){return a.updateConnectionManagerState("error"),a.connected=!1,a.$scope.$apply((function(){return a.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}))})),this.ide.socket.on("disconnect",(function(){sl_console.log("[socket.io disconnect] Disconnected"),a.connected=!1,a.ide.pushEvent("disconnected"),a.$scope.connection.state.match(/^waiting/)||(a.$scope.connection.forced_disconnect||a.userIsInactive||a.shuttingDown?a.updateConnectionManagerState("inactive"):a.startAutoReconnectCountdown())})),this.ide.socket.on("forceDisconnect",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a.updateConnectionManagerState("inactive"),a.shuttingDown=!0,a.$scope.$apply((function(){return a.$scope.permissions.write=!1,a.$scope.connection.forced_disconnect=!0})),a.ide.$scope.$broadcast("flush-changes"),setTimeout((function(){return a.ide.socket.disconnect()}),1e3),a.ide.showLockEditorMessageModal("Please wait","We're performing maintenance on Overleaf and you need to wait a moment.\nSorry for any inconvenience.\nThe editor will refresh automatically in ".concat(t," seconds.")),setTimeout((function(){return location.reload()}),1e3*t)})),this.ide.socket.on("reconnectGracefully",(function(){sl_console.log("Reconnect gracefully"),a.reconnectGracefully()})),this.ide.socket.on("unregisterServiceWorker",(function(){sl_console.log("Unregister service worker"),a.$scope.$broadcast("service-worker:unregister")}))}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype.disconnectAfterMs=864e5,this.prototype.lastUserAction=new Date,this.prototype.MIN_RETRY_INTERVAL=1e3,this.prototype.BACKGROUND_RETRY_INTERVAL=5e3,this.prototype.JOIN_PROJECT_RETRY_INTERVAL=5e3,this.prototype.JOIN_PROJECT_MAX_RETRY_INTERVAL=6e4,this.prototype.RECONNECT_GRACEFULLY_RETRY_INTERVAL=5e3,this.prototype.MAX_RECONNECT_GRACEFULLY_INTERVAL=45e3}}],(n=[{key:"updateConnectionManagerState",value:function(e){var t=this;this.$scope.$apply((function(){t.$scope.connection.jobId+=1;var n=t.$scope.connection.jobId;sl_console.log("[updateConnectionManagerState ".concat(n,"] from ").concat(t.$scope.connection.state," to ").concat(e)),t.$scope.connection.state=e,t.$scope.connection.reconnecting=!1,t.$scope.connection.stillReconnecting=!1,t.$scope.connection.inactive_disconnect=!1,t.$scope.connection.joining=!1,t.$scope.connection.reconnection_countdown=null,"connecting"===e||("reconnecting"===e?(t.stopReconnectCountdownTimer(),t.$scope.connection.reconnecting=!0,setTimeout((function(){t.$scope.connection.reconnecting&&t.$scope.connection.jobId===n&&(t.$scope.connection.stillReconnecting=!0)}),1e3)):"reconnectFailed"===e||"authenticating"===e||("joining"===e?t.$scope.connection.joining=!0:"ready"===e||("waitingCountdown"===e||"waitingGracefully"===e?t.stopReconnectCountdownTimer():"inactive"===e||"error"===e||sl_console.log("[WARN] [updateConnectionManagerState ".concat(n,"] got unrecognised state ").concat(e)))))}))}},{key:"expectConnectionManagerState",value:function(e,t){return!(this.$scope.connection.state!==e||t&&t!==this.$scope.connection.jobId)||(sl_console.log("[WARN] [state mismatch] expected state ".concat(e).concat(t?"/"+t:""," when in ").concat(this.$scope.connection.state,"/").concat(this.$scope.connection.jobId)),!1)}},{key:"reportConnectionError",value:function reportConnectionError(e){return sl_console.log("[socket.io] reporting connection error"),this.updateConnectionManagerState("error"),"not authorized"===(null!=e?e.message:void 0)||"invalid session"===(null!=e?e.message:void 0)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):(this.ide.socket.disconnect(),this.ide.showGenericMessageModal("Something went wrong connecting","Something went wrong connecting to your project. Please refresh if this continues to happen."))}},{key:"joinProject",value:function(e){var t=this;if(sl_console.log("[joinProject ".concat(e,"] joining...")),this.expectConnectionManagerState("joining",e)){var n={project_id:this.ide.project_id};window.anonymousAccessToken&&(n.anonymousAccessToken=window.anonymousAccessToken),this.ide.socket.emit("joinProject",n,(function(n,r,a,l){if(null!=n||null==r)return"ProjectNotFound"===(n=n||{}).code?void t.ide.showGenericMessageModal("Project has been deleted","This project has been deleted by the owner.").result.then((function(){return location.reload(!0)})):"TooManyRequests"===n.code?(sl_console.log("[joinProject ".concat(e,"] retrying: ").concat(n.message)),setTimeout((function(){return t.joinProject(e)}),t.joinProjectRetryInterval),void(t.joinProjectRetryInterval<t.JOIN_PROJECT_MAX_RETRY_INTERVAL&&(t.joinProjectRetryInterval+=t.JOIN_PROJECT_RETRY_INTERVAL))):t.reportConnectionError(n);t.joinProjectRetryInterval=t.JOIN_PROJECT_RETRY_INTERVAL,null!=t.$scope.protocolVersion&&t.$scope.protocolVersion!==l&&location.reload(!0),t.$scope.$apply((function(){t.updateConnectionManagerState("ready"),t.$scope.protocolVersion=l,t.$scope.project=kl(kl({},{rootDoc_id:null}),r),t.$scope.permissionsLevel=a,t.ide.loadingManager.socketLoaded(),window.dispatchEvent(new CustomEvent("project:joined",{detail:t.$scope.project})),t.$scope.$broadcast("project:joined")}))}))}else sl_console.log("[joinProject ".concat(e,"] aborting with stale connection"))}},{key:"reconnectImmediately",value:function(){return this.disconnect(),this.tryReconnect()}},{key:"disconnect",value:function(e){if(e&&e.permanent)sl_console.log("[disconnect] shutting down ConnectionManager"),this.updateConnectionManagerState("inactive"),this.shuttingDown=!0;else if(this.ide.socket.socket&&!this.ide.socket.socket.connected)return void sl_console.log("[socket.io] skipping disconnect because socket.io has not connected");return sl_console.log("[socket.io] disconnecting client"),this.ide.socket.disconnect()}},{key:"startAutoReconnectCountdown",value:function(){var e=this;this.updateConnectionManagerState("waitingCountdown");var t,n=this.$scope.connection.jobId;sl_console.log("[ConnectionManager] starting autoreconnect countdown"),t=null!=this.lastUserAction&&new Date-this.lastUserAction>12e4?60+Math.floor(120*Math.random()):3+Math.floor(7*Math.random()),this.userIsLeavingPage||(this.$scope.$apply((function(){e.$scope.connection.reconnecting=!1,e.$scope.connection.stillReconnecting=!1,e.$scope.connection.joining=!1,e.$scope.connection.reconnection_countdown=t})),setTimeout((function(){e.connected||e.countdownTimeoutId||(e.countdownTimeoutId=setTimeout((function(){return e.decreaseCountdown(n)}),1e3))}),200))}},{key:"stopReconnectCountdownTimer",value:function(){null!=this.countdownTimeoutId&&(sl_console.log("[ConnectionManager] cancelling existing reconnect timer"),clearTimeout(this.countdownTimeoutId),this.countdownTimeoutId=null)}},{key:"decreaseCountdown",value:function(e){var t=this;this.countdownTimeoutId=null,null!=this.$scope.connection.reconnection_countdown&&(this.expectConnectionManagerState("waitingCountdown",e)?(sl_console.log("[ConnectionManager] decreasing countdown",this.$scope.connection.reconnection_countdown),this.$scope.$apply((function(){t.$scope.connection.reconnection_countdown--})),this.$scope.connection.reconnection_countdown<=0?(this.$scope.connection.reconnecting=!1,this.$scope.$apply((function(){t.tryReconnect()}))):this.countdownTimeoutId=setTimeout((function(){return t.decreaseCountdown(e)}),1e3)):sl_console.log("[ConnectionManager] Aborting stale countdown ".concat(e)))}},{key:"tryReconnect",value:function(){var e=this;if(sl_console.log("[ConnectionManager] tryReconnect"),!(this.connected||this.shuttingDown||this.$scope.connection.reconnecting)){this.updateConnectionManagerState("reconnecting"),sl_console.log("[ConnectionManager] Starting new connection");var t=function(){e.ide.socket.removeListener("error",n),e.ide.socket.removeListener("connect",r)},n=function(){sl_console.log("[ConnectionManager] tryReconnect: failed"),t(),e.updateConnectionManagerState("reconnectFailed"),e.tryReconnectWithRateLimit({force:!0})},r=function(){sl_console.log("[ConnectionManager] tryReconnect: success"),t()};this.ide.socket.on("error",n),this.ide.socket.on("connect",r),this.ide.socket.socket.connect(),this.lastConnectionAttempt=new Date}}},{key:"tryReconnectWithRateLimit",value:function(e){if(!this.$scope.connection.reconnecting&&!this.connected){var t=null!=this.$scope.connection.reconnection_countdown&&this.$scope.connection.reconnection_countdown<=5,n=null!=e?e.force:void 0;if(!t||n){var r=n?this.MIN_RETRY_INTERVAL:this.BACKGROUND_RETRY_INTERVAL;null!=this.lastConnectionAttempt&&new Date-this.lastConnectionAttempt<r?"waitingCountdown"!==this.$scope.connection.state&&this.startAutoReconnectCountdown():this.tryReconnect()}}}},{key:"disconnectIfInactive",value:function(){var e=this;if(this.userIsInactive=new Date-this.lastUserAction>this.disconnectAfterMs,this.userIsInactive&&this.connected)return this.disconnect(),this.$scope.$apply((function(){return e.$scope.connection.inactive_disconnect=!0}))}},{key:"reconnectGracefully",value:function(e){var t=this;if(null==this.reconnectGracefullyStarted)this.reconnectGracefullyStarted=new Date;else if(!e)return void sl_console.log("[reconnectGracefully] reconnection is already in process, so skipping");var n=new Date-this.lastUserAction>this.RECONNECT_GRACEFULLY_RETRY_INTERVAL,r=new Date-this.reconnectGracefullyStarted>this.MAX_RECONNECT_GRACEFULLY_INTERVAL;n||r?(sl_console.log("[reconnectGracefully] User didn't do anything for last 5 seconds, reconnecting"),this._reconnectGracefullyNow()):(sl_console.log("[reconnectGracefully] User is working, will try again in 5 seconds"),this.updateConnectionManagerState("waitingGracefully"),setTimeout((function(){t.reconnectGracefully(!0)}),this.RECONNECT_GRACEFULLY_RETRY_INTERVAL))}},{key:"_reconnectGracefullyNow",value:function(){return this.gracefullyReconnecting=!0,this.reconnectGracefullyStarted=null,$.cookie("SERVERID","",{expires:-1,path:"/"}),this.reconnectImmediately()}}])&&Al(t.prototype,n),r&&Al(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).initClass(),Cl=Cl);function Tl(e){return function(e){if(Array.isArray(e))return Pl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Il(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||Il(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Il(e,t){if(e){if("string"==typeof e)return Pl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pl(e,t):void 0}}function Pl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ml=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"on",value:function(e,t){var n;this.events||(this.events={});var r=Rl(Array.from(e.split(".")),2);return e=r[0],n=r[1],this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,namespace:n})}},{key:"off",value:function(e){if(this.events||(this.events={}),null!=e){var t,n=Rl(Array.from(e.split(".")),2);if(e=n[0],null==(t=n[1]))return delete this.events[e];for(var r=[],a=0,l=Array.from(this.events[e]||[]);a<l.length;a++){var d=l[a];d.namespace!==t&&r.push(d)}return this.events[e]=r}return this.events={}}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.events||(this.events={}),Array.from(this.events[e]||[]).map((function(e){return e.callback.apply(e,Tl(Array.from(n||[])))}))}},{key:"emit",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.trigger.apply(this,Tl(Array.from(t||[])))}}])&&Dl(t.prototype,n),r&&Dl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ll=n(616),Fl=n.n(Ll);function ql(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Nl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nl(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Nl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ul(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hl(e,t,n){return t&&Ul(e.prototype,t),n&&Ul(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var zl,Vl=function(){function e(t){Bl(this,e),this._onTimeoutHandler=t,this._lastReport=void 0,this._queue=[]}return Hl(e,[{key:"_getMetaPreferLocal",value:function(){var e,t=ql(this._queue);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("ShareJsDoc"===n.scope)return n}}catch(e){t.e(e)}finally{t.f()}return this._queue.pop()}},{key:"onTimeout",value:function(e){var t=this;this._queue.push(e),setTimeout((function(){if(t._queue.length){var e=t._getMetaPreferLocal();t._queue.length=0;var n=Date.now();n-t._lastReport<6e4||(t._lastReport=n,t._onTimeoutHandler(e))}}))}}]),e}(),Wl=function(){function e(t){var n=t.parent,r=t.onTimeoutHandler;Bl(this,e),this.scope=n?"ShareJsDoc":"global",this.timeout=6e4,this.parent=n,this.reporter=n?n.reporter:new Vl(r),this.lastAck=null,this.lastUnackedEdit=null}return Hl(e,[{key:"onAck",value:function(){this.lastAck=performance.now(),this.parent&&this.parent.onAck()}},{key:"onEdit",value:function(){var e=performance.now();this.lastAck>this.lastUnackedEdit&&(this.lastUnackedEdit=null),this.lastUnackedEdit||(this.lastUnackedEdit=e);var t=e-this.lastUnackedEdit;if(t>this.timeout){var n=Date.now()-e,r={scope:this.scope,delay:t,lastAck:new Date(this.lastAck?n+this.lastAck:0),lastUnackedEdit:new Date(n+this.lastUnackedEdit)};this._log("timedOut",r),this.reporter.onTimeout(r)}}},{key:"attachToEditor",value:function(e,t){var n,r=this;if("CM6"===e){this._log("attach to editor",e),n=function(e,t){"remote"!==t.origin&&(t.removed||t.inserted)&&r.onEdit()},t.on("change",n);return function(){r._log("detach from editor",e),t.off("change",n)}}n="CM"===e?function(e,t){"remote"!==t.origin&&(t.removed||t.text)&&r.onEdit()}:function(e){"remote"!==e.origin&&("remove"!==e.action&&"insert"!==e.action||r.onEdit())},this._log("attach to editor",e),t.on("change",n);return function(){r._log("detach from editor",e),t.off("change",n)}}},{key:"_log",value:function(){var e;(e=sl_console).log.apply(e,["[EditorWatchdogManager] ".concat(this.scope,":")].concat(Array.prototype.slice.call(arguments)))}}]),e}();function Kl(e){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gl(e){return function(e){if(Array.isArray(e))return Yl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Yl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yl(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jl(e,t){return(Jl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ql(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ec(e);if(t){var a=ec(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Zl(this,n)}}function Zl(e,t){if(t&&("object"===Kl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ec(e){return(ec=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var tc=((zl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jl(e,t)}(l,e);var t,n,r,a=Ql(l);function l(e,t,n,r,d){var h;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(h=a.call(this)).doc_id=e,h.socket=r,h.type="text";var p=(t=Array.from(t).map((function(e){return decodeURIComponent(escape(e))}))).join("\n");return h.track_changes=!1,h.connection={send:function(e){if(h._startInflightOpTimeout(e),null!=window.disconnectOnUpdate&&Math.random()<window.disconnectOnUpdate&&(sl_console.log("Disconnecting on update",e),window._ide.socket.socket.disconnect()),!(null!=window.dropUpdates&&Math.random()<window.dropUpdates))return h.track_changes&&(null==e.meta&&(e.meta={}),e.meta.tc=h.track_changes_id_seeds.inflight),h.socket.emit("applyOtUpdate",h.doc_id,e,(function(e){if(null!=e)return h._handleError(e)}));sl_console.log("Simulating a lost update",e)},state:"ok",id:h.socket.publicId},h._doc=new Fl.a.Doc(h.connection,h.doc_id,{type:h.type}),h._doc.setFlushDelay(2e3),h._doc.on("change",(function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=h).trigger.apply(e,["change"].concat(Gl(Array.from(n))))})),h.EditorWatchdogManager=new Wl({parent:d}),h._doc.on("acknowledge",(function(){return h.lastAcked=new Date,h.EditorWatchdogManager.onAck(),h.trigger("acknowledge")})),h._doc.on("remoteop",(function(){var e;h._doc.setFlushDelay(500);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=h).trigger.apply(e,["remoteop"].concat(Gl(Array.from(n))))})),h._doc.on("flipped_pending_to_inflight",(function(){return h.trigger("flipped_pending_to_inflight")})),h._doc.on("saved",(function(){return h.trigger("saved")})),h._doc.on("error",(function(e){return h._handleError(e)})),h._bindToDocChanges(h._doc),h.processUpdateFromServer({open:!0,v:n,snapshot:p}),h._removeCarriageReturnCharFromShareJsDoc(),h}return t=l,r=[{key:"initClass",value:function(){this.prototype.INFLIGHT_OP_TIMEOUT=5e3,this.prototype.WAIT_FOR_CONNECTION_TIMEOUT=500,this.prototype.FATAL_OP_TIMEOUT=3e4}}],(n=[{key:"_removeCarriageReturnCharFromShareJsDoc",value:function(){var e,t=this._doc;if(-1!==t.snapshot.indexOf("\r"))for(window._ide.pushEvent("remove-carriage-return-char",{doc_id:this.doc_id});-1!==(e=t.snapshot.indexOf("\r"));)sl_console.log("[ShareJsDoc] remove-carriage-return-char",e),t.del(e,1)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this._doc).submitOp.apply(e,Gl(Array.from(n||[])))}},{key:"_isAheadOfExpectedVersion",value:function(e){return this._doc.version>0&&e.v>this._doc.version}},{key:"_pushOntoQueue",value:function(e){var t=this;sl_console.log("[processUpdate] push onto queue ".concat(e.v)),this.queuedMessageTimer||(this.queuedMessageTimer=setTimeout((function(){sl_console.log("[processUpdate] queue timeout fired for ".concat(e.v)),t.processUpdateFromServer(e)}),this.INFLIGHT_OP_TIMEOUT)),this.queuedMessages.push(e),this.queuedMessages.sort((function(e,t){return e.v-t.v}))}},{key:"_clearQueue",value:function(){this.queuedMessages=[]}},{key:"_processQueue",value:function(){if(this.queuedMessages.length>0){var e=this.queuedMessages[0].v;e>this._doc.version||(sl_console.log("[processUpdate] taken from queue ".concat(e)),this.processUpdateFromServerInOrder(this.queuedMessages.shift()),0===this.queuedMessages.length&&this.queuedMessageTimer&&(sl_console.log("[processUpdate] queue is empty, cleared timeout"),clearTimeout(this.queuedMessageTimer),this.queuedMessageTimer=null))}}},{key:"processUpdateFromServerInOrder",value:function(e){if(this.queuedMessages||(this.queuedMessages=[]),this._isAheadOfExpectedVersion(e))this._pushOntoQueue(e);else{var t=this.processUpdateFromServer(e);t instanceof Error&&"Invalid version from server"===t.message?this._clearQueue():this._processQueue()}}},{key:"processUpdateFromServer",value:function(e){try{this._doc._onMessage(e)}catch(e){return console.log(e),this._handleError(e),e}if("external"===(t=null!=e?e.meta:void 0,n=function(e){return e.type},null!=t?n(t):void 0))return this.trigger("externalUpdate",e);var t,n}},{key:"catchUp",value:function(e){var t=this;return function(){for(var n=[],r=0;r<e.length;r++){var a=e[r];a.v=t._doc.version,a.doc=t.doc_id,n.push(t.processUpdateFromServer(a))}return n}()}},{key:"getSnapshot",value:function(){return this._doc.snapshot}},{key:"getVersion",value:function(){return this._doc.version}},{key:"getType",value:function(){return this.type}},{key:"clearInflightAndPendingOps",value:function(){return this._clearFatalTimeoutTimer(),this._doc.inflightOp=null,this._doc.inflightCallbacks=[],this._doc.pendingOp=null,this._doc.pendingCallbacks=[]}},{key:"flushPendingOps",value:function(){return this._doc.flush()}},{key:"updateConnectionState",value:function(e){return sl_console.log("[updateConnectionState] Setting state to ".concat(e)),this.connection.state=e,this.connection.id=this.socket.publicId,this._doc.autoOpen=!1,this._doc._connectionStateChanged(e),this.lastAcked=null}},{key:"hasBufferedOps",value:function(){return null!=this._doc.inflightOp||null!=this._doc.pendingOp}},{key:"getInflightOp",value:function(){return this._doc.inflightOp}},{key:"getPendingOp",value:function(){return this._doc.pendingOp}},{key:"getRecentAck",value:function(){return null!=this.lastAcked&&new Date-this.lastAcked<4e3}},{key:"getOpSize",value:function(e){for(var t=0,n=0,r=Array.from(e||[]);n<r.length;n++){var a=r[n];null!=(null!=a?a.i:void 0)&&(t+=a.i.length),null!=(null!=a?a.d:void 0)&&(t+=a.d.length)}return t}},{key:"_attachEditorWatchdogManager",value:function(e,t){this._detachEditorWatchdogManager=this.EditorWatchdogManager.attachToEditor(e,t)}},{key:"_attachToEditor",value:function(e,t,n){this._attachEditorWatchdogManager(e,t),n()}},{key:"_maybeDetachEditorWatchdogManager",value:function(){this._detachEditorWatchdogManager&&(this._detachEditorWatchdogManager(),delete this._detachEditorWatchdogManager)}},{key:"attachToAce",value:function(e){var t=this;this._attachToEditor("Ace",e,(function(){t._doc.attach_ace(e,window.maxDocLength)}))}},{key:"detachFromAce",value:function(){return this._maybeDetachEditorWatchdogManager(),"function"==typeof this._doc.detach_ace?this._doc.detach_ace():void 0}},{key:"attachToCM",value:function(e){var t=this;this._attachToEditor("CM",e,(function(){t._doc.attach_cm(e,window.maxDocLength)}))}},{key:"detachFromCM",value:function(){return this._maybeDetachEditorWatchdogManager(),"function"==typeof this._doc.detach_cm?this._doc.detach_cm():void 0}},{key:"attachToCM6",value:function(e){var t=this;this._attachToEditor("CM6",e,(function(){e.attachShareJs(t._doc,window.maxDocLength)}))}},{key:"detachFromCM6",value:function(){this._maybeDetachEditorWatchdogManager(),this._doc.detach_cm6&&this._doc.detach_cm6()}},{key:"_startInflightOpTimeout",value:function(e){var t=this;this._startFatalTimeoutTimer(e);var n=setTimeout((function n(){if(sl_console.log("[inflightOpTimeout] Trying op again"),null!=t._doc.inflightOp)return e.dupIfSource=[t.connection.id].concat(Gl(Array.from(t._doc.inflightSubmittedIds))),"ok"!==t.connection.state?(sl_console.log("[inflightOpTimeout] Not connected, retrying in 0.5s"),setTimeout(n,t.WAIT_FOR_CONNECTION_TIMEOUT)):(sl_console.log("[inflightOpTimeout] Sending"),t.connection.send(e))}),this.INFLIGHT_OP_TIMEOUT);return this._doc.inflightCallbacks.push((function(){return t._clearFatalTimeoutTimer(),clearTimeout(n)}))}},{key:"_startFatalTimeoutTimer",value:function(e){var t=this;if(null==this._timeoutTimer)return this._timeoutTimer=setTimeout((function(){return t._clearFatalTimeoutTimer(),t.trigger("op:timeout",e)}),this.FATAL_OP_TIMEOUT)}},{key:"_clearFatalTimeoutTimer",value:function(){if(null!=this._timeoutTimer)return clearTimeout(this._timeoutTimer),this._timeoutTimer=null}},{key:"_handleError",value:function _handleError(e,t){return null==t&&(t={}),this.trigger("error",e,t)}},{key:"_bindToDocChanges",value:function(e){var t=this,n=e.submitOp;e.submitOp=function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t.trigger.apply(t,["op:sent"].concat(Gl(Array.from(a)))),e.pendingCallbacks.push((function(){return t.trigger.apply(t,["op:acknowledged"].concat(Gl(Array.from(a))))})),n.apply(e,a)};var r=e.flush;return e.flush=function(){t.trigger("flush",e.inflightOp,e.pendingOp,e.version);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r.apply(e,a)}}}])&&Xl(t.prototype,n),r&&Xl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ml)).initClass(),zl=zl);n(49);function nc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rc,ic=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&(t=[]),this.changes=t,null==n&&(n=[]),this.comments=n,this.setIdSeed(e.generateIdSeed()),this.resetDirtyState()}var t,n,r;return t=e,r=[{key:"generateIdSeed",value:function(){var e=Math.floor(32767*Math.random()).toString(16),t=Math.floor(16777216*Math.random()).toString(16),n=Math.floor((new Date).valueOf()/1e3).toString(16);return"00000000".substr(0,8-n.length)+n+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-e.length)+e}},{key:"generateId",value:function(){return this.generateIdSeed()+"000001"}}],(n=[{key:"getIdSeed",value:function(){return this.id_seed}},{key:"setIdSeed",value:function(e){return this.id_seed=e,this.id_increment=0}},{key:"newId",value:function(){this.id_increment++;var e=this.id_increment.toString(16);return this.id_seed+"000000".substr(0,6-e.length)+e}},{key:"getComment",value:function(e){for(var t=null,n=0,r=Array.from(this.comments);n<r.length;n++){var a=r[n];if(a.id===e){t=a;break}}return t}},{key:"removeCommentId",value:function(e){var t=this.getComment(e);if(null!=t)return this.comments=this.comments.filter((function(t){return t.id!==e})),this._markAsDirty(t,"comment","removed")}},{key:"moveCommentId",value:function(e,t,n){var r=this;return function(){for(var a=[],l=0,d=Array.from(r.comments);l<d.length;l++){var h=d[l];h.id===e?(h.op.p=t,h.op.c=n,a.push(r._markAsDirty(h,"comment","moved"))):a.push(void 0)}return a}()}},{key:"getChange",value:function(e){for(var t=null,n=0,r=Array.from(this.changes);n<r.length;n++){var a=r[n];if(a.id===e){t=a;break}}return t}},{key:"getChanges",value:function(e){for(var t=[],n={},r=0,a=Array.from(e);r<a.length;r++)n[a[r]]=!0;for(var l=0,d=Array.from(this.changes);l<d.length;l++){var h=d[l];n[h.id]&&(delete n[h.id],t.push(h))}return t}},{key:"removeChangeId",value:function(e){var t=this.getChange(e);if(null!=t)return this._removeChange(t)}},{key:"removeChangeIds",value:function(e){if(!(!(null!=e?e.length:void 0)>0)){this.changes.length;for(var t={},n=0,r=Array.from(e);n<r.length;n++)t[r[n]]=!0;for(var a=[],l=0,d=Array.from(this.changes);l<d.length;l++){var h=d[l];t[h.id]?(delete t[h.id],this._markAsDirty(h,"change","removed")):a.push(h)}return this.changes=a}}},{key:"validate",value:function(e){for(var t,n=0,r=Array.from(this.changes);n<r.length;n++){var a=r[n];if(null!=a.op.i&&(t=e.slice(a.op.p,a.op.p+a.op.i.length))!==a.op.i)throw new Error("Change (".concat(JSON.stringify(a),") doesn't match text (").concat(JSON.stringify(t),")"))}for(var l=0,d=Array.from(this.comments);l<d.length;l++){var h=d[l];if((t=e.slice(h.op.p,h.op.p+h.op.c.length))!==h.op.c)throw new Error("Comment (".concat(JSON.stringify(h),") doesn't match text (").concat(JSON.stringify(t),")"))}return!0}},{key:"applyOp",value:function(e,t){if(null==t&&(t={}),null==t.ts&&(t.ts=new Date),null!=e.i)return this.applyInsertToChanges(e,t),this.applyInsertToComments(e);if(null!=e.d)return this.applyDeleteToChanges(e,t),this.applyDeleteToComments(e);if(null!=e.c)return this.addComment(e,t);throw new Error("unknown op type")}},{key:"applyOps",value:function(e,t){var n=this;return null==t&&(t={}),Array.from(e).map((function(e){return n.applyOp(e,t)}))}},{key:"addComment",value:function(e,t){var n,r=this.getComment(e.t);return null!=r?(this.moveCommentId(e.t,e.p,e.c),r):(this.comments.push(n={id:e.t||this.newId(),op:{c:e.c,p:e.p,t:e.t},metadata:t}),this._markAsDirty(n,"comment","added"),n)}},{key:"applyInsertToComments",value:function(e){var t=this;return function(){for(var n=[],r=0,a=Array.from(t.comments);r<a.length;r++){var l=a[r];if(e.p<=l.op.p)l.op.p+=e.i.length,n.push(t._markAsDirty(l,"comment","moved"));else if(e.p<l.op.p+l.op.c.length){var d=e.p-l.op.p;l.op.c=l.op.c.slice(0,+(d-1)+1||void 0)+e.i+l.op.c.slice(d),n.push(t._markAsDirty(l,"comment","moved"))}else n.push(void 0)}return n}()}},{key:"applyDeleteToComments",value:function(e){var t=this,n=e.p,r=e.d.length,a=e.p+r;return function(){for(var l=[],d=0,h=Array.from(t.comments);d<h.length;d++){var p=h[d],f=p.op.p,y=p.op.p+p.op.c.length,w=y-f;if(a<=f)p.op.p-=r,l.push(t._markAsDirty(p,"comment","moved"));else if(n>=y);else{var x=void 0,j=void 0;j=n<=f?"":p.op.c.slice(0,n-f),x=a>=y?"":p.op.c.slice(a-f);var O=p.op.c.slice(j.length,w-x.length),C=Math.max(0,f-n);if(O!==e.d.slice(C).slice(0,O.length))throw new Error("deleted content does not match comment content");p.op.p=Math.min(f,n),p.op.c=j+x,l.push(t._markAsDirty(p,"comment","moved"))}}return l}()}},{key:"applyInsertToChanges",value:function(e,t){for(var n,r=this,a=e.p,l=e.i.length,d=e.p+l,h=!!e.u,p=!1,f=null,y=[],w=[],x=[],j=0;j<this.changes.length;j++){var O=(n=this.changes[j]).op.p;if(null!=n.op.d)a<O?(n.op.p+=l,y.push(n)):a===O&&(h&&n.op.d.length>=e.i.length&&n.op.d.slice(0,e.i.length)===e.i?(n.op.d=n.op.d.slice(e.i.length),n.op.p+=e.i.length,""===n.op.d?w.push(n):y.push(n),p=!0):(n.op.p+=l,y.push(n)));else if(null!=n.op.i){var C=void 0,S=O+n.op.i.length,_=a>=O&&a<=S,k=t.user_id===n.metadata.user_id,E=this.changes[j+1],A=null!=E&&null!=E.op.d&&e.p===S&&E.op.p===e.p,T=h&&A&&E.op.d.slice(0,e.i.length)===e.i,R=null!=f&&null!=f.op.d&&f.op.p===d;if(this.track_changes&&_&&!R&&!p&&!T&&k)C=a-O,n.op.i=n.op.i.slice(0,C)+e.i+n.op.i.slice(C),n.metadata.ts=t.ts,p=!0,y.push(n);else if(a<=O)n.op.p+=l,y.push(n);else if((!k||!this.track_changes)&&O<a&&a<S){C=a-O;var I=n.op.i.slice(0,C),P=n.op.i.slice(C);n.op.i=I,y.push(n);var D={op:{i:P,p:O+C+l},metadata:{}};for(var M in n.metadata){var L=n.metadata[M];D.metadata[M]=L}x.push(D)}}f=n}this.track_changes&&!p&&this._addOp(e,t);for(var F=0,q=Array.from(x);F<q.length;F++){var N=q[F];e=N.op,t=N.metadata,this._addOp(e,t)}for(var B=0,U=Array.from(w);B<U.length;B++)n=U[B],this._removeChange(n);return function(){for(var e=[],t=0,a=Array.from(y);t<a.length;t++)n=a[t],e.push(r._markAsDirty(n,"change","moved"));return e}()}},{key:"applyDeleteToChanges",value:function(e,t){for(var n=this,r=e.p,a=e.d.length,l=e.p+a,d=[],h=[],p=[],f=0,y=Array.from(this.changes);f<y.length;f++){var w=y[f],x=void 0;if(null!=w.op.i){var j=(x=w.op.p)+w.op.i.length;if(l<=x)w.op.p-=a,h.push(w);else if(r>=j);else{var O=void 0,C=void 0,S=void 0,_=void 0;r>=x?(C="",_=w.op.i.slice(0,r-x)):(C=e.d.slice(0,x-r),_=""),l<=j?(O="",S=w.op.i.slice(l-x)):(O=e.d.slice(j-r),S="");var k=_+S;k.length>0?(w.op.i=k,w.op.p=Math.min(x,r),w.metadata.ts=t.ts,h.push(w)):d.push(w);var E=e.d.length-C.length-O.length,A=C.length,T={d:e.d.slice(A,A+E),p:A};T.d.length>0&&p.push(T)}}else if(null!=w.op.d)if(l<(x=w.op.p)||!this.track_changes&&l===x)w.op.p-=a,h.push(w);else if(r<=x&&x<=l)if(this.track_changes){var R=x-r;p.push({i:w.op.d,p:R}),d.push(w)}else w.op.p=r,h.push(w)}e={p:e.p,d:this._applyOpModifications(e.d,p)};for(var I=0,P=Array.from(d);I<P.length;I++){var D=P[I];e.d.length>0&&null!=D.op.d&&e.p<=D.op.p&&D.op.p<=e.p+e.d.length?(D.op.p=e.p,D.op.d=e.d,D.metadata=t,h.push(D),e.d=""):this._removeChange(D)}if(this.track_changes&&e.d.length>0)this._addOp(e,t);else{var M=this._scanAndMergeAdjacentUpdates();h=h.concat(M.moved_changes);for(var L=function(){var e=q[F];n._removeChange(e),h=h.filter((function(t){return t!==e}))},F=0,q=Array.from(M.remove_changes);F<q.length;F++)L()}return function(){for(var e=[],t=0,r=Array.from(h);t<r.length;t++){var a=r[t];e.push(n._markAsDirty(a,"change","moved"))}return e}()}},{key:"_addOp",value:function(e,t){var n={id:this.newId(),op:this._clone(e),metadata:this._clone(t)};return this.changes.push(n),this.changes.sort((function(e,t){var n=e.op.p-t.op.p;return 0!==n?n:null!=e.op.i&&null!=t.op.d?1:null!=e.op.d&&null!=t.op.i?-1:0})),this._markAsDirty(n,"change","added")}},{key:"_removeChange",value:function(e){return this.changes=this.changes.filter((function(t){return t.id!==e.id})),this._markAsDirty(e,"change","removed")}},{key:"_applyOpModifications",value:function(e,t){t.sort((function(e,t){var n=t.p-e.p;return 0!==n?n:null!=e.i&&null!=t.d?1:null!=e.d&&null!=t.i?-1:0}));for(var n=0,r=Array.from(t);n<r.length;n++){var a=r[n];if(null!=a.i)e=e.slice(0,a.p)+a.i+e.slice(a.p);else if(null!=a.d){if(e.slice(a.p,a.p+a.d.length)!==a.d)throw new Error("deleted content does not match. content: ".concat(JSON.stringify(e),"; modification: ").concat(JSON.stringify(a)));e=e.slice(0,a.p)+e.slice(a.p+a.d.length)}}return e}},{key:"_scanAndMergeAdjacentUpdates",value:function(){for(var e=null,t=[],n=[],r=0,a=Array.from(this.changes);r<a.length;r++){var l=a[r];if(null!=(null!=e?e.op.i:void 0)&&null!=l.op.i){var d=e.op.p+e.op.i.length,h=e.metadata.user_id,p=l.op.p,f=l.metadata.user_id;d===p&&h===f&&(t.push(l),e.op.i+=l.op.i,n.push(e))}else null!=(null!=e?e.op.d:void 0)&&null!=l.op.d&&e.op.p===l.op.p?(e.op.d+=l.op.d,t.push(l),n.push(e)):e=l}return{moved_changes:n,remove_changes:t}}},{key:"resetDirtyState",value:function(){return this._dirtyState={comment:{moved:{},removed:{},added:{}},change:{moved:{},removed:{},added:{}}}}},{key:"getDirtyState",value:function(){return this._dirtyState}},{key:"_markAsDirty",value:function(e,t,n){return this._dirtyState[t][n][e.id]=e}},{key:"_clone",value:function(e){var t={};for(var n in e){var r=e[n];t[n]=r}return t}}])&&nc(t.prototype,n),r&&nc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function oc(e){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ac(e){return function(e){if(Array.isArray(e))return sc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cc(e,t){return(cc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hc(e);if(t){var a=hc(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return dc(this,n)}}function dc(e,t){if(t&&("object"===oc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hc(e){return(hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pc=((rc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cc(e,t)}(l,e);var t,n,r,a=uc(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=a.call(this)).ide=e,n.doc_id=t,n.connected=n.ide.socket.socket.connected,n.joined=!1,n.wantToBeJoined=!1,n._checkAceConsistency=function(){return n._checkConsistency(n.ace)},n._checkCMConsistency=function(){return n._checkConsistency(n.cm)},n._checkCM6Consistency=function(){return n._checkConsistency(n.cm6)},n._bindToEditorEvents(),n._bindToSocketEvents(),n}return t=l,r=[{key:"initClass",value:function(){this.prototype.MAX_PENDING_OP_SIZE=64}},{key:"getDocument",value:function(e,t){return this.openDocs||(this.openDocs={}),this.openDocs[t]&&(sl_console.log("[getDocument] Cleaning up existing document instance for ".concat(t)),this.openDocs[t]._cleanUp()),null==this.openDocs[t]?(sl_console.log("[getDocument] Creating new document instance for ".concat(t)),this.openDocs[t]=new l(e,t)):sl_console.log("[getDocument] Returning existing document instance for ".concat(t)),this.openDocs[t]}},{key:"hasUnsavedChanges",value:function(){var e=this.openDocs||{};for(var t in e)if(e[t].hasBufferedOps())return!0;return!1}},{key:"flushAll",value:function(){var e=this;return function(){var t=[];for(var n in e.openDocs){var r=e.openDocs[n];t.push(r.flush())}return t}()}}],(n=[{key:"editorType",value:function(){return this.ace?"ace":this.cm6?"cm6":this.cm?"cm-rich-text":null}},{key:"attachToAce",value:function(e){return this.ace=e,null!=this.doc&&this.doc.attachToAce(this.ace),this.ace.getSession().getDocument().on("change",this._checkAceConsistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromAce",value:function(){null!=this.doc&&this.doc.detachFromAce();var e=null!=this.ace?this.ace.getSession().getDocument():void 0;return null!=e&&e.off("change",this._checkAceConsistency),delete this.ace,this.clearChaosMonkey(),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"attachToCM",value:function(e){return this.cm=e,null!=this.doc&&this.doc.attachToCM(this.cm),null!=this.cm&&this.cm.on("change",this._checkCMConsistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromCM",value:function(){return null!=this.doc&&this.doc.detachFromCM(),null!=this.cm&&this.cm.off("change",this._checkCMConsistency),delete this.cm,this.clearChaosMonkey(),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"attachToCM6",value:function(e){return this.cm6=e,null!=this.doc&&this.doc.attachToCM6(this.cm6),null!=this.cm6&&this.cm6.on("change",this._checkCM6Consistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromCM6",value:function(){return null!=this.doc&&this.doc.detachFromCM6(),null!=this.cm6&&this.cm6.off("change",this._checkCM6Consistency),delete this.cm6,this.clearChaosMonkey(),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=this.doc?(e=this.doc).submitOp.apply(e,ac(Array.from(n||[]))):void 0}},{key:"_checkConsistency",value:function(e){var t=this;return setTimeout((function(){var n=null!=e?e.getValue():void 0;if(n!==(null!=t.doc?t.doc.getSnapshot():void 0))return t._onError(new Error("Editor text does not match server text"),{},n)}),0)}},{key:"getSnapshot",value:function(){return null!=this.doc?this.doc.getSnapshot():void 0}},{key:"getType",value:function(){return null!=this.doc?this.doc.getType():void 0}},{key:"getInflightOp",value:function(){return null!=this.doc?this.doc.getInflightOp():void 0}},{key:"getPendingOp",value:function(){return null!=this.doc?this.doc.getPendingOp():void 0}},{key:"getRecentAck",value:function(){return null!=this.doc?this.doc.getRecentAck():void 0}},{key:"getOpSize",value:function(e){return null!=this.doc?this.doc.getOpSize(e):void 0}},{key:"hasBufferedOps",value:function(){return null!=this.doc?this.doc.hasBufferedOps():void 0}},{key:"setTrackingChanges",value:function(e){return this.doc.track_changes=e}},{key:"getTrackingChanges",value:function(){return!!this.doc.track_changes}},{key:"setTrackChangesIdSeeds",value:function(e){return this.doc.track_changes_id_seeds=e}},{key:"_bindToSocketEvents",value:function(){var e=this;return this._onUpdateAppliedHandler=function(t){return e._onUpdateApplied(t)},this.ide.socket.on("otUpdateApplied",this._onUpdateAppliedHandler),this._onErrorHandler=function(t,n){n.doc_id===e.doc_id&&e._onError(t,n)},this.ide.socket.on("otUpdateError",this._onErrorHandler),this._onDisconnectHandler=function(t){return e._onDisconnect(t)},this.ide.socket.on("disconnect",this._onDisconnectHandler)}},{key:"_bindToEditorEvents",value:function(){var e=this;return this._unsubscribeReconnectHandler=this.ide.$scope.$on("project:joined",(function(t){return e._onReconnect(t)}))}},{key:"_unBindFromEditorEvents",value:function(){return this._unsubscribeReconnectHandler()}},{key:"_unBindFromSocketEvents",value:function(){return this.ide.socket.removeListener("otUpdateApplied",this._onUpdateAppliedHandler),this.ide.socket.removeListener("otUpdateError",this._onErrorHandler),this.ide.socket.removeListener("disconnect",this._onDisconnectHandler)}},{key:"leaveAndCleanUp",value:function(e){var t=this;return this.leave((function(n){t._cleanUp(),e&&e(n)}))}},{key:"join",value:function(e){return null==e&&(e=function(){}),this.wantToBeJoined=!0,this._cancelLeave(),this.connected?this._joinDoc(e):(this._joinCallbacks||(this._joinCallbacks=[]),this._joinCallbacks.push(e))}},{key:"leave",value:function(e){return null==e&&(e=function(){}),this.flush(),this.wantToBeJoined=!1,this._cancelJoin(),null!=this.doc&&this.doc.hasBufferedOps()?(sl_console.log("[leave] Doc has buffered ops, pushing callback for later"),this._leaveCallbacks||(this._leaveCallbacks=[]),this._leaveCallbacks.push(e)):this.connected?(sl_console.log("[leave] Leaving now"),this._leaveDoc(e)):(sl_console.log("[leave] Not connected, returning now"),e())}},{key:"flush",value:function(){return null!=this.doc?this.doc.flushPendingOps():void 0}},{key:"chaosMonkey",value:function(e,t){var n=this;null==e&&(e=0),null==t&&(t="a");var r=t,a=null,l=0;return this._cm=function d(){return null!=a&&a.length||(a=r.slice()+" "+new Date+"\n",(e+=Math.random()>.1?1:-2)<0&&(e=0),l=0),t=a[0],a=a.slice(1),n.ace?n.ace.session.insert({row:e,column:l},t):n.cm6&&n.cm6.view.dispatch({changes:{from:Math.min(l,n.cm6.view.state.doc.length),insert:t}}),l+=1,n._cm=setTimeout(d,100+(Math.random()<.1?1e3:0))}()}},{key:"clearChaosMonkey",value:function(){var e=this._cm;if(e)return delete this._cm,clearTimeout(e)}},{key:"pollSavedStatus",value:function(){var e,t=this.getInflightOp(),n=this.getPendingOp(),r=this.getRecentAck(),a=null!=n&&this.getOpSize(n);return null==t&&null==n?(e=!0,sl_console.log("[pollSavedStatus] no inflight or pending ops")):null!=t&&t===this.oldInflightOp?(e=!1,sl_console.log("[pollSavedStatus] inflight op is same as before")):null!=n&&r&&a<this.MAX_PENDING_OP_SIZE?(e=!0,sl_console.log("[pollSavedStatus] pending op (small with recent ack) assume ok",n,a)):(e=!1,sl_console.log("[pollSavedStatus] assuming not saved (inflightOp?: ".concat(null!=t,", pendingOp?: ").concat(null!=n,")"))),this.oldInflightOp=t,e}},{key:"_cancelLeave",value:function(){if(null!=this._leaveCallbacks)return delete this._leaveCallbacks}},{key:"_cancelJoin",value:function(){if(null!=this._joinCallbacks)return delete this._joinCallbacks}},{key:"_onUpdateApplied",value:function(e){return this.ide.pushEvent("received-update",{doc_id:this.doc_id,remote_doc_id:null!=e?e.doc:void 0,wantToBeJoined:this.wantToBeJoined,update:e,hasDoc:null!=this.doc}),null!=window.disconnectOnAck&&Math.random()<window.disconnectOnAck?(sl_console.log("Disconnecting on ack",e),void window._ide.socket.socket.disconnect()):null!=window.dropAcks&&Math.random()<window.dropAcks&&null==e.op?void sl_console.log("Simulating a lost ack",e):(null!=e?e.doc:void 0)!==this.doc_id||null==this.doc||(this.ide.pushEvent("received-update:processing",{update:e}),this.doc.processUpdateFromServerInOrder(e),this.wantToBeJoined)?void 0:this.leave()}},{key:"_onDisconnect",value:function(){return sl_console.log("[onDisconnect] disconnecting"),this.connected=!1,this.joined=!1,null!=this.doc?this.doc.updateConnectionState("disconnected"):void 0}},{key:"_onReconnect",value:function(){var e=this;if(sl_console.log("[onReconnect] reconnected (joined project)"),this.ide.pushEvent("reconnected:afterJoinProject"),this.connected=!0,this.wantToBeJoined||(null!=this.doc?this.doc.hasBufferedOps():void 0))return sl_console.log("[onReconnect] Rejoining (wantToBeJoined: ".concat(this.wantToBeJoined," OR hasBufferedOps: ").concat(null!=this.doc?this.doc.hasBufferedOps():void 0,")")),this._joinDoc((function(t){return null!=t?e._onError(t):(e.doc.updateConnectionState("ok"),e.doc.flushPendingOps(),e._callJoinCallbacks())}))}},{key:"_callJoinCallbacks",value:function(){for(var e=0,t=Array.from(this._joinCallbacks||[]);e<t.length;e++)(0,t[e])();return delete this._joinCallbacks}},{key:"_joinDoc",value:function(e){var t=this;return null==e&&(e=function(){}),null!=this.doc?(this.ide.pushEvent("joinDoc:existing",{doc_id:this.doc_id,version:this.doc.getVersion()}),this.ide.socket.emit("joinDoc",this.doc_id,this.doc.getVersion(),{encodeRanges:!0},(function(n,r,a,l,d){return null!=n?e(n):(t.joined=!0,t.doc.catchUp(l),t._decodeRanges(d),t._catchUpRanges(null!=d?d.changes:void 0,null!=d?d.comments:void 0),e())}))):(this.ide.pushEvent("joinDoc:new",{doc_id:this.doc_id}),this.ide.socket.emit("joinDoc",this.doc_id,{encodeRanges:!0},(function(n,r,a,l,d){return null!=n?e(n):(t.joined=!0,t.ide.pushEvent("joinDoc:inited",{doc_id:t.doc_id,version:a}),t.doc=new tc(t.doc_id,r,a,t.ide.socket,t.ide.globalEditorWatchdogManager),t._decodeRanges(d),t.ranges=new ic(null!=d?d.changes:void 0,null!=d?d.comments:void 0),t._bindToShareJsDocEvents(),e())})))}},{key:"_decodeRanges",value:function(e){var t=function(e){return decodeURIComponent(escape(e))};try{for(var n=0,r=Array.from(e.changes||[]);n<r.length;n++){var a=r[n];null!=a.op.i&&(a.op.i=t(a.op.i)),null!=a.op.d&&(a.op.d=t(a.op.d))}return function(){for(var n=[],r=0,a=Array.from(e.comments||[]);r<a.length;r++){var l=a[r];null!=l.op.c?n.push(l.op.c=t(l.op.c)):n.push(void 0)}return n}()}catch(e){return console.log(e)}}},{key:"_leaveDoc",value:function(e){var t=this;return null==e&&(e=function(){}),this.ide.pushEvent("leaveDoc",{doc_id:this.doc_id}),sl_console.log("[_leaveDoc] Sending leaveDoc request"),this.ide.socket.emit("leaveDoc",this.doc_id,(function(n){if(null!=n)return e(n);t.joined=!1;for(var r=0,a=Array.from(t._leaveCallbacks||[]);r<a.length;r++)e=a[r],sl_console.log("[_leaveDoc] Calling buffered callback",e),e(n);return delete t._leaveCallbacks,e(n)}))}},{key:"_cleanUp",value:function(){if(!this.hasBufferedOps())return l.openDocs[this.doc_id]===this?(sl_console.log("[_cleanUp] Removing self (".concat(this.doc_id,") from in openDocs")),delete l.openDocs[this.doc_id]):sl_console.log("[_cleanUp] New instance of (".concat(this.doc_id,") created. Not removing")),this._unBindFromEditorEvents(),this._unBindFromSocketEvents();sl_console.log("[_cleanUp] Document (".concat(this.doc_id,") has buffered ops, refusing to remove from openDocs"))}},{key:"_bindToShareJsDocEvents",value:function(){var e=this;return this.doc.on("error",(function(t,n){return e._onError(t,n)})),this.doc.on("externalUpdate",(function(t){return e.ide.pushEvent("externalUpdate",{doc_id:e.doc_id}),e.trigger("externalUpdate",t)})),this.doc.on("remoteop",(function(){e.ide.pushEvent("remoteop",{doc_id:e.doc_id});for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.trigger.apply(e,["remoteop"].concat(ac(Array.from(n))))})),this.doc.on("op:sent",(function(t){return e.ide.pushEvent("op:sent",{doc_id:e.doc_id,op:t}),e.trigger("op:sent")})),this.doc.on("op:acknowledged",(function(t){return e.ide.pushEvent("op:acknowledged",{doc_id:e.doc_id,op:t}),e.ide.$scope.$emit("ide:opAcknowledged",{doc_id:e.doc_id,op:t}),e.trigger("op:acknowledged")})),this.doc.on("op:timeout",(function(t){return e.ide.pushEvent("op:timeout",{doc_id:e.doc_id,op:t}),e.trigger("op:timeout"),e._onError(new Error("op timed out"))})),this.doc.on("flush",(function(t,n,r){return e.ide.pushEvent("flush",{doc_id:e.doc_id,inflightOp:t,pendingOp:n,v:r})})),this.doc.on("change",(function(t,n,r){return e._applyOpsToRanges(t,n,r),window.dispatchEvent(new CustomEvent("doc:changed",{detail:{id:e.doc_id}})),e.ide.$scope.$emit("doc:changed",{doc_id:e.doc_id})})),this.doc.on("flipped_pending_to_inflight",(function(){return e.trigger("flipped_pending_to_inflight")})),this.doc.on("saved",(function(){return window.dispatchEvent(new CustomEvent("doc:saved",{detail:{id:e.doc_id}})),e.ide.$scope.$emit("doc:saved",{doc_id:e.doc_id})}))}},{key:"_onError",value:function _onError(e,t,n){if(null==t&&(t={}),t.doc_id=this.doc_id,sl_console.log("ShareJS error",e,t),"no project_id found on client"!==e.message)return null!=this.doc&&this.doc.clearInflightAndPendingOps(),this.trigger("error",e,t,n),this._cleanUp();sl_console.log("ignoring error, will wait to join project")}},{key:"_applyOpsToRanges",value:function(e,t,n){var r,a=this;null==e&&(e=[]);var l,d,h=null,p=null!=n;null!=(l=null!=n?n.meta:void 0,d=function(e){return e.tc},null!=l?d(l):void 0)&&(r=this.ranges.getIdSeed(),this.ranges.setIdSeed(n.meta.tc)),p&&(null!=n.meta?n.meta.tc:void 0)?h=n.meta.user_id:p||null==this.track_changes_as||(h=this.track_changes_as),this.ranges.track_changes=null!=h;for(var f=0,y=Array.from(e);f<y.length;f++){var w=y[f];this.ranges.applyOp(w,{user_id:h})}return null!=r&&this.ranges.setIdSeed(r),p?setTimeout((function(){return a.emit("ranges:dirty")})):this.emit("ranges:dirty")}},{key:"_catchUpRanges",value:function(e,t){null==e&&(e=[]),null==t&&(t=[]),this.emit("ranges:clear"),this.ranges.changes=e,this.ranges.comments=t,this.ranges.track_changes=this.doc.track_changes;for(var n=0,r=Array.from(this.doc.getInflightOp()||[]);n<r.length;n++){var a=r[n];this.ranges.setIdSeed(this.doc.track_changes_id_seeds.inflight),this.ranges.applyOp(a,{user_id:this.track_changes_as})}for(var l=0,d=Array.from(this.doc.getPendingOp()||[]);l<d.length;l++){var h=d[l];this.ranges.setIdSeed(this.doc.track_changes_id_seeds.pending),this.ranges.applyOp(h,{user_id:this.track_changes_as})}return this.emit("ranges:redraw")}}])&&lc(t.prototype,n),r&&lc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ml)).initClass(),rc=rc);y.a.component("spellMenu",{bindings:{open:"<",top:"<",left:"<",layoutFromBottom:"<",highlight:"<",replaceWord:"&",learnWord:"&"},template:'<div\nclass="dropdown context-menu spell-check-menu"\nng-show="$ctrl.open"\nng-style="{top: $ctrl.top, left: $ctrl.left}"\nng-class="{open: $ctrl.open, \'spell-check-menu-from-bottom\': $ctrl.layoutFromBottom}"\n>\n<ul class="dropdown-menu">\n  <li ng-repeat="suggestion in $ctrl.highlight.suggestions | limitTo:8">\n    <button\n      class="btn-link text-left dropdown-menu-button"\n      ng-click="$ctrl.replaceWord({ highlight: $ctrl.highlight, suggestion: suggestion })"\n    >\n      {{ suggestion }}\n    </a>\n  </li>\n  <li class="divider"></li>\n  <li>\n    <a href ng-click="$ctrl.learnWord({ highlight: $ctrl.highlight })">Add to Dictionary</a>\n  </li>\n</ul>\n</div>'}),n(144);function fc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var gc=ace.require("ace/undomanager").UndoManager,mc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.onChangeSession=this.onChangeSession.bind(this),this.onChange=this.onChange.bind(this)}var t,n,r;return t=e,(n=[{key:"onChangeSession",value:function(e){e.setUndoManager(new gc)}},{key:"onChange",value:function(e){var t=this;"remote"===e.origin&&setTimeout((function(){t.editor.getSession().getUndoManager().reset()}))}}])&&fc(t.prototype,n),r&&fc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),vc=[{caption:"\\begin{}",snippet:"\\begin{$1}",meta:"env",score:7.849662248028187},{caption:"\\end{}",snippet:"\\end{$1}",meta:"env",score:7.847906405228455},{caption:"\\usepackage[]{}",snippet:"\\usepackage[$1]{$2}",meta:"pkg",score:5.427890758130527},{caption:"\\item",snippet:"\\item",meta:"cmd",score:3.800886892251021},{caption:"\\item[]",snippet:"\\item[$1]",meta:"cmd",score:3.800886892251021},{caption:"\\section{}",snippet:"\\section{$1}",meta:"cmd",score:3.0952612541683835},{caption:"\\textbf{}",snippet:"\\textbf{$1}",meta:"cmd",score:2.627755982816738},{caption:"\\cite{}",snippet:"\\cite{$1}",meta:"cmd",score:2.341195220791228},{caption:"\\label{}",snippet:"\\label{$1}",meta:"cmd",score:1.897791904799601},{caption:"\\textit{}",snippet:"\\textit{$1}",meta:"cmd",score:1.6842996195493385},{caption:"\\includegraphics[]{}",snippet:"\\includegraphics[$1]{$2}",meta:"cmd",score:1.4595731795525781},{caption:"\\documentclass[]{}",snippet:"\\documentclass[$1]{$2}",meta:"cmd",score:1.4425339817971206},{caption:"\\documentclass{}",snippet:"\\documentclass{$1}",meta:"cmd",score:1.4425339817971206},{caption:"\\ref{}",snippet:"\\ref{$1}",meta:"cross-reference",score:.014379554883991673},{caption:"\\frac{}{}",snippet:"\\frac{$1}{$2}",meta:"cmd",score:1.4341091141105058},{caption:"\\subsection{}",snippet:"\\subsection{$1}",meta:"cmd",score:1.3890912739512353},{caption:"\\hline",snippet:"\\hline",meta:"cmd",score:1.3209538327406387},{caption:"\\caption{}",snippet:"\\caption{$1}",meta:"cmd",score:1.2569477427490174},{caption:"\\centering",snippet:"\\centering",meta:"cmd",score:1.1642881814937829},{caption:"\\vspace{}",snippet:"\\vspace{$1}",meta:"cmd",score:.9533807826673939},{caption:"\\title{}",snippet:"\\title{$1}",meta:"cmd",score:.9202908262245683},{caption:"\\author{}",snippet:"\\author{$1}",meta:"cmd",score:.8973590434087177},{caption:"\\author[]{}",snippet:"\\author[$1]{$2}",meta:"cmd",score:.8973590434087177},{caption:"\\maketitle",snippet:"\\maketitle",meta:"cmd",score:.7504160124360846},{caption:"\\textwidth",snippet:"\\textwidth",meta:"cmd",score:.7355328080889112},{caption:"\\newcommand{}{}",snippet:"\\newcommand{$1}{$2}",meta:"cmd",score:.7264891987129375},{caption:"\\newcommand{}[]{}",snippet:"\\newcommand{$1}[$2]{$3}",meta:"cmd",score:.7264891987129375},{caption:"\\date{}",snippet:"\\date{$1}",meta:"cmd",score:.7225518453076786},{caption:"\\emph{}",snippet:"\\emph{$1}",meta:"cmd",score:.7060308784832261},{caption:"\\textsc{}",snippet:"\\textsc{$1}",meta:"cmd",score:.6926466355384758},{caption:"\\multicolumn{}{}{}",snippet:"\\multicolumn{$1}{$2}{$3}",meta:"cmd",score:.5473606021405326},{caption:"\\input{}",snippet:"\\input{$1}",meta:"cmd",score:.4966021927742672},{caption:"\\alpha",snippet:"\\alpha",meta:"cmd",score:.49520006391384913},{caption:"\\in",snippet:"\\in",meta:"cmd",score:.4716039670146658},{caption:"\\mathbf{}",snippet:"\\mathbf{$1}",meta:"cmd",score:.4682018419466319},{caption:"\\right",snippet:"\\right",meta:"cmd",score:.4299239459457309},{caption:"\\left",snippet:"\\left",meta:"cmd",score:.42937815279867964},{caption:"\\sum",snippet:"\\sum",meta:"cmd",score:.42607994509619934},{caption:"\\chapter{}",snippet:"\\chapter{$1}",meta:"cmd",score:.422097569591803},{caption:"\\par",snippet:"\\par",meta:"cmd",score:.413853376001159},{caption:"\\lambda",snippet:"\\lambda",meta:"cmd",score:.39389600578684125},{caption:"\\subsubsection{}",snippet:"\\subsubsection{$1}",meta:"cmd",score:.3727781330132016},{caption:"\\bibitem{}",snippet:"\\bibitem{$1}",meta:"cmd",score:.3689547570562042},{caption:"\\bibitem[]{}",snippet:"\\bibitem[$1]{$2}",meta:"cmd",score:.3689547570562042},{caption:"\\text{}",snippet:"\\text{$1}",meta:"cmd",score:.3608680734736821},{caption:"\\setlength{}{}",snippet:"\\setlength{$1}{$2}",meta:"cmd",score:.354445763583904},{caption:"\\mathcal{}",snippet:"\\mathcal{$1}",meta:"cmd",score:.35084018920966636},{caption:"\\newpage",snippet:"\\newpage",meta:"cmd",score:.3277033727934986},{caption:"\\renewcommand{}{}",snippet:"\\renewcommand{$1}{$2}",meta:"cmd",score:.3267437011085663},{caption:"\\theta",snippet:"\\theta",meta:"cmd",score:.3210417159232142},{caption:"\\hspace{}",snippet:"\\hspace{$1}",meta:"cmd",score:.3147206476372336},{caption:"\\beta",snippet:"\\beta",meta:"cmd",score:.3061799530337638},{caption:"\\texttt{}",snippet:"\\texttt{$1}",meta:"cmd",score:.3019066753744355},{caption:"\\times",snippet:"\\times",meta:"cmd",score:.2957960629411553},{caption:"\\color{}",snippet:"\\color{$1}",meta:"cmd",score:.2864294797053033},{caption:"\\mu",snippet:"\\mu",meta:"cmd",score:.27635652476799255},{caption:"\\bibliography{}",snippet:"\\bibliography{$1}",meta:"cmd",score:.2659628337907604},{caption:"\\linewidth",snippet:"\\linewidth",meta:"cmd",score:.2639498312518439},{caption:"\\delta",snippet:"\\delta",meta:"cmd",score:.2620578600722735},{caption:"\\sigma",snippet:"\\sigma",meta:"cmd",score:.25940147926344487},{caption:"\\pi",snippet:"\\pi",meta:"cmd",score:.25920934567729714},{caption:"\\hat{}",snippet:"\\hat{$1}",meta:"cmd",score:.25264309033778715},{caption:"\\bibliographystyle{}",snippet:"\\bibliographystyle{$1}",meta:"cmd",score:.25122317941387773},{caption:"\\small",snippet:"\\small",meta:"cmd",score:.2447632045426295},{caption:"\\LaTeX",snippet:"\\LaTeX",meta:"cmd",score:.2334089308452787},{caption:"\\cdot",snippet:"\\cdot",meta:"cmd",score:.23029085545522762},{caption:"\\footnote{}",snippet:"\\footnote{$1}",meta:"cmd",score:.2253056071787701},{caption:"\\newtheorem{}{}",snippet:"\\newtheorem{$1}{$2}",meta:"cmd",score:.215689795055434},{caption:"\\Delta",snippet:"\\Delta",meta:"cmd",score:.21386475063892618},{caption:"\\tau",snippet:"\\tau",meta:"cmd",score:.21236188205859796},{caption:"\\hfill",snippet:"\\hfill",meta:"cmd",score:.2058248088519886},{caption:"\\leq",snippet:"\\leq",meta:"cmd",score:.20498894440637172},{caption:"\\footnotesize",snippet:"\\footnotesize",meta:"cmd",score:.2038592081252624},{caption:"\\large",snippet:"\\large",meta:"cmd",score:.20377416734108866},{caption:"\\sqrt{}",snippet:"\\sqrt{$1}",meta:"cmd",score:.20240160977404634},{caption:"\\epsilon",snippet:"\\epsilon",meta:"cmd",score:.2005136761359043},{caption:"\\Large",snippet:"\\Large",meta:"cmd",score:.1987771081149759},{caption:"\\rho",snippet:"\\rho",meta:"cmd",score:.1959287380541684},{caption:"\\omega",snippet:"\\omega",meta:"cmd",score:.19326783415115262},{caption:"\\mathrm{}",snippet:"\\mathrm{$1}",meta:"cmd",score:.19117752976172653},{caption:"\\boldsymbol{}",snippet:"\\boldsymbol{$1}",meta:"cmd",score:.18137737738638837},{caption:"\\gamma",snippet:"\\gamma",meta:"cmd",score:.17940276535431304},{caption:"\\clearpage",snippet:"\\clearpage",meta:"cmd",score:.1789117552185788},{caption:"\\infty",snippet:"\\infty",meta:"cmd",score:.17837290019711305},{caption:"\\phi",snippet:"\\phi",meta:"cmd",score:.17405809173097808},{caption:"\\partial",snippet:"\\partial",meta:"cmd",score:.17168102367966637},{caption:"\\include{}",snippet:"\\include{$1}",meta:"cmd",score:.1547080054979312},{caption:"\\address{}",snippet:"\\address{$1}",meta:"cmd",score:.1525055392611109},{caption:"\\quad",snippet:"\\quad",meta:"cmd",score:.15242755832392743},{caption:"\\paragraph{}",snippet:"\\paragraph{$1}",meta:"cmd",score:.152074250347974},{caption:"\\varepsilon",snippet:"\\varepsilon",meta:"cmd",score:.05411564201390573},{caption:"\\zeta",snippet:"\\zeta",meta:"cmd",score:.023330249803752954},{caption:"\\eta",snippet:"\\eta",meta:"cmd",score:.11088718379889091},{caption:"\\vartheta",snippet:"\\vartheta",meta:"cmd",score:.0025822992078068712},{caption:"\\iota",snippet:"\\iota",meta:"cmd",score:.0024774003791525486},{caption:"\\kappa",snippet:"\\kappa",meta:"cmd",score:.04887876299369008},{caption:"\\nu",snippet:"\\nu",meta:"cmd",score:.09206962821059342},{caption:"\\xi",snippet:"\\xi",meta:"cmd",score:.06496042899265699},{caption:"\\varpi",snippet:"\\varpi",meta:"cmd",score:.0007039358167790341},{caption:"\\varrho",snippet:"\\varrho",meta:"cmd",score:.0011279491613898612},{caption:"\\varsigma",snippet:"\\varsigma",meta:"cmd",score:.0010424880711234978},{caption:"\\upsilon",snippet:"\\upsilon",meta:"cmd",score:.00420715572598688},{caption:"\\varphi",snippet:"\\varphi",meta:"cmd",score:.03351251516668212},{caption:"\\chi",snippet:"\\chi",meta:"cmd",score:.043373492287805675},{caption:"\\psi",snippet:"\\psi",meta:"cmd",score:.09994508706163642},{caption:"\\Gamma",snippet:"\\Gamma",meta:"cmd",score:.04801549269801977},{caption:"\\Theta",snippet:"\\Theta",meta:"cmd",score:.038090902146599444},{caption:"\\Lambda",snippet:"\\Lambda",meta:"cmd",score:.032206594305977686},{caption:"\\Xi",snippet:"\\Xi",meta:"cmd",score:.01060997225400494},{caption:"\\Pi",snippet:"\\Pi",meta:"cmd",score:.021264671817473237},{caption:"\\Sigma",snippet:"\\Sigma",meta:"cmd",score:.05769642802079917},{caption:"\\Upsilon",snippet:"\\Upsilon",meta:"cmd",score:.00032875192955749566},{caption:"\\Phi",snippet:"\\Phi",meta:"cmd",score:.0538724950042562},{caption:"\\Psi",snippet:"\\Psi",meta:"cmd",score:.03056589143021648},{caption:"\\Omega",snippet:"\\Omega",meta:"cmd",score:.09490387997853639}];function bc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wc(e,t,n){return t&&yc(e.prototype,t),n&&yc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var xc=function(){function e(t,n){bc(this,e),this.doc=t,this.prefix=n}return wc(e,[{key:"parse",value:function(){var e,t,n,r=null;t="undefined"!=typeof window&&null!==window?window._ide:void 0,n=function(e){return e.browserIsSafari},(null!=t?n(t):void 0)&&(r=5e3);for(var a=[],l=[],d={},h=0;e=this.nextCommand();){if(h+=1,r&&h>r)return a;for(var p=this.doc,f=0;this.consumeArgument("[","]");)f++;for(var y=0;this.consumeArgument("{","}");)y++;var w="".concat(e,"\\").concat(f,"\\").concat(y);null!=this.prefix&&"\\".concat(e)===this.prefix?l.push([e,f,y]):null==d[w]&&(d[w]=!0,a.push([e,f,y])),this.doc=p}if(l.length>1){var x=l.sort((function(e,t){return t[1]+t[2]-(e[1]+e[2])}))[0];a.push(x)}return a}},{key:"nextCommand",value:function(){var e=this.doc.search(this.commandRegex);if(-1===e)return!1;var t=this.doc.match(this.commandRegex)[1];return this.doc=this.doc.substr(e+t.length+1),t}},{key:"consumeWhitespace",value:function(){var e=this.doc.match(/^[ \t\n]*/m)[0];return this.doc=this.doc.substr(e.length)}},{key:"consumeArgument",value:function(e,t){if(this.consumeWhitespace(),this.doc[0]===e){for(var n=1,r=1;r>0&&n<this.doc.length;)this.doc[n]===e?r++:this.doc[n]===t&&r--,n++;return 0===r&&(this.doc=this.doc.substr(n),!0)}return!1}}],[{key:"initClass",value:function(){this.prototype.commandRegex=/\\([a-zA-Z]{2,})/}}]),e}();xc.initClass();var jc=function(){function e(t){bc(this,e),this.metadataManager=t}return wc(e,[{key:"getCompletions",value:function(e,t,n,r,a){for(var l={},d=0,h=Array.from(vc);d<h.length;d++){l[h[d].caption.match(/\w+/)[0]]=!0}var p=this.metadataManager.getAllPackages(),f=[];for(var y in p)for(var w=p[y],x=0,j=Array.from(w);x<j.length;x++){var C=j[x];f.push(C),l[C.caption.match(/\w+/)[0]]=!0}for(var S=t.getValue(),_=new xc(S,r).parse(),k=[],E=0,A=Array.from(_);E<A.length;E++){var T=A[E];l[T[0]]||function(){var e="\\".concat(T[0]),t=e===r?99:50,n=e,a=1;O.a.times(T[1],(function(){return n+="[${".concat(a,"}]"),e+="[]",a++})),O.a.times(T[2],(function(){return n+="{${".concat(a,"}}"),e+="{}",a++})),k.push({caption:e,snippet:n,meta:"cmd",score:t})}()}return a(null,k=k.concat(vc,f))}},{key:"loadCommandsFromDoc",value:function(e){var t=new xc(e);return this.commands=t.parse()}},{key:"getSuggestions",value:function(e){var t=O.a.filter(this.commands,(function(t){return t[0].slice(0,e.length)===e}));return O.a.map(t,(function(t){var n,r,a="\\".concat(e),l="";O.a.times(t[1],(function(){return l+="[]"})),O.a.times(t[2],(function(){return l+="{}"}));var d=t[0].slice(e.length);return 0===t[1]+t[2]?(r=d,n=""):(r=d+l[0],n=l.slice(1)),{base:a,completion:d+l,completionBeforeCursor:r,completionAfterCursor:n}}))}}]),e}();var Oc=["abstract","align","align*","equation","equation*","gather","gather*","multline","multline*","split","verbatim","quote","center"],Cc={all:Oc.concat(["array","figure","tabular","table","list","enumerate","itemize","frame","thebibliography"]),withoutSnippets:Oc};function Sc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var kc=Array.from(Cc.withoutSnippets).map((function(e){return{caption:"\\begin{".concat(e,"}..."),snippet:"\\begin{".concat(e,"}\n\t$1\n\\end{").concat(e,"}"),meta:"env"}}));kc=kc.concat([{caption:"\\begin{array}...",snippet:"\\begin{array}{${1:cc}}\n\t$2 & $3 \\\\\\\\\n\t$4 & $5\n\\end{array}",meta:"env"},{caption:"\\begin{figure}...",snippet:"\\begin{figure}\n\t\\centering\n\t\\includegraphics{$1}\n\t\\caption{${2:Caption}}\n\t\\label{${3:fig:my_label}}\n\\end{figure}",meta:"env"},{caption:"\\begin{tabular}...",snippet:"\\begin{tabular}{${1:c|c}}\n\t$2 & $3 \\\\\\\\\n\t$4 & $5\n\\end{tabular}",meta:"env"},{caption:"\\begin{table}...",snippet:"\\begin{table}[$1]\n\t\\centering\n\t\\begin{tabular}{${2:c|c}}\n\t\t$3 & $4 \\\\\\\\\n\t\t$5 & $6\n\t\\end{tabular}\n\t\\caption{${7:Caption}}\n\t\\label{${8:tab:my_label}}\n\\end{table}",meta:"env"},{caption:"\\begin{list}...",snippet:"\\begin{list}\n\t\\item $1\n\\end{list}",meta:"env"},{caption:"\\begin{enumerate}...",snippet:"\\begin{enumerate}\n\t\\item $1\n\\end{enumerate}",meta:"env"},{caption:"\\begin{itemize}...",snippet:"\\begin{itemize}\n\t\\item $1\n\\end{itemize}",meta:"env"},{caption:"\\begin{frame}...",snippet:"\\begin{frame}{${1:Frame Title}}\n\t$2\n\\end{frame}",meta:"env"}]);var Ec={caption:"\\begin{document}...",snippet:"\\begin{document}\n$1\n\\end{document}",meta:"env"},Ac={caption:"\\begin{thebibliography}...",snippet:"\\begin{thebibliography}{$1}\n\\bibitem{$2}\n$3\n\\end{thebibliography}",meta:"env"};kc.push(Ec);var $c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getCompletions",value:function(e,t,n,r,a){var l,d=t.getValue(),h=function(e){for(var t,n=/^\\newenvironment{(\w+)}.*$/gm,r=[],a=0;t=n.exec(e);)if(r.push({name:t[1],whitespace:null}),(a+=1)>=1e3)return r;return r}(d),p=function(e){for(var t,n=/^([\t ]*)\\begin{(\w+)}.*\n([\t ]*)/gm,r=[],a=0;t=n.exec(e);){var l=t[3].replace(t[1]||"","");if(!Array.from(Cc.all).includes(t[2])&&"document"!==t[2]&&(r.push({name:t[2],whitespace:l}),(a+=1)>=1e3))return r;n.lastIndex=t.index+1}return r}(d);null!==/^\\begin{document}/m.exec(d)?-1!==(l=kc.indexOf(Ec))&&kc.splice(l,1):kc.push(Ec),function(e){return null!==/^\\begin{thebibliography}/m.exec(e)}(d)?-1!==(l=kc.indexOf(Ac))&&kc.splice(l,1):kc.push(Ac);for(var f={},y=0,w=Array.from(h);y<w.length;y++){var x=w[y];f[x.name]=x}for(var j=0,C=Array.from(p);j<C.length;j++){var S=C[j];f[S.name]=S}var _=O.a.values(f);return a(null,kc.concat(_.map((function(e){return{caption:"\\begin{".concat(e.name,"}..."),snippet:"\\begin{".concat(e.name,"}\n").concat(e.whitespace||"","$0\n\\end{").concat(e.name,"}"),meta:"env"}}))).concat(_.map((function(e){return{caption:"\\end{".concat(e.name,"}"),value:"\\end{".concat(e.name,"}"),meta:"env"}}))))}}])&&Sc(t.prototype,n),r&&Sc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Tc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rc=["inputenc","graphicx","amsmath","geometry","amssymb","hyperref","babel","color","xcolor","url","natbib","fontenc","fancyhdr","amsfonts","booktabs","amsthm","float","tikz","caption","setspace","multirow","array","multicol","titlesec","enumitem","ifthen","listings","blindtext","subcaption","times","bm","subfigure","algorithm","fontspec","biblatex","tabularx","microtype","etoolbox","parskip","calc","verbatim","mathtools","epsfig","wrapfig","lipsum","cite","textcomp","longtable","textpos","algpseudocode","enumerate","subfig","pdfpages","epstopdf","latexsym","lmodern","pifont","ragged2e","rotating","dcolumn","xltxtra","marvosym","indentfirst","xspace","csquotes","xparse","changepage","soul","xunicode","comment","mathrsfs","tocbibind","lastpage","algorithm2e","pgfplots","lineno","graphics","algorithmic","fullpage","mathptmx","todonotes","ulem","tweaklist","moderncvstyleclassic","collection","moderncvcompatibility","gensymb","helvet","siunitx","adjustbox","placeins","colortbl","appendix","makeidx","supertabular","ifpdf","framed","aliascnt","layaureo","authblk"],Ic=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadataManager=t}var t,n,r;return t=e,(n=[{key:"getCompletions",value:function(e,t,n,r,a){for(var l=Object.keys(this.metadataManager.getAllPackages()),d=[],h=0,p=Array.from(Rc);h<p.length;h++){var f=p[h];Array.from(l).includes(f)||d.push({caption:"\\usepackage{".concat(f,"}"),snippet:"\\usepackage{".concat(f,"}"),meta:"pkg"})}return d.push({caption:"\\usepackage{}",snippet:"\\usepackage{$1}",meta:"pkg",score:70}),a(null,d)}}])&&Tc(t.prototype,n),r&&Tc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Pc=(n(591),ace.require("ace/range").Range),Dc={getLastCommandFragment:function(e){var t;return(t=Dc.getLastCommandFragmentIndex(e))>-1?e.slice(t):null},getLastCommandFragmentIndex:function(e){var t;return(t=e.replace(/\[([^\]]*)\]/g,(function(e){return Array(e.length+1).join(".")})).match(/(\\[^\\]*)$/))?t.index:-1},getCommandNameFromFragment:function(e){return t=null!=e?e.match(/\\(\w+)\{/):void 0,n=function(e){return e[1]},null!=t?n(t):void 0;var t,n},getContext:function(e,t){var n=new Pc(t.row,0,t.row,t.column),r=e.getSession().getTextRange(n),a=Dc.getLastCommandFragment(r),l=Dc.getCommandNameFromFragment(a),d=new Pc(t.row,t.column,t.row,99999);return{lineUpToCursor:r,commandFragment:a,commandName:l,lineBeyondCursor:e.getSession().getTextRange(d)}}},Mc=Dc;function Lc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||qc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=qc(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function qc(e,t){if(e){if("string"==typeof e)return Nc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nc(e,t):void 0}}function Nc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Uc=ace.require("ace/range").Range,Hc=ace.require("ace/snippets").snippetManager,zc=function(){function e(t,n,r,a,l,d,h){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.editor=n,this.element=r,this.metadataManager=a,this.graphics=l,this.preamble=d,this.files=h,this.monkeyPatchAutocomplete(),this.$scope.$watch("autoComplete",(function(e){e?p.enable():p.disable()}));var f=function(e){p.onChange(e)};this.editor.on("changeSession",(function(e){e.oldSession.off("change",f),e.session.on("change",f)}))}var t,n,r;return t=e,(n=[{key:"enable",value:function(){var e=this;this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1});var t=new jc(this.metadataManager),n=new $c,r=new Ic(this.metadataManager,Mc),a=this.graphics,l=this.preamble,d=this.files,h={getCompletions:function(e,t,n,r,d){var h=Mc.getContext(e,n).commandFragment;if(h){var p=h.match(/^~?\\(includegraphics(?:\[.*])?){([^}]*, *)?(\w*)/);if(p){var f,y=p[1],w=l.getGraphicsPaths(),x=[],j=Fc(a.getGraphicsFiles());try{for(j.s();!(f=j.n()).done;){var O,C=f.value.path,S=Fc(w);try{for(S.s();!(O=S.n()).done;){var _=O.value;if(0===C.indexOf(_)){C=C.slice(_.length);break}}}catch(e){S.e(e)}finally{S.f()}x.push({caption:"\\".concat(y,"{").concat(C,"}"),value:"\\".concat(y,"{").concat(C,"}"),meta:"graphic",score:50})}}catch(e){j.e(e)}finally{j.f()}d(null,x)}}}},p=this.metadataManager,f={getCompletions:function(t,n,r,a,l){var h=Mc.getContext(t,r).commandFragment;if(h){var p=h.match(/^\\(input|include){(\w*)/);if(p){var f,y=p[1],w=[],x=Fc(d.getTeXFiles());try{for(x.s();!(f=x.n()).done;){var j=f.value;if(j.id!==e.$scope.docId&&!j.deleted&&j.path){var O=j.path,C=O.replace(/(.+)\.tex$/i,"$1");w.push({caption:"\\".concat(y,"{").concat(O,"}"),value:"\\".concat(y,"{").concat(C,"}"),meta:"file",score:50})}}}catch(e){x.e(e)}finally{x.f()}l(null,w)}}}},y={getCompletions:function(e,t,n,r,a){var l=Mc.getContext(e,n).commandFragment;if(l){var d=l.match(/^~?\\([a-zA-Z]*ref){([^}]*, *)?(\w*)/);if(d){var h=d[1],f=[];"ref"!==h&&f.push({caption:"\\".concat(h,"{}"),snippet:"\\".concat(h,"{}"),meta:"cross-reference",score:60});var y,w=Fc(p.getAllLabels());try{for(w.s();!(y=w.n()).done;){var x=y.value;f.push({caption:"\\".concat(h,"{").concat(x,"}"),value:"\\".concat(h,"{").concat(x,"}"),meta:"cross-reference",score:50})}}catch(e){w.e(e)}finally{w.f()}a(null,f)}}}},w=this.$scope.$root._references,x={getCompletions:function(e,t,n,r,a){var l=Mc.getContext(e,n).commandFragment;if(l){var d=l.match(/^~?\\([a-z]*cite[a-z]*(?:\[.*])?){([^}]*, *)?(\w*)/);if(d){var h=Lc(d,3),p=(h[0],h[1]),f=h[2];null==f&&(f="");var y=f.length>8?"…,":f,x=[];x.push({caption:"\\".concat(p,"{}"),snippet:"\\".concat(p,"{}"),meta:"reference",score:60}),w.keys&&w.keys.length>0?(w.keys.forEach((function(e){null!=e&&x.push({caption:"\\".concat(p,"{").concat(y).concat(e,"}"),value:"\\".concat(p,"{").concat(f).concat(e,"}"),meta:"reference",score:50})})),a(null,x)):a(null,x)}}}};this.editor.completers=[t,n,r,x,y,h,f]}},{key:"disable",value:function(){return this.editor.setOptions({enableBasicAutocompletion:!1,enableSnippets:!1})}},{key:"onChange",value:function(e){var t,n=this,r=this.editor.getCursorPosition(),a=e.end,l=Mc.getContext(this.editor,a),d=l.lineUpToCursor,h=l.commandFragment;if(!((t=d.indexOf("%"))>-1&&"\\"!==d[t-1])){var p="\\"===d.slice(-1),f=d.slice(-2);if(!/^\\[^a-zA-Z]$/.test(f)){"remote"!==e.origin&&"insert"===e.action&&a.row===r.row&&a.column===r.column+1&&((null!=h?h.length:void 0)>2||p)&&setTimeout((function(){n.editor.execCommand("startAutocomplete")}),0);var y=e.lines[0].match(/\\(\w+){}/);return"insert"===e.action&&y&&y[1]&&/(begin|end|[a-zA-Z]*ref|usepackage|[a-z]*cite[a-z]*|input|include)/.test(y[1])?setTimeout((function(){n.editor.execCommand("startAutocomplete")}),0):void 0}this.editor.completer&&this.editor.completer.detach()}}},{key:"monkeyPatchAutocomplete",value:function(){var e=this,t=ace.require("ace/autocomplete").Autocomplete,n=ace.require("ace/autocomplete/util");null==t.prototype._insertMatch&&(t.prototype._insertMatch=t.prototype.insertMatch,t.prototype.insertMatch=function(e){var n=this.editor,r=n.getCursorPosition(),a=new Uc(r.row,r.column,r.row,r.column+1),l=n.session.getTextRange(a);if(/^\\\w+(\[[\w\\,=. ]*\])?{/.test(this.completions.filterText)&&"}"===l&&n.session.remove(a),null==e){var d=this.completions,h=this.popup;(e=h.getData(h.getRow())).completer={insertMatch:function(e,t){var n,r=Fc(e.selection.getAllRanges());try{for(r.s();!(n=r.n()).done;){a=n.value;var l=O.a.clone(a),h=O.a.clone(a),p=e.getSession().getTextRange(new Uc(a.start.row,0,a.start.row,a.start.column)),f=Mc.getLastCommandFragmentIndex(p);-1!==f?l.start.column=f:l.start.column-=d.filterText.length,e.session.remove(l);var y=e.getSession().getTextRange(new Uc(h.start.row,h.start.column,h.end.row,99999));if(y){var w=y.match(/^([a-zA-Z0-9]+)\{/);if(w){var x=w[1];h.end.column+=x.length-d.filterText.length,e.session.remove(h),null!=t.snippet&&(t.snippet=t.snippet.replace(/[{[].*[}\]]/,"")),null!=t.caption&&(t.caption=t.caption.replace(/[{[].*[}\]]/,"")),null!=t.value&&(t.value=t.value.replace(/[{[].*[}\]]/,""))}var j=y.match(/^([\w._-]+)\}(.*)/);if(j){var C=j[1];j[2]&&(h.end.column=h.start.column+C.length+1),e.session.remove(h)}}}}catch(e){r.e(e)}finally{r.f()}t.snippet?Hc.insertSnippet(e,t.snippet):e.execCommand("insertstring",t.value||t)}}}t.prototype._insertMatch.call(this,e)},t.startCommand={name:"startAutocomplete",exec:function(n){n.completer||(n.completer=new t),n.completer.autoInsert=!1,n.completer.autoSelect=!0,n.completer.showPopup(n),n.completer.cancelContextMenu();var r=$(null!=n.completer.popup?n.completer.popup.container:void 0);r.css({"font-size":e.$scope.fontSize+"px"});var a=n.completer.completions&&n.completer.completions.filtered;if(a){var l=O.a.max(a.map((function(e){return e.caption.length}))),d=O.a.max(a.map((function(e){return e.meta.length}))),h=n.renderer.characterWidth,p=Math.max(Math.min(Math.round(l*h+d*h+5*h),700),280);r.css({width:"".concat(p,"px")})}0===a.length&&n.completer.detach()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"}),n.retrievePrecedingIdentifier=function(e,t,n){for(var r=0,a=t-1;a<=0;a++)if("\n"===e[a]){r=a+1;break}var l=e.slice(r,t);return Mc.getLastCommandFragment(l)||""}}}])&&Bc(t.prototype,n),r&&Bc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Vc=(n(630),n(592));function Wc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kc(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Kc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yc=new RegExp("\\\\(label|[a-z]{0,16}ref|usepackage|begin|end|[a-z]{0,16}cite|input|include|includegraphics)(\\[[^\\]]*\\])?\\{[^}]*\\}","g"),Xc=/\\?(?:['A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D])+/g,Jc=function(){function e(t,n,r,a,l){var d=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onChange=this.onChange.bind(this),this.onSessionChange=this.onSessionChange.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onScroll=this.onScroll.bind(this),this.learnWord=this.learnWord.bind(this),this.$scope=t,this.$http=r,this.$q=a,this.adapter=l,this.$scope.spellMenu={open:!1,top:"0px",left:"0px",suggestions:[]},this.inProgressRequest=null,this.changedLines=[],this.firstCheck=!0,this.$scope.$watch("spellCheckLanguage",(function(e,t){if(e!==t&&null!=t)return d.reInitForLangChange()})),this.$scope.replaceWord=this.adapter.replaceWord,this.$scope.learnWord=this.learnWord,this.cache=n.get("spellCheck-cache")||n("spellCheck-cache",{capacity:15e3}),this.selectedHighlightContents=null,this.ignoredMisspellings=new Set(Vc.a.concat(Object(le.a)("ol-learnedWords"))),$(document).on("click",(function(e){if(!window._ide.browserIsSafari||!e.ctrlKey)return 3!==e.which&&d.closeContextMenu(),!0}))}var t,n,r;return t=e,(n=[{key:"init",value:function(){this.changedLines=Array(this.adapter.getLineCount()).fill(!0),this.firstCheck=!0,this.isSpellCheckEnabled()&&this.runSpellCheckSoon(500)}},{key:"reInitForLangChange",value:function(){this.adapter.highlightedWordManager.reset(),this.init()}},{key:"isSpellCheckEnabled",value:function(){return!(!this.$scope.spellCheck||!this.$scope.spellCheckLanguage||""===this.$scope.spellCheckLanguage)}},{key:"onChange",value:function(e){var t=this;this.isSpellCheckEnabled()&&(this.$scope.$applyAsync((function(){t.selectedHighlightContents&&t.selectedHighlightContents!==t.adapter.getSelectionContents()&&t.closeContextMenu()})),this.markLinesAsUpdated(this.adapter.normalizeChangeEvent(e)),this.adapter.highlightedWordManager.clearHighlightTouchingRange(e),this.runSpellCheckSoon(500))}},{key:"onSessionChange",value:function(){this.adapter.highlightedWordManager.reset(),null!=this.inProgressRequest&&this.inProgressRequest.abort(),this.isSpellCheckEnabled()&&this.runSpellCheckSoon(500)}},{key:"onContextMenu",value:function(e){this.closeContextMenu(),this.openContextMenu(e)}},{key:"onScroll",value:function(){this.isSpellCheckEnabled()&&this.runSpellCheckSoon(500),this.closeContextMenu()}},{key:"openContextMenu",value:function(e){var t=this,n=this.adapter.getCoordsFromContextMenuEvent(e),r=this.adapter.getHighlightFromCoords(n),a=this.adapter.isContextMenuEventOnBottomHalf(e);r&&(this.adapter.preventContextMenuEventDefault(e),this.adapter.selectHighlightedWord(r),this.$scope.$applyAsync((function(){t.selectedHighlightContents=t.adapter.getSelectionContents(),t.$scope.spellMenu={open:!0,top:n.y+"px",left:n.x+"px",layoutFromBottom:a,highlight:r}})))}},{key:"closeContextMenu",value:function(){var e=this;(null!=this.$scope?this.$scope.spellMenu:void 0)&&!1!==this.$scope.spellMenu.open&&(this.selectedHighlightContents=null,this.$scope.$applyAsync((function(){e.$scope.spellMenu.open=!1})))}},{key:"learnWord",value:function(e){this.apiRequest("/learn",{word:e.word}),this.adapter.highlightedWordManager.removeWord(e.word);var t=this.$scope.spellCheckLanguage;this.cache.put("".concat(t,":").concat(e.word),!0),this.ignoredMisspellings.add(e.word)}},{key:"markLinesAsUpdated",value:function(e){var t=this,n=e.start,r=e.end;"insert"===e.action?(this.changedLines[n.row]=!0,function(){for(var e=r.row-n.row;e--;)t.changedLines.splice(n.row,0,!0)}()):"remove"===e.action&&(this.changedLines[n.row]=!0,function(){for(var e=r.row-n.row;e--;)t.changedLines.splice(n.row+1,1)}())}},{key:"runSpellCheckSoon",value:function(e){var t=this;null==e&&(e=1e3),null!=this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){delete t.timeoutId,t.runSpellCheck()}),e)}},{key:"runSpellCheck",value:function(){var e,t,n,r,a=this,l=this.getRowNumsToCheck(),d=this.$scope.spellCheckLanguage,h=this.getWords(l),p=h.words,f=h.positions,y=[],w={},x=[],j=[];for(t=e=0;e<p.length;e++,t=e){r=p[t],n="".concat(d,":").concat(r),null==w[n]&&(w[n]=this.cache.get(n));var O=w[n];null==O?(x.push(p[t]),j.push(f[t])):!0===O||y.push({column:f[t].column,row:f[t].row,word:r,suggestions:O})}f=j;var C=function(e){null==a.timeoutId&&(a.firstCheck=!1,l.forEach((function(e){a.changedLines[e]=!1,a.adapter.highlightedWordManager.clearRow(e)})),e.map((function(e){return a.adapter.highlightedWordManager.addHighlight(e)})))};(p=x).length?this.inProgressRequest=this.apiRequest("/check",{language:d,words:p,skipLearnedWords:!0},(function(e,l){if(delete a.inProgressRequest,null!=e||null==l||null==l.misspellings)return null;var h,x=[],j=Wc(l.misspellings);try{for(j.s();!(h=j.n()).done;){var O=h.value;r=p[O.index];var S=f[O.index];x[O.index]=!0,y.push({column:S.column,row:S.row,word:r,suggestions:O.suggestions}),n="".concat(d,":").concat(r),w[n]||(a.cache.put(n,O.suggestions),w[n]=!0)}}catch(e){j.e(e)}finally{j.f()}for(t=0;t<p.length;t++)r=p[t],x[t]||(n="".concat(d,":").concat(r),w[n]||(a.cache.put(n,!0),w[n]=!0));C(y)})):C(y)}},{key:"apiRequest",value:function(e,t,n){null==n&&(n=function(e,t){console.error(e)}),t.token=window.user.id,t._csrf=window.csrfToken;var r=this.$q.defer(),a={timeout:r.promise};return this.$http.post("/spelling".concat(e),t,a).then((function(e){return n(null,e.data)})).catch((function(e){return n(new Error("api failure"))})),{abort:function(){return r.resolve()}}}},{key:"getWords",value:function(e){for(var t=this.adapter.getLinesByRows(e),n=[],r=[],a=0;a<t.length;a++){var l=t[a],d=e[a];l=this.blankOutBlacklistedCommands(l);var h=void 0;for(Xc.lastIndex=0;h=Xc.exec(l);){var p=h[0];"\\"!==p.slice(0,1)&&("'"===p[0]&&(p=p.slice(1)),"'"===p[p.length-1]&&(p=p.slice(0,-1)),this.ignoredMisspellings.has(p)||(r.push({row:d,column:h.index}),n.push(p)))}}return{words:n,positions:r}}},{key:"getRowNumsToCheck",value:function(){var e=this.adapter.getFirstVisibleRowNum(),t=this.adapter.getLastVisibleRowNum(),n=e,r=t;if(this.firstCheck){var a=this.adapter.getLineCount()-1,l=t-e+1;n=Math.max(0,e-2*l),r=Math.min(t+2*l,a)}return this.changedLines.reduce((function(e,t,a){return t&&a>=n&&a<=r&&e.push(a),e}),[])}},{key:"blankOutBlacklistedCommands",value:function(e){return e.replace(Yc,(function(e){return Array(e.length+1).join(".")}))}}])&&Gc(t.prototype,n),r&&Gc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(e,t,n){return t&&Qc(e.prototype,t),n&&Qc(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function eu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var tu=ace.require("ace/range").Range,nu=Zc((function e(t,n,r){eu(this,e),this.markerId=t,this.range=n,this.word=r.word,this.suggestions=r.suggestions})),ru=function(){function e(t){eu(this,e),this.editor=t,this.reset()}return Zc(e,[{key:"reset",value:function(){var e=this;return null!=this.highlights&&this.highlights.forEach((function(t){return e.editor.getSession().removeMarker(t.markerId)})),this.highlights=[]}},{key:"addHighlight",value:function(e){var t=this.editor.getSession(),n=t.getDocument(),r=new tu;r.start=n.createAnchor({row:e.row,column:e.column}),r.end=n.createAnchor({row:e.row,column:e.column+e.word.length}),r.end.$insertRight=!0;var a=t.addMarker(r,"spelling-highlight","text",!1);return this.highlights.push(new nu(a,r,e))}},{key:"removeHighlight",value:function(e){return this.editor.getSession().removeMarker(e.markerId),this.highlights=this.highlights.filter((function(t){return t!==e}))}},{key:"removeWord",value:function(e){var t=this;return this.highlights.filter((function(t){return t.word===e})).forEach((function(e){return t.removeHighlight(e)}))}},{key:"clearRow",value:function(e){var t=this;return this.highlights.filter((function(t){return t.range.start.row===e})).forEach((function(e){return t.removeHighlight(e)}))}},{key:"findHighlightWithinRange",value:function(e){var t=this;return O.a.find(this.highlights,(function(n){return t._doesHighlightOverlapRange(n,e.start,e.end)}))}},{key:"_doesHighlightOverlapRange",value:function(e,t,n){var r=e.range.start.row,a=e.range.start.column,l=e.range.end.column,d=r<t.row||r===t.row&&l<=t.column,h=r>n.row||r===n.row&&a>=n.column;return!(d||h)}},{key:"clearHighlightTouchingRange",value:function(e){var t=this,n=O.a.find(this.highlights,(function(n){return t._doesHighlightTouchRange(n,e.start,e.end)}));if(n)return this.removeHighlight(n)}},{key:"_doesHighlightTouchRange",value:function(e,t,n){var r=e.range.start.row,a=e.range.start.column,l=e.range.end.column,d=a<=t.column&&l>=t.column,h=a<=n.column&&l>=n.column;return r===t.row&&(d||h)}}]),e}();function iu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ou=ace.require("ace/range").Range,au=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.replaceWord=this.replaceWord.bind(this),this.editor=t,this.highlightedWordManager=new ru(this.editor)}var t,n,r;return t=e,(n=[{key:"getLines",value:function(){return this.editor.getValue().split("\n")}},{key:"getLineCount",value:function(){return this.editor.session.getLength()}},{key:"getFirstVisibleRowNum",value:function(){return this.editor.renderer.layerConfig.firstRow}},{key:"getLastVisibleRowNum",value:function(){return this.editor.renderer.layerConfig.lastRow}},{key:"getLinesByRows",value:function(e){var t=this;return e.map((function(e){return t.editor.session.doc.getLine(e)}))}},{key:"getSelectionContents",value:function(){return this.editor.getSelectedText()}},{key:"normalizeChangeEvent",value:function(e){return e}},{key:"getCoordsFromContextMenuEvent",value:function(e){return e.domEvent.stopPropagation(),{x:e.domEvent.clientX,y:e.domEvent.clientY}}},{key:"preventContextMenuEventDefault",value:function(e){e.domEvent.preventDefault()}},{key:"getHighlightFromCoords",value:function(e){var t=this.editor.renderer.screenToTextCoordinates(e.x,e.y);return this.highlightedWordManager.findHighlightWithinRange({start:t,end:t})}},{key:"isContextMenuEventOnBottomHalf",value:function(e){var t=e.domEvent.clientY,n=e.target.container.getBoundingClientRect();return(t-n.top)/n.height>.5}},{key:"selectHighlightedWord",value:function(e){var t=e.range.start.row,n=e.range.start.column,r=e.range.end.column;this.editor.getSession().getSelection().setSelectionRange(new ou(t,n,t,r))}},{key:"replaceWord",value:function(e,t){var n=e.range.start.row,r=e.range.start.column,a=e.range.end.column;this.editor.getSession().replace(new ou(n,r,n,a),t),this.editor.focus()}}])&&iu(t.prototype,n),r&&iu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),su=n(91);function lu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cu=ace.require("ace/range").Range,uu=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.editor=n,this.element=r,this.markerIds=[],this.labels=[],this.$scope.annotationLabel={show:!1,right:"auto",left:"auto",top:"auto",bottom:"auto",backgroundColor:"black",text:""},this.$scope.updateLabels={updatesAbove:0,updatesBelow:0},this.$scope.$watch("highlights",(function(e){return a.redrawAnnotations()})),this.$scope.$watch("theme",(function(e){return a.redrawAnnotations()})),this.editor.on("mousemove",(function(e){var t=a.editor.renderer.screenToTextCoordinates(e.clientX,e.clientY);return e.position=t,a.showAnnotationLabels(t)}));var l=function(){return a.updateShowMoreLabels()};this.editor.getSession().on("changeScrollTop",l),this.$scope.$watch("text",(function(){if(a.$scope.navigateHighlights)return setTimeout((function(){return a.scrollToFirstHighlight()}),0)})),this.editor.on("changeSession",(function(e){return null!=e.oldSession&&e.oldSession.off("changeScrollTop",l),e.session.on("changeScrollTop",l),a.redrawAnnotations()})),this.$scope.gotoHighlightBelow=function(){if(null!=a.firstHiddenHighlightAfter)return a.editor.scrollToLine(a.firstHiddenHighlightAfter.end.row,!0,!1)},this.$scope.gotoHighlightAbove=function(){if(null!=a.lastHiddenHighlightBefore)return a.editor.scrollToLine(a.lastHiddenHighlightBefore.start.row,!0,!1)}}var t,n,r;return t=e,(n=[{key:"redrawAnnotations",value:function(){var e=this;this._clearMarkers(),this._clearLabels();for(var t=0,n=Array.from(this.$scope.highlights||[]);t<n.length;t++)!function(t){var n=su.a.getColorScheme(t.hue,e.element);null!=t.cursor?(e.labels.push({text:t.label,range:new cu(t.cursor.row,t.cursor.column,t.cursor.row,t.cursor.column+1),colorScheme:n,snapToStartOfRange:!0}),e._drawCursor(t,n)):null!=t.highlight?(e.labels.push({text:t.label,range:new cu(t.highlight.start.row,t.highlight.start.column,t.highlight.end.row,t.highlight.end.column),colorScheme:n}),e._drawHighlight(t,n)):null!=t.strikeThrough&&(e.labels.push({text:t.label,range:new cu(t.strikeThrough.start.row,t.strikeThrough.start.column,t.strikeThrough.end.row,t.strikeThrough.end.column),colorScheme:n}),e._drawStrikeThrough(t,n))}(n[t]);return this.updateShowMoreLabels()}},{key:"showAnnotationLabels",value:function(e){for(var t,n,r=this,a=null,l=0,d=Array.from(this.labels||[]);l<d.length;l++){var h=d[l];h.range.contains(e.row,e.column)&&(a=h)}if(null!=a){var p,f,y,w,x,j=$(this.editor.renderer.container).find(".ace_scroller");j.append(this.element.find(".annotation-label")),f=a.snapToStartOfRange?this.editor.renderer.textToScreenCoordinates(a.range.start.row,a.range.start.column):this.editor.renderer.textToScreenCoordinates(e.row,e.column);var O=j.offset(),C=j.height();f.pageX=f.pageX-O.left,f.pageY=f.pageY-O.top,f.pageY>2*this.editor.renderer.lineHeight?(x="auto",p=C-f.pageY):(x=f.pageY+this.editor.renderer.lineHeight,p="auto"),this.$scope.$apply((function(){return r.$scope.annotationLabel.text=a.text,r.$scope.annotationLabel.show=!0}));var S=this.element.find(".annotation-label");return f.pageX+S.outerWidth()<j.width()?(y=f.pageX,w="auto"):(w=0,y="auto"),this.$scope.$apply((function(){return r.$scope.annotationLabel={show:!0,left:y,right:w,bottom:p,top:x,backgroundColor:a.colorScheme.labelBackgroundColor,text:a.text}}))}if(!1!==(t=null!=this.$scope?this.$scope.annotationLabel:void 0,n=function(e){return e.show},null!=t?n(t):void 0))return this.$scope.$apply((function(){return r.$scope.annotationLabel.show=!1}))}},{key:"updateShowMoreLabels",value:function(){var e=this;if(this.$scope.navigateHighlights)return setTimeout((function(){var t=e.editor.getFirstVisibleRow(),n=e.editor.getLastVisibleRow(),r=0,a=0;e.lastHiddenHighlightBefore=null,e.firstHiddenHighlightAfter=null;for(var l=0,d=Array.from(e.$scope.highlights||[]);l<d.length;l++){var h=d[l],p=h.highlight||h.strikeThrough;null!=p&&(p.start.row<t&&(r+=1,e.lastHiddenHighlightBefore=p),p.end.row>n&&(a+=1,e.firstHiddenHighlightAfter||(e.firstHiddenHighlightAfter=p)))}return e.$scope.$apply((function(){return e.$scope.updateLabels={highlightsBefore:r,highlightsAfter:a}}))}),100)}},{key:"scrollToFirstHighlight",value:function(){var e=this;return function(){for(var t=0,n=Array.from(e.$scope.highlights||[]);t<n.length;t++){var r=n[t],a=r.highlight||r.strikeThrough;if(null!=a){e.editor.scrollToLine(a.start.row,!0,!1);break}}return[]}()}},{key:"_clearMarkers",value:function(){for(var e=0,t=Array.from(this.markerIds);e<t.length;e++){var n=t[e];this.editor.getSession().removeMarker(n)}return this.markerIds=[]}},{key:"_clearLabels",value:function(){return this.labels=[]}},{key:"_drawCursor",value:function(e,t){return this._addMarkerWithCustomStyle(new cu(e.cursor.row,e.cursor.column,e.cursor.row,e.cursor.column+1),"annotation remote-cursor",!1,"border-color: ".concat(t.cursor,";"))}},{key:"_drawHighlight",value:function(e,t){return this._addMarkerWithCustomStyle(new cu(e.highlight.start.row,e.highlight.start.column,e.highlight.end.row,e.highlight.end.column),"annotation highlight",!1,"background-color: ".concat(t.highlightBackgroundColor))}},{key:"_drawStrikeThrough",value:function(e,t){return this._addMarkerWithCustomStyle(new cu(e.strikeThrough.start.row,e.strikeThrough.start.column,e.strikeThrough.end.row,e.strikeThrough.end.column),"annotation strike-through-background",!1,"background-color: ".concat(t.strikeThroughBackgroundColor)),this._addMarkerWithCustomStyle(new cu(e.strikeThrough.start.row,e.strikeThrough.start.column,e.strikeThrough.end.row,e.strikeThrough.end.column),"annotation strike-through-foreground",!0,"color: ".concat(t.strikeThroughForegroundColor,";"))}},{key:"_addMarkerWithCustomStyle",value:function(e,t,n,r){var a;return a=n?this.editor.renderer.$markerFront:this.editor.renderer.$markerBack,this.markerIds.push(this.editor.getSession().addMarker(e,t,(function(e,n,l,d,h){return n.isMultiLine()?a.drawTextMarker(e,n,t,h,r):a.drawSingleLineMarker(e,n,"".concat(t," ace_start"),h,0,r)}),n))}}])&&lu(t.prototype,n),r&&lu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hu,pu=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storePositionAndLine=this.storePositionAndLine.bind(this),this.jumpToPositionInNewDoc=this.jumpToPositionInNewDoc.bind(this),this.onUnload=this.onUnload.bind(this),this.onCursorChange=this.onCursorChange.bind(this),this.onSyncToPdf=this.onSyncToPdf.bind(this),this.$scope=t,this.adapter=n,this.localStorage=r,this.$scope.$on("editorInit",this.jumpToPositionInNewDoc),this.$scope.$on("beforeChangeDocument",this.storePositionAndLine),this.$scope.$on("afterChangeDocument",this.jumpToPositionInNewDoc),this.$scope.$on("changeEditor",this.storePositionAndLine),this.$scope.$on("".concat(this.$scope.name,":gotoLine"),(function(e,t,n,r){if(null!=t)return setTimeout((function(){a.adapter.gotoLine(t,n),r&&a.onSyncToPdf()}),10)})),this.$scope.$on("".concat(this.$scope.name,":gotoOffset"),(function(e,t){if(null!=t)return setTimeout((function(){return a.adapter.gotoOffset(t)}),10)})),this.$scope.$on("".concat(this.$scope.name,":clearSelection"),(function(e){return a.adapter.clearSelection()}))}var t,n,r;return t=e,(n=[{key:"storePositionAndLine",value:function(){return this.storeCursorPosition(),this.storeFirstVisibleLine()}},{key:"jumpToPositionInNewDoc",value:function(){var e=this;return this.doc_id=null!=this.$scope.sharejsDoc?this.$scope.sharejsDoc.doc_id:void 0,setTimeout((function(){return e.gotoStoredPosition()}),0)}},{key:"onUnload",value:function(){return this.storeCursorPosition(),this.storeFirstVisibleLine()}},{key:"onCursorChange",value:function(){return this.emitCursorUpdateEvent()}},{key:"onSyncToPdf",value:function(){return this.$scope.$emit("cursor:".concat(this.$scope.name,":syncToPdf"))}},{key:"storeFirstVisibleLine",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return e.firstVisibleLine=this.adapter.getEditorScrollPosition(),this.localStorage("doc.position.".concat(this.doc_id),e)}}},{key:"storeCursorPosition",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return e.cursorPosition=this.adapter.getCursor(),this.localStorage("doc.position.".concat(this.doc_id),e)}}},{key:"emitCursorUpdateEvent",value:function(){var e=this.adapter.getCursor();this.$scope.$emit("cursor:".concat(this.$scope.name,":update"),e),window.dispatchEvent(new CustomEvent("cursor:".concat(this.$scope.name,":update"),{detail:e}))}},{key:"gotoStoredPosition",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return this.adapter.setCursor(e),this.adapter.setEditorScrollPosition(e)}}}])&&du(t.prototype,n),r&&du(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),fu=hu={rangeToShareJs:function(e,t){for(var n=0,r=0;r<t.length;r++){var a=t[r];n+=r<e.row?a.length:e.column}return n+=e.row},changeToShareJs:function(e,t){var n=hu.rangeToShareJs(e.start,t),r=e.lines.join("\n");switch(e.action){case"insert":return{i:r,p:n};case"remove":return{d:r,p:n};default:throw new Error("unknown action: ".concat(e.action))}},shareJsOffsetToRowColumn:function(e,t){var n=0;for(n=0;n<t.length;n++){if(e<=t[n].length)break;e-=t[n].length+1}return{row:n,column:e}}};function gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t}var t,n,r;return t=e,(n=[{key:"getCursor",value:function(){return this.editor.getCursorPosition()}},{key:"getEditorScrollPosition",value:function(){return this.editor.getFirstVisibleRow()}},{key:"setCursor",value:function(e){return e=e.cursorPosition||{row:0,column:0},this.editor.moveCursorToPosition(e)}},{key:"setEditorScrollPosition",value:function(e){return e=e.firstVisibleLine||0,this.editor.scrollToLine(e)}},{key:"clearSelection",value:function(){return this.editor.selection.clearSelection()}},{key:"gotoLine",value:function(e,t){return this.editor.gotoLine(e,t),this.editor.scrollToLine(e,!0,!0),this.editor.focus()}},{key:"gotoOffset",value:function(e){var t=this.editor.getSession().getDocument().getAllLines(),n=fu.shareJsOffsetToRowColumn(e,t);return this.gotoLine(n.row+1,n.column)}}])&&gu(t.prototype,n),r&&gu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function vu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wu=ace.require("ace/range").Range,xu=function(){function e(t,n,r,a){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._doneUpdateThisLoop=!1,this._pendingUpdates=!1,this.onChangeSession=this.onChangeSession.bind(this),this.onChangeSelection=this.onChangeSelection.bind(this),this.onCut=this.onCut.bind(this),this.onPaste=this.onPaste.bind(this),this.onResize=this.onResize.bind(this),this.tearDown=this.tearDown.bind(this),this.$scope=t,this.editor=n,this.element=r,this.adapter=a,this._scrollTimeout=null,this.changingSelection=!1,null==window.trackChangesManager&&(window.trackChangesManager=this),this.$scope.$watch("trackChanges",(function(e){null!=e&&l.setTrackChanges(e)})),this.$scope.$watch("sharejsDoc",(function(e,t){null!=e&&(null!=t&&l.disconnectFromDoc(t),l.setTrackChanges(l.$scope.trackChanges),l.connectToDoc(e))})),this.$scope.$on("comment:add",(function(e,t,n,r){l.addCommentToSelection(t,n,r)})),this.$scope.$on("comment:select_line",(function(e){l.selectLineIfNoSelection()})),this.$scope.$on("changes:accept",(function(e,t){l.acceptChangeIds(t)})),this.$scope.$on("changes:reject",(function(e,t){l.rejectChangeIds(t)})),this.$scope.$on("comment:remove",(function(e,t){l.removeCommentId(t)})),this.$scope.$on("comment:resolve_threads",(function(e,t){l.hideCommentsByThreadIds(t)})),this.$scope.$on("comment:unresolve_thread",(function(e,t){l.showCommentByThreadId(t)})),this.$scope.$on("review-panel:recalculate-screen-positions",(function(){l.recalculateReviewEntriesScreenPositions()})),this._resetCutState()}var t,n,r;return t=e,(n=[{key:"onChangeSession",value:function(e){this.clearAnnotations(),this.redrawAnnotations(),this.editor&&this.editor.session.on("changeScrollTop",this.onChangeScroll.bind(this))}},{key:"onChangeScroll",value:function(){var e=this;if(null==this._scrollTimeout)return this._scrollTimeout=setTimeout((function(){return e.recalculateVisibleEntries(),e.$scope.$apply(),e._scrollTimeout=null}),200)}},{key:"onChangeSelection",value:function(){var e=this;if(!this.changingSelection)return this.changingSelection=!0,this.$scope.$evalAsync((function(){return e.changingSelection=!1,e.updateFocus()}))}},{key:"onResize",value:function(){this.recalculateReviewEntriesScreenPositions()}},{key:"connectToDoc",value:function(e){var t=this;this.rangesTracker=e.ranges,this.setTrackChanges(this.$scope.trackChanges),e.on("ranges:dirty",(function(){t.updateAnnotations()})),e.on("ranges:clear",(function(){t.clearAnnotations()})),e.on("ranges:redraw",(function(){t.redrawAnnotations()}))}},{key:"disconnectFromDoc",value:function(e){e.off("ranges:clear"),e.off("ranges:redraw"),e.off("ranges:dirty")}},{key:"tearDown",value:function(){this.adapter.tearDown()}},{key:"setTrackChanges",value:function(e){e?null!=this.$scope.sharejsDoc&&(this.$scope.sharejsDoc.track_changes_as=window.user.id||"anonymous"):null!=this.$scope.sharejsDoc&&(this.$scope.sharejsDoc.track_changes_as=null)}},{key:"clearAnnotations",value:function(){this.adapter.clearAnnotations()}},{key:"redrawAnnotations",value:function(){for(var e=this,t=0,n=Array.from(this.rangesTracker.changes);t<n.length;t++){var r=n[t];null!=r.op.i?this.adapter.onInsertAdded(r):null!=r.op.d&&this.adapter.onDeleteAdded(r)}Array.from(this.rangesTracker.comments).forEach((function(t){e.isCommentResolved(t)||e.adapter.onCommentAdded(t)})),this.broadcastChange()}},{key:"updateAnnotations",value:function(){var e=this;if(!this._doneUpdateThisLoop)return this._doUpdateAnnotations(),this._doneUpdateThisLoop=!0,setTimeout((function(){e._pendingUpdates&&e._doUpdateAnnotations(),e._doneUpdateThisLoop=!1,e._pendingUpdates=!1}));this._pendingUpdates=!0}},{key:"_doUpdateAnnotations",value:function(){var e,t,n=this.rangesTracker.getDirtyState(),r=!1;for(var a in n.change.added)null!=(e=n.change.added[a]).op.i?this.adapter.onInsertAdded(e):null!=e.op.d&&this.adapter.onDeleteAdded(e);for(var l in n.change.removed)null!=(e=n.change.removed[l]).op.i?this.adapter.onInsertRemoved(e):null!=e.op.d&&this.adapter.onDeleteRemoved(e);for(var d in n.change.moved)e=n.change.moved[d],r=!0,this.adapter.onChangeMoved(e);for(var h in n.comment.added)t=n.comment.added[h],this.isCommentResolved(t)||this.adapter.onCommentAdded(t);for(var p in n.comment.removed)t=n.comment.removed[p],this.isCommentResolved(t)||this.adapter.onCommentRemoved(t);for(var f in n.comment.moved)t=n.comment.moved[f],this.adapter.onCommentMoved&&!this.isCommentResolved(t)&&(r=!0,this.adapter.onCommentMoved(t));this.editor||(r=!1),this.rangesTracker.resetDirtyState(),r&&this.editor.renderer.updateBackMarkers(),this.broadcastChange()}},{key:"addComment",value:function(e,t,n){var r={c:t,p:e,t:n};this.$scope.sharejsDoc.submitOp(r)}},{key:"addCommentToSelection",value:function(e,t,n){var r=this.adapter.shareJsOffsetToRowColumn(t),a=this.adapter.shareJsOffsetToRowColumn(t+n),l=new wu(r.row,r.column,a.row,a.column),d=this.editor.session.getTextRange(l);this.addComment(t,d,e)}},{key:"isCommentResolved",value:function(e){return this.rangesTracker.resolvedThreadIds[e.op.t]}},{key:"selectLineIfNoSelection",value:function(){this.editor.selection.isEmpty()&&this.editor.selection.selectLine()}},{key:"acceptChangeIds",value:function(e){this.rangesTracker.removeChangeIds(e),this.updateAnnotations(),this.updateFocus()}},{key:"rejectChangeIds",value:function(e){var t=this,n=this.rangesTracker.getChanges(e);if(0!==n.length){n.sort((function(e,t){return t.op.p-e.op.p}));for(var r=this.editor.getSession(),a=0,l=Array.from(n);a<l.length;a++){var d=l[a];if(null!=d.op.d){var h=d.op.d,p=this.adapter.shareJsOffsetToRowColumn(d.op.p);r.$fromReject=!0,r.insert(p,h),r.$fromReject=!1}else{if(null==d.op.i)throw new Error("unknown change: ".concat(JSON.stringify(d)));var f=this.adapter.shareJsOffsetToRowColumn(d.op.p),y=this.adapter.shareJsOffsetToRowColumn(d.op.p+d.op.i.length),w=r.getDocument().getTextRange({start:f,end:y});if(w!==d.op.i)throw new Error("Op to be removed (".concat(JSON.stringify(d.op),"), does not match editor text, '").concat(w,"'"));r.$fromReject=!0,r.remove({start:f,end:y}),r.$fromReject=!1}}setTimeout((function(){return t.updateFocus()}))}}},{key:"removeCommentId",value:function(e){return this.rangesTracker.removeCommentId(e),this.updateAnnotations()}},{key:"hideCommentsByThreadIds",value:function(e){for(var t={},n=this.rangesTracker.comments||[],r=0,a=Array.from(e);r<a.length;r++)t[a[r]]=!0;var l,d=vu(n);try{for(d.s();!(l=d.n()).done;){var h=l.value;t[h.op.t]&&this.adapter.onCommentRemoved(h)}}catch(e){d.e(e)}finally{d.f()}return this.broadcastChange()}},{key:"showCommentByThreadId",value:function(e){var t,n=vu(this.rangesTracker.comments||[]);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.op.t!==e||this.isCommentResolved(r)||this.adapter.onCommentAdded(r)}}catch(e){n.e(e)}finally{n.f()}return this.broadcastChange()}},{key:"_resetCutState",value:function(){return this._cutState={text:null,comments:[],docId:null}}},{key:"onCut",value:function(){var e=this;this._resetCutState();var t=this.editor.getSelectionRange(),n=this._rangeToShareJs(t.start),r=this._rangeToShareJs(t.end);return this._cutState.text=this.editor.getSelectedText(),this._cutState.docId=this.$scope.docId,function(){for(var t=[],a=0,l=Array.from(e.rangesTracker.comments);a<l.length;a++){var d=l[a],h=d.op.p,p=h+d.op.c.length;n<=h&&p<=r?t.push(e._cutState.comments.push({offset:d.op.p-n,text:d.op.c,comment:d})):t.push(void 0)}return t}()}},{key:"onPaste",value:function(){var e=this;this.editor.once("change",(function(t){if("insert"===t.action){var n=t.lines.join("\n"),r=e._rangeToShareJs(t.start);e.$scope.sharejsDoc.on("ranges:dirty.paste",(function(){if(e.$scope.sharejsDoc.off("ranges:dirty.paste"),n===e._cutState.text&&e.$scope.docId===e._cutState.docId)for(var t=0,a=Array.from(e._cutState.comments);t<a.length;t++){var l=a[t],d=l.comment,h=l.offset,p={c:l.text,p:r+h,t:d.id};e.$scope.sharejsDoc.submitOp(p)}e._resetCutState(),e.rangesTracker.validate(e.editor.getValue())}))}}))}},{key:"checkMapping",value:function(){var e,t,n,r,a,l,d=this.editor.getSession(),h={},p=d.getMarkers();for(var f in p)r=p[f],h[f]=r;for(var y=[],w=0,x=Array.from(this.rangesTracker.changes);w<x.length;w++){var j=x[w];if(null!=this.adapter.changeIdToMarkerIdMap[j.id]){a=j.op;var O=this.adapter.changeIdToMarkerIdMap[j.id];e=O.background_marker_id,t=O.callout_marker_id,l=this.adapter.shareJsOffsetToRowColumn(a.p),null!=a.i?n=this.adapter.shareJsOffsetToRowColumn(a.p+a.i.length):null!=a.d&&(n=l),y.push({marker_id:e,start:l,end:n}),y.push({marker_id:t,start:l,end:l})}}for(var C=0,S=Array.from(this.rangesTracker.comments);C<S.length;C++){var _=S[C];if(null!=this.adapter.changeIdToMarkerIdMap[_.id]){var k=this.adapter.changeIdToMarkerIdMap[_.id];e=k.background_marker_id,t=k.callout_marker_id,l=this.adapter.shareJsOffsetToRowColumn(_.op.p),n=this.adapter.shareJsOffsetToRowColumn(_.op.p+_.op.c.length),y.push({marker_id:e,start:l,end:n}),y.push({marker_id:t,start:l,end:l})}}for(var E=0,A=Array.from(y);E<A.length;E++){var T=A[E],R=T.marker_id,I=T.start,P=T.end;r=h[R],delete h[R],r.range.start.row===I.row&&r.range.start.column===I.column&&r.range.end.row===P.row&&r.range.end.column===P.column||console.error("Change doesn't match marker anymore",{marker:r,start:I,end:P})}return function(){var e=[];for(var t in h)r=h[t],/track-changes/.test(r.clazz)?e.push(console.error("Orphaned ace marker",r)):e.push(void 0);return e}()}},{key:"broadcastChange",value:function(){this.$scope.$emit("editor:track-changes:changed",this.$scope.docId)}},{key:"recalculateReviewEntriesScreenPositions",value:function(){if(this.editor){var e=this.editor.getSession(),t=this.editor.renderer,n=this._getCurrentDocEntries()||{};for(var r in n){var a=n[r],l=this.adapter.shareJsOffsetToRowColumn(a.offset),d=e.documentToScreenPosition(l.row,l.column).row*t.lineHeight;null==a.screenPos&&(a.screenPos={}),a.screenPos.y=d,a.docPos=l}this.recalculateVisibleEntries(),this.$scope.$apply()}}},{key:"recalculateVisibleEntries",value:function(){var e=this.editor.renderer.layerConfig,t=e.firstRow,n=e.lastRow,r=this._getCurrentDocEntries()||{},a=Object.keys(r).length,l=!1;for(var d in r){var h=r[d],p=h.visible;h.visible=a<100||t-20<=h.docPos.row&&h.docPos.row<=n+20,h.visible!==p&&(l=!0)}l&&this.$scope.$emit("editor:track-changes:visibility_changed")}},{key:"_getCurrentDocEntries",value:function(){var e=this.$scope.docId;return this.$scope.reviewPanel.entries[e]||{}}},{key:"updateFocus",value:function(){if(this.editor){var e=this.editor.getSelectionRange(),t=this._rangeToShareJs(e.start),n=this._rangeToShareJs(e.end),r=t!==n;this.$scope.$emit("editor:focus:changed",t,n,r)}}},{key:"_rangeToShareJs",value:function(e){var t=this.editor.getSession().getDocument().getLines(0,e.row);return fu.rangeToShareJs(e,t)}},{key:"_changeToShareJs",value:function(e){var t=this.editor.getSession().getDocument().getLines(0,e.start.row);return fu.changeToShareJs(e,t)}}])&&yu(t.prototype,n),r&&yu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ou=ace.require("ace/range").Range,Cu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.changeIdToMarkerIdMap={}}var t,n,r;return t=e,(n=[{key:"tearDown",value:function(){this.changeIdToMarkerIdMap={}}},{key:"clearAnnotations",value:function(){var e=this.editor.getSession();for(var t in this.changeIdToMarkerIdMap){var n=this.changeIdToMarkerIdMap[t];for(var r in n){var a=n[r];e.removeMarker(a)}}this.changeIdToMarkerIdMap={}}},{key:"onInsertAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length),r=this.editor.getSession(),a=new Ou(t.row,t.column,n.row,n.column),l=r.addMarker(a,"track-changes-marker track-changes-added-marker","text"),d=this.createCalloutMarker(t,"track-changes-added-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:l,callout_marker_id:d}}},{key:"onDeleteAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.editor.getSession(),r=this.editor.renderer.$markerBack,a="track-changes-marker track-changes-deleted-marker",l=this.makeZeroWidthRange(t),d=n.addMarker(l,a,(function(e,t,n,l,d){return r.drawSingleLineMarker(e,t,"".concat(a," ace_start"),d,0,"")})),h=this.createCalloutMarker(t,"track-changes-deleted-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:d,callout_marker_id:h}}},{key:"onInsertRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var a=this.editor.getSession();a.removeMarker(n),a.removeMarker(r)}}},{key:"onDeleteRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var a=this.editor.getSession();a.removeMarker(n),a.removeMarker(r)}}},{key:"onChangeMoved",value:function(e){var t,n=this.shareJsOffsetToRowColumn(e.op.p);t=null!=e.op.i?this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length):n,this.updateMarker(e.id,n,t)}},{key:"onCommentAdded",value:function(e){if(null==this.changeIdToMarkerIdMap[e.id]){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length),r=this.editor.getSession(),a=new Ou(t.row,t.column,n.row,n.column),l=r.addMarker(a,"track-changes-marker track-changes-comment-marker","text"),d=this.createCalloutMarker(t,"track-changes-comment-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:l,callout_marker_id:d}}}},{key:"onCommentMoved",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length);this.updateMarker(e.id,t,n)}},{key:"onCommentRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var a=this.editor.getSession();a.removeMarker(n),a.removeMarker(r)}}},{key:"updateMarker",value:function(e,t,n){if(null!=this.changeIdToMarkerIdMap[e]){var r=this.editor.getSession().getMarkers(),a=this.changeIdToMarkerIdMap[e],l=a.background_marker_id,d=a.callout_marker_id;if(null!=l&&null!=r[l]){var h=r[l];h.range.start=t,h.range.end=n}if(null!=d&&null!=r[d]){var p=r[d];p.range.start=t,p.range.end=t}}}},{key:"shareJsOffsetToRowColumn",value:function(e){var t=this.editor.getSession().getDocument().getAllLines();return fu.shareJsOffsetToRowColumn(e,t)}},{key:"createCalloutMarker",value:function(e,t){var n=this.editor.getSession(),r=this.makeZeroWidthRange(e),a=this.editor.renderer.$markerBack;return n.addMarker(r,t,(function(e,n,r,l,d){return a.drawSingleLineMarker(e,n,"track-changes-marker-callout ".concat(t," ace_start"),d,0,"width: auto; right: 0;")}))}},{key:"makeZeroWidthRange",value:function(e){var t=new Ou(e.row,e.column,e.row,e.column);return t.clipRows=function(e,t){return this.isEmpty=function(){return e>this.end.row||t<this.start.row},this},t}}])&&ju(t.prototype,n),r&&ju(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _u=ace.require("ace/range").Range,ku=function(){function e(t,n,r,a){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.editor=n,this.element=r,this.Metadata=a,this.debouncer={};var d=function(e){if("remote"!==e.origin&&["remove","insert"].includes(e.action)){l.editor.getCursorPosition();var t=e.end,n=new _u(t.row,0,t.row,t.column),r=l.editor.getSession().getTextRange(n);"%"!==r.trim()&&"\\"!==r.slice(0,1)||(n=new _u(t.row,0,t.row,t.column+80),r=l.editor.getSession().getTextRange(n));var a=function(e){var t;return(t=e.match(/(\\[^\\]+)$/))?t[1]:null}(r),d=O.a.some(e.lines,(function(e){return e.match(/^\\usepackage(?:\[.{0,80}?])?{(.{0,80}?)}/)})),h=O.a.some(e.lines,(function(e){return e.match(/^\\RequirePackage(?:\[.{0,80}?])?{(.{0,80}?)}/)})),p=O.a.some(e.lines,(function(e){return e.match(/\\label{(.{0,80}?)}/)})),f=d||p||h,y="\\label{"===(null!=a?a.slice(0,7):void 0),w="\\usepackage"===(null!=a?a.slice(0,11):void 0),x="\\RequirePackage"===(null!=a?a.slice(0,15):void 0);return f||(w||y||x)?l.Metadata.scheduleLoadDocMetaFromServer(l.$scope.docId):void 0}};this.editor.on("changeSession",(function(e){return e.oldSession.off("change",d),e.session.on("change",d)}))}var t,n,r;return t=e,(n=[{key:"getAllLabels",value:function(){return this.Metadata.getAllLabels()}},{key:"getAllPackages",value:function(){return this.Metadata.getAllPackages()}}])&&Su(t.prototype,n),r&&Su(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();n(928),n(929),n(930),y.a.factory("metadata",["$http","ide",function(e,t){var n={},r={documents:{}},a={state:r,onBroadcastDocMeta:function(e){null!=e.docId&&null!=e.meta&&(r.documents[e.docId]=e.meta,window.dispatchEvent(new CustomEvent("project:metadata",{detail:r.documents})))},onEntityDeleted:function(e,t){if("doc"===t.type)return delete r.documents[t.id]},getAllLabels:function(){return O.a.flattenDeep(function(){var e=[];for(var t in r.documents){var n=r.documents[t];e.push(n.labels)}return e}())},getAllPackages:function(){var e={};for(var t in r.documents){var n=r.documents[t];for(var a in n.packages){var l=n.packages[a];e[a]=l}}return e},loadProjectMetaFromServer:function(){return e.get("/project/".concat(window.project_id,"/metadata")).then((function(e){var t=e.data;if(t.projectMeta)return function(){var e=[];for(var n in t.projectMeta){var a=t.projectMeta[n];e.push(r.documents[n]=a)}return window.dispatchEvent(new CustomEvent("project:metadata",{detail:r.documents})),e}()}))},loadDocMetaFromServer:function(n){return e.post("/project/".concat(window.project_id,"/doc/").concat(n,"/metadata"),{broadcast:t.$scope.onlineUsersCount>0,_csrf:window.csrfToken}).then((function(e){var t=e.data;a.onBroadcastDocMeta(t)}))},scheduleLoadDocMetaFromServer:function(e){if("readOnly"!==t.$scope.permissionsLevel){var r=n[e];return null!=r&&(clearTimeout(r),delete n[e]),n[e]=setTimeout((function(){return a.loadDocMetaFromServer(e),delete n[e]}),1e3)}}};return window.addEventListener("editor:metadata-outdated",(function(){a.scheduleLoadDocMetaFromServer(t.$scope.editor.sharejs_doc.doc_id)})),a}]),y.a.factory("graphics",["ide",function(e){return{getGraphicsFiles:function(){var t=[];return e.fileTreeManager.forEachEntity((function(e,n,r){if("file"===e.type&&(l=null!=e?e.name:void 0,d="match",h=function(e){return e.match(/.*\.(png|jpg|jpeg|pdf|eps)/i)},null!=l&&"function"==typeof l[d]?h(l,d):void 0)){var a=O.a.clone(e);return a.path=r,t.push(a)}var l,d,h})),t}}}]);y.a.factory("preamble",["ide",function(e){var t={getPreambleText:function(){return Eu(e.editorManager.getCurrentDocValue().slice(0,5e3).match(/([^]*)^\\begin\{document\}/m),(function(e){return e[1]}))||""},getGraphicsPaths:function(){for(var e,n=Eu(t.getPreambleText().match(/\\graphicspath\{(.*)\}/),(function(e){return e[1]}))||"",r=[],a=/\{([^}]*)\}/g;e=a.exec(n);)r.push(e[1]);return r}};return t}]);function Eu(e,t){return null!=e?t(e):void 0}var Au;y.a.factory("files",["ide",function(e){return{getTeXFiles:function(){var t=[];return e.fileTreeManager.forEachEntity((function(e,n,r){if("doc"===e.type&&/.*\.(tex|md|txt|tikz)/.test(e.name)){var a=O.a.clone(e);a.path=r,t.push(a)}})),t}}}]);function $u(e){return function(e){if(Array.isArray(e))return Ru(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Tu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tu(e,t){if(e){if("string"==typeof e)return Ru(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ru(e,t):void 0}}function Ru(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Iu=ace.require("ace/edit_session").EditSession,Pu=ace.require("ace/ext/modelist"),Du=ace.require("ace/keyboard/vim").Vim,Mu=ace.require("ace/ext/searchbox");""!==window.aceBasePath?(Au=!0,ace.config.set("basePath","".concat(window.aceBasePath))):Au=!1,ace.config.setDefaultValue("session","useWorker",!1),null==ace.config._moduleUrl&&(ace.config._moduleUrl=ace.config.moduleUrl,ace.config.moduleUrl=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=(e=ace.config)._moduleUrl.apply(e,$u(Array.from(n||[])));return a}),y.a.directive("aceEditor",["ide","$timeout","$compile","$rootScope","eventTracking","localStorage","$cacheFactory","metadata","graphics","preamble","files","$http","$q","$window",function(e,t,n,r,a,l,d,h,p,f,y,w,x,j){return function(e,t){$("#ace_searchbox").remove();var n=Mu.SearchBox,r=n.prototype.$init;n.prototype.$init=function(){return this.element=t('<div class="ace_search right">\n<a href type="button" action="hide" class="ace_searchbtn_close">\n  <i class="fa fa-fw fa-times"></i>\n</a>\n<div class="ace_search_form">\n  <input class="ace_search_field form-control input-sm" placeholder="Search for" spellcheck="false"></input>\n  <div class="btn-group">\n    <button type="button" action="findNext" class="ace_searchbtn next btn btn-default btn-sm">\n      <i class="fa fa-chevron-down fa-fw"></i>\n    </button>\n    <button type="button" action="findPrev" class="ace_searchbtn prev btn btn-default btn-sm">\n      <i class="fa fa-chevron-up fa-fw"></i>\n    </button>\n  </div>\n</div>\n<div class="ace_replace_form">\n  <input class="ace_search_field form-control input-sm" placeholder="Replace with" spellcheck="false"></input>\n  <div class="btn-group">\n    <button type="button" action="replaceAndFindNext" class="ace_replacebtn btn btn-default btn-sm">Replace</button>\n    <button type="button" action="replaceAll" class="ace_replacebtn btn btn-default btn-sm">All</button>\n  </div>\n</div>\n<div class="ace_search_options">\n  <div class="btn-group">\n    <button action="toggleRegexpMode" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="RegExp Search">.*</button>\n    <button action="toggleCaseSensitive" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="CaseSensitive Search">Aa</button>\n    <button action="toggleWholeWords" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="Whole Word Search">"..."</button>\n    <button action="searchInSelection" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="Search Within Selection"><i class="fa fa-align-left"></i></button>\n  </div>\n  <span class="ace_search_counter"></span>\n</div>\n<div action="toggleReplace" class="hidden"></div>\n</div>')(e.$new())[0],r.apply(this)}}(r,n),{scope:{theme:"=",showPrintMargin:"=",keybindings:"=",fontSize:"=",autoComplete:"=",autoPairDelimiters:"=",sharejsDoc:"=",spellCheck:"=",spellCheckLanguage:"=",highlights:"=",text:"=",readOnly:"=",annotations:"=",navigateHighlights:"=",fileName:"=",onCtrlEnter:"=",onCtrlJ:"=",onCtrlShiftC:"=",onCtrlShiftA:"=",onSave:"=",syntaxValidation:"=",reviewPanel:"=",eventsBridge:"=",trackChanges:"=",docId:"=",rendererData:"=",lineHeight:"=",fontFamily:"="},link:function(t,n,j){var C;t.$originalApply=t.$apply,t.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)};var S=ace.edit(n.find(".ace-editor-body")[0]);S.$blockScrolling=1/0,"editor"===j.aceEditor&&e.globalEditorWatchdogManager.attachToEditor("Ace",S),S.setOption("behavioursEnabled",t.autoPairDelimiters||!1),S.setOption("wrapBehavioursEnabled",!1),e.$scope.$on("editor:replace-selection",(function(e,t){S.focus();var n,r=S.session.getDocument(),a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Tu(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}(S.selection.getAllRanges());try{for(a.s();!(n=a.n()).done;){var l=n.value;r.replace(l,t)}}catch(e){a.e(e)}finally{a.f()}})),e.$scope.$on("symbol-palette-toggled",(function(e,t){t||S.focus()})),t.$watch("autoPairDelimiters",(function(e){return e?S.setOption("behavioursEnabled",!0):S.setOption("behavioursEnabled",!1)})),window._debug_editors||(window._debug_editors=[]),window._debug_editors.push(S),t.name=j.aceEditor,t.spellCheck&&(C=new Jc(t,d,w,x,new au(S)));var _=new mc(S),k=(new uu(t,S,n),new pu(t,new mu(S),l)),E=new xu(t,S,n,new Cu(S)),A=new ku(t,S,n,h),T=(new zc(t,S,n,A,p,f,y),/[\0\uD800-\uDFFF]/g);S.commands.on("exec",(function(e){e.command&&"paste"===e.command.name&&(T.lastIndex=0,e.args&&T.test(e.args.text)&&(e.args.text=e.args.text.replace(T,"�"))),e.command&&"insertstring"===e.command.name&&(T.lastIndex=0,e.args&&T.test(e.args)&&(e.args=e.args.replace(T,"�")))})),t.$watch("onSave",(function(e){if(null!=e)return Du.defineEx("write","w",e),S.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:e,readOnly:!0}),S.commands.addCommand({name:"recompile_v1",bindKey:{win:"Ctrl-.",mac:"Ctrl-."},exec:e,readOnly:!0})})),S.commands.removeCommand("transposeletters"),S.commands.removeCommand("showSettingsMenu"),S.commands.removeCommand("foldall"),S.commands.removeCommand("toggleBlockComment"),S.commands.removeCommand("togglecomment"),S.commands.addCommand({name:"togglecomment",bindKey:{win:"Ctrl-/|Ctrl-Shift-7",mac:"Command-/|Command-Shift-/"},exec:function(e){return e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"}),S.commands.addCommand({name:"find",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(e){return Mu.Search(e,!0)},readOnly:!0}),S.commands.addCommand({name:"bold",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:function(e){if(e.getSelection().isEmpty())return e.insert("\\textbf{}"),e.navigateLeft(1);var t=e.getCopyText();return e.insert("\\textbf{".concat(t,"}"))},readOnly:!1}),S.commands.addCommand({name:"italics",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(e){if(e.getSelection().isEmpty())return e.insert("\\textit{}"),e.navigateLeft(1);var t=e.getCopyText();return e.insert("\\textit{".concat(t,"}"))},readOnly:!1}),t.$watch("onCtrlEnter",(function(e){if(null!=e)return S.commands.addCommand({name:"compile",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(t){return e()},readOnly:!0})})),t.$watch("onCtrlJ",(function(e){if(null!=e)return S.commands.addCommand({name:"toggle-review-panel",bindKey:{win:"Ctrl-J",mac:"Command-J"},exec:function(t){return e()},readOnly:!0})})),t.$watch("onCtrlShiftC",(function(e){if(null!=e)return S.commands.addCommand({name:"add-new-comment",bindKey:{win:"Ctrl-Shift-C",mac:"Command-Shift-C"},exec:function(t){return e()},readOnly:!0})})),t.$watch("onCtrlShiftA",(function(e){if(null!=e)return S.commands.addCommand({name:"toggle-track-changes",bindKey:{win:"Ctrl-Shift-A",mac:"Command-Shift-A"},exec:function(t){return e()},readOnly:!0})})),S.showCommandLine=function(e){if("/"===e)return Mu.Search(S,!0)};var R=function(){var e=S.getSession(),t=e.selection.getCursor();return e.documentToScreenPosition(t.row,t.column).row*S.renderer.lineHeight-e.getScrollTop()};if(null!=j.resizeOn)for(var I=0,P=Array.from(j.resizeOn.split(","));I<P.length;I++){var D=P[I];t.$on(D,(function(){t.$applyAsync((function(){var e=R();S.resize();var t=R(),n=S.getSession();return n.setScrollTop(n.getScrollTop()+t-e)}))}))}function M(e,t){var n=!1;if(S.renderer.scrollMargin.top!==e&&(S.renderer.scrollMargin.top=e,n=!0),S.renderer.scrollMargin.bottom!==t&&(S.renderer.scrollMargin.bottom=t,n=!0),n)return S.renderer.updateFull()}t.$on("".concat(t.name,":set-scroll-size"),(function(e,t){var n=t.overflowTop,r=S.renderer.layerConfig.maxHeight;return M(n,Math.max(t.height-r,0))}));t.$watch("theme",(function(e){return S.setTheme("ace/theme/".concat(e))})),t.$watch("showPrintMargin",(function(e){return S.setShowPrintMargin(e)})),t.$watch("keybindings",(function(e){return["vim","emacs"].includes(e)?S.setKeyboardHandler("ace/keyboard/".concat(e)):S.setKeyboardHandler(null)})),t.$watch("fontSize",(function(e){return n.find(".ace_editor, .ace_content").css({"font-size":e+"px"})})),t.$watch("fontFamily",(function(e){if(null!=e)switch(e){case"monaco":return S.setOption("fontFamily",["Monaco","Menlo","Ubuntu Mono","Consolas","monospace"].join(", "));case"lucida":return S.setOption("fontFamily",'"Lucida Console", "Source Code Pro", monospace');default:return S.setOption("fontFamily",null)}})),t.$watch("lineHeight",(function(e){if(null!=e){switch(e){case"compact":S.container.style.lineHeight=1.33;break;case"normal":S.container.style.lineHeight=1.6;break;case"wide":S.container.style.lineHeight=2;break;default:S.container.style.lineHeight=1.6}return S.renderer.updateFontSize()}})),t.$watch("sharejsDoc",(function(e,n){if(null!=n&&(t.$broadcast("beforeChangeDocument"),K(n)),null!=e&&function(e){var n,a=e.getSnapshot().split("\n"),l=S.getSession();null!=l&&l.destroy();try{if(/\.(Rtex|bbl|tikz)$/i.test(t.fileName))n="ace/mode/latex";else if(/\.(sty|cls|clo)$/.test(t.fileName))n="ace/mode/tex";else{var d=Pu.getModeForPath(t.fileName);"ace/mode/text"===(n=d.mode)&&(n="ace/mode/plain_text")}}catch(e){n="ace/mode/plain_text"}(l=new Iu(a,n)).setUseWrapMode(!0),null!=t.syntaxValidation&&Au&&!/\.bib$/.test(t.fileName)&&l.setOption("useWorker",t.syntaxValidation);S.setReadOnly(!0),S.setSession(l),l.getDocument().on("change",F),S.initing=!0,e.attachToAce(S),S.initing=!1,S.setReadOnly(t.readOnly),W(),t.readOnly||function(){if(!C)return;C.init(),S.on("changeSession",B),B({session:S.getSession()}),S.on("nativecontextmenu",C.onContextMenu)}();(function(){if(E.rangesTracker=t.sharejsDoc.ranges,E.onChangeSession(),!E)return;S.on("changeSelection",E.onChangeSelection),S.on("change",E.onChangeSelection),S.on("changeSession",E.onChangeSession),S.on("cut",E.onCut),S.on("paste",E.onPaste),S.renderer.on("resize",E.onResize)})(),_.onChangeSession(S.getSession()),void S.on("change",_.onChange),void M(0,0),l.setAnnotations(t.annotations),null!=t.eventsBridge&&l.on("changeScrollTop",N);r.hasLintingError=!1,l.on("changeAnnotation",(function(){var e=l.getAnnotations().filter((function(e){return"info"!==e.type&&"compile"!==e.source})).length>0;if(r.hasLintingError!==e)return r.hasLintingError=e})),setTimeout((function(){return N(S.renderer.getScrollTop())})),S.focus()}(e),null!=e&&null!=n)return t.$broadcast("afterChangeDocument")})),t.$watch("text",(function(e){if(null!=e)return S.setValue(e,-1),S.getSession().setUseWrapMode(!0)})),t.$watch("annotations",(function(e){return S.getSession().setAnnotations(e)})),t.$watch("readOnly",(function(e){return S.setReadOnly(!!e)})),t.$watch("syntaxValidation",(function(e){if(null!=e&&Au)return S.getSession().setOption("useWorker",e)})),S.setOption("scrollPastEnd",!0);var L=0,F=function(){return 100===++L&&a.send("editor-interaction","multi-doc-update"),t.$emit("".concat(t.name,":change"))},q=null,N=function(e){if(null!=t.eventsBridge){var n=S.renderer.layerConfig.maxHeight;return function(){var e=S.getFirstVisibleRow();if(e!==q){q=e;var n=S.getLastVisibleRow();t.$emit("scroll:editor:update",Math.floor((e+n)/2))}}(),t.eventsBridge.emit("aceScroll",e,n)}};null!=t.eventsBridge&&(S.renderer.on("scrollbarVisibilityChanged",(function(e,n){if(null!=t.eventsBridge)return t.eventsBridge.emit("aceScrollbarVisibilityChanged",n.scrollBarV.isVisible,n.scrollBarV.width)})),t.eventsBridge.on("externalScroll",(function(e){return S.getSession().setScrollTop(e)})),t.eventsBridge.on("refreshScrollPosition",(function(){var e=S.getSession();return e.setScrollTop(e.getScrollTop()+1),e.setScrollTop(e.getScrollTop()-1)})));var B=function(e){return C.onSessionChange(),null!=e.oldSession&&e.oldSession.getDocument().off("change",C.onChange),e.session.getDocument().on("change",C.onChange),null!=e.oldSession&&e.oldSession.off("changeScrollTop",C.onScroll),e.session.on("changeScrollTop",C.onScroll)},U=function(){if(C)return S.off("changeSession",B),S.off("nativecontextmenu",C.onContextMenu)},H=function(){S.off("change",_.onChange)},z=function(e){return null!=e.oldSession&&e.oldSession.selection.off("changeCursor",k.onCursorChange),e.session.selection.on("changeCursor",k.onCursorChange)},V=function(){return k.onUnload(S.getSession())};S.on("changeSession",z),z({session:S.getSession()}),$(window).on("unload",V);var W=O.a.once((function(){return t.$broadcast("editorInit")}));function K(e){U(),E&&(E.tearDown(),S.off("changeSelection",E.onChangeSelection),S.off("change",E.onChangeSelection),S.off("changeSession",E.onChangeSession),S.off("cut",E.onCut),S.off("paste",E.onPaste),S.renderer.off("resize",E.onResize)),H(),e.detachFromAce(),e.off("remoteop.recordRemote");var t=S.getSession();return t.off("changeScrollTop"),t.getDocument().off("change",F)}return null!=t.rendererData&&S.renderer.on("changeCharacterSize",(function(){t.$apply((function(){return t.rendererData.lineHeight=S.renderer.lineHeight}))})),t.$watch("rendererData",(function(e){if(null!=e)return e.lineHeight=S.renderer.lineHeight})),t.$on("$destroy",(function(){if(null!=t.sharejsDoc){t.$broadcast("changeEditor"),U(),S.off("changeSession",z),$(window).off("unload",V),H(),K(t.sharejsDoc);var e=S.getSession();return null!=e&&e.destroy(),t.eventsBridge.emit("aceScrollbarVisibilityChanged",!1,0)}})),t.$emit("".concat(t.name,":inited"),S)},template:'<div class="ace-editor-wrapper">\n<div\n  class="undo-conflict-warning alert alert-danger small"\n  ng-show="undo.show_remote_warning"\n>\n  <strong>Watch out!</strong>\n  We had to undo some of your collaborators changes before we could undo yours.\n  <a\n    href="#"\n    class="pull-right"\n    ng-click="undo.show_remote_warning = false"\n  >Dismiss</a>\n</div>\n<div class="ace-editor-body"></div>\n<spell-menu\n  open="spellMenu.open"\n  top="spellMenu.top"\n  left="spellMenu.left"\n  layout-from-bottom="spellMenu.layoutFromBottom"\n  highlight="spellMenu.highlight"\n  replace-word="replaceWord(highlight, suggestion)"\n  learn-word="learnWord(highlight)"\n></spell-menu>\n<div\n  class="annotation-label"\n  ng-show="annotationLabel.show"\n  ng-style="{\n    position: \'absolute\',\n    left:     annotationLabel.left,\n    right:    annotationLabel.right,\n    bottom:   annotationLabel.bottom,\n    top:      annotationLabel.top,\n    \'background-color\': annotationLabel.backgroundColor\n  }"\n>\n  {{ annotationLabel.text }}\n</div>\n\n<a\n  href\n  class="highlights-before-label btn btn-info btn-xs"\n  ng-show="updateLabels.highlightsBefore > 0"\n  ng-click="gotoHighlightAbove()"\n>\n  <i class="fa fa-fw fa-arrow-up"></i>\n  {{ updateLabels.highlightsBefore }} more update{{ updateLabels.highlightsBefore > 1 && "" || "s" }} above\n</a>\n\n<a\n  href\n  class="highlights-after-label btn btn-info btn-xs"\n  ng-show="updateLabels.highlightsAfter > 0"\n  ng-click="gotoHighlightBelow()"\n>\n  <i class="fa fa-fw fa-arrow-down"></i>\n  {{ updateLabels.highlightsAfter }} more update{{ updateLabels.highlightsAfter > 1 && "" || "s" }} below\n\n</a>\n</div>'}}]);y.a.directive("toggleSwitch",(function(){return{restrict:"E",scope:{description:"@",labelFalse:"@",labelTrue:"@",ngModel:"="},template:'<fieldset class="toggle-switch">\n  <legend class="sr-only">{{description}}</legend>\n\n  <input\n    type="radio"\n    name="toggle-switch-{{$id}}"\n    class="toggle-switch-input"\n    id="toggle-switch-false-{{$id}}"\n    ng-value="false"\n    ng-model="ngModel"\n  >\n  <label for="toggle-switch-false-{{$id}}" class="toggle-switch-label"><span>{{labelFalse}}</span></label>\n\n  <input\n    type="radio"\n    class="toggle-switch-input"\n    name="toggle-switch-{{$id}}"\n    id="toggle-switch-true-{{$id}}"\n    ng-value="true"\n    ng-model="ngModel"\n  >\n  <label for="toggle-switch-true-{{$id}}" class="toggle-switch-label"><span>{{labelTrue}}</span></label>\n</fieldset>'}})),y.a.controller("SavingNotificationController",["$scope","$interval","ide",function(e,t,n){var r;setInterval((function(){return function(){var t,r=e.docSavingStatus,d=e.docSavingStatusCount,h={},p=0,f=0;for(var y in pc.openDocs){pc.openDocs[y].pollSavedStatus()||(p++,null!=r[y]?(h[y]=r[y],(t=h[y].unsavedSeconds+=1)>f&&(f=t)):h[y]={unsavedSeconds:0,doc:n.fileTreeManager.findEntityById(y)})}p>0&&t>15&&!l&&(l=n.showLockEditorMessageModal("Connection lost","Sorry, the connection to the server is down."),a=n.$scope.permissionsLevel,n.$scope.permissionsLevel="readOnly",l.result.finally((function(){l=null,n.$scope.permissionsLevel=a})));l&&0===p&&(l.dismiss("connection back up"),a&&(n.$scope.permissionsLevel=a));if(p||d)return e.docSavingStatus=h,e.docSavingStatusCount=p,e.$apply()}()}),1e3),$(window).bind("beforeunload",(function(){return r()}));var a,l=null;return e.docSavingStatus={},r=function(){if(pc.hasUnsavedChanges())return"You have unsaved changes. If you leave now they will not be saved."}}]);function Lu(e){return function(e){if(Array.isArray(e))return Fu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Fu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fu(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qu=Object(le.a)("ol-debugPdfDetach");function Nu(e,t,n,r){var a=we(),l=a.role,d=a.broadcastEvent,h=a.addEventHandler,p=a.deleteEventHandler,f="action-".concat(e),y=Object(C.useCallback)((function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];l===n?d(f,{args:r}):t.apply(void 0,r)}),[l,n,f,t,d]),w=Object(C.useCallback)((function(e){e.event===f&&l===r&&(qu&&console.log("Do ".concat(t.name," on event ").concat(f)),t.apply(void 0,Lu(e.data.args)))}),[l,r,f,t]);return Object(C.useEffect)((function(){return h(w),function(){return p(w)}}),[h,p,w]),y}var Bu=/Mac/i.test(navigator.platform)?"Cmd":"Ctrl";function Uu(e){var t=e.startCompile,n=e.compiling,r=Pe().detachRole,a=Object(Mt.a)().t,l=n?a("compiling")+"…":a("recompile");return Object(R.jsx)(hi.a,{placement:"bottom",delayShow:500,overlay:Object(R.jsxs)(di.a,{id:"tooltip-logs-toggle",className:"keyboard-tooltip",children:[a("recompile_pdf")," ","detached"!==r&&Object(R.jsxs)("span",{className:"keyboard-shortcut",children:["(",Bu," + Enter)"]})]}),children:Object(R.jsxs)(Ir.a,{className:"btn-recompile",bsStyle:"success",onClick:function(){return t()},"aria-label":l,disabled:n,children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:n}),Object(R.jsx)("span",{className:"toolbar-hide-medium toolbar-hide-small btn-recompile-label",children:l})]})})}Uu.propTypes={compiling:k.a.bool.isRequired,startCompile:k.a.func.isRequired};var Hu=Object(C.memo)(Uu);function zu(){var e=Object(ks.b)(),t=e.compiling,n=e.hasChanges,r=Nu("start-compile",e.startCompile,"detacher","detached"),a=Object(C.useCallback)((function(){return r()}),[r]);return Object(R.jsx)("div",{className:re()({"btn-recompile-group":!0,"btn-recompile-group-has-changes":n}),children:Object(R.jsx)(Hu,{startCompile:a,compiling:t})})}function Vu(){var e=Pe(Wu),t=e.detachRole,n=e.detachIsLinked;return"detacher"===t&&n?Object(R.jsx)(zu,{}):null}var Wu={detachRole:k.a.string,detachIsLinked:k.a.bool},Ku=Object(C.memo)(Vu);y.a.component("editorCompileButton",Object(x.react2angular)(Ys.use(Ku)));var Gu,Yu=["doc"];function Xu(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qu,Zu=((Gu=function(){function e(t,n,r,a){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.editorOpenDocEpoch=0,this.$scope=n,this.localStorage=r,this.$scope.editor={sharejs_doc:null,open_doc_id:null,open_doc_name:null,opening:!0,trackChanges:!1,wantTrackChanges:!1,docTooLongErrorShown:!1,showRichText:this.showRichText(),newSourceEditor:this.newSourceEditor(),showSymbolPalette:!1,toggleSymbolPalette:function(){var e=!l.$scope.editor.showSymbolPalette;l.$scope.editor.showSymbolPalette=e,t.$scope.$emit("symbol-palette-toggled",e),a.sendMB(e?"symbol-palette-show":"symbol-palette-hide")},insertSymbol:function(e){t.$scope.$emit("editor:replace-selection",e.command),a.sendMB("symbol-palette-insert")}},window.addEventListener("editor:insert-symbol",(function(e){l.$scope.editor.insertSymbol(e.detail)})),this.$scope.$on("entity:selected",(function(e,t){if("history"!==l.$scope.ui.view&&"doc"===t.type)return l.openDoc(t)})),this.$scope.$on("entity:no-selection",(function(){l.$scope.$apply((function(){l.$scope.ui.view=null}))})),this.$scope.$on("entity:deleted",(function(e,t){if(l.$scope.editor.open_doc_id===t.id){if(!l.$scope.project.rootDoc_id)return void(l.$scope.ui.view=null);var n=l.ide.fileTreeManager.findEntityById(l.$scope.project.rootDoc_id);return null==n?void(l.$scope.ui.view=null):l.openDoc(n)}}));var d=!1;this.$scope.$on("file-tree:initialized",(function(){if(!d)return d=!0,l.autoOpenDoc()})),this.$scope.$on("flush-changes",(function(){return pc.flushAll()})),window.addEventListener("flush-changes",(function(){pc.flushAll()})),window.addEventListener("blur",(function(){sl_console.log("[EditorManager] forcing flush onblur"),pc.flushAll()})),this.$scope.$watch("editor.wantTrackChanges",(function(e){if(null!=e)return l._syncTrackChangesState(l.$scope.editor.sharejs_doc)})),window.addEventListener("editor:open-doc",(function(e){var t=e.detail,n=t.doc,r=Xu(t,Yu);l.openDoc(n,r)}))}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype._syncTimeout=null}}],(n=[{key:"getEditorType",value:function(){return this.$scope.editor.sharejs_doc?this.$scope.editor.sharejs_doc.editorType():null}},{key:"showRichText",value:function(){return"rich-text"===this.localStorage("editor.mode.".concat(this.$scope.project_id))}},{key:"newSourceEditor",value:function(){return!!Object(le.a)("ol-showNewSourceEditorOption")&&"cm6"===this.localStorage("editor.source_editor.".concat(this.$scope.project_id))}},{key:"autoOpenDoc",value:function(){var e=this.ide.localStorage("doc.open_id.".concat(this.$scope.project_id))||this.$scope.project.rootDoc_id;if(null!=e){var t=this.ide.fileTreeManager.findEntityById(e);if(null!=t)return this.openDoc(t)}}},{key:"openDocId",value:function(e,t){null==t&&(t={});var n=this.ide.fileTreeManager.findEntityById(e);if(null!=n)return this.openDoc(n,t)}},{key:"jumpToLine",value:function(e){return this.$scope.$broadcast("editor:gotoLine",e.gotoLine,e.gotoColumn,e.syncToPdf)}},{key:"openDoc",value:function(e,t){var n=this;null==t&&(t={}),sl_console.log("[openDoc] Opening ".concat(e.id)),this.$scope.ui.view="editor";var r=function(e){return n.$scope.$broadcast("doc:after-opened",{isNewDoc:e}),window.dispatchEvent(new CustomEvent("doc:after-opened",{isNewDoc:e})),null!=t.gotoLine?setTimeout((function(){return n.jumpToLine(t)}),0):null!=t.gotoOffset?setTimeout((function(){return n.$scope.$broadcast("editor:gotoOffset",t.gotoOffset)}),0):void 0};return e.id!==this.$scope.editor.open_doc_id||t.forceReopen?(this.$scope.editor.open_doc_id=e.id,this.$scope.editor.open_doc_name=e.name,this.ide.localStorage("doc.open_id.".concat(this.$scope.project_id),e.id),this.ide.fileTreeManager.selectEntity(e),this.$scope.editor.opening=!0,this._openNewDocument(e,(function(t,a){if(t&&"another document was loaded"===t.message)sl_console.log("[openDoc] another document was loaded while ".concat(e.id," was loading"));else{if(null==t)return n._syncTrackChangesState(a),n.$scope.$broadcast("doc:opened"),n.$scope.$apply((function(){return n.$scope.editor.opening=!1,n.$scope.editor.sharejs_doc=a,r(!0)}));n.ide.showGenericMessageModal("Error opening document","Sorry, something went wrong opening this document. Please try again.")}}))):(this.ide.fileTreeManager.selectEntity(e),void this.$scope.$apply((function(){return r(!1)})))}},{key:"_openNewDocument",value:function(e,t){var n=this,r=this.$scope.editor.sharejs_doc,a=r&&r.doc_id,l=r&&r.hasBufferedOps();if(r&&a!==e.id||l){sl_console.log("[_openNewDocument] Leaving existing open doc..."),this._unbindFromDocumentEvents(r),this._attachErrorHandlerToDocument(e,r);var d=++this.editorOpenDocEpoch;r.leaveAndCleanUp((function(r){return r?(sl_console.log("[_openNewDocument] error leaving doc ".concat(a),r),t(r)):n.editorOpenDocEpoch!==d?(sl_console.log("[openNewDocument] editorOpenDocEpoch mismatch ".concat(n.editorOpenDocEpoch," vs ").concat(d)),t(new Error("another document was loaded"))):void n._doOpenNewDocument(e,t)}))}else this._doOpenNewDocument(e,t)}},{key:"_doOpenNewDocument",value:function(e,t){var n=this;null==t&&(t=function(){}),sl_console.log("[_doOpenNewDocument] Opening...");var r=pc.getDocument(this.ide,e.id),a=++this.editorOpenDocEpoch;return r.join((function(l){return null!=l?(sl_console.log("[_doOpenNewDocument] error joining doc ".concat(e.id),l),t(l)):n.editorOpenDocEpoch!==a?(sl_console.log("[openNewDocument] editorOpenDocEpoch mismatch ".concat(n.editorOpenDocEpoch," vs ").concat(a)),r.leaveAndCleanUp(),t(new Error("another document was loaded"))):(n._bindToDocumentEvents(e,r),t(null,r))}))}},{key:"_attachErrorHandlerToDocument",value:function(e,t){var n=this;t.on("error",(function(r,a,l){var d;if(d=null!=(null!=r?r.message:void 0)?r.message:"string"==typeof r?r:"",/maxDocLength/.test(d))n.$scope.docTooLongErrorShown=!0,n.openDoc(e,{forceReopen:!0}),n.ide.showGenericMessageModal("Document Too Long","Sorry, this file is too long to be edited manually. Please upload it directly.").result.finally((function(){n.$scope.docTooLongErrorShown=!1}));else if(/too many comments or tracked changes/.test(d))n.ide.showGenericMessageModal("Too many comments or tracked changes","Sorry, this file has too many comments or tracked changes. Please try accepting or rejecting some existing changes, or resolving and deleting some comments.");else if(!n.$scope.docTooLongErrorShown)return t.off("error"),l="string"==typeof l?l:t.doc._doc.snapshot,t.doc&&t.doc.clearInflightAndPendingOps(),t.leaveAndCleanUp(),n.ide.connectionManager.disconnect({permanent:!0}),n.ide.reportError(r,a),n.$scope.editor.error_state=!0,void n.ide.showOutOfSyncModal("Out of sync","Sorry, this file has gone out of sync and we need to do a full refresh. <br> <a target='_blank' rel='noopener noreferrer' href='/learn/Kb/Editor_out_of_sync_problems'>Please see this help guide for more information</a>",l);var h=n.$scope.$on("project:joined",(function(){n.openDoc(e,{forceReopen:!0}),h()}))}))}},{key:"_bindToDocumentEvents",value:function(e,t){var n=this;return this._attachErrorHandlerToDocument(e,t),t.on("externalUpdate",(function(e){if(!n._ignoreExternalUpdates&&("external"!==O.a.property(["meta","type"])(e)||"git-bridge"!==O.a.property(["meta","source"])(e)))return n.ide.showGenericMessageModal("Document Updated Externally","This document was just updated externally. Any recent changes you have made may have been overwritten. To see previous versions please look in the history.")}))}},{key:"_unbindFromDocumentEvents",value:function(e){return e.off()}},{key:"getCurrentDocValue",value:function(){return null!=this.$scope.editor.sharejs_doc?this.$scope.editor.sharejs_doc.getSnapshot():void 0}},{key:"getCurrentDocId",value:function(){return this.$scope.editor.open_doc_id}},{key:"startIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!0}},{key:"stopIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!1}},{key:"_syncTrackChangesState",value:function(e){var t,n=this;if(null!=e){null!=this._syncTimeout&&(clearTimeout(this._syncTimeout),this._syncTimeout=null);var r=this.$scope.editor.wantTrackChanges,a=e.getTrackingChanges();if(r!==a)return(t=function(){return null==e.getInflightOp()&&null==e.getPendingOp()?(e.setTrackingChanges(r),n.$scope.$apply((function(){return n.$scope.editor.trackChanges=r}))):n._syncTimeout=setTimeout(t,100)})();this.$scope.editor.trackChanges=r}}}])&&Ju(t.prototype,n),r&&Ju(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).initClass(),Gu=Gu),ed=n(164),td=n.n(ed);function nd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rd=((Qu=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.onlineUsers={},this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsersArray=[],this.$scope.onlineUsersCount=0,this.$scope.$on("cursor:editor:update",(function(e,t){return r.sendCursorPositionUpdate(t)})),this.$scope.$on("project:joined",(function(){return r.ide.socket.emit("clientTracking.getConnectedUsers",(function(e,t){r.$scope.onlineUsers={};for(var n=0,a=Array.from(t||[]);n<a.length;n++){var l=a[n];l.client_id!==r.ide.socket.publicId&&(r.$scope.onlineUsers[l.client_id]={id:l.client_id,user_id:l.user_id,email:l.email,name:"".concat(l.first_name," ").concat(l.last_name),doc_id:null!=l.cursorData?l.cursorData.doc_id:void 0,row:null!=l.cursorData?l.cursorData.row:void 0,column:null!=l.cursorData?l.cursorData.column:void 0})}return r.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientUpdated",(function(e){if(e.id!==r.ide.socket.publicId)return r.$scope.$apply((function(){return r.$scope.onlineUsers[e.id]=e,r.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientDisconnected",(function(e){return r.$scope.$apply((function(){return delete r.$scope.onlineUsers[e],r.refreshOnlineUsers()}))})),this.$scope.getHueForUserId=function(e){return su.a.getHueForUserId(e)}}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype.cursorUpdateInterval=500}}],(n=[{key:"refreshOnlineUsers",value:function(){for(var e in this.$scope.onlineUsersArray=[],this.$scope.onlineUsers){var t=this.$scope.onlineUsers[e];null!=t.doc_id&&(t.doc=this.ide.fileTreeManager.findEntityById(t.doc_id)),null!==t.name&&0!==t.name.trim().length||(t.email?t.name=t.email.trim():"anonymous-user"===t.user_id&&(t.name="Anonymous")),t.initial=null!=t.name?t.name[0]:void 0,t.initial&&" "!==t.initial||(t.initial="?"),this.$scope.onlineUsersArray.push(t)}for(var n in this.$scope.onlineUsersCount=this.$scope.onlineUsersArray.length,this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsers){var r=this.$scope.onlineUsers[n],a=r.doc_id;null!=a&&null!=r.row&&null!=r.column&&(this.$scope.onlineUserCursorHighlights[a]||(this.$scope.onlineUserCursorHighlights[a]=[]),this.$scope.onlineUserCursorHighlights[a].push({label:r.name,cursor:{row:r.row,column:r.column},hue:su.a.getHueForUserId(r.user_id)}))}return this.$scope.onlineUsersArray.length>0?(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=500):(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=3e5)}},{key:"sendCursorPositionUpdate",value:function(e){var t=this;if(null!=e&&(this.$scope.currentPosition=e),null==this.cursorUpdateTimeout)return this.cursorUpdateTimeout=setTimeout((function(){var e=t.$scope.editor.open_doc_id;return t.ide.socket.emit("clientTracking.updatePosition",{row:null!=t.$scope.currentPosition?t.$scope.currentPosition.row:void 0,column:null!=t.$scope.currentPosition?t.$scope.currentPosition.column:void 0,doc_id:e}),delete t.cursorUpdateTimeout}),this.cursorUpdateInterval)}}])&&nd(t.prototype,n),r&&nd(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).initClass(),Qu=Qu),id=n(36),od=n.n(id),ad=function(e){if(null==e)return"Anonymous";if(e.id===window.user.id)return"you";if(null!=e.name)return e.name;var t=[e.first_name,e.last_name].filter((function(e){return null!=e})).join(" ").trim();return""===t&&(t=e.email.split("@")[0]),null==t||""===t?"?":t};y.a.controller("HistoryListController",["$scope","$modal","ide",function(e,t,n){e.hoveringOverListSelectors=!1,e.projectUsers=[],e.$watch("project.members",(function(t){if(null!=t)return e.projectUsers=t.concat(e.project.owner)}));return e.getDisplayNameById=function(t){return ad(function(t){return O.a.find(e.projectUsers,(function(e){return((null!=e?e._id:void 0)||(null!=e?e.id:void 0))===t}))}(t))},e.deleteLabel=function(e){return t.open({templateUrl:"historyV2DeleteLabelModalTemplate",controller:"HistoryV2DeleteLabelModalController",resolve:{labelDetails:function(){return e}}})},e.loadMore=function(){return n.historyManager.fetchNextBatchOfUpdates()},e.recalculateSelectedUpdates=function(){var t=!0,n=!1;return e.history.selection.updates=[],function(){for(var r=[],a=0,l=Array.from(e.history.updates);a<l.length;a++){var d=l[a],h=void 0;d.selectedTo&&(h=!0,t=!1),d.beforeSelection=t,d.inSelection=h,d.afterSelection=n,h&&e.history.selection.updates.push(d),d.selectedFrom?(h=!1,r.push(n=!0)):r.push(void 0)}return r}()},e.recalculateHoveredUpdates=function(){for(var t,n=!1,r=!1,a=0,l=Array.from(e.history.updates);a<l.length;a++){var d=l[a];d.hoverSelectedFrom&&(n=!0),d.hoverSelectedTo&&(r=!0)}if(n){t=!1;for(var h=0,p=Array.from(e.history.updates);h<p.length;h++){var f=p[h];f.selectedTo&&(f.hoverSelectedTo=!0,t=!0),f.inHoverSelection=t,f.hoverSelectedFrom&&(t=!1)}}if(r)return t=!1,function(){for(var n=[],r=0,a=Array.from(e.history.updates);r<a.length;r++){var l=a[r];l.hoverSelectedTo&&(t=!0),l.inHoverSelection=t,l.selectedFrom?(l.hoverSelectedFrom=!0,n.push(t=!1)):n.push(void 0)}return n}()},e.resetHoverState=function(){return function(){for(var t=[],n=0,r=Array.from(e.history.updates);n<r.length;n++){var a=r[n];delete a.hoverSelectedFrom,delete a.hoverSelectedTo,t.push(delete a.inHoverSelection)}return t}()},e.$watch("history.updates.length",(function(){return e.recalculateSelectedUpdates()}))}]);y.a.controller("HistoryListItemController",["$scope","eventTracking",function(e,t){return e.$watch("update.selectedFrom",(function(t,n){if(t){for(var r=0,a=Array.from(e.history.updates);r<a.length;r++){var l=a[r];l!==e.update&&(l.selectedFrom=!1)}return e.recalculateSelectedUpdates()}})),e.$watch("update.selectedTo",(function(t,n){if(t){for(var r=0,a=Array.from(e.history.updates);r<a.length;r++){var l=a[r];l!==e.update&&(l.selectedTo=!1)}return e.recalculateSelectedUpdates()}})),e.select=function(){return t.sendMB("history-view-change"),e.update.selectedTo=!0,e.update.selectedFrom=!0},e.mouseOverSelectedFrom=function(){return e.history.hoveringOverListSelectors=!0,e.update.hoverSelectedFrom=!0,e.recalculateHoveredUpdates()},e.mouseOutSelectedFrom=function(){return e.history.hoveringOverListSelectors=!1,e.resetHoverState()},e.mouseOverSelectedTo=function(){return e.history.hoveringOverListSelectors=!0,e.update.hoverSelectedTo=!0,e.recalculateHoveredUpdates()},e.mouseOutSelectedTo=function(){return e.history.hoveringOverListSelectors=!1,e.resetHoverState()},e.displayName=ad}]);y.a.controller("HistoryDiffController",["$scope","$modal","ide","eventTracking",function(e,t,n,r){return e.restoreDeletedDoc=function(){return r.sendMB("history-restore-deleted"),e.history.diff.restoreInProgress=!0,n.historyManager.restoreDeletedDoc(e.history.diff.doc).then((function(t){var n=t.data;return e.history.diff.restoredDocNewId=n.doc_id,e.history.diff.restoreInProgress=!1,e.history.diff.restoreDeletedSuccess=!0}))},e.openRestoreDiffModal=function(){return r.sendMB("history-restore-modal"),t.open({templateUrl:"historyRestoreDiffModalTemplate",controller:"HistoryRestoreDiffModalController",resolve:{diff:function(){return e.history.diff}}})},e.backToEditorAfterRestore=function(){return n.editorManager.openDoc({id:e.history.diff.restoredDocNewId})}}]);var sd;y.a.controller("HistoryRestoreDiffModalController",["$scope","$modalInstance","diff","ide","eventTracking",function(e,t,n,r,a){return e.state={inflight:!1},e.diff=n,e.restore=function(){return a.sendMB("history-restored"),e.state.inflight=!0,r.historyManager.restoreDiff(n).then((function(){return e.state.inflight=!1,t.close(),r.editorManager.openDoc(n.doc)}))},e.cancel=function(){return t.dismiss()}}]),y.a.directive("infiniteScroll",(function(){return{link:function(e,t,n,r){var a=t.find(".infinite-scroll-inner");t.css({"overflow-y":"auto"});var l=function(){return t.scrollTop()<30},d=function(){return t.scrollTop()+t.height()>=a.height()-30};function h(){if((t.height()>a.height()||(null!=n.infiniteScrollUpwards?l():d()))&&!e.$eval(n.infiniteScrollDisabled))return e.$eval(n.infiniteScroll).then((function(){return setTimeout((function(){return h()}),0)}))}return t.on("scroll",(function(e){return h()})),e.$watch(n.infiniteScrollInitialize,(function(e){if(e)return h()}))}}}));function ld(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cd=((sd=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.reset(),this.$scope.toggleHistory=function(){return"history"===r.$scope.ui.view?r.hide():r.show()},this.$scope.$watch("history.selection.updates",(function(e){if(null!=e&&e.length>0)return r._selectDocFromUpdates(),r.reloadDiff()})),this.$scope.$on("entity:selected",(function(e,t){if("history"===r.$scope.ui.view&&"doc"===t.type)return r.$scope.history.selection.doc=t,r.reloadDiff()}))}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype.BATCH_SIZE=10}}],(n=[{key:"show",value:function(){return this.$scope.ui.view="history",this.reset()}},{key:"hide",value:function(){return this.$scope.ui.view="editor",this.$scope.$emit("entity:selected",this.ide.fileTreeManager.findSelectedEntity())}},{key:"reset",value:function(){return this.$scope.history={updates:[],nextBeforeTimestamp:null,atEnd:!1,selection:{updates:[],doc:null,range:{fromV:null,toV:null,start_ts:null,end_ts:null}},diff:null}}},{key:"autoSelectRecentUpdates",value:function(){if(0!==this.$scope.history.updates.length){this.$scope.history.updates[0].selectedTo=!0;for(var e=0,t=0;t<this.$scope.history.updates.length;t++){var n=this.$scope.history.updates[t];if(this._updateContainsUserId(n,this.$scope.user.id))break;e=t}return this.$scope.history.updates[e].selectedFrom=!0}}},{key:"fetchNextBatchOfUpdates",value:function(){var e=this,t="/project/".concat(this.ide.project_id,"/updates?min_count=").concat(this.BATCH_SIZE);return null!=this.$scope.history.nextBeforeTimestamp&&(t+="&before=".concat(this.$scope.history.nextBeforeTimestamp)),this.$scope.history.loading=!0,this.ide.$http.get(t).then((function(t){var n=t.data;return e._loadUpdates(n.updates),e.$scope.history.nextBeforeTimestamp=n.nextBeforeTimestamp,null==n.nextBeforeTimestamp&&(e.$scope.history.atEnd=!0),e.$scope.history.loading=!1}))}},{key:"reloadDiff",value:function(){var e=this,t=this.$scope.history.diff,n=this.$scope.history.selection,r=(n.updates,n.doc),a=this._calculateRangeFromSelection(),l=a.fromV,d=a.toV,h=a.start_ts,p=a.end_ts;if(null!=r&&(null==t||t.doc!==r||t.fromV!==l||t.toV!==d)){if(this.$scope.history.diff=t={fromV:l,toV:d,start_ts:h,end_ts:p,doc:r,error:!1,pathname:r.name},r.deleted)return t.deleted=!0,t.restoreInProgress=!1,t.restoreDeletedSuccess=!1,t.restoredDocNewId=null;t.loading=!0;var f="/project/".concat(this.$scope.project_id,"/doc/").concat(t.doc.id,"/diff");return null!=t.fromV&&null!=t.toV&&(f+="?from=".concat(t.fromV,"&to=").concat(t.toV)),this.ide.$http.get(f).then((function(n){var r=n.data;t.loading=!1;var a=e._parseDiff(r),l=a.text,d=a.highlights;return t.text=l,t.highlights=d})).catch((function(){return t.loading=!1,t.error=!0}))}}},{key:"restoreDeletedDoc",value:function(e){var t="/project/".concat(this.$scope.project_id,"/doc/").concat(e.id,"/restore");return this.ide.$http.post(t,{name:e.name,_csrf:window.csrfToken})}},{key:"restoreDiff",value:function(e){var t="/project/".concat(this.$scope.project_id,"/doc/").concat(e.doc.id,"/version/").concat(e.fromV,"/restore");return this.ide.$http.post(t,{_csrf:window.csrfToken})}},{key:"_parseDiff",value:function(e){for(var t=0,n=0,r=[],a="",l=e.diff||[],d=0;d<l.length;d++){var h=void 0,p=void 0,f=l[d],y=f.u||f.i||f.d;y||(y=""),a+=y;var w=y.split("\n"),x=t,j=n;w.length>1?(p=x+w.length-1,h=w[w.length-1].length):(p=x,h=j+w[0].length),t=p,n=h;var O={start:{row:x,column:j},end:{row:p,column:h}};if(null!=f.i||null!=f.d){var C=ad(f.meta.user),S=od()(f.meta.end_ts).format("Do MMM YYYY, h:mm a");null!=f.i?r.push({label:"Added by ".concat(C," on ").concat(S),highlight:O,hue:su.a.getHueForUserId(null!=f.meta.user?f.meta.user.id:void 0)}):null!=f.d&&r.push({label:"Deleted by ".concat(C," on ").concat(S),strikeThrough:O,hue:su.a.getHueForUserId(null!=f.meta.user?f.meta.user.id:void 0)})}}return{text:a,highlights:r}}},{key:"_loadUpdates",value:function(e){null==e&&(e=[]);for(var t=this.$scope.history.updates[this.$scope.history.updates.length-1],n=0,r=Array.from(e);n<r.length;n++){var a=r[n];a.pathnames=[];var l=a.docs||{};for(var d in l){var h=l[d];h.entity=this.ide.fileTreeManager.findEntityById(d,{includeDeleted:!0}),a.pathnames.push(h.entity.name)}for(var p=0,f=Array.from(a.meta.users||[]);p<f.length;p++){var y=f[p];null!=y&&(y.hue=su.a.getHueForUserId(y.id))}null!=t&&od()(t.meta.end_ts).isSame(a.meta.end_ts,"day")||(a.meta.first_in_day=!0),a.selectedFrom=!1,a.selectedTo=!1,a.inSelection=!1,t=a}var w=0===this.$scope.history.updates.length;if(this.$scope.history.updates=this.$scope.history.updates.concat(e),w)return this.autoSelectRecentUpdates()}},{key:"_calculateRangeFromSelection",value:function(){for(var e,t,n,r=n=t=e=null,a=null!=this.$scope.history.selection.doc?this.$scope.history.selection.doc.id:void 0,l=0,d=Array.from(this.$scope.history.selection.updates||[]);l<d.length;l++){var h=d[l];for(var p in h.docs){var f=h.docs[p];if(p===a){null!=r&&null!=n?(r=Math.min(r,f.fromV),n=Math.max(n,f.toV),t=Math.min(t,h.meta.start_ts),e=Math.max(e,h.meta.end_ts)):(r=f.fromV,n=f.toV,t=h.meta.start_ts,e=h.meta.end_ts);break}}}return{fromV:r,toV:n,start_ts:t,end_ts:e}}},{key:"_selectDocFromUpdates",value:function(){for(var e,t,n={},r=0,a=Array.from(this.$scope.history.selection.updates);r<a.length;r++){var l=a[r];for(t in l.docs)e=l.docs[t],n[t]=e.entity}var d=this.$scope.history.selection.doc;if(null!=d&&null!=n[d.id]);else{var h=Object.keys(n);h.length>0&&(d=e=n[h[0]])}return this.$scope.history.selection.doc=d,this.ide.fileTreeManager.selectEntity(d)}},{key:"_updateContainsUserId",value:function(e,t){for(var n=0,r=Array.from(e.meta.users);n<r.length;n++){var a=r[n];if((null!=a?a.id:void 0)===t)return!0}return!1}}])&&ld(t.prototype,n),r&&ld(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).initClass(),sd=sd),ud={POINT_IN_TIME:"point_in_time",COMPARE:"compare"},dd=(y.a.controller("HistoryV2ListController",["$scope","$modal","ide",function(e,t,n){return e.hoveringOverListSelectors=!1,e.listConfig={showOnlyLabelled:!1},e.projectUsers=[],e.$watch("project.members",(function(t){if(null!=t)return e.projectUsers=t.concat(e.project.owner)})),e.loadMore=function(){return n.historyManager.fetchNextBatchOfUpdates()},e.handleVersionSelect=function(t){return e.$applyAsync((function(){return n.historyManager.selectVersionForPointInTime(t)}))},e.handleRangeSelect=function(t,r){return e.$applyAsync((function(){return n.historyManager.selectVersionsForCompare(t,r)}))},e.handleLabelDelete=function(e){return t.open({templateUrl:"historyV2DeleteLabelModalTemplate",controller:"HistoryV2DeleteLabelModalController",resolve:{labelDetails:function(){return e}}})}}]),y.a.controller("HistoryV2FileTreeController",["$scope","ide",function(e,t){e.handleFileSelection=function(e){t.historyManager.selectFile(e)}}]),y.a.controller("HistoryV2ToolbarController",["$scope","$modal","ide","eventTracking","waitFor",function(e,t,n,r,a){e.currentUpdate=null,e.currentLabel=null,e.restoreState={inflight:!1,error:!1},e.toolbarUIConfig={showOnlyLabels:!1};var l=e.$watch("history.showOnlyLabels",(function(t){null!=t&&(e.toolbarUIConfig.showOnlyLabels=t,l())}));e.$watch("toolbarUIConfig.showOnlyLabels",(function(e,t){null!=e&&e!==t&&(e?n.historyManager.showOnlyLabels():n.historyManager.showAllUpdates())})),e.$watch("history.viewMode",(function(t,r){null!=t&&t!==r&&(e.currentUpdate=n.historyManager.getUpdateForVersion(t))})),e.$watch("history.selection.range.toV",(function(t,r){null!=t&&t!==r&&e.history.viewMode===e.HistoryViewModes.POINT_IN_TIME&&(e.currentUpdate=n.historyManager.getUpdateForVersion(t))})),e.toggleHistoryViewMode=function(){n.historyManager.toggleHistoryViewMode()},e.restoreDeletedFile=function(){var t=e.history.selection.file,l=t.pathname,d=t.deletedAtV;if(null!=l&&null!=d)return r.sendMB("history-v2-restore-deleted"),e.restoreState.inflight=!0,n.historyManager.restoreFile(d,l).then((function(t){return function(t){var r=t.id,l=t.type;return a((function(){return n.fileTreeManager.findEntityById(r)}),3e3).then((function(t){"doc"===l?(n.editorManager.openDoc(t),n.$timeout((function(){e.$broadcast("history:toggle")}),0)):"file"===l&&(n.binaryFilesManager.openFile(t),n.$timeout((function(){e.$broadcast("history:toggle")}),0))})).catch((function(e){return console.warn(e)}))}(t.data)})).catch((function(){return n.showGenericMessageModal("Sorry, something went wrong with the restore")})).finally((function(){return e.restoreState.inflight=!1}))},e.showAddLabelDialog=function(){t.open({templateUrl:"historyV2AddLabelModalTemplate",controller:"HistoryV2AddLabelModalController",resolve:{update:function(){return e.history.selection.update}}})}}]),y.a.controller("HistoryV2AddLabelModalController",["$scope","$modalInstance","ide","update",function(e,t,n,r){return e.update=r,e.inputs={labelName:null},e.state={inflight:!1,error:!1},t.opened.then((function(){return e.$applyAsync((function(){return e.$broadcast("open")}))})),e.addLabelModalFormSubmit=function(){return e.state.inflight=!0,n.historyManager.labelCurrentVersion(e.inputs.labelName).then((function(n){return e.state.inflight=!1,t.close()})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}))}}]),y.a.controller("HistoryV2DeleteLabelModalController",["$scope","$modalInstance","ide","labelDetails",function(e,t,n,r){return e.labelDetails=r,e.state={inflight:!1,error:!1},e.deleteLabel=function(){return e.state.inflight=!0,n.historyManager.deleteLabel(r).then((function(n){return e.state.inflight=!1,t.close()})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}))}}]),y.a.directive("historyDraggableBoundary",(function(){return{scope:{historyDraggableBoundary:"@",historyDraggableBoundaryOnDragStart:"&",historyDraggableBoundaryOnDragStop:"&"},restrict:"A",link:function(e,t,n){t.data("selectionBoundary",{boundary:e.historyDraggableBoundary}),t.draggable({axis:"y",opacity:!1,helper:"clone",revert:!0,scroll:!0,cursor:"row-resize",start:function(t,n){n.helper.data("wasProperlyDropped",!1),e.historyDraggableBoundaryOnDragStart()},stop:function(t,n){e.historyDraggableBoundaryOnDragStop({isValidDrop:n.helper.data("wasProperlyDropped"),boundary:e.historyDraggableBoundary})}})}}})),y.a.directive("historyDroppableArea",(function(){return{scope:{historyDroppableAreaOnDrop:"&",historyDroppableAreaOnOver:"&",historyDroppableAreaOnOut:"&"},restrict:"A",link:function(e,t,n){t.droppable({accept:function(e){return".history-entry-toV-handle, .history-entry-fromV-handle"},drop:function(t,n){var r=n.draggable.data("selectionBoundary").boundary;n.helper.data("wasProperlyDropped",!0),e.historyDroppableAreaOnDrop({boundary:r})},over:function(t,n){var r=n.draggable.data("selectionBoundary").boundary;e.historyDroppableAreaOnOver({boundary:r})}})}}})),function(e,t,n){var r=this;r.$entryListViewportEl=null,r.isDragging=!1;r.onEntryLinked=function(t,n){r.rangeSelectionEnabled||t.toV!==r.selectedHistoryVersion||e.$applyAsync((function(){(function(e){var t=e.offset().top,n=t+e.outerHeight(),a=r.$entryListViewportEl.offset().top,l=a+r.$entryListViewportEl.height();return t>=a&&n<=l})(n)||r.$entryListViewportEl.scrollTop(function(e){var t=r.$entryListViewportEl.height()/2;return e.offset().top-t}(n))}))},r.handleEntrySelect=function(e){r.rangeSelectionEnabled?r.onRangeSelect({selectedToV:e.toV,selectedFromV:e.fromV}):r.onVersionSelect({version:e.toV})},r.setRangeToV=function(e){e>r.selectedHistoryRange.fromV&&r.onRangeSelect({selectedToV:e,selectedFromV:r.selectedHistoryRange.fromV})},r.setRangeFromV=function(e){e<r.selectedHistoryRange.toV&&r.onRangeSelect({selectedToV:r.selectedHistoryRange.toV,selectedFromV:e})},r.initHoveredRange=function(){r.hoveredHistoryRange={toV:r.selectedHistoryRange.toV,fromV:r.selectedHistoryRange.fromV}},r.resetHoveredRange=function(){r.hoveredHistoryRange={toV:null,fromV:null}},r.setHoveredRangeToV=function(t){t>r.hoveredHistoryRange.fromV&&e.$applyAsync((function(){return r.hoveredHistoryRange.toV=t}))},r.setHoveredRangeFromV=function(t){t<r.hoveredHistoryRange.toV&&e.$applyAsync((function(){return r.hoveredHistoryRange.fromV=t}))},r.onDraggingStart=function(){e.$applyAsync((function(){r.isDragging=!0,r.initHoveredRange()}))},r.onDraggingStop=function(t,n){e.$applyAsync((function(){r.isDragging=!1,t||("toV"===n?r.setRangeToV(r.hoveredHistoryRange.toV):"fromV"===n&&r.setRangeFromV(r.hoveredHistoryRange.fromV)),r.resetHoveredRange()}))},r.$onInit=function(){r.$entryListViewportEl=t.find("> .history-entries"),r.resetHoveredRange()}});dd.$inject=["$scope","$element","$attrs"];y.a.component("historyEntriesList",{bindings:{entries:"<",users:"<",loadEntries:"&",loadDisabled:"<",loadInitialize:"<",isLoading:"<",currentUser:"<",freeHistoryLimitHit:"<",currentUserIsOwner:"<",rangeSelectionEnabled:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",onVersionSelect:"&",onRangeSelect:"&",onLabelDelete:"&"},controller:dd,templateUrl:"historyEntriesListTpl"});var hd=function(e,t,n){var r=this;r.displayName=ad,r.displayNameById=function(e){return ad(function(e){return O.a.find(r.users,(function(t){return((null!=t?t._id:void 0)||(null!=t?t.id:void 0))===e}))}(e))},r.getProjectOpDoc=function(e){return null!=e.rename?"".concat(e.rename.pathname," → ").concat(e.rename.newPathname):null!=e.add?"".concat(e.add.pathname):null!=e.remove?"".concat(e.remove.pathname):void 0},r.getUserCSSStyle=function(e){var t=(null!=e?e._id:void 0)||(null!=e?e.id:void 0),n=su.a.getHueForUserId(t)||100;return r.isEntrySelected()||r.isEntryHoverSelected()?{color:"#FFF"}:{color:"hsl(".concat(n,", 70%, 50%)")}},r.isEntrySelected=function(){return r.rangeSelectionEnabled?r.entry.toV<=r.selectedHistoryRange.toV&&r.entry.fromV>=r.selectedHistoryRange.fromV:r.entry.toV===r.selectedHistoryVersion},r.isEntryHoverSelected=function(){return r.rangeSelectionEnabled&&r.entry.toV<=r.hoveredHistoryRange.toV&&r.entry.fromV>=r.hoveredHistoryRange.fromV},r.onDraggingStart=function(){r.historyEntriesList.onDraggingStart()},r.onDraggingStop=function(e,t){return r.historyEntriesList.onDraggingStop(e,t)},r.onDrop=function(t){"toV"===t?e.$applyAsync((function(){return r.historyEntriesList.setRangeToV(r.entry.toV)})):"fromV"===t&&e.$applyAsync((function(){return r.historyEntriesList.setRangeFromV(r.entry.fromV)}))},r.onOver=function(t){"toV"===t?e.$applyAsync((function(){return r.historyEntriesList.setHoveredRangeToV(r.entry.toV)})):"fromV"===t&&e.$applyAsync((function(){return r.historyEntriesList.setHoveredRangeFromV(r.entry.fromV)}))},r.$onInit=function(){r.$entryEl=t.find("> .history-entry"),r.$entryDetailsEl=t.find(".history-entry-details"),r.$toVHandleEl=t.find(".history-entry-toV-handle"),r.$fromVHandleEl=t.find(".history-entry-fromV-handle"),r.historyEntriesList.onEntryLinked(r.entry,r.$entryEl)}};hd.$inject=["$scope","$element","$attrs"];y.a.component("historyEntry",{bindings:{entry:"<",currentUser:"<",users:"<",rangeSelectionEnabled:"<",isDragging:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",hoveredHistoryRange:"<?",onSelect:"&",onLabelDelete:"&"},require:{historyEntriesList:"^historyEntriesList"},controller:hd,templateUrl:"historyEntryTpl"});var pd=function(e,t,n){var r=this;r.isDragging=!1,r.versionsWithLabels=[],e.$watchCollection("$ctrl.labels",(function(e){if(e){var t=O.a.groupBy(e,"version");r.versionsWithLabels=O.a.map(t,(function(e,t){return{version:parseInt(t,10),labels:e}}))}})),r.initHoveredRange=function(){r.hoveredHistoryRange={toV:r.selectedHistoryRange.toV,fromV:r.selectedHistoryRange.fromV}},r.resetHoveredRange=function(){r.hoveredHistoryRange={toV:null,fromV:null}},r.setHoveredRangeToV=function(e){e>=r.hoveredHistoryRange.fromV&&(r.hoveredHistoryRange.toV=e)},r.setHoveredRangeFromV=function(e){e<=r.hoveredHistoryRange.toV&&(r.hoveredHistoryRange.fromV=e)},r.isVersionSelected=function(e){return r.rangeSelectionEnabled?e<=r.selectedHistoryRange.toV&&e>=r.selectedHistoryRange.fromV:e===r.selectedHistoryVersion},r.isVersionHoverSelected=function(e){return r.rangeSelectionEnabled&&e<=r.hoveredHistoryRange.toV&&e>=r.hoveredHistoryRange.fromV},r.onDraggingStart=function(){e.$applyAsync((function(){r.isDragging=!0,r.initHoveredRange()}))},r.onDraggingStop=function(t,n){e.$applyAsync((function(){t||("toV"===n?r.setRangeToV(r.hoveredHistoryRange.toV):"fromV"===n&&r.setRangeFromV(r.hoveredHistoryRange.fromV)),r.isDragging=!1,r.resetHoveredRange()}))},r.onDrop=function(t,n){"toV"===t?e.$applyAsync((function(){return r.setRangeToV(n.version)})):"fromV"===t&&e.$applyAsync((function(){return r.setRangeFromV(n.version)}))},r.onOver=function(t,n){"toV"===t?e.$applyAsync((function(){return r.setHoveredRangeToV(n.version)})):"fromV"===t&&e.$applyAsync((function(){return r.setHoveredRangeFromV(n.version)}))},r.handleVersionSelect=function(e){r.rangeSelectionEnabled?r.onRangeSelect({selectedToV:e.version,selectedFromV:e.version}):r.onVersionSelect({version:e.version})},r.setRangeToV=function(e){e>=r.selectedHistoryRange.fromV&&r.onRangeSelect({selectedToV:e,selectedFromV:r.selectedHistoryRange.fromV})},r.setRangeFromV=function(e){e<=r.selectedHistoryRange.toV&&r.onRangeSelect({selectedToV:r.selectedHistoryRange.toV,selectedFromV:e})},r.buildUserView=function(e){return{_id:e.user_id,displayName:e.user_display_name}},r.displayName=ad,r.getUserCSSStyle=function(e,t){var n=(null!=e?e._id:void 0)||(null!=e?e.id:void 0),a=su.a.getHueForUserId(n)||100;return r.isVersionSelected(t.version)||r.isVersionHoverSelected(t.version)?{color:"#FFF"}:{color:"hsl(".concat(a,", 70%, 50%)")}},r.$onInit=function(){r.resetHoveredRange()}};pd.$inject=["$scope","$element","$attrs"];y.a.component("historyLabelsList",{bindings:{labels:"<",rangeSelectionEnabled:"<",users:"<",currentUser:"<",isLoading:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",onVersionSelect:"&",onRangeSelect:"&",onLabelDelete:"&"},controller:pd,templateUrl:"historyLabelsListTpl"});var fd=function(e,t,n,r){var a=this;a.$onInit=function(){null==a.showTooltip&&(a.showTooltip=!0),null==a.isPseudoCurrentStateLabel&&(a.isPseudoCurrentStateLabel=!1)}};fd.$inject=["$scope","$element","$attrs","$filter"];y.a.component("historyLabel",{bindings:{labelText:"<",labelOwnerName:"<?",labelCreationDateTime:"<?",isOwnedByCurrentUser:"<",isPseudoCurrentStateLabel:"<",onLabelDelete:"&",showTooltip:"<?"},controller:fd,templateUrl:"historyLabelTpl"});var gd=function(e,t,n){var r=this;function a(e,t){for(var n=t.pathname.split("/"),r=e,a=function(e){var a=void 0,l=n[e];e===n.length-1?((a=O.a.clone(t)).name=l,a.type="file",r.push(a)):(null==(a=O.a.find(r,(function(e){return e.name===l})))&&(a={name:l,type:"folder",children:[]},r.push(a)),r=a.children)},l=0;l<n.length;l++)a(l);return e}r.handleEntityClick=function(e){return r.onSelectedFileChange({file:e})},r._fileTree=[],e.$watch("$ctrl.files",(function(e){null!=e&&e.length>0&&(r._fileTree=O.a.reduce(e,a,[]))}))};gd.$inject=["$scope","$element","$attrs"];y.a.component("historyFileTree",{bindings:{files:"<",selectedPathname:"<",onSelectedFileChange:"&",isLoading:"<"},controller:gd,templateUrl:"historyFileTreeTpl"});void 0!==window.fileActionI18n&&window.fileActionI18n;var md={edited:"edited",renamed:"renamed",created:"created",deleted:"deleted"};function vd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yd=function(e,t,n){var r=this;r.hasOperation=!1,r.getRenameTooltip=function(e){var t=vd(a(r.fileEntity.oldPathname,r.fileEntity.pathname),2),n=t[0],l=t[1];return"".concat(md.renamed," <strong>").concat(n,"</strong> &rarr; <strong>").concat(l,"</strong>")},r.getFileOperationName=function(){return"edited"===r.fileEntity.operation?md.edited:"renamed"===r.fileEntity.operation?md.renamed:"added"===r.fileEntity.operation?md.created:"removed"===r.fileEntity.operation?md.deleted:""};var a=function(e,t){var n,r=e.split("/"),a=t.split("/"),l=Math.min(r.length,a.length)-1;for(n=0;n<l&&r[n]===a[n];n++);return r.splice(0,n),a.splice(0,n),[r.join("/"),a.join("/")]},l=function(){r.isOpen=!r.isOpen,r.entityTypeIconClass=h()},d=function(){return r.historyFileTreeController.handleEntityClick(r.fileEntity)};function h(){return r.isOpen?"fa-folder-open":"fa-folder"}r.$onInit=function(){"folder"===r.fileEntity.type?(r.isOpen=!0,r.entityTypeIconClass=h(),r.handleClick=l):(r.fileEntity.operation&&(r.hasOperation=!0),r.entityTypeIconClass="fa-".concat(w(r.fileEntity.name)),r.entityOpTextClass=r.fileEntity.operation?"history-file-entity-name-".concat(r.fileEntity.operation):null,r.handleClick=d,e.$watch((function(){return r.historyFileTreeController.selectedPathname}),(function(e){return r.isSelected=r.fileEntity.pathname===e})))}};yd.$inject=["$scope","$element","$attrs"];y.a.component("historyFileEntity",{require:{historyFileTreeController:"^historyFileTree"},bindings:{fileEntity:"<"},controller:yd,templateUrl:"historyFileEntityTpl"});var wd,xd=n(140);function jd(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Od(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Od(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Od(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Sd=((wd=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.labelCurrentVersion=this.labelCurrentVersion.bind(this),this.deleteLabel=this.deleteLabel.bind(this),this._addLabelLocally=this._addLabelLocally.bind(this),this.ide=t,this.$scope=n,this.localStorage=r,this.$scope.HistoryViewModes=ud,this._localStorageViewModeProjKey="history.userPrefs.viewMode.".concat(n.project_id),this._localStorageShowOnlyLabelsProjKey="history.userPrefs.showOnlyLabels.".concat(n.project_id),this._previouslySelectedPathname=null,this._loadFileTreeRequestCanceller=null,this.hardReset(),this.$scope.toggleHistory=function(){"history"===a.$scope.ui.view?a.hide():(a.show(),a._handleHistoryUIStateChange()),a.ide.$timeout((function(){a.$scope.$broadcast("history:toggle")}),0)},this.$scope.isHistoryLoading=function(){var e=a.$scope.history.selection;return a.$scope.history.loadingFileTree||a.$scope.history.viewMode===ud.POINT_IN_TIME&&e.file&&e.file.loading||a.$scope.history.viewMode===ud.COMPARE&&e.diff&&e.diff.loading}}var t,n,r;return t=e,r=[{key:"initClass",value:function(){this.prototype.MAX_RECENT_UPDATES_TO_SELECT=5,this.prototype.BATCH_SIZE=10}}],(n=[{key:"show",value:function(){this.$scope.ui.view="history",this.hardReset(),this.$scope.history.showOnlyLabels&&this.fetchNextBatchOfUpdates()}},{key:"hide",value:function(){this.$scope.ui.view="editor"}},{key:"_getViewModeUserPref",value:function(){return this.localStorage(this._localStorageViewModeProjKey)||ud.POINT_IN_TIME}},{key:"_getShowOnlyLabelsUserPref",value:function(){return this.localStorage(this._localStorageShowOnlyLabelsProjKey)||!1}},{key:"_setViewModeUserPref",value:function(e){e!==ud.POINT_IN_TIME&&e!==ud.COMPARE||this.localStorage(this._localStorageViewModeProjKey,e)}},{key:"_setShowOnlyLabelsUserPref",value:function(e){this.localStorage(this._localStorageShowOnlyLabelsProjKey,!!e)}},{key:"hardReset",value:function(){var e=this;this.$scope.history={isV2:!0,updates:[],viewMode:this._getViewModeUserPref(),nextBeforeTimestamp:null,loading:!1,atEnd:!1,userHasFullFeature:void 0,freeHistoryLimitHit:!1,selection:{docs:{},pathname:null,range:{fromV:null,toV:null},hoveredRange:{fromV:null,toV:null},diff:null,files:[],file:null},error:null,showOnlyLabels:this._getShowOnlyLabelsUserPref(),labels:null,loadingFileTree:!0};var t=this.$scope.$watch("project.features.versioning",(function(n){null!=n&&(e.$scope.history.userHasFullFeature=n,e.$scope.user.isAdmin&&(e.$scope.history.userHasFullFeature=!0),t())}))}},{key:"softReset",value:function(){this.$scope.history.viewMode=this._getViewModeUserPref(),this.$scope.history.selection={docs:{},pathname:null,range:{fromV:null,toV:null},hoveredRange:{fromV:null,toV:null},diff:null,files:[],file:null},this.$scope.history.error=null,this.$scope.history.showOnlyLabels=this._getShowOnlyLabelsUserPref()}},{key:"toggleHistoryViewMode",value:function(){var e=this;this.$scope.history.viewMode===ud.COMPARE?(this.softReset(),this.$scope.history.viewMode=ud.POINT_IN_TIME,this._setViewModeUserPref(ud.POINT_IN_TIME)):(this.softReset(),this.$scope.history.viewMode=ud.COMPARE,this._setViewModeUserPref(ud.COMPARE)),this._handleHistoryUIStateChange(),this.ide.$timeout((function(){e.$scope.$broadcast("history:toggle")}),0)}},{key:"_handleHistoryUIStateChange",value:function(){this.$scope.history.viewMode===ud.COMPARE?this.$scope.history.showOnlyLabels?this.autoSelectLabelsForComparison():this.autoSelectRecentUpdates():this.$scope.history.showOnlyLabels?this.autoSelectLabelForPointInTime():this.autoSelectVersionForPointInTime()}},{key:"setHoverFrom",value:function(e){var t=this.$scope.history.selection;t.hoveredRange.fromV=e,t.hoveredRange.toV=t.range.toV,this.$scope.history.hoveringOverListSelectors=!0}},{key:"setHoverTo",value:function(e){var t=this.$scope.history.selection;t.hoveredRange.toV=e,t.hoveredRange.fromV=t.range.fromV,this.$scope.history.hoveringOverListSelectors=!0}},{key:"resetHover",value:function(){var e=this.$scope.history.selection;e.hoveredRange.toV=null,e.hoveredRange.fromV=null,this.$scope.history.hoveringOverListSelectors=!1}},{key:"showAllUpdates",value:function(){this.$scope.history.showOnlyLabels&&(this.$scope.history.showOnlyLabels=!1,this._setShowOnlyLabelsUserPref(!1),this._handleHistoryUIStateChange())}},{key:"showOnlyLabels",value:function(){this.$scope.history.showOnlyLabels||(this.$scope.history.showOnlyLabels=!0,this._setShowOnlyLabelsUserPref(!0),this._handleHistoryUIStateChange())}},{key:"restoreFile",value:function(e,t){var n="/project/".concat(this.$scope.project_id,"/restore_file");return this.ide.$http.post(n,{version:e,pathname:t,_csrf:window.csrfToken})}},{key:"loadFileTreeForVersion",value:function(e){return this._loadFileTree(e,e)}},{key:"loadFileTreeDiff",value:function(e,t){return this._loadFileTree(e,t)}},{key:"_loadFileTree",value:function(e,t){var n=this,r="/project/".concat(this.$scope.project_id,"/filetree/diff"),a=this.$scope.history.selection,l=["from=".concat(t),"to=".concat(e)];return r+="?".concat(l.join("&")),this.$scope.$applyAsync((function(){return n.$scope.history.loadingFileTree=!0})),a.file=null,a.pathname=null,null!=this._loadFileTreeRequestCanceller&&this._loadFileTreeRequestCanceller.resolve(),this._loadFileTreeRequestCanceller=this.ide.$q.defer(),this.ide.$http.get(r,{timeout:this._loadFileTreeRequestCanceller.promise}).then((function(e){n.$scope.history.selection.files=e.data.diff;var t,r=jd(n.$scope.history.selection.files);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a.newPathname&&(a.oldPathname=a.pathname,a.pathname=a.newPathname,delete a.newPathname)}}catch(e){r.e(e)}finally{r.f()}n._loadFileTreeRequestCanceller=null,n.$scope.history.loadingFileTree=!1,n.autoSelectFile()})).catch((function(e){-1!==e.status?n._loadFileTreeRequestCanceller=null:n.$scope.history.loadingFileTree=!1}))}},{key:"selectFile",value:function(e){null!=e&&null!=e.pathname&&(this.$scope.history.selection.pathname=this._previouslySelectedPathname=e.pathname,this.$scope.history.selection.file=e,this.$scope.history.viewMode===ud.POINT_IN_TIME?this.loadFileAtPointInTime():this.reloadDiff())}},{key:"autoSelectFile",value:function(){var e=this.$scope.history.selection.files,t=null,n=null,r=!1,a=this._getFilesWithOps();if(null!=this._previouslySelectedPathname&&(n=O.a.find(e,{pathname:this._previouslySelectedPathname}),r=O.a.some(a,{pathname:this._previouslySelectedPathname})),null!=n&&r)t=n;else{var l,d=jd(["edited","added","renamed","removed"]);try{for(d.s();!(l=d.n()).done;){var h=l.value,p=O.a.find(a,{operation:h});if(null!=p){t=O.a.find(e,{pathname:p.pathname});break}}}catch(e){d.e(e)}finally{d.f()}if(null==t)if(null!=n)t=n;else{var f=O.a.find(e,(function(e){return/main\.tex$/.test(e.pathname)}));if(null!=f)t=f;else{var y=O.a.find(e,(function(e){return/\.tex$/.test(e.pathname)}));t=null!=y?y:e[0]}}}this.selectFile(t)}},{key:"_getFilesWithOps",value:function(){var e;if(this.$scope.history.viewMode===ud.POINT_IN_TIME){var t=this.getUpdateForVersion(this.$scope.history.selection.range.toV);if(e=[],null!=t){var n,r=jd(t.pathnames);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.push({pathname:a,operation:"edited"})}}catch(e){r.e(e)}finally{r.f()}var l,d=jd(t.project_ops);try{for(d.s();!(l=d.n()).done;){var h=l.value,p=void 0;null!=h.add?p={pathname:h.add.pathname,operation:"added"}:null!=h.remove?p={pathname:h.remove.pathname,operation:"removed"}:null!=h.rename&&(p={pathname:h.rename.newPathname,operation:"renamed"}),null!=p&&e.push(p)}}catch(e){d.e(e)}finally{d.f()}}}else e=O.a.reduce(this.$scope.history.selection.files,(function(e,t){return t.operation&&e.push({pathname:t.pathname,operation:t.operation}),e}),[]);return e}},{key:"autoSelectRecentUpdates",value:function(){if(0!==this.$scope.history.updates.length){for(var e,t=this.$scope.history.updates[0].toV,n=0,r=0;r<this.$scope.history.updates.length;r++){var a=this.$scope.history.updates[r];if(this._updateContainsUserId(a,this.$scope.user.id)||r>this.MAX_RECENT_UPDATES_TO_SELECT)break;n=r}e=this.$scope.history.updates[n].fromV,this.selectVersionsForCompare(t,e)}}},{key:"autoSelectVersionForPointInTime",value:function(){if(0!==this.$scope.history.updates.length){var e=this.$scope.history.updates[0].toV,t=this.$scope.history.selection.range;null!=t.toV&&null!=t.fromV&&t.toV===t.fromV&&(e=t.toV),this.selectVersionForPointInTime(e)}}},{key:"autoSelectLastLabel",value:function(){if(null!=this.$scope.history.labels&&0!==this.$scope.history.labels.length)return this.selectLabelForPointInTime(this.$scope.history.labels[0])}},{key:"expandSelectionToVersion",value:function(e){e>this.$scope.history.selection.range.toV?this.$scope.history.selection.range.toV=e:e<this.$scope.history.selection.range.fromV&&(this.$scope.history.selection.range.fromV=e)}},{key:"selectVersionForPointInTime",value:function(e){var t=this.$scope.history.selection;t.range.toV!==e&&t.range.fromV!==e&&(t.range.toV=e,t.range.fromV=e,this.loadFileTreeForVersion(e))}},{key:"selectVersionsForCompare",value:function(e,t){var n=this.$scope.history.selection.range;n.toV===e&&n.fromV===t||(n.toV=e,n.fromV=t,this.loadFileTreeDiff(e,t))}},{key:"autoSelectLabelForPointInTime",value:function(){var e=this.getUpdateForVersion(this.$scope.history.selection.range.toV),t=0;if(null!=e&&null!=e.labels&&(t=e.labels.length),0===t)this.autoSelectLastLabel();else if(1===t)this.selectLabelForPointInTime(e.labels[0]);else if(t>1){var n=this.ide.$filter("orderBy")(e.labels,"-created_at")[0];this.selectLabelForPointInTime(n)}}},{key:"selectLabelForPointInTime",value:function(e){var t=null;if(!this._isLabelSelected(e)){for(var n=0,r=Array.from(this.$scope.history.updates);n<r.length;n++){var a=r[n];if(a.toV===e.version){t=a;break}}if(null!=t)this.selectVersionForPointInTime(t.toV);else{var l=this.$scope.history.selection;l.range.toV=e.version,l.range.fromV=e.version,this.loadFileTreeForVersion(e.version)}}}},{key:"getUpdateForVersion",value:function(e){var t,n=jd(this.$scope.history.updates);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.toV===e)return r}}catch(e){n.e(e)}finally{n.f()}}},{key:"autoSelectLabelsForComparison",value:function(){var e=this.$scope.history.labels,t=0;Array.isArray(e)&&(t=e.length),0===t||(1===t?this.selectVersionsForCompare(e[0].version,e[0].version):t>1&&this.selectVersionsForCompare(e[0].version,e[1].version))}},{key:"fetchNextBatchOfUpdates",value:function(){var e=this;if(!this.$scope.history.atEnd){var t="/project/".concat(this.ide.project_id,"/updates?min_count=").concat(this.BATCH_SIZE);null!=this.$scope.history.nextBeforeTimestamp&&(t+="&before=".concat(this.$scope.history.nextBeforeTimestamp));var n="/project/".concat(this.ide.project_id,"/labels"),r={updates:this.ide.$http.get(t)};return null==this.$scope.history.labels&&(r.labels=this.ide.$http.get(n)),this.$scope.history.loading=!0,this.ide.$q.all(r).then((function(t){e.$scope.history.loading=!1;var n=t.updates.data,r=null;n.updates.length>0&&(r=n.updates[0].toV),null!=t.labels&&(e.$scope.history.labels=e._loadLabels(t.labels.data,r)),e._loadUpdates(n.updates),e.$scope.history.nextBeforeTimestamp=n.nextBeforeTimestamp,(null==n.nextBeforeTimestamp||e.$scope.history.freeHistoryLimitHit||0===e.$scope.history.updates.length)&&(e.$scope.history.atEnd=!0),0===e.$scope.history.updates.length&&(e.$scope.history.loadingFileTree=!1)})).catch((function(t){e.$scope.history.loading=!1;var n=t.status,r=t.statusText;e.$scope.history.error={status:n,statusText:r},e.$scope.history.atEnd=!0,e.$scope.history.loadingFileTree=!1}))}}},{key:"_loadLabels",value:function(e,t){var n=this._sortLabelsByVersionAndDate(e),r=this._deletePseudoCurrentStateLabelIfExistent(n);return this._addPseudoCurrentStateLabelIfNeeded(r,t)}},{key:"_deletePseudoCurrentStateLabelIfExistent",value:function(e){return e.length&&e[0].isPseudoCurrentStateLabel&&e.shift(),e}},{key:"_addPseudoCurrentStateLabelIfNeeded",value:function(e,t){if(e.length&&e[0].version!==t||0===e.length){var n={id:"1",isPseudoCurrentStateLabel:!0,version:t,created_at:(new Date).toISOString()};e.unshift(n)}return e}},{key:"_sortLabelsByVersionAndDate",value:function(e){return this.ide.$filter("orderBy")(e,["isPseudoCurrentStateLabel","-version","-created_at"])}},{key:"loadFileAtPointInTime",value:function(){var e=this,t=this.$scope.history.selection.range.toV,n=this.$scope.history.selection.pathname;if(null!=t){var r="/project/".concat(this.$scope.project_id,"/diff"),a=["pathname=".concat(encodeURIComponent(n)),"from=".concat(t),"to=".concat(t)];return r+="?".concat(a.join("&")),this.$scope.history.selection.file.loading=!0,this.ide.$http.get(r).then((function(t){var n=e._parseDiff(t.data.diff),r=n.text,a=n.binary;e.$scope.history.selection.file.binary=a,e.$scope.history.selection.file.text=r,e.$scope.history.selection.file.loading=!1})).catch((function(){}))}}},{key:"reloadDiff",value:function(){var e=this,t=this.$scope.history.selection.diff,n=this.$scope.history.selection,r=n.range,a=n.pathname,l=r.fromV,d=r.toV;if(null!=a){if(null==t||t.pathname!==a||t.fromV!==l||t.toV!==d){this.$scope.history.selection.diff=t={fromV:l,toV:d,pathname:a,error:!1},t.loading=!0;var h="/project/".concat(this.$scope.project_id,"/diff"),p=["pathname=".concat(encodeURIComponent(a))];return null!=t.fromV&&null!=t.toV&&p.push("from=".concat(t.fromV),"to=".concat(t.toV)),h+="?".concat(p.join("&")),this.ide.$http.get(h).then((function(n){var r=n.data;t.loading=!1;var a=e._parseDiff(r.diff),l=a.text,d=a.highlights,h=a.binary;t.binary=h,t.text=l,t.highlights=d})).catch((function(){t.loading=!1,t.error=!0}))}}else this.$scope.history.selection.diff=null}},{key:"labelCurrentVersion",value:function(e){return this._labelVersion(e,this.$scope.history.selection.range.toV)}},{key:"deleteLabel",value:function(e){var t=this,n="/project/".concat(this.$scope.project_id,"/labels/").concat(e.id);return this.ide.$http({url:n,method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(n){return t._deleteLabelLocally(e)}))}},{key:"_deleteLabelLocally",value:function(e){for(var t=0;t<this.$scope.history.updates.length;t++){var n=this.$scope.history.updates[t];if(n.toV===e.version){n.labels=O.a.filter(n.labels,(function(t){return t.id!==e.id}));break}}this.$scope.history.labels=this._loadLabels(O.a.filter(this.$scope.history.labels,(function(t){return t.id!==e.id})),this.$scope.history.updates[0].toV),this._handleHistoryUIStateChange()}},{key:"_isLabelSelected",value:function(e){return!!e&&e.version<=this.$scope.history.selection.range.toV&&e.version>=this.$scope.history.selection.range.fromV}},{key:"_parseDiff",value:function(e){if(e.binary)return{binary:!0};for(var t=0,n=0,r=[],a="",l=e||[],d=0;d<l.length;d++){var h=void 0,p=void 0,f=l[d],y=f.u||f.i||f.d;y||(y=""),a+=y;var w=y.split("\n"),x=t,j=n;w.length>1?(p=x+w.length-1,h=w[w.length-1].length):(p=x,h=j+w[0].length),t=p,n=h;var O={start:{row:x,column:j},end:{row:p,column:h}};if(null!=f.i||null!=f.d){var C=null!=f.meta.users?f.meta.users[0]:void 0,S=ad(C),_=od()(f.meta.end_ts).format("Do MMM YYYY, h:mm a");null!=f.i?r.push({label:"Added by ".concat(S," on ").concat(_),highlight:O,hue:su.a.getHueForUserId(null!=C?C.id:void 0)}):null!=f.d&&r.push({label:"Deleted by ".concat(S," on ").concat(_),strikeThrough:O,hue:su.a.getHueForUserId(null!=C?C.id:void 0)})}}return{text:a,highlights:r}}},{key:"_loadUpdates",value:function(e){null==e&&(e=[]);for(var t=this.$scope.history.updates[this.$scope.history.updates.length-1],n=new Date,r=n.setDate(n.getDate()-1),a=null,l=e||[],d=0;d<l.length;d++){for(var h=l[d],p=0,f=Array.from(h.meta.users||[]);p<f.length;p++){var y=f[p];null!=y&&(y.hue=su.a.getHueForUserId(y.id))}if(null!=t&&od()(t.meta.end_ts).isSame(h.meta.end_ts,"day")||(h.meta.first_in_day=!0),t=h,!this.$scope.history.userHasFullFeature&&h.meta.end_ts<r){a=d||1,this.$scope.history.freeHistoryLimitHit=!0,this.$scope.project.owner._id===this.$scope.user.id&&(ga("send","event","subscription-funnel","editor-click-feature","history"),Object(xd.a)("history"));break}}var w=0===this.$scope.history.updates.length;this.$scope.history.userHasFullFeature||null==a||(e=e.slice(0,a)),this.$scope.history.updates=this.$scope.history.updates.concat(e),w&&this._handleHistoryUIStateChange()}},{key:"_labelVersion",value:function(e,t){var n=this,r="/project/".concat(this.$scope.project_id,"/labels");return this.ide.$http.post(r,{comment:e,version:t,_csrf:window.csrfToken}).then((function(e){return n._addLabelLocally(e.data)}))}},{key:"_addLabelLocally",value:function(e){var t=O.a.find(this.$scope.history.updates,(function(t){return t.toV===e.version}));null!=t&&(t.labels=t.labels.concat(e)),this.$scope.history.labels=this._loadLabels(this.$scope.history.labels.concat(e),this.$scope.history.updates[0].toV),this._handleHistoryUIStateChange()}},{key:"_updateContainsUserId",value:function(e,t){for(var n=0,r=Array.from(e.meta.users);n<r.length;n++){var a=r[n];if((null!=a?a.id:void 0)===t)return!0}return!1}}])&&Cd(t.prototype,n),r&&Cd(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()).initClass(),wd=wd);function _d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kd(e,t,n){return t&&_d(e.prototype,t),n&&_d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ed=kd((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.permissions={read:!1,write:!1,admin:!1,comment:!1},this.$scope.$watch("permissionsLevel",(function(e){if(null!=e&&("readOnly"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.write=!1,r.$scope.permissions.admin=!1,r.$scope.permissions.comment=!0):"readAndWrite"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.comment=!0):"owner"===e&&(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.admin=!0,r.$scope.permissions.comment=!0)),r.$scope.anonymous)return r.$scope.permissions.comment=!1}))}));function Ad(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $d=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("entity:selected",(function(e,t){return"track-changes"!==r.$scope.ui.view&&"file"===t.type?r.openFile(t):"doc"===t.type?r.closeFile():void 0}))}var t,n,r;return t=e,(n=[{key:"openFile",value:function(e){var t=this;return this.ide.fileTreeManager.selectEntity(e),this.$scope.ui.view="file",this.$scope.openFile=null,this.$scope.$apply(),window.setTimeout((function(){t.$scope.openFile=e,t.$scope.$apply(),t.$scope.$broadcast("file-view:file-opened")}),0,this)}},{key:"closeFile",value:function(){var e=this;return window.setTimeout((function(){e.$scope.openFile=null,e.$scope.ui.view="editor",e.$scope.$apply()}),0,this)}}])&&Ad(t.prototype,n),r&&Ad(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Td=n(486),Rd=n.n(Td);function Id(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pd=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$root._references=this.state={keys:[]},this.existingIndexHash={},this.$scope.$on("document:closed",(function(e,t){var n,a,l;if(t.doc_id&&(n=r.ide.fileTreeManager.findEntityById(t.doc_id)),a=null!=n?n.name:void 0,l=function(e){return e.match(/.*\.bib$/)},null!=a?l(a):void 0)return r.indexReferencesIfDocModified(t,!0)})),this.$scope.$on("references:should-reindex",(function(e,t){return r.indexAllReferences(!0)})),this.inited=!1,this.$scope.$on("project:joined",(function(e){r.inited||(r.inited=!0,r.ide.socket.on("references:keys:updated",(function(e){return r._storeReferencesKeys(e)})),r.indexAllReferences(!1))}))}var t,n,r;return t=e,(n=[{key:"_storeReferencesKeys",value:function(e){var t=this.$scope.$root._references.keys,n=O.a.union(t,e);return window.dispatchEvent(new CustomEvent("project:references",{detail:n})),this.$scope.$root._references.keys=n}},{key:"indexReferencesIfDocModified",value:function(e,t){var n=e.doc_id,r=e._doc.snapshot,a=Date.now(),l=Rd()("blob "+r.length+"\0"+r).toString(),d=this.existingIndexHash[n];d&&d.timestamp>a-216e5&&d.hash===l||(this.indexReferences([n],t),this.existingIndexHash[n]={hash:l,timestamp:a})}},{key:"indexReferences",value:function(e,t){var n=this,r={docIds:e,shouldBroadcast:t,_csrf:window.csrfToken};return this.ide.$http.post("/project/".concat(this.$scope.project_id,"/references/index"),r).then((function(e){return n._storeReferencesKeys(e.data.keys)}))}},{key:"indexAllReferences",value:function(e){var t=this,n={shouldBroadcast:e,_csrf:window.csrfToken};return this.ide.$http.post("/project/".concat(this.$scope.project_id,"/references/indexAll"),n).then((function(e){return t._storeReferencesKeys(e.data.keys)}))}}])&&Id(t.prototype,n),r&&Id(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Dd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Md=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.metadata=r,this.ide.socket.on("broadcastDocMeta",(function(e){return a.metadata.onBroadcastDocMeta(e)})),this.$scope.$on("entity:deleted",this.metadata.onEntityDeleted)}var t,n,r;return t=e,(n=[{key:"loadProjectMetaFromServer",value:function(){return this.metadata.loadProjectMetaFromServer()}}])&&Dd(t.prototype,n),r&&Dd(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ld=(y.a.controller("ReviewPanelController",["$scope","$element","ide","$timeout","$http","$modal","eventTracking","localStorage",function(e,t,n,r,a,l,d,h){var p,f=t.find("#review-panel"),y="member",w="guest",x="anonymous",j=function(){if(null==(null!=n.$scope.user?n.$scope.user.id:void 0))return x;var e=n.$scope.user.id,t=n.$scope.project;if((null!=t.owner?t.owner.id:void 0)===e)return y;for(var r=0,a=Array.from(t.members);r<a.length;r++){if(a[r]._id===e)return y}return w};e.SubViews={CUR_FILE:"cur_file",OVERVIEW:"overview"},e.UserTCSyncState=p={SYNCED:"synced",PENDING:"pending"},e.reviewPanel={trackChangesState:{},trackChangesOnForEveryone:!1,trackChangesOnForGuests:!1,trackChangesForGuestsAvailable:!1,entries:{},resolvedComments:{},hasEntries:!1,subView:e.SubViews.CUR_FILE,openSubView:e.SubViews.CUR_FILE,overview:{loading:!1,docsCollapsedState:JSON.parse(h("docs_collapsed_state:".concat(e.project_id)))||{}},dropdown:{loading:!1},commentThreads:{},resolvedThreadIds:{},rendererData:{},formattedProjectMembers:{},fullTCStateCollapsed:!0,loadingThreads:!1,selectedEntryIds:[],nVisibleSelectedChanges:0},window.addEventListener("beforeunload",(function(){var t={};for(var n in e.reviewPanel.overview.docsCollapsedState){var r=e.reviewPanel.overview.docsCollapsedState[n];r&&(t[n]=r)}var a=Object.keys(t).length>0?JSON.stringify(t):null;return h("docs_collapsed_state:".concat(e.project_id),a)})),e.$on("layout:pdf:linked",(function(t,n){return e.$broadcast("review-panel:layout")})),e.$on("layout:pdf:resize",(function(t,n){return e.$broadcast("review-panel:layout",!1)})),e.$on("expandable-text-area:resize",(function(t){return r((function(){return e.$broadcast("review-panel:layout")}))})),e.$on("review-panel:sizes",(function(t,n){return e.$broadcast("editor:set-scroll-size",n)})),e.$watch("project.features.trackChangesVisible",(function(t){if(null!=t)return t?void 0:e.ui.reviewPanelOpen=!1})),e.$watch("project.members",(function(t){if(e.reviewPanel.formattedProjectMembers={},null!=(null!=e.project?e.project.owner:void 0)&&(e.reviewPanel.formattedProjectMembers[e.project.owner._id]=Z(e.project.owner)),null!=(null!=e.project?e.project.members:void 0))return function(){for(var n=[],r=0,a=Array.from(t);r<a.length;r++){var l=a[r];"readAndWrite"===l.privileges?(null==e.reviewPanel.trackChangesState[l._id]&&B(l._id,e.reviewPanel.trackChangesOnForEveryone,!0),n.push(e.reviewPanel.formattedProjectMembers[l._id]=Z(l))):n.push(void 0)}return n}()})),e.commentState={adding:!1,content:""},e.users={},e.reviewPanelEventsBridge=new Ml,n.socket.on("new-comment",(function(t,n){var a=S(t);return delete a.submitting,a.messages.push(Q(n)),e.$apply(),r((function(){return e.$broadcast("review-panel:layout")}))})),n.socket.on("accept-changes",(function(t,n){return t!==e.editor.open_doc_id?_(t).removeChangeIds(n):(e.$broadcast("changes:accept",n),Ld("changes:accept",n)),R(t),e.$apply((function(){}))})),n.socket.on("resolve-thread",(function(e,t){return M(e,t)})),n.socket.on("reopen-thread",(function(e){return L(e)})),n.socket.on("delete-thread",(function(t){return F(t),e.$apply((function(){}))})),n.socket.on("edit-message",(function(t,n,r){return function(e,t,n){var r=S(e);if(null==r)return;for(var a=0,l=Array.from(r.messages);a<l.length;a++){var d=l[a];d.id===t&&(d.content=n)}R()}(t,n,r),e.$apply((function(){}))})),n.socket.on("delete-message",(function(t,n){return q(t,n),e.$apply((function(){}))}));var O={},C=function(t){return null==e.reviewPanel.entries[t]&&(e.reviewPanel.entries[t]={}),e.reviewPanel.entries[t]};function S(t){return null==e.reviewPanel.commentThreads[t]&&(e.reviewPanel.commentThreads[t]={messages:[]}),e.reviewPanel.commentThreads[t]}function _(t){return null==O[t]&&(O[t]=new ic,O[t].resolvedThreadIds=e.reviewPanel.resolvedThreadIds),O[t]}var k={};function E(){return k.isVisible&&e.reviewPanel.subView===e.SubViews.CUR_FILE&&!e.editor.showRichText?f.css("right","".concat(k.scrollbarWidth,"px")):f.css("right","0")}function A(e){var t=_(e.doc_id).getIdSeed(),n=ic.generateIdSeed();return _(e.doc_id).setIdSeed(n),e.setTrackChangesIdSeeds({pending:n,inflight:t})}e.reviewPanelEventsBridge.on("aceScrollbarVisibilityChanged",(function(e,t){return k={isVisible:e,scrollbarWidth:t},E()})),e.$watch("!ui.reviewPanelOpen && reviewPanel.hasEntries",(function(t,n){if(null!=t)return e.ui.miniReviewPanelVisible=t,t!==n?r((function(){return e.$broadcast("review-panel:toggle")})):void 0})),e.$watch("ui.reviewPanelOpen",(function(t){if(null!=t)return t?e.reviewPanel.subView=e.reviewPanel.openSubView:(e.reviewPanel.openSubView=e.reviewPanel.subView,e.reviewPanel.subView=e.SubViews.CUR_FILE),r((function(){return e.$broadcast("review-panel:toggle"),e.$broadcast("review-panel:layout",!1)}))})),e.$watch("reviewPanel.subView",(function(t){if(null!=t)return E(),t===e.SubViews.OVERVIEW?(e.reviewPanel.overview.loading=!0,T().then((function(){return e.reviewPanel.overview.loading=!1})).catch((function(){return e.reviewPanel.overview.loading=!1}))):void 0})),e.$watch("editor.sharejs_doc",(function(t,n){if(null!=t)return O[t.doc_id]=t.ranges,O[t.doc_id].resolvedThreadIds=e.reviewPanel.resolvedThreadIds,e.reviewPanel.rangesTracker=O[t.doc_id],null!=n&&n.off("flipped_pending_to_inflight"),t.on("flipped_pending_to_inflight",(function(){return A(t)})),A(t)})),e.$watch((function(){var t=e.reviewPanel.entries[e.editor.open_doc_id]||{},n={};for(var r in t){var a=t[r];["add-comment","bulk-actions"].includes(r)||(n[r]=a)}return Object.keys(n).length}),(function(t){return e.reviewPanel.hasEntries=t>0&&e.project.features.trackChangesVisible}));var T=function(){return a.get("/project/".concat(e.project_id,"/ranges")).then((function(t){var n=t.data;return function(){for(var t=[],r=0,a=Array.from(n);r<a.length;r++){var l=a[r];if(null==e.reviewPanel.overview.docsCollapsedState[l.id]&&(e.reviewPanel.overview.docsCollapsedState[l.id]=!1),l.id!==e.editor.open_doc_id){var d=_(l.id);d.comments=(null!=l.ranges?l.ranges.comments:void 0)||[],d.changes=(null!=l.ranges?l.ranges.changes:void 0)||[]}t.push(R(l.id))}return t}()}))};function R(t){var n=_(t),l=C(t),d=function(t){return null==e.reviewPanel.resolvedComments[t]&&(e.reviewPanel.resolvedComments[t]={}),e.reviewPanel.resolvedComments[t]}(t),h=!1,p={};for(var f in l){var y=l[f];if(!["add-comment","bulk-actions"].includes(f))for(var w=0,x=Array.from(y.entry_ids);w<x.length;w++){p[x[w]]=!0}}for(var j in d)for(var O=d[j],S=0,k=Array.from(O.entry_ids);S<k.length;S++){p[k[S]]=!0}for(var E=!1,A=null,T=0,R=Array.from(n.changes);T<R.length;T++){var I=R[T];if(h=!0,E&&I.op.d&&I.op.p===A.op.p+A.op.i.length&&I.metadata.user_id===A.metadata.user_id)l[A.id].type="aggregate-change",l[A.id].metadata.replaced_content=I.op.d,l[A.id].entry_ids.push(I.id);else{null==l[I.id]&&(l[I.id]={}),delete p[I.id];var P={type:I.op.i?"insert":"delete",entry_ids:[I.id],content:I.op.i||I.op.d,offset:I.op.p,metadata:I.metadata};for(var D in P)l[I.id][D]=P[D]}I.op.i?(E=!0,A=I):(E=!1,A=null),null==e.users[I.metadata.user_id]&&X(I.metadata.user_id)}n.comments.length>0&&function(){if(J)return;J=!0,e.reviewPanel.loadingThreads=!0,a.get("/project/".concat(e.project_id,"/threads")).then((function(t){var n=t.data;for(var a in e.reviewPanel.loadingThreads=!1,e.reviewPanel.resolvedThreadIds){e.reviewPanel.resolvedThreadIds[a];delete e.reviewPanel.resolvedThreadIds[a]}for(var l in n){for(var d=n[l],h=0,p=Array.from(d.messages);h<p.length;h++){Q(p[h])}null!=d.resolved_by_user&&(d.resolved_by_user=Z(d.resolved_by_user),e.reviewPanel.resolvedThreadIds[l]=!0,e.$broadcast("comment:resolve_threads",[l]),Ld("comment:resolve_threads",[l]))}return e.reviewPanel.commentThreads=n,r((function(){return e.$broadcast("review-panel:layout")}))}))}();for(var M=0,L=Array.from(n.comments);M<L.length;M++){var F=L[M],q=void 0;h=!0,delete p[F.id],e.reviewPanel.resolvedThreadIds[F.op.t]?(q=null!=d[F.id]?d[F.id]:d[F.id]={},delete l[F.id]):(q=null!=l[F.id]?l[F.id]:l[F.id]={},delete d[F.id]);var N={type:"comment",thread_id:F.op.t,entry_ids:[F.id],content:F.op.c,offset:F.op.p};for(var B in N)q[B]=N[B]}for(var U in p){p[U];h=!0,delete l[U],delete d[U]}return h&&e.$broadcast("entries:changed"),l}function I(t){a.post("/project/".concat(e.project_id,"/doc/").concat(e.editor.open_doc_id,"/changes/accept"),{change_ids:t,_csrf:window.csrfToken}),e.$broadcast("changes:accept",t),Ld("changes:accept",t)}e.refreshResolvedCommentsDropdown=function(){e.reviewPanel.dropdown.loading=!0;var t=T();return t.then((function(){return e.reviewPanel.dropdown.loading=!1})),t.catch((function(){return e.reviewPanel.dropdown.loading=!1})),t},e.$on("editor:track-changes:changed",(function(){var t=R(e.editor.open_doc_id);if(!e.editor.showRichText)return e.$broadcast("review-panel:recalculate-screen-positions"),Ld("recalculate-screen-positions",t),e.$broadcast("review-panel:layout")})),e.$on("editor:track-changes:visibility_changed",(function(){return r((function(){return e.$broadcast("review-panel:layout",!1)}))})),e.$on("editor:focus:changed",(function(t,n,r,a){var l=e.editor.open_doc_id,d=C(l);for(var h in e.reviewPanel.selectedEntryIds=[],e.reviewPanel.nVisibleSelectedChanges=0,delete d["add-comment"],delete d["bulk-actions"],a&&(d["add-comment"]={type:"add-comment",offset:n,length:r-n},d["bulk-actions"]={type:"bulk-actions",offset:n,length:r-n}),d){var p=d[h],f=!1;if("comment"!==p.type||e.reviewPanel.resolvedThreadIds[p.thread_id]?"insert"===p.type?(f=p.offset>=n&&p.offset+p.content.length<=r,p.focused=p.offset<=n&&n<=p.offset+p.content.length):"delete"===p.type?(f=n<=p.offset&&p.offset<=r,p.focused=p.offset===n):"aggregate-change"===p.type?(f=p.offset>=n&&p.offset+p.content.length<=r,p.focused=p.offset<=n&&n<=p.offset+p.content.length):["add-comment","bulk-actions"].includes(p.type)&&a&&(p.focused=!0):p.focused=p.offset<=n&&n<=p.offset+p.content.length,f){for(var y=0,w=Array.from(p.entry_ids);y<w.length;y++){var x=w[y];e.reviewPanel.selectedEntryIds.push(x)}e.reviewPanel.nVisibleSelectedChanges++}}return e.$broadcast("review-panel:recalculate-screen-positions"),Ld("recalculate-screen-positions",d),e.$broadcast("review-panel:layout")})),e.acceptChanges=function(t){I(t),d.sendMB("rp-changes-accepted",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})},e.rejectChanges=function(t){P(t),d.sendMB("rp-changes-rejected",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})};var P=function(t){e.$broadcast("changes:reject",t),Ld("changes:reject",t)};e.showBulkAcceptDialog=function(){return D(!0)},e.showBulkRejectDialog=function(){return D(!1)};var D=function(t){return l.open({templateUrl:"bulkActionsModalTemplate",controller:"BulkActionsModalController",resolve:{isAccept:function(){return t},nChanges:function(){return e.reviewPanel.nVisibleSelectedChanges}},scope:e.$new()}).result.then((function(t){return t?(I(e.reviewPanel.selectedEntryIds.slice()),void d.sendMB("rp-bulk-accept",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",nEntries:e.reviewPanel.nVisibleSelectedChanges})):(P(e.reviewPanel.selectedEntryIds.slice()),void d.sendMB("rp-bulk-reject",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",nEntries:e.reviewPanel.nVisibleSelectedChanges}))}))};function M(t,n){var r=S(t);null!=r&&(r.resolved=!0,r.resolved_by_user=Z(n),r.resolved_at=(new Date).toISOString(),e.reviewPanel.resolvedThreadIds[t]=!0,e.$broadcast("comment:resolve_threads",[t]),Ld("comment:resolve_threads",[t]))}function L(t){var n=S(t);null!=n&&(delete n.resolved,delete n.resolved_by_user,delete n.resolved_at,delete e.reviewPanel.resolvedThreadIds[t],e.$broadcast("comment:unresolve_thread",t),Ld("comment:unresolve_thread",t))}function F(t){delete e.reviewPanel.resolvedThreadIds[t],delete e.reviewPanel.commentThreads[t],e.$broadcast("comment:remove",t),Ld("comment:remove",t)}function q(e,t){var n=S(e);if(null!=n)return n.messages=n.messages.filter((function(e){return e.id!==t})),R()}e.handleTogglerClick=function(t){return t.target.blur(),e.toggleReviewPanel()},e.addNewComment=function(){return e.$broadcast("comment:start_adding"),e.toggleReviewPanel()},e.addNewCommentFromKbdShortcut=function(){if(e.project.features.trackChangesVisible)return e.$broadcast("comment:select_line"),Ld("comment:select_line"),e.ui.reviewPanelOpen||e.toggleReviewPanel(),r((function(){return e.$broadcast("review-panel:layout"),e.$broadcast("comment:start_adding")}))},e.startNewComment=function(){return e.$broadcast("comment:select_line"),Ld("comment:select_line"),r((function(){return e.$broadcast("review-panel:layout")}))},e.submitNewComment=function(t){if(null!=t&&""!==t){var l=e.editor.open_doc_id,h=C(l);if(null!=h["add-comment"]){var p=h["add-comment"],f=p.offset,y=p.length,w=ic.generateId();S(w).submitting=!0,e.$broadcast("comment:add",w,f,y),Ld("comment:add",{threadId:w,offset:f,length:y}),a.post("/project/".concat(e.project_id,"/thread/").concat(w,"/messages"),{content:t,_csrf:window.csrfToken}).catch((function(){return n.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment")})),e.$broadcast("editor:clearSelection"),r((function(){return e.$broadcast("review-panel:layout")})),d.sendMB("rp-new-comment",{size:t.length})}}},e.cancelNewComment=function(t){return r((function(){return e.$broadcast("review-panel:layout")}))},e.startReply=function(t){return t.replying=!0,r((function(){return e.$broadcast("review-panel:layout")}))},e.submitReply=function(t,l){var h=t.thread_id,p=t.replyContent;a.post("/project/".concat(e.project_id,"/thread/").concat(h,"/messages"),{content:p,_csrf:window.csrfToken}).catch((function(){return n.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment")}));var f={view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",size:t.replyContent.length,thread:h};S(h).submitting=!0,t.replyContent="",t.replying=!1,r((function(){return e.$broadcast("review-panel:layout")})),d.sendMB("rp-comment-reply",f)},e.cancelReply=function(t){return t.replying=!1,t.replyContent="",e.$broadcast("review-panel:layout")},e.resolveComment=function(t,r){t.focused=!1,a.post("/project/".concat(e.project_id,"/thread/").concat(t.thread_id,"/resolve"),{_csrf:window.csrfToken}),M(t.thread_id,n.$scope.user),d.sendMB("rp-comment-resolve",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})},e.unresolveComment=function(t){L(t),a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/reopen"),{_csrf:window.csrfToken}),d.sendMB("rp-comment-reopen")},e.deleteThread=function(t,n,r){F(r),a({method:"DELETE",url:"/project/".concat(e.project_id,"/doc/").concat(n,"/thread/").concat(r),headers:{"X-CSRF-Token":window.csrfToken}}),d.sendMB("rp-comment-delete")},e.saveEdit=function(t,n){return a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(n.id,"/edit"),{content:n.content,_csrf:window.csrfToken}),r((function(){return e.$broadcast("review-panel:layout")}))},e.deleteComment=function(t,n){return q(t,n.id),a({method:"DELETE",url:"/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(n.id),headers:{"X-CSRF-Token":window.csrfToken}}),r((function(){return e.$broadcast("review-panel:layout")}))},e.setSubView=function(t){e.reviewPanel.subView=t,d.sendMB("rp-subview-change",{subView:t})},e.gotoEntry=function(e,t){return n.editorManager.openDocId(e,{gotoOffset:t.offset})},e.toggleFullTCStateCollapse=function(){return e.project.features.trackChanges?e.reviewPanel.fullTCStateCollapsed=!e.reviewPanel.fullTCStateCollapsed:(N(),e.openTrackChangesUpgradeModal())};var N=function(){d.send("subscription-funnel","editor-click-feature","real-time-track-changes"),d.sendMB("paywall-prompt",{"paywall-type":"track-changes"})},B=function(t,r,a){null==a&&(a=!1),null==e.reviewPanel.trackChangesState[t]&&(e.reviewPanel.trackChangesState[t]={});var l=e.reviewPanel.trackChangesState[t];if(null==l.syncState||l.syncState===p.SYNCED?(l.value=r,l.syncState=p.SYNCED):l.syncState===p.PENDING&&l.value===r?l.syncState=p.SYNCED:a&&(l.value=r,l.syncState=p.PENDING),t===n.$scope.user.id)return e.editor.wantTrackChanges=r},U=function(t,n){null==n&&(n=!1),e.reviewPanel.trackChangesOnForEveryone=t;for(var r=e.project,a=0,l=Array.from(r.members);a<l.length;a++){var d=l[a];B(d._id,t,n)}return H(t,n),B(r.owner._id,t,n)};function H(t,n){if(null==n&&(n=!1),e.reviewPanel.trackChangesOnForGuests=t,j()===w||j()===x)return e.editor.wantTrackChanges=t}var z=function(){var t={};if(e.reviewPanel.trackChangesOnForEveryone)t.on=!0;else{for(var n in t.on_for={},e.reviewPanel.trackChangesState){var r=e.reviewPanel.trackChangesState[n];t.on_for[n]=r.value}e.reviewPanel.trackChangesOnForGuests&&(t.on_for_guests=!0)}return t._csrf=window.csrfToken,a.post("/project/".concat(e.project_id,"/track_changes"),t)},V=function(t){if("boolean"==typeof t)return U(t),H(t);var n=e.project;e.reviewPanel.trackChangesOnForEveryone=!1,H(!0===t.__guests__);for(var r=0,a=Array.from(n.members);r<a.length;r++){var l=a[r];B(l._id,null!=t[l._id]&&t[l._id])}return B(e.project.owner._id,null!=t[e.project.owner._id]&&t[e.project.owner._id])};e.toggleTrackChangesForEveryone=function(e){return U(e,!0),H(e,!0),z()},e.toggleTrackChangesForGuests=function(e){return H(e,!0),z()},e.toggleTrackChangesForUser=function(e,t){return B(t,e,!0),z()},n.socket.on("toggle-track-changes",(function(t){return e.$apply((function(){return V(t)}))})),e.toggleTrackChangesFromKbdShortcut=function(){if(e.project.features.trackChangesVisible&&e.project.features.trackChanges)return e.toggleTrackChangesForUser(!e.reviewPanel.trackChangesState[n.$scope.user.id].value,n.$scope.user.id)};var W=function(t){return e.reviewPanel.trackChangesForGuestsAvailable="tokenBased"===t};e.$watch("project.publicAccesLevel",W),e.$watch("reviewPanel.trackChangesForGuestsAvailable",(function(t){if(null!=t)return function(t){if(!t&&e.reviewPanel.trackChangesOnForGuests&&!e.reviewPanel.trackChangesOnForEveryone)return e.toggleTrackChangesForGuests(!1)}(t)}));var K=!1;n.$scope.$on("project:joined",(function(){if(!K){var e=n.$scope.project;return e.features.trackChanges?V(e.trackChangesState):V(!1),W(e.publicAccesLevel),K=!0}}));var G=!1,Y={};function X(t){if(null!=t){if(null!=Y[t])return;Y[t]=!0}if(!G)return G=!0,a.get("/project/".concat(e.project_id,"/changes/users")).then((function(t){var r=t.data;return G=!1,e.users={},null!=(null!=n.$scope.user?n.$scope.user.id:void 0)&&(e.users[n.$scope.user.id]=Z(n.$scope.user)),function(){for(var t=[],n=0,a=Array.from(r);n<a.length;n++){var l=a[n];null!=l.id?t.push(e.users[l.id]=Z(l)):t.push(void 0)}return t}()})).catch((function(){return G=!1}))}var J=!1;function Q(e){return e.user=Z(e.user),e.timestamp=new Date(e.timestamp),e}function Z(e){var t,n,r=(null!=e?e._id:void 0)||(null!=e?e.id:void 0);return null==r?{email:null,name:"Anonymous",isSelf:!1,hue:su.a.ANONYMOUS_HUE,avatar_text:"A"}:(r===window.user_id?(n="You",t=!0):(""===(n=[e.first_name,e.last_name].filter((function(e){return null!=e&&""!==e})).join(" "))&&(n=(null!=e.email?e.email.split("@")[0]:void 0)||"Unknown"),t=!1),{id:r,email:e.email,name:n,isSelf:t,hue:su.a.getHueForUserId(r),avatar_text:[e.first_name,e.last_name].filter((function(e){return null!=e})).map((function(e){return e[0]})).join("")})}e.openTrackChangesUpgradeModal=function(){return l.open({templateUrl:"trackChangesUpgradeModalTemplate",controller:"TrackChangesUpgradeModalController",scope:e.$new()})},window.addEventListener("editor:event",(function(t){var n=t.detail,r=n.type,a=n.payload;switch(r){case"line-height":e.reviewPanel.rendererData.lineHeight=a,e.$broadcast("review-panel:layout");break;case"track-changes:changed":e.$broadcast("editor:track-changes:changed");break;case"track-changes:visibility_changed":e.$broadcast("editor:track-changes:visibility_changed");break;case"focus:changed":var l=a.from,d=a.to,h=a.empty;e.$broadcast("editor:focus:changed",l,d,!h)}}))}]),function(e,t){window.dispatchEvent(new CustomEvent("review-panel:event",{detail:{type:e,payload:t}}))}),Fd=(y.a.controller("TrackChangesUpgradeModalController",["$scope","$modalInstance",function(e,t){return e.cancel=function(){return t.dismiss()}}]),y.a.controller("BulkActionsModalController",["$scope","$modalInstance","isAccept","nChanges",function(e,t,n,r){return e.isAccept=n,e.nChanges=r,e.cancel=function(){return t.dismiss()},e.confirm=function(){return t.close(n)}}]),y.a.directive("reviewPanelSorted",["$timeout",function(e){return{link:function(e,t,n){var r=0,a=function(n){var a,l,d,h,p,f,y,w,x,j,O;null==n&&(n=!0),n?t.removeClass("no-animate"):t.addClass("no-animate"),e.ui.reviewPanelOpen?(x=8,j=38,w=57):(x=4,j=4,w=0);for(var C=[],S=0,_=Array.from(t.find(".rp-entry-wrapper"));S<_.length;S++){var k=_[S];l={$indicator_el:$(k).find(".rp-entry-indicator"),$box_el:$(k).find(".rp-entry"),$callout_el:$(k).find(".rp-entry-callout"),scope:angular.element(k).scope()},e.ui.reviewPanelOpen?l.$layout_el=l.$box_el:l.$layout_el=l.$indicator_el,l.height=l.$layout_el.height(),C.push(l)}if(C.sort((function(e,t){return e.scope.entry.offset-t.scope.entry.offset})),0!==C.length){var E=e.reviewPanel.rendererData.lineHeight,A=Math.min(r,C.length-1);for(h=0;h<C.length;h++)if((l=C[h]).scope.entry.focused){A=h;break}var T=C.slice(A+1),R=C.slice(0,A),I=C[A];r=A,sl_console.log("focused_entry_index",A);var P=function(e,t,n,r){return t<=n?(e.removeClass("rp-entry-callout-inverted"),e.css({top:t+r-1,height:n-t})):(e.addClass("rp-entry-callout-inverted"),e.css({top:n+r,height:t-n}))},D=Math.max(I.scope.entry.screenPos.y,j);I.$box_el.css({top:D,visibility:"visible"}),I.$indicator_el.css({top:D}),y=null!==(a=I.scope.entry.screenPos.height)&&void 0!==a?a:E,P(I.$callout_el,I.scope.entry.screenPos.y,D,y);for(var M=D+I.$layout_el.height(),L=0,F=Array.from(T);L<F.length;L++){var q;p=(l=F[L]).scope.entry.screenPos.y,y=null!==(q=l.scope.entry.screenPos.height)&&void 0!==q?q:E,d=l.height,M=(O=Math.max(p,M+x))+d,l.$box_el.css({top:O,visibility:"visible"}),l.$indicator_el.css({top:O}),P(l.$callout_el,p,O,y),sl_console.log("ENTRY",{entry:l.scope.entry,top:O})}var N=D;for(R.reverse(),h=0;h<R.length;h++){var B;p=(l=R[h]).scope.entry.screenPos.y,y=null!==(B=l.scope.entry.screenPos.height)&&void 0!==B?B:E;var U=p+(d=l.height);N=O=Math.min(U,N-x)-d,l.$box_el.css({top:O,visibility:"visible"}),l.$indicator_el.css({top:O}),P(l.$callout_el,p,O,y),sl_console.log("ENTRY",{entry:l.scope.entry,top:O})}return f=O<j?-O+j:0,e.$emit("review-panel:sizes",{overflowTop:f,height:M+w})}};e.$applyAsync((function(){return a()})),e.$on("review-panel:layout",(function(t,n){return null==n&&(n=!0),e.$applyAsync((function(){return a(n)}))})),e.$watch("reviewPanel.rendererData.lineHeight",(function(){return a()}));var l=t,d=t.find(".rp-entry-list-inner");ace.require("ace/lib/event").addMouseWheelListener(l[0],(function(e){var t=e.wheelY,n=parseInt(d.css("top"))-4*t;return f(-n),y(-n),e.preventDefault()}));var h=!1,p=function(e,t){if(h)return h=!1;return d.height(t),d.css({top:-e})},f=function(t){return e.reviewPanelEventsBridge.emit("externalScroll",t)};e.reviewPanelEventsBridge.on("aceScroll",p),e.$on("$destroy",(function(){return e.reviewPanelEventsBridge.off("aceScroll")})),window.addEventListener("editor:scroll",(function(e){var t=e.detail,n=t.scrollTop,r=t.height;p(n,r)}));var y=function(e){window.dispatchEvent(new CustomEvent("review-panel:event",{detail:{type:"scroll",payload:e}}))};return e.reviewPanelEventsBridge.emit("refreshScrollPosition")}}}]),y.a.directive("reviewPanelToggle",(function(){return{restrict:"E",scope:{onToggle:"&",ngModel:"=",valWhenUndefined:"=?",isDisabled:"=?",onDisabledClick:"&?",description:"@"},link:function(e){return null==e.disabled&&(e.disabled=!1),e.onChange=function(){return e.onToggle({isOn:e.localModel})},e.handleClick=function(){if(e.disabled&&null!=e.onDisabledClick)return e.onDisabledClick()},e.localModel=e.ngModel,e.$watch("ngModel",(function(t){return null!=e.valWhenUndefined&&null==t&&(t=e.valWhenUndefined),e.localModel=t}))},template:'<fieldset class="rp-toggle" ng-click="handleClick();">\n<legend class="sr-only">{{description}}</legend>\n<input id="rp-toggle-{{$id}}" ng-disabled="isDisabled" type="checkbox" class="rp-toggle-hidden-input" ng-model="localModel" ng-change="onChange()" />\n<label for="rp-toggle-{{$id}}" class="rp-toggle-btn"></label>\n</fieldset>'}})),y.a.directive("changeEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"changeEntryTemplate",scope:{entry:"=",user:"=",permissions:"=",onAccept:"&",onReject:"&",onIndicatorClick:"&",onBodyClick:"&"},link:function(t,n,r){return t.contentLimit=40,t.isCollapsed=!0,t.needsCollapsing=!1,n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-entry-description, .rp-entry-body, .rp-entry-action-icon i"))return t.onBodyClick()})),t.toggleCollapse=function(){return t.isCollapsed=!t.isCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.$watch("entry.content.length",(function(e){return t.needsCollapsing=e>t.contentLimit}))}}}]),y.a.directive("aggregateChangeEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"aggregateChangeEntryTemplate",scope:{entry:"=",user:"=",permissions:"=",onAccept:"&",onReject:"&",onIndicatorClick:"&",onBodyClick:"&"},link:function(t,n,r){return t.contentLimit=17,t.isDeletionCollapsed=!0,t.isInsertionCollapsed=!0,t.deletionNeedsCollapsing=!1,t.insertionNeedsCollapsing=!1,n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-entry-description, .rp-entry-body, .rp-entry-action-icon i"))return t.onBodyClick()})),t.toggleDeletionCollapse=function(){return t.isDeletionCollapsed=!t.isDeletionCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.toggleInsertionCollapse=function(){return t.isInsertionCollapsed=!t.isInsertionCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.$watch("entry.metadata.replaced_content.length",(function(e){return t.deletionNeedsCollapsing=e>t.contentLimit})),t.$watch("entry.content.length",(function(e){return t.insertionNeedsCollapsing=e>t.contentLimit}))}}}]),y.a.directive("commentEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"commentEntryTemplate",scope:{entry:"=",threads:"=",permissions:"=",onResolve:"&",onReply:"&",onIndicatorClick:"&",onSaveEdit:"&",onDelete:"&",onBodyClick:"&"},link:function(t,n,r){return t.state={animating:!1},n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-comment-loaded, .rp-comment-content, .rp-comment-reply, .rp-entry-metadata"))return t.onBodyClick()})),t.handleCommentReplyKeyPress=function(e){if(13===e.keyCode&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),t.entry.replyContent.length>0))return e.target.blur(),t.onReply()},t.animateAndCallOnResolve=function(){return t.state.animating=!0,n.find(".rp-entry").css("top",0),e((function(){return t.onResolve()}),350),!0},t.startEditing=function(e){return e.editing=!0,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.saveEdit=function(e){return e.editing=!1,t.onSaveEdit({comment:e})},t.confirmDelete=function(e){return e.deleting=!0,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.cancelDelete=function(e){return e.deleting=!1,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.doDelete=function(e){return e.deleting=!1,t.onDelete({comment:e})},t.saveEditOnEnter=function(e,n){if(13===e.keyCode&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey)return e.preventDefault(),t.saveEdit(n)}}}}]),"");y.a.directive("addCommentEntry",(function(){return{restrict:"E",templateUrl:"addCommentEntryTemplate",scope:{onStartNew:"&",onSubmit:"&",onCancel:"&"},link:function(e,t,n){e.state={isAdding:!1,content:Fd},e.$on("comment:start_adding",(function(){return e.startNewComment()})),e.$on("$destroy",(function(){Fd=e.state.content})),e.startNewComment=function(){e.state.isAdding=!0,e.onStartNew(),setTimeout((function(){return e.$broadcast("comment:new:open")}))},e.cancelNewComment=function(){e.state.isAdding=!1,e.state.content="",e.onCancel()};var r=["PageDown","PageUp"];e.handleCommentKeyDown=function(e){r.includes(e.key)&&e.target.closest("textarea")&&e.preventDefault()},e.handleCommentKeyPress=function(t){13!==t.keyCode||t.shiftKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.state.content.length>0&&e.submitNewComment())},e.submitNewComment=function(t){e.onSubmit({content:e.state.content}),Fd=e.state.content,e.state.isAdding=!1,e.state.content=""}}}}));y.a.directive("bulkActionsEntry",(function(){return{restrict:"E",templateUrl:"bulkActionsEntryTemplate",scope:{onBulkAccept:"&",onBulkReject:"&",nEntries:"="},link:function(e,t,n){return e.bulkAccept=function(){return e.onBulkAccept()},e.bulkReject=function(){return e.onBulkReject()}}}})),y.a.directive("resolvedCommentEntry",(function(){return{restrict:"E",templateUrl:"resolvedCommentEntryTemplate",scope:{thread:"=",permissions:"=",onUnresolve:"&",onDelete:"&"},link:function(e,t,n){return e.contentLimit=40,e.needsCollapsing=!1,e.isCollapsed=!0,e.toggleCollapse=function(){return e.isCollapsed=!e.isCollapsed},e.$watch("thread.content.length",(function(t){return e.needsCollapsing=t>e.contentLimit}))}}})),y.a.directive("resolvedCommentsDropdown",(function(){return{restrict:"E",templateUrl:"resolvedCommentsDropdownTemplate",scope:{entries:"=",threads:"=",resolvedIds:"=",docs:"=",permissions:"=",onOpen:"&",onUnresolve:"&",onDelete:"&",isLoading:"="},link:function(e,t,n){var r;e.state={isOpen:!1},e.toggleOpenState=function(){if(e.state.isOpen=!e.state.isOpen,e.state.isOpen)return e.onOpen().then((function(){return r()}))},e.resolvedComments=[],e.handleUnresolve=function(t){return e.onUnresolve({threadId:t}),e.resolvedComments=e.resolvedComments.filter((function(e){return e.threadId!==t}))},e.handleDelete=function(t,n,r){return e.onDelete({entryId:t,docId:n,threadId:r}),e.resolvedComments=e.resolvedComments.filter((function(e){return e.threadId!==r}))};var a=function(t){var n=O.a.find(e.docs,(function(e){return e.doc.id===t}));return null!=n?n.path:null};return r=function(){return e.resolvedComments=[],function(){var t=[],n=function(n){var r=e.entries[n];t.push(function(){var t=[];for(var l in r){var d=r[l];if("comment"===d.type&&null!=(null!=e.threads[d.thread_id]?e.threads[d.thread_id].resolved:void 0)){var h=angular.copy(e.threads[d.thread_id]);h.content=d.content,h.threadId=d.thread_id,h.entryId=l,h.docId=n,h.docName=a(n),t.push(e.resolvedComments.push(h))}else t.push(void 0)}return t}())};for(var r in e.entries)n(r);return t}()}}}})),y.a.directive("reviewPanelCollapseHeight",["$parse",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch((function(){return e(r.reviewPanelCollapseHeight)(t)}),(function(e){var t=n.prop("scrollHeight");return t>0?e?n.animate({height:0},150):n.animate({height:t},150):e?n.height(0):void 0}))}}}]),y.a.filter("notEmpty",(function(){return function(e){return!angular.equals({},e)}})),y.a.filter("numKeys",(function(){return function(e){return null!=e?Object.keys(e).length:0}})),y.a.filter("orderOverviewEntries",(function(){return function(e){var t=[];for(var n in e){var r=e[n];r.entry_id=n,t.push(r)}return t.sort((function(e,t){return e.offset-t.offset})),t}})),n(631),n(632);function qd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Nd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bd(e){var t=e.outlineItem,n=e.jumpToLine,r=e.highlightedLine,a=Object(Mt.a)().t,l=qd(Object(C.useState)(!0),2),d=l[0],h=l[1],p=Object(C.createRef)(),f=Object(C.useRef)(!1),y=re()("outline-item",{"outline-item-no-children":!t.children}),w=!d&&function e(t){return(t||[]).map((function(t){return e(t.children).concat(t.line)})).flat()}(t.children).includes(r),x=r===t.line||w,j=re()("outline-item-link",{"outline-item-link-highlight":x});Object(C.useEffect)((function(){var e=f.current;f.current=x,!e&&x&&Or(p.current,{scrollMode:"if-needed",block:"center"})}),[x,p,f]);var O=t.children?d:void 0;return Object(R.jsxs)("li",{className:y,"aria-expanded":O,role:"treeitem","aria-current":x,"aria-label":t.title,children:[Object(R.jsxs)("div",{className:"outline-item-row",children:[t.children?Object(R.jsx)("button",{className:"outline-item-expand-collapse-btn",onClick:function(){h(!d)},"aria-label":a(d?"collapse":"expand"),children:Object(R.jsx)(Pr.a,{type:d?"angle-down":"angle-right",className:"outline-caret-icon"})}):null,Object(R.jsx)("button",{className:j,onClick:function(){n(t.line,!1)},onDoubleClick:function(){n(t.line,!0)},ref:p,children:t.title})]}),d&&t.children?Object(R.jsx)(zd,{outline:t.children,jumpToLine:n,isRoot:!1,highlightedLine:r}):null]})}Bd.propTypes={outlineItem:k.a.exact({line:k.a.number.isRequired,title:k.a.string.isRequired,level:k.a.number,children:k.a.array}).isRequired,jumpToLine:k.a.func.isRequired,highlightedLine:k.a.number};var Ud=Bd;function Hd(e){var t=e.outline,n=e.jumpToLine,r=e.isRoot,a=e.highlightedLine,l=re()("outline-item-list",{"outline-item-list-root":r});return Object(R.jsx)("ul",{className:l,role:r?"tree":"group",children:t.map((function(e,t){return Object(R.jsx)(Ud,{outlineItem:e,jumpToLine:n,highlightedLine:a},"".concat(e.level,"-").concat(t))}))})}Hd.propTypes={outline:k.a.array.isRequired,jumpToLine:k.a.func.isRequired,isRoot:k.a.bool,highlightedLine:k.a.number};var zd=Hd;function Vd(e){var t=e.outline,n=e.jumpToLine,r=e.highlightedLine,a=Object(Mt.a)().t;return Object(R.jsx)("div",{children:t.length?Object(R.jsx)(zd,{outline:t,jumpToLine:n,isRoot:!0,highlightedLine:r}):Object(R.jsxs)("div",{className:"outline-body-no-elements",children:[a("we_cant_find_any_sections_or_subsections_in_this_file"),"."," ",Object(R.jsx)("a",{href:"/learn/how-to/Using_the_File_Outline_feature",className:"outline-body-link",target:"_blank",rel:"noopener noreferrer",children:a("find_out_more_about_the_file_outline")})]})})}Vd.propTypes={outline:k.a.array.isRequired,jumpToLine:k.a.func.isRequired,highlightedLine:k.a.number};var Wd=Vd;function Kd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Yd=S.a.memo((function(e){var t=e.isTexFile,n=e.outline,r=e.jumpToLine,a=e.onToggle,l=e.eventTracking,d=e.highlightedLine,h=Object(Mt.a)().t,p=Object(A.c)({_id:k.a.string.isRequired})._id,f="file_outline.expanded.".concat(p),y=Kd(Object(C.useState)((function(){return!1!==ke.a.getItem(f)})),2),w=y[0],x=y[1],j=t&&w;Object(C.useEffect)((function(){a(j)}),[j,a]);var O=re()("outline-pane",{"outline-pane-disabled":!t});return Object(R.jsxs)("div",{className:O,children:[Object(R.jsx)("header",{className:"outline-header",children:Object(R.jsxs)("button",{className:"outline-header-expand-collapse-btn",disabled:!t,onClick:function(){t&&(ke.a.setItem(f,!w),l.sendMB(w?"outline-collapse":"outline-expand"),x(!w))},"aria-label":h(w?"hide_outline":"show_outline"),children:[Object(R.jsx)(Pr.a,{type:j?"angle-down":"angle-right",className:"outline-caret-icon"}),Object(R.jsx)("h4",{className:"outline-header-name",children:h("file_outline")})]})}),w&&t?Object(R.jsx)("div",{className:"outline-body",children:Object(R.jsx)(Wd,{outline:n,jumpToLine:r,highlightedLine:d})}):null]})}));Yd.propTypes={isTexFile:k.a.bool.isRequired,outline:k.a.array.isRequired,jumpToLine:k.a.func.isRequired,onToggle:k.a.func.isRequired,eventTracking:k.a.object.isRequired,highlightedLine:k.a.number};var Xd=Object(E.a)(Yd);y.a.controller("OutlineController",["$scope","ide","eventTracking",function(e,t,n){e.isTexFile=!1,e.outline=[],e.eventTracking=n,e.$on("outline-manager:outline-changed",(function(t,n){e.$applyAsync((function(){e.isTexFile=n.isTexFile,e.outline=n.outline,e.highlightedLine=n.highlightedLine}))})),e.jumpToLine=function(e,r){t.outlineManager.jumpToLine(e,r),n.sendMB("outline-jump-to-line")},e.onToggle=function(t){e.$applyAsync((function(){e.$emit("outline-toggled",t)}))}}]),y.a.component("outlinePane",Object(x.react2angular)(Ys.use(Xd),["outline","jumpToLine","highlightedLine","eventTracking","onToggle","isTexFile"]));var Jd=n(487),Qd=new RegExp("\\.(".concat(window.ExposedSettings.validRootDocExtensions.join("|"),")$"),"i");var Zd=function(e){return Qd.test(e)};function eh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var th=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.scope=n,this.shareJsDoc=null,this.isTexFile=!1,this.flatOutline=[],this.outline=[],this.highlightedLine=null,this.ignoreNextScroll=!1,this.ignoreNextCursorUpdate=!1,n.$on("doc:after-opened",(function(e,t){t.isNewDoc&&(r.ignoreNextCursorUpdate=!0),r.ignoreNextScroll=!0,r.shareJsDoc=n.editor.sharejs_doc,r.isTexFile=Zd(n.editor.open_doc_name),r.updateOutline(),r.broadcastChangeEvent()})),n.$watch("openFile.name",(function(e){r.isTexFile=Zd(e),r.updateOutline(),r.broadcastChangeEvent()})),n.$on("doc:changed",(function(){r.updateOutline(),r.broadcastChangeEvent()})),n.$on("file-view:file-opened",(function(){r.isTexFile=!1,r.updateOutline(),r.broadcastChangeEvent()})),n.$on("cursor:editor:update",(function(e,t){r.ignoreNextCursorUpdate?r.ignoreNextCursorUpdate=!1:(r.updateHighlightedLine(t.row+1),r.broadcastChangeEvent())})),n.$on("scroll:editor:update",(function(e,t){r.ignoreNextScroll?r.ignoreNextScroll=!1:r.updateHighlightedLine(t+1)})),n.$watch("editor.showRichText",(function(){r.ignoreNextScroll=!0,r.ignoreNextCursorUpdate=!0}))}var t,n,r;return t=e,(n=[{key:"updateOutline",value:function(){if(this.outline=[],this.isTexFile){var e=this.ide.editorManager.getCurrentDocValue();e&&(this.flatOutline=Object(Jd.a)(e),this.outline=Object(Jd.c)(this.flatOutline))}}},{key:"updateHighlightedLine",value:function(e){for(var t=null,n=0;n<this.flatOutline.length;n++){var r=this.flatOutline[n];if(e<r.line)break;t=r.line}t!==this.highlightedLine&&(this.highlightedLine=t,this.broadcastChangeEvent())}},{key:"jumpToLine",value:function(e,t){this.ignoreNextScroll=!0,this.ide.editorManager.jumpToLine({gotoLine:e,syncToPdf:t})}},{key:"broadcastChangeEvent",value:function(){this.scope.$broadcast("outline-manager:outline-changed",{isTexFile:this.isTexFile,outline:this.outline,highlightedLine:this.highlightedLine})}}])&&eh(t.prototype,n),r&&eh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function nh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rh(e,t,n){return t&&nh(e.prototype,t),n&&nh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ih=rh((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOverAce=!1,this.pdfDiv=null,this.aceDiv=null,this.handlePdfDivMouseLeave=function(){return n.pdfDiv.addEventListener("wheel",n.dispatchToAce)},this.handlePdfDivMouseEnter=function(){return n.pdfDiv.removeEventListener("wheel",n.dispatchToAce)},this.handleAceDivMouseLeave=function(){return n.isOverAce=!1},this.handleAceDivMouseEnter=function(){return n.isOverAce=!0},this.setListeners=function(){n.isOverAce=!1,null!=n.pdfDiv&&(n.pdfDiv.removeEventListener("mouseleave",n.handlePdfDivMouseLeave),n.pdfDiv.removeEventListener("mouseenter",n.handlePdfDivMouseEnter)),null!=n.aceDiv&&(n.aceDiv.removeEventListener("mouseleave",n.handleAceDivMouseLeave),n.aceDiv.removeEventListener("mouseenter",n.handleAceDivMouseEnter)),n.pdfDiv=document.querySelector(".pdfjs-viewer"),n.aceDiv=document.querySelector(".ace_content"),null!=n.pdfDiv&&(n.pdfDiv.addEventListener("mouseleave",n.handlePdfDivMouseLeave),n.pdfDiv.addEventListener("mouseenter",n.handlePdfDivMouseEnter)),null!=n.aceDiv&&(n.aceDiv.addEventListener("mouseleave",n.handleAceDivMouseLeave),n.aceDiv.addEventListener("mouseenter",n.handleAceDivMouseEnter))},this.dispatchToAce=function(e){if(n.isOverAce)return window.setTimeout((function(){return n.aceDiv.dispatchEvent(e)}),1),e.preventDefault()},t.$on("loaded",(function(){return n.setListeners()}))})),oh=n(33),ah=n(74);Promise.resolve();function sh(){return"serviceWorker"in navigator}function lh(){sh()&&(navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"disable"}),navigator.serviceWorker.getRegistrations().then((function(e){e.forEach((function(e){e.unregister()}))})))}var ch=window.brandVariation;y.a.factory("CobrandingDataService",(function(){return{isProjectCobranded:function(){return null!=ch},getLogoImgUrl:function(){return null!=ch?ch.logo_url:void 0},getSubmitBtnHtml:function(){return null!=ch?ch.submit_button_html:void 0},getBrandVariationName:function(){return null!=ch?ch.name:void 0},getBrandVariationHomeUrl:function(){return null!=ch?ch.home_url:void 0},getPublishGuideHtml:function(){return null!=ch?ch.publish_guide_html:void 0},getPartner:function(){return null!=ch?ch.partner:void 0},hasBrandedMenu:function(){return null!=ch?ch.branded_menu:void 0},getBrandId:function(){return null!=ch?ch.brand_id:void 0},getBrandVariationId:function(){return null!=ch?ch.id:void 0}}})),y.a.factory("settings",["ide","eventTracking",function(e,t){return{saveSettings:function(n){for(var r=0,a=Array.from(Object.keys(n));r<a.length;r++){var l=a[r],d=l,h=n[l];t.sendMB("setting-changed",{changedSetting:d,changedSettingVal:h})}return n._csrf=window.csrfToken,e.$http.post("/user/settings",n)},saveProjectSettings:function(t){return t._csrf=window.csrfToken,e.$http.post("/project/".concat(e.project_id,"/settings"),t)},saveProjectAdminSettings:function(t){return t._csrf=window.csrfToken,e.$http.post("/project/".concat(e.project_id,"/settings/admin"),t)}}}]),y.a.controller("SettingsController",["$scope","settings","ide",function(e,t,n){var r=this;e.overallThemesList=window.overallThemes,e.ui={loadingStyleSheet:!1};["default","vim","emacs"].includes(e.settings.mode)||(e.settings.mode="default"),["pdfjs","native"].includes(e.settings.pdfViewer)||(e.settings.pdfViewer="pdfjs"),null==e.settings.fontFamily||["monaco","lucida"].includes(e.settings.fontFamily)||delete e.settings.fontFamily,null==e.settings.lineHeight||["compact","normal","wide"].includes(e.settings.lineHeight)||delete e.settings.lineHeight,e.fontSizeAsStr=function(t){return null!=t&&(e.settings.fontSize=t),e.settings.fontSize.toString()},e.getValidMainDocs=function(){var t=[];return e.docs&&(t=e.docs.filter((function(t){return Zd(t.doc.name)||e.project.rootDoc_id===t.doc.id}))),t},e.$watch("settings.editorTheme",(function(e,n){if(e!==n)return t.saveSettings({editorTheme:e})})),e.$watch("settings.overallTheme",(function(n,r){if(n!==r){var a=O.a.find(e.overallThemesList,(function(e){return e.val===n}));if(null!=a)return function(t){e.ui.loadingStyleSheet=!0;var n=document.querySelector("head"),r=document.getElementById("main-stylesheet"),a=document.createElement("link");a.addEventListener("load",(function(t){return e.$applyAsync((function(){return e.ui.loadingStyleSheet=!1,n.removeChild(r)}))})),a.setAttribute("rel","stylesheet"),a.setAttribute("id","main-stylesheet"),a.setAttribute("href",t.path),n.appendChild(a)}(a),t.saveSettings({overallTheme:n})}})),e.$watch("settings.fontSize",(function(e,n){if(e!==n)return t.saveSettings({fontSize:parseInt(e,10)})})),e.$watch("settings.mode",(function(e,n){if(e!==n)return t.saveSettings({mode:e})})),e.$watch("settings.autoComplete",(function(e,n){if(e!==n)return t.saveSettings({autoComplete:e})})),e.$watch("settings.autoPairDelimiters",(function(e,n){if(e!==n)return t.saveSettings({autoPairDelimiters:e})})),e.$watch("settings.pdfViewer",(function(e,n){if(e!==n)return t.saveSettings({pdfViewer:e})})),e.$watch("settings.syntaxValidation",(function(e,n){if(e!==n)return t.saveSettings({syntaxValidation:e})})),e.$watch("settings.fontFamily",(function(e,n){if(e!==n)return t.saveSettings({fontFamily:e})})),e.$watch("settings.lineHeight",(function(e,n){if(e!==n)return t.saveSettings({lineHeight:e})})),e.$watch("project.spellCheckLanguage",(function(e,n){if(!r.ignoreUpdates)return null!=n&&e!==n?(t.saveProjectSettings({spellCheckLanguage:e}),t.saveSettings({spellCheckLanguage:e})):void 0})),e.$watch("project.compiler",(function(e,n){if(!r.ignoreUpdates)return null!=n&&e!==n?t.saveProjectSettings({compiler:e}):void 0})),e.$watch("project.imageName",(function(e,n){if(!r.ignoreUpdates)return null!=n&&e!==n?t.saveProjectSettings({imageName:e}):void 0}));var a=0;return e.$watch("project.rootDoc_id",(function(n,l){r.ignoreUpdates||void 0!==l&&"readOnly"!==e.permissionsLevel&&n!==l&&t.saveProjectSettings({rootDocId:n}).then((function(){a=0})).catch((function(){a++,setTimeout((function(){a>10&&(r.ignoreUpdates=!0),e.$apply((function(){e.project.rootDoc_id=l})),r.ignoreUpdates=!1}))}))})),n.socket.on("compilerUpdated",(function(t){return r.ignoreUpdates=!0,e.$apply((function(){return e.project.compiler=t})),delete r.ignoreUpdates})),n.socket.on("imageNameUpdated",(function(t){return r.ignoreUpdates=!0,e.$apply((function(){return e.project.imageName=t})),delete r.ignoreUpdates})),n.socket.on("spellCheckLanguageUpdated",(function(t){return r.ignoreUpdates=!0,e.$apply((function(){return e.project.spellCheckLanguage=t})),delete r.ignoreUpdates}))}]);function uh(e,t){if(null==e||"anonymous-user"===e)return 100;if(t===e)return 200;var n,r,a=(n=e,r=td()(n),parseInt(r.toString().slice(0,8),16)%320);return a>180&&a<220&&(a=(a-=200)+360-20),a}var dh=n(617),hh=n.n(dh);function ph(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fh(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function fh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gh(e){var t=e.content,n=Object(C.useRef)(null);return Object(C.useEffect)((function(){if(window.MathJax&&window.MathJax.Hub){var e=window.MathJax.Hub,t=e.config&&e.config.tex2jax&&e.config.tex2jax.inlineMath||[];t.some((function(e){return"$"===e[0]&&"$"===e[1]}))||e.Config({tex2jax:{inlineMath:t.concat([["$","$"]])}})}}),[]),Object(C.useEffect)((function(){var e,t=ph(n.current.getElementsByTagName("a"));try{for(t.s();!(e=t.n()).done;){var r=e.value;r.setAttribute("target","_blank"),r.setAttribute("rel","noreferrer noopener")}}catch(e){t.e(e)}finally{t.f()}var a=window.MathJax.Hub,l=setTimeout((function(){a.Queue(["Typeset",a,n.current])}),0);return function(){return clearTimeout(l)}}),[t]),Object(R.jsx)("p",{ref:n,children:Object(R.jsx)(hh.a,{children:t})})}gh.propTypes={content:k.a.string.isRequired};var mh=gh;function vh(e){var t=e.message,n=e.userId;function r(e){return e?uh(e.id,n):0}var a,l=!!t.user&&t.user.id===n;return Object(R.jsxs)("div",{className:"message-wrapper",children:[!l&&Object(R.jsx)("div",{className:"name",children:Object(R.jsx)("span",{children:t.user.first_name||t.user.email})}),Object(R.jsxs)("div",{className:"message",style:(a=t.user,{borderColor:"hsl(".concat(r(a),", 85%, 40%)"),backgroundColor:"hsl(".concat(r(a),", 85%, 40%")}),children:[!l&&Object(R.jsx)("div",{className:"arrow",style:function(e){return{borderColor:"hsl(".concat(r(e),", 85%, 40%)")}}(t.user)}),Object(R.jsx)("div",{className:"message-content",children:t.contents.map((function(e,t){return Object(R.jsx)(mh,{content:e},t)}))})]})]})}vh.propTypes={message:k.a.shape({contents:k.a.arrayOf(k.a.string).isRequired,user:k.a.shape({id:k.a.string,email:k.a.string,first_name:k.a.string})}),userId:k.a.string.isRequired};var bh=vh;function yh(e){var t=e.messages,n=e.resetUnreadMessages,r=e.userId;function a(e){if(0===e)return!0;var n=t[e],r=t[e-1];return n.timestamp-r.timestamp>3e5}return Object(R.jsx)("ul",{className:"list-unstyled",onClick:n,onKeyDown:n,children:t.map((function(e,t){return Object(R.jsxs)("li",{className:"message",children:[a(t)&&Object(R.jsx)("div",{className:"date",children:Object(R.jsx)("time",{dateTime:e.timestamp?od()(e.timestamp).format():void 0,children:(n=e.timestamp,n?"".concat(od()(n).format("h:mm a")," ").concat(od()(n).calendar()):"N/A")})}),Object(R.jsx)(bh,{message:e,userId:r})]},e.id);var n}))})}yh.propTypes={messages:k.a.arrayOf(k.a.shape({id:k.a.string.isRequired,timestamp:k.a.number})).isRequired,resetUnreadMessages:k.a.func.isRequired,userId:k.a.string.isRequired};var wh=yh;function xh(e){var t=e.resetUnreadMessages,n=e.sendMessage,r=Object(Mt.a)().t;return Object(R.jsxs)("div",{className:"new-message",children:[Object(R.jsx)("label",{htmlFor:"chat-input",className:"sr-only",children:r("your_message")}),Object(R.jsx)("textarea",{id:"chat-input",placeholder:"".concat(r("your_message"),"…"),onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),n(e.target.value),e.target.value="")},onClick:t})]})}xh.propTypes={resetUnreadMessages:k.a.func.isRequired,sendMessage:k.a.func.isRequired};var jh=xh;function Oh(e){var t=e.atEnd,n=e.children,r=e.className,a=void 0===r?"":r,l=e.fetchData,d=e.itemCount,h=e.isLoading,p=Object(C.useRef)(null),f=Object(C.useRef)(0);function y(){p.current.scrollTop=p.current.scrollHeight-p.current.clientHeight-f.current}return Object(C.useLayoutEffect)(y,[d]),Object(C.useEffect)((function(){var e=O.a.debounce(y,400);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(R.jsx)("div",{ref:p,onScroll:function(e){var n,r;n=p.current.scrollHeight-p.current.scrollTop-p.current.clientHeight,f.current=n,e.target===e.currentTarget&&(r=p.current.children[0].clientHeight<p.current.clientHeight,!(t||h||r)&&p.current.scrollTop<30&&l())},className:"infinite-scroll ".concat(a),children:n})}Oh.propTypes={atEnd:k.a.bool,children:k.a.element.isRequired,className:k.a.string,fetchData:k.a.func.isRequired,itemCount:k.a.number.isRequired,isLoading:k.a.bool};var Ch=Oh;function ChatFallbackError(e){var t=e.reconnect,n=Object(Mt.a)().t;return Object(R.jsx)("aside",{className:"chat",children:Object(R.jsxs)("div",{className:"chat-error",children:[Object(R.jsx)(Xo.a,{bsStyle:"danger",children:n("chat_error")}),t&&Object(R.jsx)("p",{className:"text-center",children:Object(R.jsx)(Ir.a,{bsStyle:"info",type:"button",onClick:t,children:n("reconnect")})})]})})}ChatFallbackError.propTypes={reconnect:k.a.any};var Sh=ChatFallbackError,_h=n(154),kh=S.a.memo((function(){var e=Object(Mt.a)().t,t=Pe({chatIsOpen:k.a.bool}).chatIsOpen,n=Object(Io.b)({id:k.a.string.isRequired}),r=zs(),a=r.status,l=r.messages,d=r.initialMessagesLoaded,h=r.atEnd,p=r.loadInitialMessages,f=r.loadMoreMessages,y=r.reset,w=r.sendMessage,x=r.markMessagesAsRead,j=r.error;Object(C.useEffect)((function(){t&&!d&&p()}),[t,p,d]);var O="pending"!==a&&0===l.length,S=l.reduce((function(e,t){return e+t.contents.length}),0);if(j){if(j instanceof B.a)return Object(R.jsx)(Sh,{reconnect:y});throw j}return n?Object(R.jsxs)("aside",{className:"chat",children:[Object(R.jsx)(Ch,{atEnd:h,className:"messages",fetchData:f,isLoading:"pending"===a,itemCount:S,children:Object(R.jsxs)("div",{children:[Object(R.jsx)("h2",{className:"sr-only",children:e("chat")}),"pending"===a&&Object(R.jsx)(_h.a,{}),O&&Object(R.jsx)(Eh,{}),Object(R.jsx)(wh,{messages:l,userId:n.id,resetUnreadMessages:x})]})}),Object(R.jsx)(jh,{resetUnreadMessages:x,sendMessage:w})]}):null}));function Eh(){var e=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"no-messages text-center small",children:e("no_messages")}),Object(R.jsxs)("div",{className:"first-message text-center",children:[e("send_first_message"),Object(R.jsx)("br",{}),Object(R.jsx)(Pr.a,{type:"arrow-down"})]})]})}var Ah=Object(E.a)(kh,Sh);y.a.component("chat",Object(x.react2angular)(Ys.use(Ah)));y.a.controller("CloneProjectController",["$scope","$modal",function(e,t){return e.openCloneProjectModal=function(){return t.open({templateUrl:"cloneProjectModalTemplate",controller:"CloneProjectModalController"})}}]),y.a.controller("CloneProjectModalController",["$scope","$modalInstance","$timeout","$http","ide",function(e,t,n,r,a){e.inputs={projectName:a.$scope.project.name+" (Copy)"},e.state={inflight:!1,error:!1},t.opened.then((function(){return n((function(){return e.$broadcast("open")}),200)}));return e.clone=function(){return e.state.inflight=!0,e.state.error=!1,(t=e.inputs.projectName,r.post("/project/".concat(a.$scope.project._id,"/clone"),{_csrf:window.csrfToken,projectName:t})).then((function(e){var t=e.data;return window.location="/project/".concat(t.project_id)})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}));var t},e.cancel=function(){return t.dismiss("cancel")}}]);function $h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Th(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Th(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Th(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rh(e){var t=e.handleHide,n=e.inFlight,r=e.setInFlight,a=e.openProject,l=Object(A.c)(),d=l._id,h=l.name,p=Object(Mt.a)().t,f=$h(Object(C.useState)(),2),y=f[0],w=f[1],x=$h(Object(C.useState)("".concat(h," (Copy)")),2),j=x[0],O=x[1],S=Object(C.useMemo)((function(){return j.trim().length>0}),[j]);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:p("copy_project")})}),Object(R.jsxs)(yi.a.Body,{children:[Object(R.jsx)("form",{id:"clone-project-form",onSubmit:function(e){e.preventDefault(),S&&(w(!1),r(!0),Object(B.d)("/project/".concat(d,"/clone"),{body:{projectName:j}}).then((function(e){a(e.project_id)})).catch((function(e){var t=e.response,n=e.data;400===(null==t?void 0:t.status)?w(n.message):w(!0)})).finally((function(){r(!1)})))},children:Object(R.jsxs)(Jo.a,{children:[Object(R.jsx)(Qo.a,{htmlFor:"clone-project-form-name",children:p("new_name")}),Object(R.jsx)(Zo.a,{id:"clone-project-form-name",type:"text",placeholder:"New Project Name",required:!0,value:j,onChange:function(e){return O(e.target.value)}})]})}),y&&Object(R.jsx)(Xo.a,{bsStyle:"danger",children:y.length?y:p("generic_something_went_wrong")})]}),Object(R.jsxs)(yi.a.Footer,{children:[Object(R.jsx)(Ir.a,{type:"button",disabled:n,onClick:t,children:p("cancel")}),Object(R.jsx)(Ir.a,{form:"clone-project-form",type:"submit",bsStyle:"primary",disabled:n||!S,children:n?Object(R.jsxs)(R.Fragment,{children:[p("copying"),"…"]}):p("copy")})]})]})}function Ih(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ph(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ph(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ph(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Rh.propTypes={handleHide:k.a.func.isRequired,inFlight:k.a.bool,setInFlight:k.a.func.isRequired,openProject:k.a.func.isRequired};var Dh=S.a.memo((function(e){var t=e.show,n=e.handleHide,r=e.openProject,a=Ih(Object(C.useState)(!1),2),l=a[0],d=a[1],h=Object(C.useCallback)((function(){l||n()}),[n,l]);return Object(R.jsx)(wi.a,{animation:!0,show:t,onHide:h,id:"clone-project-modal",backdrop:"static",children:Object(R.jsx)(Rh,{handleHide:h,inFlight:l,setInFlight:d,openProject:r})})}));Dh.propTypes={handleHide:k.a.func.isRequired,show:k.a.bool.isRequired,openProject:k.a.func.isRequired};var Mh=Object(E.a)(Dh);y.a.controller("LeftMenuCloneProjectModalController",["$scope",function(e){e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openCloneProjectModal=function(){e.$applyAsync((function(){e.show=!0}))},e.openProject=function(e){window.location.assign("/project/".concat(e))}}]);function linked_file_refresh_error_LinkedFileRefreshError(e){var t=e.file,n=Object(Mt.a)().t;return"mendeley"===t.linkedFileData.provider?Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{children:[n("if_error_persists_try_relinking_provider",{provider:"Mendeley"}),": "]}),Object(R.jsx)("div",{className:"text-center",children:Object(R.jsx)("a",{href:"/user/settings",target:"_blank",style:{fontWeight:"bold"},children:n("account_settings")})})]}):"zotero"===t.linkedFileData.provider?Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{children:[n("if_error_persists_try_relinking_provider",{provider:"Zotero"}),": "]}),Object(R.jsx)("div",{className:"text-center",children:Object(R.jsx)("a",{href:"/user/settings",target:"_blank",style:{fontWeight:"bold"},children:n("account_settings")})})]}):null}function Lh(e){return od()(e).format("h:mm a")}function Fh(e){return od()(e).calendar()}function qh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}y.a.component("cloneProjectModal",Object(x.react2angular)(Ys.use(Mh),Object.keys(Mh.propTypes))),linked_file_refresh_error_LinkedFileRefreshError.propTypes={file:k.a.shape({linkedFileData:k.a.shape({provider:k.a.string.isRequired}).isRequired}).isRequired},od.a.updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}});var Bh=function(e){return Object(R.jsx)(Pr.a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qh(Object(n),!0).forEach((function(t){Nh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:"external-link-square",modifier:"rotate-180",className:"linked-file-icon"},e))};function Uh(e){var t=e.file,n=Object(Mt.a)().t;return"mendeley"===t.linkedFileData.provider?Object(R.jsx)("div",{children:Object(R.jsxs)("p",{children:[Object(R.jsx)(Bh,{fw:!0}),n("imported_from_mendeley_at_date",{formattedDate:Lh(t.created),relativeDate:Fh(t.created)})]})}):"zotero"===t.linkedFileData.provider?Object(R.jsx)("div",{children:Object(R.jsxs)("p",{children:[Object(R.jsx)(Bh,{fw:!0}),n("imported_from_zotero_at_date",{formattedDate:Lh(t.created),relativeDate:Fh(t.created)})]})}):null}function Hh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Uh.propTypes={file:k.a.shape({created:k.a.string,linkedFileData:k.a.shape({provider:k.a.string})})};var Vh=[{import:h,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/linked-file-info.js"}],Wh=[{import:d,path:"/overleaf/services/web/modules/tpr-webmodule/frontend/js/components/linked-file-refresh-error.js"}],Kh=25-"...".length;function Gh(e){if(e)return e.length>60?e.slice(0,35)+"..."+e.slice(e.length-Kh):e}function Yh(e){var t,n=e.file,r=e.storeReferencesKeys,a=Object(A.c)({_id:k.a.string.isRequired})._id,l=Object(te.b)({permissionsLevel:k.a.string}).permissionsLevel,d=Object(Mt.a)().t,h=Hh(Object(C.useState)(!1),2),p=h[0],f=h[1],y=Hh(Object(C.useState)(null),2),w=y[0],x=y[1],j=Object(ea.a)().signal;n.linkedFileData&&("url"===n.linkedFileData.provider?t=Object(R.jsx)("div",{children:Object(R.jsx)(Xh,{file:n})}):"project_file"===n.linkedFileData.provider?t=Object(R.jsx)("div",{children:Object(R.jsx)(Jh,{file:n})}):"project_output_file"===n.linkedFileData.provider&&(t=Object(R.jsx)("div",{children:Object(R.jsx)(Qh,{file:n})})));var O=Object(C.useCallback)((function(){f(!0),window.expectingLinkedFileRefreshedSocketFor=n.name,Object(B.d)("/project/".concat(a,"/linked_file/").concat(n.id,"/refresh"),{signal:j}).then((function(){f(!1)})).catch((function(e){var t;f(!1),x((null===(t=e.data)||void 0===t?void 0:t.message)||e.message)})).finally((function(){("mendeley"===n.linkedFileData.provider||"zotero"===n.linkedFileData.provider||n.name.match(/^.*\.bib$/))&&Object(B.d)("/project/".concat(a,"/references/indexAll"),{body:{shouldBroadcast:!0}}).then((function(e){r(e.keys)})).catch((function(e){console.log(e)}))}))}),[n,a,j,r]);return Object(R.jsxs)("div",{children:[n.linkedFileData&&t,n.linkedFileData&&Vh.map((function(e){var t=e.import.LinkedFileInfo,r=e.path;return Object(R.jsx)(t,{file:n},r)})),n.linkedFileData&&"readOnly"!==l&&Object(R.jsxs)("button",{className:"btn btn-success",onClick:O,disabled:p,children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:p,fw:!0}),Object(R.jsx)("span",{children:p?d("refreshing")+"...":d("refresh")})]})," ",Object(R.jsxs)("a",{href:"/project/".concat(a,"/file/").concat(n.id),className:"btn btn-info",children:[Object(R.jsx)(Pr.a,{type:"download",fw:!0})," ",Object(R.jsx)("span",{children:d("download")})]}),w&&Object(R.jsxs)("div",{className:"row",children:[Object(R.jsx)("br",{}),Object(R.jsxs)("div",{className:"alert alert-danger col-md-6 col-md-offset-3",children:[d("error"),": ",w,Wh.map((function(e){var t=e.import.LinkedFileRefreshError,r=e.path;return Object(R.jsx)(t,{file:n},r)}))]})]})]})}function Xh(e){var t=e.file;return Object(R.jsxs)("p",{children:[Object(R.jsx)(Bh,{})," ",Object(R.jsx)(_i.a,{i18nKey:"imported_from_external_provider_at_date",components:[Object(R.jsx)("a",{href:t.linkedFileData.url})],values:{shortenedUrl:Gh(t.linkedFileData.url),formattedDate:Lh(t.created),relativeDate:Fh(t.created)}})]})}function Jh(e){var t=e.file;return Object(R.jsxs)("p",{children:[Object(R.jsx)(Bh,{})," ",Object(R.jsx)(_i.a,{i18nKey:"imported_from_another_project_at_date",components:t.linkedFileData.v1_source_doc_id?[Object(R.jsx)("span",{})]:[Object(R.jsx)("a",{href:"/project/".concat(t.linkedFileData.source_project_id),target:"_blank",rel:"noopener"})],values:{sourceEntityPath:t.linkedFileData.source_entity_path.slice(1),formattedDate:Lh(t.created),relativeDate:Fh(t.created)}})]})}function Qh(e){var t=e.file;return Object(R.jsxs)("p",{children:[Object(R.jsx)(Bh,{})," ",Object(R.jsx)(_i.a,{i18nKey:"imported_from_the_output_of_another_project_at_date",components:t.linkedFileData.v1_source_doc_id?[Object(R.jsx)("span",{})]:[Object(R.jsx)("a",{href:"/project/".concat(t.linkedFileData.source_project_id),target:"_blank",rel:"noopener"})],values:{sourceOutputFilePath:t.linkedFileData.source_output_file_path,formattedDate:Lh(t.created),relativeDate:Fh(t.created)}})]})}function Zh(e){var t=e.fileName,n=e.fileId,r=e.onLoad,a=e.onError,l=Object(A.c)({_id:k.a.string.isRequired})._id;return Object(R.jsx)("img",{src:"/project/".concat(l,"/file/").concat(n),onLoad:r,onError:a,onAbort:a,alt:t})}function ep(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Yh.propTypes={file:k.a.shape({id:k.a.string,name:k.a.string,linkedFileData:k.a.object}).isRequired,storeReferencesKeys:k.a.func.isRequired},Xh.propTypes={file:k.a.shape({linkedFileData:k.a.object,created:k.a.string}).isRequired},Jh.propTypes={file:k.a.shape({linkedFileData:k.a.object,created:k.a.string}).isRequired},Qh.propTypes={file:k.a.shape({linkedFileData:k.a.object,created:k.a.string}).isRequired},Zh.propTypes={fileName:k.a.string.isRequired,fileId:k.a.string.isRequired,onLoad:k.a.func.isRequired,onError:k.a.func.isRequired};function np(e){var t=e.file,n=e.onLoad,r=e.onError,a=Object(A.c)({_id:k.a.string.isRequired})._id,l=ep(Object(C.useState)(""),2),d=l[0],h=l[1],p=ep(Object(C.useState)(!1),2),f=p[0],y=p[1],w=ep(Object(C.useState)(!1),2),x=w[0],j=w[1];return Object(C.useEffect)((function(){if(!x){var e="/project/".concat(a,"/file/").concat(t.id);fetch(e,{method:"HEAD"}).then((function(e){if(!e.ok)throw new Error("HTTP Error Code: "+e.status);return e.headers.get("Content-Length")})).then((function(t){var r=!1,a=null;return t>2097152&&(r=!0,a=2097152),null!=a&&(e+="?range=0-".concat(a)),fetch(e).then((function(e){return e.text().then((function(e){r&&(e=e.replace(/\n.*$/,"")),h(e),n(),y(r)}))}))})).catch((function(e){console.error(e),r()})).finally((function(){j(!1)}))}}),[a,t.id,r,n,x]),Object(R.jsx)("div",{children:d&&Object(R.jsx)("div",{className:"text-preview",children:Object(R.jsxs)("div",{className:"scroll-container",children:[Object(R.jsx)("p",{children:d}),f&&Object(R.jsx)("p",{children:"..."})]})})})}function rp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ip(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ip(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ip(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}np.propTypes={file:k.a.shape({id:k.a.string}).isRequired,onLoad:k.a.func.isRequired,onError:k.a.func.isRequired};var op=["png","jpg","jpeg","gif"],ap=window.ExposedSettings.textExtensions;function sp(e){var t=e.file,n=e.storeReferencesKeys,r=rp(Object(C.useState)(!0),2),a=r[0],l=r[1],d=rp(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Object(Mt.a)().t,y=t.name.split(".").pop().toLowerCase(),w=!op.includes(y)&&!ap.includes(y),x=Object(C.useCallback)((function(){l(!1)}),[]),j=Object(C.useCallback)((function(){h||(l(!1),p(!0))}),[h]),O=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Yh,{file:t,storeReferencesKeys:n}),op.includes(y)&&Object(R.jsx)(Zh,{fileName:t.name,fileId:t.id,onLoad:x,onError:j}),ap.includes(y)&&Object(R.jsx)(np,{file:t,onLoad:x,onError:j})]});return Object(R.jsxs)("div",{className:"file-view full-size",children:[!h&&O,!w&&a&&Object(R.jsx)(lp,{}),(w||h)&&Object(R.jsx)("p",{className:"no-preview",children:f("no_preview_available")})]})}function lp(){var e=Object(Mt.a)().t;return Object(R.jsx)("div",{className:"loading-panel loading-panel-file-view",children:Object(R.jsxs)("span",{children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:!0}),"  ",e("loading"),"…"]})})}sp.propTypes={file:k.a.shape({id:k.a.string,name:k.a.string}).isRequired,storeReferencesKeys:k.a.func.isRequired};y.a.controller("FileViewController",["$scope","$rootScope",function(e,t){e.file=e.openFile,e.storeReferencesKeys=function(e){var n=t._references.keys;return t._references.keys=O.a.union(n,e)}}]);y.a.component("fileView",Object(x.react2angular)(Ys.use(sp),["storeReferencesKeys","file"]));var cp=/INPUT|SELECT|TEXTAREA/i,up=($(document).bind("keydown keypress",(function(e){if(8===e.which&&(!cp.test(e.target.tagName)||e.target.disabled||e.target.readOnly))return e.preventDefault()})),n(1022)),dp=n(1023);function hp(e){var t=e.animation,n=void 0===t||t,r=e.handleHide,a=e.show,l=e.isMac,d=void 0!==l&&l,h=e.trackChangesVisible,p=void 0!==h&&h,f=Object(Mt.a)().t,y=d?"Cmd":"Ctrl";return Object(R.jsxs)(wi.a,{bsSize:"large",onHide:r,show:a,animation:n,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:f("hotkeys")})}),Object(R.jsxs)(yi.a.Body,{className:"modal-hotkeys",children:[Object(R.jsx)("h3",{children:f("common")}),Object(R.jsxs)(up.a,{children:[Object(R.jsxs)(dp.a,{xs:4,children:[Object(R.jsx)(pp,{combination:"".concat(y," + F"),description:f("hotkey_find_and_replace")}),Object(R.jsx)(pp,{combination:"".concat(y," + Enter"),description:f("hotkey_compile")})]}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + Z"),description:f("hotkey_undo")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + Y"),description:f("hotkey_redo")})})]}),Object(R.jsx)("h3",{children:f("navigation")}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + Home"),description:f("hotkey_beginning_of_document")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + End"),description:f("hotkey_end_of_document")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + L"),description:f("hotkey_go_to_line")})})]}),Object(R.jsx)("h3",{children:f("editing")}),Object(R.jsxs)(up.a,{children:[Object(R.jsxs)(dp.a,{xs:4,children:[Object(R.jsx)(pp,{combination:"".concat(y," + /"),description:f("hotkey_toggle_comment")}),Object(R.jsx)(pp,{combination:"".concat(y," + D"),description:f("hotkey_delete_current_line")}),Object(R.jsx)(pp,{combination:"".concat(y," + A"),description:f("hotkey_select_all")})]}),Object(R.jsxs)(dp.a,{xs:4,children:[Object(R.jsx)(pp,{combination:"Ctrl + U",description:f("hotkey_to_uppercase")}),Object(R.jsx)(pp,{combination:"Ctrl + Shift + U",description:f("hotkey_to_lowercase")}),Object(R.jsx)(pp,{combination:"Tab",description:f("hotkey_indent_selection")})]}),Object(R.jsxs)(dp.a,{xs:4,children:[Object(R.jsx)(pp,{combination:"".concat(y," + B"),description:f("hotkey_bold_text")}),Object(R.jsx)(pp,{combination:"".concat(y," + I"),description:f("hotkey_italic_text")})]})]}),Object(R.jsx)("h3",{children:f("autocomplete")}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"Ctrl + Space",description:f("hotkey_autocomplete_menu")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"Tab / Up / Down",description:f("hotkey_select_candidate")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"Enter",description:f("hotkey_insert_candidate")})})]}),Object(R.jsx)("h3",{children:Object(R.jsx)(_i.a,{i18nKey:"autocomplete_references",components:{code:Object(R.jsx)("code",{})}})}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"Ctrl + Space ",description:f("hotkey_search_references")})})}),p&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("h3",{children:f("review")}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + J"),description:f("hotkey_toggle_review_panel")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + Shift + A"),description:f("hotkey_toggle_track_changes")})}),Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsx)(pp,{combination:"".concat(y," + Shift + C"),description:f("hotkey_add_a_comment")})})]})]})]}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{onClick:r,children:f("ok")})})]})}function pp(e){var t=e.combination,n=e.description;return Object(R.jsxs)("div",{className:"hotkey","data-test-selector":"hotkey",children:[Object(R.jsx)("span",{className:"combination",children:t}),Object(R.jsx)("span",{className:"description",children:n})]})}hp.propTypes={animation:k.a.bool,isMac:k.a.bool,show:k.a.bool.isRequired,handleHide:k.a.func.isRequired,trackChangesVisible:k.a.bool},pp.propTypes={combination:k.a.string.isRequired,description:k.a.string.isRequired},y.a.component("hotkeysModal",Object(x.react2angular)(hp,void 0));y.a.controller("HotkeysModalController",["$scope",function(e){e.show=!1,e.isMac=/Mac/i.test(navigator.platform),e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openHotkeysModal=function(){e.$applyAsync((function(){e.trackChangesVisible=e.project&&e.project.features.trackChangesVisible,e.show=!0}))}}]);var fp=n(1029);function gp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vp(e,t){var n=gp(Object(C.useState)(!0),2),r=n[0],a=n[1],l=gp(Object(C.useState)(!1),2),d=l[0],h=l[1],p=gp(Object(C.useState)(),2),f=p[0],y=p[1],w=Object(ea.a)().signal;return Object(C.useEffect)((function(){(function(e,t,n){var r="";return t&&(r="?clsiserverid=".concat(t)),Object(B.c)("/project/".concat(e,"/wordcount").concat(r),n)})(e,t,{signal:w}).then((function(e){y(e.texcount)})).catch((function(){h(!0)})).finally((function(){a(!1)}))}),[w,t,e]),{data:f,error:d,loading:r}}function bp(e){var t=e.handleHide,n=Object(A.c)()._id,r=Object(_e.b)().clsiServerId,a=Object(Mt.a)().t,l=vp(n,r),d=l.data,h=l.error,p=l.loading;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:a("word_count")})}),Object(R.jsxs)(yi.a.Body,{children:[p&&!h&&Object(R.jsxs)("div",{className:"loading",children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:!0,fw:!0})," ",a("loading"),"…"]}),h&&Object(R.jsx)(Xo.a,{bsStyle:"danger",children:a("generic_something_went_wrong")}),d&&Object(R.jsxs)(fp.a,{fluid:!0,children:[d.messages&&Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{xs:12,children:Object(R.jsx)(Xo.a,{bsStyle:"danger",children:Object(R.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:d.messages})})})}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsxs)("div",{className:"pull-right",children:[a("total_words"),":"]})}),Object(R.jsx)(dp.a,{xs:6,children:d.textWords})]}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsxs)("div",{className:"pull-right",children:[a("headers"),":"]})}),Object(R.jsx)(dp.a,{xs:6,children:d.headers})]}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsxs)("div",{className:"pull-right",children:[a("math_inline"),":"]})}),Object(R.jsx)(dp.a,{xs:6,children:d.mathInline})]}),Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsxs)("div",{className:"pull-right",children:[a("math_display"),":"]})}),Object(R.jsx)(dp.a,{xs:6,children:d.mathDisplay})]})]})]}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{onClick:t,children:a("done")})})]})}bp.propTypes={handleHide:k.a.func.isRequired};var yp=S.a.memo((function(e){var t=e.show,n=e.handleHide;return Object(R.jsx)(wi.a,{animation:!0,show:t,onHide:n,id:"clone-project-modal",children:Object(R.jsx)(bp,{handleHide:n})})}));yp.propTypes={show:k.a.bool,handleHide:k.a.func.isRequired};var wp=Object(E.a)(yp);y.a.controller("WordCountModalController",["$scope",function(e){e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openWordCountModal=function(){e.$applyAsync((function(){e.show=!0}))}}]);y.a.component("wordCountModal",Object(x.react2angular)(Ys.use(wp),Object.keys(wp.propTypes)));n(943),n(944),y.a.directive("layout",["$parse","$compile","ide",function(e,t,n){return{compile:function(){return{pre:function(r,a,l){var d,h,p=l.layout,f=l.customTogglerPane,y=l.customTogglerMsgWhenOpen,w=l.customTogglerMsgWhenClosed,x=null!=f&&null!=y&&null!=w,j={spacing_open:null!=l.spacingOpen?parseInt(l.spacingOpen,10):7,spacing_closed:null!=l.spacingClosed?parseInt(l.spacingClosed,10):7,slidable:!1,enableCursorHotkey:!1,onopen:function(e){return function(e){if(!x&&e!==f)return;return d.scope().$applyAsync((function(){return d.scope().isOpen=!0}))}(e)},onclose:function(e){return function(e){if(!x&&e!==f)return;return d.scope().$applyAsync((function(){return d.scope().isOpen=!1}))}(e)},onresize:function(){return _()},maskIframesOnResize:r.$eval(l.maskIframesOnResize||"false"),east:{size:r.$eval(l.initialSizeEast),initClosed:r.$eval(l.initClosedEast)},west:{size:r.$eval(l.initialSizeEast),initClosed:r.$eval(l.initClosedWest)}};null!=(h=n.localStorage("layout.".concat(p)))&&(null!=h.east&&(null==l.minimumRestoreSizeEast||h.east.size>=l.minimumRestoreSizeEast&&!h.east.initClosed)&&(j.east=h.east),null!=h.west&&(null==l.minimumRestoreSizeWest||h.west.size>=l.minimumRestoreSizeWest&&!h.west.initClosed)&&(j.west=h.west)),j.east.resizerCursor="ew-resize",j.west.resizerCursor="ew-resize";var C=function(){if(null!=d){h=a.layout().readState();var e="east"===f?"right":"left",t=h[f];return null!=t?d.css(e,t.initClosed?0:t.size):void 0}},S=function(){if(h=a.layout().readState(),null!=l.openEast&&null!=h.east)return e(l.openEast).assign(r,!h.east.initClosed)};function _(){return h=a.layout().readState(),r.$broadcast("layout:".concat(p,":resize"),h),function(){if(null!=(h=a.layout().readState()).east){var e=a.find("> .ui-layout-resizer-controls");h.east.initClosed?e.hide():(e.show(),e.css({right:h.east.size}))}}(),x&&C(),S()}var k=a.width(),E=function(){if(null!=l.resizeProportionally&&r.$eval(l.resizeProportionally)){var e=a.layout().readState().east;if(null!=e){var t=e.size/k*a.width();return k=a.width(),void a.layout().sizePane("east",t)}}n.$timeout((function(){a.layout().resizeAll()}))};if(a.layout(j),a.layout().resizeAll(),null!=l.resizeOn)for(var A=0,T=Array.from(l.resizeOn.split(","));A<T.length;A++){var R=T[A];r.$on(R,(function(){return E()}))}if(x){h=a.layout().readState();var I=r.$new();I.isOpen=!0,I.isVisible=!0,!0===(null!=h[f]?h[f].initClosed:void 0)&&(I.isOpen=!1),I.tooltipMsgWhenOpen=y,I.tooltipMsgWhenClosed=w,I.tooltipPlacement="east"===f?"left":"right",I.handleClick=function(){return a.layout().toggle(f),C()},d=t('<a href ng-show="isVisible" class="custom-toggler '.concat("custom-toggler-".concat(f),'" ng-class="isOpen ? \'custom-toggler-open\' : \'custom-toggler-closed\'" tooltip="{{ isOpen ? tooltipMsgWhenOpen : tooltipMsgWhenClosed }}" tooltip-placement="{{ tooltipPlacement }}" ng-click="handleClick()">'))(I),a.append(d)}if($(window).unload((function(){var e=O.a.mapValues(a.layout().readState(),(function(e){return O.a.omit(e,"children")}));n.localStorage("layout.".concat(p),e)})),null!=l.openEast&&r.$watch(l.openEast,(function(e,t){return null!=e&&e!==t&&(e?a.layout().open("east"):a.layout().close("east")),setTimeout((function(){return r.$digest()}),0)})),null!=l.allowOverflowOn){var P=a.layout(),D=r.$eval(l.allowOverflowOn),M=P.panes[D];P.allowOverflow(D);var L=M.zIndex();M.css("z-index",L+1)}if(S(),_(),null!=l.layoutDisabled)return r.$watch(l.layoutDisabled,(function(e){if(e?a.layout().hide("east"):a.layout().show("east"),x)return d.scope().$applyAsync((function(){return d.scope().isOpen=!e,d.scope().isVisible=!e}))}))},post:function(e,t,n){var r=n.layout,a=t.layout().readState();return e.$broadcast("layout:".concat(r,":linked"),a)}}}}}]);var xp,jp=new RegExp("[\\/\\\\\\*\\u0000-\\u001F\\u007F\\u0080-\\u009F\\uD800-\\uDFFF]","g"),Op=new RegExp("(^\\.$)|(^\\.\\.$)|(^\\s+)|(\\s+$)","g"),Cp=new RegExp("^(prototype|constructor|toString|toLocaleString|valueOf|hasOwnProperty|isPrototypeOf|propertyIsEnumerable|__defineGetter__|__lookupGetter__|__defineSetter__|__lookupSetter__|__proto__)$"),Sp=xp={clean:function(e){return e=(e=(e=e.replace(jp,"_")).replace(Op,(function(e){return new Array(e.length+1).join("_")}))).replace(Cp,"@$1")},isCleanFilename:function(e){return xp.isAllowedLength(e)&&!e.match(jp)&&!e.match(Op)},isAllowedLength:function(e){return e.length>0&&e.length<=1024}},_p=(y.a.directive("validFile",(function(){return{require:"ngModel",link:function(e,t,n,r){return r.$validators.validFile=function(e){return Sp.isCleanFilename(e)}}}})),{center:{paneSelector:"[vertical-resizable-top]",paneClass:"vertical-resizable-top",size:"auto"},south:{paneSelector:"[vertical-resizable-bottom]",paneClass:"vertical-resizable-bottom",resizerClass:"vertical-resizable-resizer",resizerCursor:"ns-resize",size:"auto",resizable:!0,closable:!1,slidable:!1,spacing_open:6,spacing_closed:6,maxSize:"75%"}});y.a.directive("verticalResizablePanes",["localStorage","ide",function(e,t){return{restrict:"A",link:function(n,r,a){var l=a.verticalResizablePanes,d=a.verticalResizablePanesMinSize,h=a.verticalResizablePanesMaxSize,p=a.verticalResizablePanesDefaultSize,f=null,y=!1;if(l){var w="vertical-resizable:".concat(l,":south-size");f=e(w),$(window).unload((function(){f&&e(w,f)}))}var x=a.verticalResizablePanesToggledExternallyOn,j=a.verticalResizablePanesHiddenExternallyOn,O=a.verticalResizablePanesHiddenInitially,C=a.verticalResizablePanesResizeOn,S="".concat(_p.south.resizerClass,"-disabled");x&&n.$on(x,(function(e,t){var n="auto";t?(f&&(n=f),_.resizers&&_.resizers.south&&_.resizers.south.removeClass(S)):_.resizers&&_.resizers.south&&_.resizers.south.addClass(S),_.sizePane("south",n)})),j&&t.$scope.$on(j,(function(e,t){t?_.show("south"):_.hide("south")})),C&&t.$scope.$on(C,(function(){t.$timeout((function(){_.resizeAll()}))})),h&&(_p.south.maxSize=h),d&&(_p.south.minSize=d),p&&(_p.south.size=p),_p.south.ondrag_end=function(){y=!0},_p.south.onresize=function(e,t,n){y&&(f=n.size),y=!1};var _=r.layout(_p);"true"===O&&_.hide("south")}}}]),n(228),n(945);function kp(e){return(kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ep(e,t){return null!=e?t(e):void 0}y.a.factory("ide",["$http","queuedHttp","$modal","$q","$filter","$timeout","eventTracking",function(e,t,n,r,a,l,d){var h=this,p={};return p.$http=e,p.queuedHttp=t,p.$q=r,p.$filter=a,p.$timeout=l,p.globalEditorWatchdogManager=new Wl({onTimeoutHandler:function(e){d.sendMB("losing-edits",e),p.reportError("losing-edits",Object.assign({},e))}}),this.recentEvents=[],p.pushEvent=function(e,t){if(null==t&&(t={}),sl_console.log("event",e,t),h.recentEvents.push({type:e,meta:t,date:new Date}),h.recentEvents.length>100)return h.recentEvents.shift()},p.reportError=function(t,n){null==n&&(n={}),n.user_id=window.user_id,n.project_id=window.project_id,n.client_id=Ep(null!=p.socket?p.socket.socket:void 0,(function(e){return e.sessionid})),n.transport=Ep(Ep(null!=p.socket?p.socket.socket:void 0,(function(e){return e.transport})),(function(e){return e.name})),n.client_now=new Date;var r={};if("object"===kp(t))for(var a=0,l=Array.from(Object.getOwnPropertyNames(t));a<l.length;a++){var d=l[a];r[d]=t[d]}else"string"==typeof t&&(r.message=t);return e.post("/error/client",{error:r,meta:n,_csrf:window.csrfToken})},p.showGenericMessageModal=function(e,t){return n.open({templateUrl:"genericMessageModalTemplate",controller:"GenericMessageModalController",resolve:{title:function(){return e},message:function(){return t}}})},p.showOutOfSyncModal=function(e,t,r){return n.open({templateUrl:"outOfSyncModalTemplate",controller:"OutOfSyncModalController",backdrop:!1,keyboard:!1,resolve:{title:function(){return e},message:function(){return t},editorContent:function(){return r}},windowClass:"out-of-sync-modal"})},p.showLockEditorMessageModal=function(e,t){return n.open({templateUrl:"lockEditorModalTemplate",controller:"GenericMessageModalController",backdrop:!1,keyboard:!1,resolve:{title:function(){return e},message:function(){return t}},windowClass:"lock-editor-modal"})},p}]),y.a.controller("GenericMessageModalController",["$scope","$modalInstance","title","message",function(e,t,n,r){return e.title=n,e.message=r,e.done=function(){return t.close()}}]),y.a.controller("OutOfSyncModalController",["$scope","$window","title","message","editorContent",function(e,t,n,r,a){e.title=n,e.message=r,e.editorContent=a,e.editorContentRows=a.split("\n").length,e.done=function(){t.location.reload()}}]);n(400),n(401),y.a.directive("updateScrollBottomOn",["$timeout",function(e){return{restrict:"A",link:function(t,n,r,a){var l=0;return n.on("scroll",(function(e){return l=n[0].scrollHeight-n[0].scrollTop-n[0].clientHeight})),t.$on(r.updateScrollBottomOn,(function(){return e((function(){return n.scrollTop(n[0].scrollHeight-n[0].clientHeight-l)}),0)}))}}}]),n(402),n(399),y.a.directive("rightClick",(function(){return{restrict:"A",link:function(e,t,n){return t.bind("contextmenu",(function(t){return t.preventDefault(),t.stopPropagation(),e.$eval(n.rightClick)}))}}})),y.a.directive("expandableTextArea",(function(){return{restrict:"A",link:function(e,t){return e.$watch((function(){return t.val()}),(function(){var n=t.outerHeight(),r=t.prop("scrollHeight");""===t.val()?t.css("height","unset"):r>n&&(e.$emit("expandable-text-area:resize"),t.css("height",r))}))}}})),y.a.directive("videoPlayState",["$parse",function(e){return{restrict:"A",link:function(t,n,r){var a=n[0];return t.$watch((function(){return e(r.videoPlayState)(t)}),(function(e){return e?(a.currentTime=0,a.play()):a.pause()}))}}}]),n(329),n(403),n(404),y.a.factory("waitFor",["$q",function(e){return function(t,n,r){null==r&&(r=500);var a=Math.floor(n/r),l=0;return e((function(e,d){var h;return(h=function(){if(l>a)return d(new Error("waiting too long, ".concat(JSON.stringify({timeout:n,pollInterval:r}))));l+=1;var p=t();return null!=p?e(p):setTimeout(h,r)})()}))}}]),n(405),n(395),n(394),n(396);function Ap(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ip(e){var t=e.dropbox,n=t.userIsLinkedToDropbox,r=t.linkToDropbox,a=t.startedLinkProcess,l=Object(Mt.a)().t,d=Tp(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Tp(Object(oe.a)("project",!0),1)[0],y=Tp(Object(oe.a)("user",!0),1)[0];Object(C.useEffect)((function(){y&&!y.features.dropbox&&Object(xe.a)("subscription-funnel","editor-click-feature","dropbox")}),[y]);var w=Object(C.useMemo)((function(){if(f)return f.owner._id===y.id||f.members.some((function(e){return e._id===y.id}))}),[f,y]);return y.features.dropbox?n?w?Object(R.jsxs)("p",{className:"small","data-testid":"dropbox-will-appear",children:[l("this_project_will_appear_in_your_dropbox_folder_at")," ",Object(R.jsxs)("strong",{children:["Apps/Overleaf/",f.name]})]}):Object(R.jsx)("div",{children:l("dropbox_for_link_share_projs")}):a?Object(R.jsx)("p",{className:"small text-center",children:l("refresh_page_after_linking_dropbox")}):Object(R.jsxs)("span",{children:[l("account_not_linked_to_dropbox"),"  ",Object(R.jsx)(Ir.a,{bsStyle:"info",onClick:r,children:l("update_dropbox_settings")})]}):Object(R.jsxs)("div",{children:[Object(R.jsx)("h4",{className:"teaser-title",children:l("easily_manage_your_project_files_everywhere")}),Object(R.jsx)("img",{className:"teaser-img",src:"/img/teasers/dropbox/teaser-dropbox-editor.png",alt:"Dropbox"}),h&&Object(R.jsx)("p",{className:"small",children:l("refresh_page_after_starting_free_trial")}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{md:8,mdOffset:2,children:Object(R.jsxs)("ul",{className:"list-unstyled",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",l("manage_files_from_your_dropbox_folder")]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",l("have_an_extra_backup")]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",l("work_with_non_overleaf_users")]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",l("work_offline")]})]})})}),Object(R.jsx)(up.a,{className:"text-center",children:Object(R.jsx)(ma.a,{source:"dropbox",setStartedFreeTrial:p,children:l("try_it_for_free")})})]})}function Pp(e){var t,n,r,a,l,d,h,p,f,y=e.handleHide,w=Object(Mt.a)().t,x=(t=Ap(Object(C.useState)(!1),2),n=t[0],r=t[1],a=Ap(Object(C.useState)(!1),2),l=a[0],d=a[1],h=Ap(Object(C.useState)(!1),2),p=h[0],f=h[1],Object(C.useEffect)((function(){Object(B.c)("/dropbox/status").then((function(e){r(!0),d(e.registered)}))}),[]),{gotLinkStatus:n,userIsLinkedToDropbox:l,linkToDropbox:Object(C.useCallback)((function(){f(!0),window.open("/user/settings#dropboxSettings")}),[]),startedLinkProcess:p});return Object(R.jsxs)(wi.a,{show:!0,onHide:y,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:w("dropbox_sync")})}),Object(R.jsx)(yi.a.Body,{className:"modal-body-share",children:x.gotLinkStatus?Object(R.jsx)(Ip,{dropbox:x}):Object(R.jsxs)("div",{children:[Object(R.jsx)(Pr.a,{type:"refresh",spin:!0}),"  ",Object(R.jsx)("span",{className:"small",children:w("checking_dropbox_status")})]})}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{onClick:y,children:w("dismiss")})})]})}function Dp(e){var t=e.show,n=e.handleHide;return t?Object(R.jsx)(Pp,{handleHide:n}):null}Ip.propTypes={dropbox:k.a.shape({userIsLinkedToDropbox:k.a.bool,linkToDropbox:k.a.func.isRequired,startedLinkProcess:k.a.bool})},Pp.propTypes={handleHide:k.a.func.isRequired},Dp.propTypes={show:k.a.bool.isRequired,handleHide:k.a.func.isRequired},y.a.component("dropboxModal",Object(x.react2angular)(Ys.use(Dp),Object.keys(Dp.propTypes)));y.a.controller("ReactDropboxModalController",["$scope",function(e){e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openDropboxModal=function(){e.$applyAsync((function(){e.show=!0}))}}]),n(946);function Mp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fp(e){var t,n=e.link,r=e.tooltipId,a=Object(Mt.a)().t,l=Mp(Object(C.useState)(!1),2),d=l[0],h=l[1],p=Object(C.useCallback)((function(){navigator.clipboard.writeText(n).then((function(){h(!0),window.setTimeout((function(){h(!1)}),1500)}))}),[n]);return null!==(t=navigator.clipboard)&&void 0!==t&&t.writeText?Object(R.jsx)(hi.a,{placement:"top",delayHide:d?1e3:250,shouldUpdatePosition:!0,overlay:Object(R.jsx)(di.a,{id:r,children:d?"Copied!":Object(R.jsx)(_i.a,{i18nKey:"copy"})}),children:Object(R.jsx)(Ir.a,{onClick:p,bsSize:"xsmall",bsStyle:"link",className:"copy-button","aria-label":a("copy"),children:d?Object(R.jsx)(Pr.a,{type:"check"}):Object(R.jsx)(Pr.a,{type:"clipboard"})})}):null}function qp(e){var t=e.projectId,n="".concat(window.gitBridgePublicBaseUrl,"/").concat(t),r="git clone ".concat(n);return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{children:Object(R.jsx)(_i.a,{i18nKey:"git_bridge_modal_description",components:{code:Object(R.jsx)("code",{})}})}),Object(R.jsx)("pre",{className:"text-center",children:Object(R.jsxs)("kbd",{children:[Object(R.jsx)("span",{children:r}),Object(R.jsx)(Fp,{link:r,tooltipId:"git-clone-copy-tooltip"})]})})]})}Fp.propTypes={link:k.a.string.isRequired,tooltipId:k.a.string.isRequired},qp.propTypes={projectId:k.a.string.isRequired};var Np=qp;var Bp=function(){var e=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("h4",{className:"teaser-title",children:e("access_your_projects_with_git")}),Object(R.jsx)("p",{className:"text-center",children:e("ask_proj_owner_to_upgrade_for_git_bridge")})]})};function Up(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Hp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zp=function(){var e=Object(Mt.a)().t,t=Up(Object(C.useState)(!1),2),n=t[0],r=t[1];return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"teaser-video-container",children:Object(R.jsxs)("video",{className:"teaser-video",autoPlay:!0,loop:!0,children:[Object(R.jsx)("source",{src:"/img/teasers/git-bridge/teaser-git-bridge.mp4",type:"video/mp4"}),Object(R.jsx)("img",{src:"/img/teasers/git-bridge/teaser-git-bridge.gif",alt:e("demonstrating_git_integration")})]})}),Object(R.jsx)(up.a,{children:Object(R.jsxs)(dp.a,{md:8,mdOffset:2,children:[Object(R.jsx)("h4",{className:"teaser-title",children:e("collaborate_online_and_offline")}),n&&Object(R.jsx)("p",{className:"small teaser-refresh-label",children:e("refresh_page_after_starting_free_trial")}),Object(R.jsxs)("ul",{className:"list-unstyled",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",e("get_collaborative_benefits")]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",e("use_your_own_machine")]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",e("store_your_work")]})]})]})}),Object(R.jsx)(up.a,{className:"text-center",children:Object(R.jsx)(ma.a,{buttonStyle:"primary",source:"git-bridge",setStartedFreeTrial:r,children:e("try_it_for_free")})})]})},Vp=S.a.memo((function(e){var t=e.show,n=e.handleHide,r=e.type,a=Object(Mt.a)().t;return Object(R.jsxs)(wi.a,{bsSize:"large",onHide:n,show:t,animation:!0,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:a("clone_with_git")})}),Object(R.jsx)(yi.a.Body,{children:Object(R.jsx)(Wp,{type:r})}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{onClick:n,children:a("close")})})]})}));function Wp(e){var t=e.type,n=Object(A.c)({_id:k.a.string.isRequired})._id;return"show_url"===t?Object(R.jsx)(Np,{projectId:n}):"collaborator"===t?Object(R.jsx)(Bp,{}):Object(R.jsx)(zp,{})}Vp.propTypes={show:k.a.bool,handleHide:k.a.func.isRequired,type:k.a.string.isRequired},Wp.propTypes={type:k.a.oneOf(["show_url","collaborator","teaser"]).isRequired};var Kp=Vp;y.a.controller("GitBridgeController",["$scope","$modal","eventTracking","ide",function(e,t,n,r){e.type="show_url",e.openGitBridgeModal=function(){var t=r.$scope.project.features.gitBridge||r.$scope.user.features.gitBridge,a=e.user.id===e.project.owner._id;t||n.send("subscription-funnel","editor-click-feature","gitBridge"),e.$applyAsync((function(){e.type=t?"show_url":a?"teaser":"collaborator",e.show=!0}))},e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))}}]);y.a.component("gitBridgeModal",Object(x.react2angular)(Ys.use(Kp),["show","handleHide","type"]));n(37);function Gp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xp=function(){var e=Object(Mt.a)().t,t=window.ExposedSettings.appName,n=Gp(Object(C.useState)(!1),2),r=n[0],a=n[1];return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("h4",{className:"teaser-title",children:["Push to GitHub, pull to ",t," "]}),r&&Object(R.jsx)("p",{className:"text-center small",children:e("refresh_page_after_starting_free_trial")}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{md:8,mdOffset:2,children:Object(R.jsxs)("ul",{className:"list-unstyled",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"}),"   Work offline, then pull to ",t]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"}),"   Import existing projects from GitHub"]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"}),"   Have an extra backup"]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"}),"   Work with other GitHub users"]})]})})}),Object(R.jsx)(up.a,{className:"text-center",children:Object(R.jsx)(ma.a,{source:"github",buttonStyle:"primary",setStartedFreeTrial:a,children:e("try_it_for_free")})})]})};function Jp(e){var t=e.refreshState,n=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{children:Object(R.jsx)(_i.a,{i18nKey:"link_to_github_description"})}),Object(R.jsx)("p",{children:Object(R.jsx)(Ir.a,{bsStyle:"primary",type:"button",onClick:function(){var e=window.open("/github-sync/beginAuth","github-sync-auth","width=700,height=500"),n=setInterval((function(){var r;try{r=e&&e.location&&e.location.pathname}catch(e){r=null}if("/github-sync/linked"===r)return e.close(),t(),clearInterval(n)}),1e3)},children:n("link_to_github")})})]})}Jp.propTypes={refreshState:k.a.func.isRequired};var Qp=Jp,Zp=n(1024);function ef(){var e=Object(C.useRef)(!0);return Object(C.useEffect)((function(){return function(){e.current=!1}}),[e]),e}function tf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rf(e){var t=e.refreshState,n=e.projectName,r=e.projectId,a=tf(Object(C.useState)(""),2),l=a[0],d=a[1],h=tf(Object(C.useState)(!0),2),p=h[0],f=h[1],y=tf(Object(C.useState)(!1),2),w=y[0],x=y[1],j=tf(Object(C.useState)({}),2),O=j[0],S=j[1],_=tf(Object(C.useState)([]),2),k=_[0],E=_[1],A=tf(Object(C.useState)(null),2),T=A[0],I=A[1],P=tf(Object(C.useState)(n),2),D=P[0],M=P[1],L=tf(Object(C.useState)(!1),2),F=L[0],q=L[1],N=tf(Object(C.useState)("private"),2),U=N[0],H=N[1],z=ef();Object(C.useEffect)((function(){Object(B.c)("/user/github-sync/orgs").then((function(e){S(e.user),E(e.orgs),I(e.user.login),f(!1)})).catch((function(e){z.current&&W(e)}))}),[z]);var V=Object(C.useCallback)((function(){q(!0);var e={name:D,description:l,private:"private"===U};null!=T&&T!==O.login&&(e.org=T),Object(B.d)("/project/".concat(r,"/github-sync/export"),{body:e}).then((function(){q(!1),t()})).catch(W)}),[l,D,T,r,t,U,O]),W=function(e){q(!1),x(e)},K=Object(Mt.a)().t;function G(){if(504===w.info.statusCode)return K("github_timeout_error");if(w.data.error)switch(w.data.error){case"GithubWorkflowFilesError":return K("github_workflow_files_error");case"GitFolderError":return K("github_git_folder_error")}return K("github_validation_check")}return p?Object(R.jsxs)("div",{className:"loading",children:[Object(R.jsx)(Pr.a,{modifier:"fw",type:"refresh",spin:!0}),Object(R.jsx)("span",{children:K("checking_project_github_status")})]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("h4",{children:[" ",K("export_project_to_github")," "]}),Object(R.jsxs)("p",{children:[" ",K("project_not_linked_to_github")," "]}),w&&Object(R.jsxs)(Xo.a,{"aria-label":G(),bsStyle:"danger",children:[G(),function(){if(w.data.error)switch(w.data.error){case"GithubWorkflowFilesError":return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{className:"text-center row-spaced-small",children:Object(R.jsx)(Ir.a,{bsStyle:"primary",href:"/github-sync/addWorkflowScope",target:"_blank",children:K("github_workflow_authorize")})}),Object(R.jsx)("p",{className:"text-small ",children:K("github_workflow_files_delete_github_repo")})]})}return null}()]}),Object(R.jsxs)(Zp.a,{children:[Object(R.jsxs)(up.a,{children:[Object(R.jsx)(dp.a,{xs:4,children:Object(R.jsxs)(Jo.a,{controlId:"github-sync-owner",children:[Object(R.jsx)(Qo.a,{children:K("owner")}),Object(R.jsxs)(Zo.a,{componentClass:"select",name:"org",onBlur:function(e){return I(e.target.value)},children:[Object(R.jsxs)("option",{children:[" ",O.login," "]}),k.map((function(e){return Object(R.jsxs)("option",{children:[" ",e.login," "]},e.login)}))]})]})}),Object(R.jsx)(dp.a,{xs:5,children:Object(R.jsxs)(Jo.a,{controlId:"github-sync-name",children:[Object(R.jsx)(Qo.a,{children:K("repository_name")}),Object(R.jsx)(Zo.a,{name:"name",type:"text",onChange:function(e){return M(e.target.value)},value:D})]})})]}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{xs:12,children:Object(R.jsxs)(Jo.a,{controlId:"github-sync-description",children:[Object(R.jsxs)(Qo.a,{children:[K("description")," (",K("optional"),")"]}),Object(R.jsx)(Zo.a,{name:"description",type:"text",onChange:function(e){return d(e.target.value)},value:l})]})})}),Object(R.jsx)("hr",{}),Object(R.jsx)(up.a,{children:Object(R.jsxs)(dp.a,{xs:12,children:[Object(R.jsxs)("label",{children:[Object(R.jsx)("input",{name:"private",type:"radio",value:"false",checked:"public"===U,onChange:function(){return H("public")}})," ",K("public")]}),Object(R.jsxs)("small",{children:[" ",K("github_public_description")," "]})]})}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{xs:12,children:Object(R.jsxs)(Jo.a,{children:[Object(R.jsxs)("label",{children:[Object(R.jsx)("input",{name:"private",value:"true",type:"radio",checked:"private"===U,onChange:function(){return H("private")}})," ",K("private")]}),Object(R.jsxs)("small",{children:[" ",K("github_private_description")," "]})]})})})]}),Object(R.jsx)(Ir.a,{bsStyle:"primary",type:"button",disabled:F,onClick:V,children:F?Object(R.jsxs)(R.Fragment,{children:[K("creating")," "]}):Object(R.jsxs)(R.Fragment,{children:[" ",K("create_project_in_github")," "]})})]})}rf.propTypes={refreshState:k.a.func.isRequired,projectName:k.a.string,projectId:k.a.string.isRequired};var of=rf;function af(e){var t=e.repo,n=e.commitState,r=Object(Mt.a)().t;return n.loading?Object(R.jsxs)("div",{className:"text-center",children:[Object(R.jsx)(Pr.a,{fw:!0,type:"refresh",spin:!0})," ",Object(R.jsx)("span",{children:r("loading_recent_github_commits")})]}):0===n.commits.length?Object(R.jsx)("div",{className:"text-center commit-message",children:Object(R.jsx)("p",{className:"small",children:r("no_new_commits_in_github")})}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("h3",{children:[" ",r("recent_commits_in_github")," "]}),n.commits.diverged&&Object(R.jsxs)(Xo.a,{bsStyle:"warning",children:[r("github_repository_diverged")," "]}),Object(R.jsx)("div",{style:{maxHeight:200,overflow:"auto"},children:n.commits.map((function(e){return Object(R.jsxs)("div",{id:e.sha,children:[Object(R.jsx)("span",{className:"small pull-right",children:Object(R.jsx)("a",{href:"https://github.com/".concat(t,"/commit/").concat(e.sha),target:"_blank",rel:"noreferrer noopener",children:e.sha.slice(0,6)})}),Object(R.jsx)("a",{href:"https://github.com/".concat(t,"/commit/").concat(e.sha),target:"_blank",className:"commit-message",rel:"noreferrer noopener",children:e.message}),Object(R.jsxs)("div",{className:"small",children:["by ","".concat(e.author.name," <").concat(e.author.email,">")]})]},e.sha)}))})]})}af.propTypes={repo:k.a.string.isRequired,commitState:k.a.object.isRequired};var sf=af;function lf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uf(e){var t=e.mergeAction,n=e.refreshState,r=e.projectId,a=e.handleIgnoringExternalUpdates,l=(e.cancel,Object(Mt.a)().t),d=lf(Object(C.useState)(!1),2),h=d[0],p=d[1],f=lf(Object(C.useState)(null),2),y=f[0],w=f[1],x=lf(Object(C.useState)(null),2),j=x[0],O=x[1];function S(){p(!0);var e={message:y};a(!0),Object(B.d)("/project/".concat(r,"/github-sync/merge"),{body:e}).then((function(){a(!1),n()})).catch((function(e){a(!1),O(e),p(!1)}))}function _(){if(504===j.response.status)return l("github_timeout_error");if(j.data.error)switch(j.data.error){case"GithubTooManyFilesError":return l("github_too_many_files_error");case"GithubFileSizeLimitError":return l("github_large_files_error");case"GithubFileNameError":return l("github_file_name_error");case"GithubSymlinkError":return l("github_symlink_error");case"GithubWorkflowFilesError":return l("github_workflow_files_error");case"GitFolderError":return l("github_git_folder_error");default:return j.data.error}return l("github_sync_error")}return h||j||"pull"!==t||S(),h?Object(R.jsxs)("div",{className:"loading",children:[Object(R.jsx)(Pr.a,{fw:!0,type:"refresh",spin:!0})," ",Object(R.jsx)("span",{children:l("importing_and_merging_changes_in_github")})]}):Object(R.jsxs)(R.Fragment,{children:[j&&Object(R.jsxs)(Xo.a,{"aria-label":_(),bsStyle:"danger",children:[_(),function(){if(j.data.error)switch(j.data.error){case"GithubWorkflowFilesError":return Object(R.jsx)("p",{className:"text-center row-spaced-small",children:Object(R.jsx)(Ir.a,{bsStyle:"primary",href:"/github-sync/addWorkflowScope",target:"_blank",children:l("github_workflow_authorize")})})}return null}()]}),"push"===t&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(Zp.a,{children:[Object(R.jsx)("p",{children:Object(R.jsx)(_i.a,{i18nKey:"sync_project_to_github_explanation"})}),Object(R.jsx)(up.a,{children:Object(R.jsx)(dp.a,{xs:12,children:Object(R.jsx)(Jo.a,{children:Object(R.jsx)(Zo.a,{componentClass:"textarea",placeholder:l("github_commit_message_placeholder"),onChange:function(e){return w(e.target.value)}})})})})]}),Object(R.jsx)("p",{children:Object(R.jsx)(Ir.a,{bsStyle:"primary",type:"button",onClick:S,children:l("commit")})})]})]})}uf.propTypes={mergeAction:k.a.string.isRequired,refreshState:k.a.func.isRequired,projectId:k.a.string.isRequired,handleIgnoringExternalUpdates:k.a.func.isRequired,cancel:k.a.func.isRequired};var df=uf;var hf=function GithubSyncFallbackError(){var e=Object(Mt.a)().t;return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Xo.a,{bsStyle:"danger",children:e("github_sync_error")})})};function pf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ff(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ff(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ff(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gf(e){var t,n=e.projectId,r=e.refreshState,a=Object(Mt.a)().t,l=pf(Object(C.useState)(!1),2),d=l[0],h=l[1];return t=a(d?"unlinking":"unlink_github_repository"),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Xo.a,{bsStyle:"danger",children:a("github_sync_repository_not_found_description")}),Object(R.jsx)(Ir.a,{bsStyle:"primary",disabled:d,onClick:function(){h(!0),Object(B.b)("/project/".concat(n,"/github-sync/")).finally((function(){r()}))},children:t})]})}gf.propTypes={projectId:k.a.string.isRequired,refreshState:k.a.func.isRequired};var mf=gf;function vf(e,t,n,r,a,l,d){try{var h=e[l](d),p=h.value}catch(e){return void n(e)}h.done?t(p):Promise.resolve(p).then(r,a)}function bf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wf(e){var t=e.cancel,n=e.handleIgnoringExternalUpdates,r=e.isProjectMember,a=Object(A.c)({_id:k.a.string.isRequired,name:k.a.string.isRequired}),l=a._id,d=a.name,h=bf(Object(C.useState)(!0),2),p=h[0],f=h[1],y=bf(Object(C.useState)(null),2),w=y[0],x=y[1],j=bf(Object(C.useState)({enabled:null}),2),O=j[0],S=j[1],_=bf(Object(C.useState)({enabled:null}),2),E=_[0],T=_[1],I=bf(Object(C.useState)({loading:!0,commits:[],diverged:!1}),2),P=I[0],D=I[1],M=bf(Object(C.useState)(null),2),L=M[0],F=M[1],q=Object(ea.a)().signal,N=Object(C.useCallback)((function(){f(!0),x(null),S({enabled:null}),T({enabled:null}),D({loading:!0,commits:[],diverged:!1}),F(null),Object(B.c)("/user/github-sync/status",{signal:q}).then(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r,a,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(t),e.next=3,Object(B.c)("/project/".concat(l,"/github-sync/status"));case 3:if(n=e.sent,T(n),f(!1),!n.enabled){e.next=13;break}return e.next=9,Object(B.c)("/project/".concat(l,"/github-sync/commits/unmerged"));case 9:r=e.sent,a=r.commits?r.commits:r,d=!!r.diverged&&r.diverged,D({commits:a,diverged:d,loading:!1});case 13:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function d(e){vf(l,r,a,d,h,"next",e)}function h(e){vf(l,r,a,d,h,"throw",e)}d(void 0)}))});return function(e){return t.apply(this,arguments)}}()).catch((function(e){x(e)}))}),[l,q]);Object(C.useEffect)((function(){N()}),[N]);var U=Object(Mt.a)().t;return null!=L?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(df,{mergeAction:L,refreshState:N,handleIgnoringExternalUpdates:n,projectId:l,cancel:t})}):w?Object(R.jsx)(Of,{error:w,projectId:l,refreshState:N}):p?Object(R.jsxs)("div",{className:"loading",children:[Object(R.jsx)(Pr.a,{fw:!0,type:"refresh",spin:!0}),Object(R.jsx)("span",{children:U("checking_project_github_status")})]}):E.enabled?Object(R.jsx)(xf,{project:E,commits:P,setMergeAction:F}):Object(R.jsx)(jf,{user:O,refreshState:N,isProjectMember:r,projectName:d,projectId:l})}function xf(e){var t=e.project,n=e.commits,r=e.setMergeAction,a=Object(Mt.a)().t;return"success"===t.merge_status?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("p",{className:"text-center",children:[a("project_synced_with_git_repo_at"),"  ",Object(R.jsx)("a",{href:"https://github.com/".concat(t.repo),target:"_blank",rel:"noreferrer noopener",children:t.repo})]}),Object(R.jsx)("hr",{}),Object(R.jsx)(sf,{repo:t.repo,commitState:n}),n.commits.length>0&&Object(R.jsx)("p",{className:"text-center row-spaced",children:Object(R.jsxs)(Ir.a,{bsStyle:"info",onClick:function(){return r("pull")},children:[Object(R.jsx)(Pr.a,{fw:!0,type:"file"}),Object(R.jsx)(Pr.a,{fw:!0,type:"long-arrow-left"}),Object(R.jsx)(Pr.a,{fw:!0,type:"github"})," ",a("pull_github_changes_into_sharelatex")]})}),Object(R.jsx)("hr",{}),Object(R.jsx)("p",{className:"text-center",children:Object(R.jsxs)(Ir.a,{bsStyle:"info",onClick:function(){return r("push")},children:[Object(R.jsx)(Pr.a,{fw:!0,type:"file"}),Object(R.jsx)(Pr.a,{fw:!0,type:"long-arrow-right"}),Object(R.jsx)(Pr.a,{fw:!0,type:"github"})," ",a("push_sharelatex_changes_to_github")]})})]}):Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(Xo.a,{bsStyle:"alert-danger",children:[Object(R.jsx)(_i.a,{i18nKey:"github_merge_failed",values:{sharelatex_branch:t.unmerged_branch,master_branch:"master"},components:[Object(R.jsx)("b",{},"sharelatex_branch"),Object(R.jsx)("b",{},"master_branch")]}),Object(R.jsx)("p",{className:"text-center",children:Object(R.jsx)(Ir.a,{bsStyle:"info",onClick:function(){return r("push")},children:a("continue_github_merge")})})]})})}function jf(e){var t=e.user,n=e.refreshState,r=e.isProjectMember,a=e.projectName,l=e.projectId,d=Object(Mt.a)().t;return t.enabled?r?Object(R.jsx)(of,{refreshState:n,projectName:a,projectId:l}):Object(R.jsx)("p",{children:d("github_for_link_shared_projects")}):t.available?r?Object(R.jsx)(Qp,{refreshState:n}):Object(R.jsx)("p",{children:d("github_for_link_shared_projects")}):Object(R.jsx)(Xp,{})}function Of(e){var t=e.error,n=e.projectId,r=e.refreshState,a=Object(Mt.a)().t;switch(t.response.status){case 401:return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Xo.a,{bsStyle:"danger",children:a("github_credentials_expired")}),Object(R.jsx)(Ir.a,{bsStyle:"primary",href:"/github-sync/beginAuth",children:a("reauthorize_github_account")})]});case 404:return Object(R.jsx)(mf,{projectId:n,refreshState:r});default:return Object(R.jsx)(Xo.a,{bsStyle:"danger",children:a("github_sync_error")})}}wf.propTypes={cancel:k.a.func.isRequired,handleIgnoringExternalUpdates:k.a.func.isRequired,isProjectMember:k.a.bool},xf.propTypes={project:k.a.object.isRequired,commits:k.a.object.isRequired,setMergeAction:k.a.func.isRequired},jf.propTypes={user:k.a.object.isRequired,refreshState:k.a.func.isRequired,isProjectMember:k.a.bool,projectName:k.a.string,projectId:k.a.string.isRequired},Of.propTypes={error:k.a.object.isRequired,projectId:k.a.string.isRequired,refreshState:k.a.func.isRequired};var Cf=Object(E.a)(wf,hf),Sf=S.a.memo((function(e){var t=e.handleHide,n=e.handleIgnoringExternalUpdates,r=e.show,a=e.isProjectMember,l=Object(Mt.a)().t;return Object(R.jsxs)(wi.a,{show:r,onHide:t,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:l("github_sync")})}),Object(R.jsx)(yi.a.Body,{children:Object(R.jsx)(Cf,{cancel:t,handleIgnoringExternalUpdates:n,isProjectMember:a})}),Object(R.jsx)(yi.a.Footer,{children:Object(R.jsx)(Ir.a,{type:"button",onClick:t,children:l("close")})})]})}));Sf.propTypes={handleHide:k.a.func.isRequired,handleIgnoringExternalUpdates:k.a.func.isRequired,isProjectMember:k.a.bool,show:k.a.bool.isRequired};var _f=Sf;y.a.component("githubSyncModal",Object(x.react2angular)(Ys.use(_f),["show","handleHide","isProjectMember","handleIgnoringExternalUpdates"]));y.a.controller("LeftMenuGithubSyncModalController",["$scope","ide",function(e,t){e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.handleIgnoringExternalUpdates=function(e){e?t.editorManager.startIgnoringExternalUpdates():t.editorManager.stopIgnoringExternalUpdates()},e.openGithubSyncModal=function(){e.$applyAsync((function(){t.$scope.project&&(e.isProjectMember=t.$scope.permissions.write,e.show=!0)}))}}]);var kf=ace.require("ace/range").Range;y.a.controller("ReferencesSearchController",["$scope","$modal","ide","$timeout","eventTracking","$rootScope",function(e,t,n,r,a,l){if(e.searchFeatureEnabled=function(){return!0},e.searchFeatureEnabled()){e.searchEnabled=!1,e.isCursorAtCitation=function(e){var t=e.getCursorPosition(),n=new kf(t.row,0,t.row,t.column),r=function(e){var t;return(t=e.match(/(\\[^\\]+)$/))?t[1]:null}(e.getSession().getTextRange(n));if(r&&r.match(/^~?\\([a-z]*cite[a-z]*(?:\[.*])?){([^}]*, *)?(\w*)/))return!0;return!1},e._hintNode=null,e._buildHintNode=function(){a.sendMBOnce("bib-search-hint-shown-once");var e=$(".sl_references_search_hint")[0];if(e)return e.style.display="block",e.style.visibility="visible",e;console.log("Error: could not find .sl_references_search_hint node in dom")},e.updateHintNode=function(t){if(!0===Ef(Ef(null!=t?t.completer:void 0,(function(e){return e.popup})),(function(e){return e.isOpen}))&&!e._hintNode&&e.isCursorAtCitation(t)){var n=e._buildHintNode(),a=Ef(Ef(Ef(null!=t?t.completer:void 0,(function(e){return e.popup})),(function(e){return e.renderer})),(function(e){return e.container}));if(!a)return void console.log("Error attaching search hint: could not find popup container");a.style.overflow="visible",$(a).append(n),e._hintNode=n;var l=t.completer.popup;if(!l.hide._sl_patched){var d=l.hide.bind(l);l.hide=function(){return r((function(){if(!e.isCursorAtCitation(t))return e._hideHint()}),0),d()},l.hide._sl_patched=!0}}if(e._hintNode)return e.isCursorAtCitation(t)?e._showHint():e._hideHint()},e._showHint=function(){if(e._hintNode)return e._hintNode.style.visibility="visible"},e._hideHint=function(){if(e._hintNode)return e._hintNode.style.visibility="hidden"},e.setup=function(){if(!1!==e.settings.autoComplete)if(null!=d){var t=Ef(Ef(null!=d?d.commands:void 0,(function(e){return e.commands})),(function(e){return e.startAutocomplete}));if(t){if(!t._sl_patched){var l=t.exec;t.exec=function(t,n,a,d,h){return r((function(){return e.updateHintNode(t)}),0),l(t)},t._sl_patched=!0}d.commands.addCommand({name:"triggerReferencesSearchPopup",exec:function(l){r((function(){return e.updateHintNode(l)}),0);var d=e.isCursorAtCitation(l);return!0===Ef(Ef(null!=l?l.completer:void 0,(function(e){return e.popup})),(function(e){return e.isOpen}))&&!0===d?(a.sendMB("bib-search-modal-opened"),e.searchEnabled=!0===Ef(Ef(Ef(null!=n?n.$scope:void 0,(function(e){return e.project})),(function(e){return e.features})),(function(e){return e.referencesSearch})),e.openReferencesSearchModal()):t.exec(l)},bindKey:t.bindKey})}else console.log("could not find startAutocomplete command")}else console.log("no editor found")};var d=null;return l.$on("editor:inited",(function(t,n){return d=n,setTimeout(e.setup)})),e.insertKeyAtCursor=function(e){if(null!=d){var t=d.getCursorPosition(),n=d.getSession(),r=d.getSession().getTextRange(new kf(t.row,0,t.row,t.column)),a=!d.getSession().getTextRange(new kf(t.row,t.column,t.row,99999)).match(/^[^{]*}/),l=Math.max(r.lastIndexOf("{"),r.lastIndexOf(","),r.lastIndexOf(" "));return l<t.column-1?(n.remove(new kf(t.row,l+1,t.row,t.column)),t=d.getCursorPosition(),n.insert(t,e)):n.insert(t,e),a?n.insert(d.getCursorPosition(),"}"):void 0}console.log("no editor found")},e.openReferencesSearchModal=function(){var n=t.open({templateUrl:"referencesSearchModalTemplate",controller:"ReferencesSearchModalController",scope:e,size:"lg",animation:!1,backdrop:!0,backdropClass:"references-search-modal-backdrop",keyboard:!0});return e.searchEnabled||a.sendMB("paywall-prompt",{"paywall-type":"references-search"}),n.result.then((function(t){return e.insertKeyAtCursor(t)}))},n.referencesSearchManager={openReferencesModal:function(t){return e.openReferencesSearchModal(t)}}}}]);function Ef(e,t){return null!=e?t(e):void 0}y.a.controller("ReferencesSearchModalController",["$scope","$modalInstance","$window","$timeout","ide","eventTracking",function(e,t,n,r,a,l){if(e.searchFeatureEnabled())return e.state={queryText:"",searchResults:null,selectedIndex:null,currentlySearching:!1,error:!1},e.handleInputKeyDown=function(t){return 40===t.keyCode?(t.preventDefault(),void e.moveSelectionForward()):38===t.keyCode?(t.preventDefault(),void e.moveSelectionBackward()):9===t.keyCode?(t.preventDefault(),void(t.shiftKey?e.moveSelectionBackward():e.moveSelectionForward())):13===t.keyCode?(t.preventDefault(),void e.acceptSelectedSearchResult()):[37,39].includes(t.keyCode)?void(e.state.selectedIndex=null):[8].includes(t.keyCode)?(e.state.selectedIndex=null,void r(e.doAutoSearch,0)):void(16===t.keyCode||t.altKey||t.ctrlKey||t.metaKey||r(e.doAutoSearch,0))},e.doAutoSearch=function(){var t=e.state;if(t.queryText&&t.queryText.length>=3)return e.doSearch()},e.moveSelectionForward=function(){if(null===e.state.selectedIndex){if(e.state.searchResults&&e.state.searchResults.length>0)return e.state.selectedIndex=0}else if(e.state.searchResults&&e.state.searchResults.length>0){e.state.selectedIndex++;var t=e.state.searchResults.length-1;if(e.state.selectedIndex>t)return e.state.selectedIndex=t}},e.moveSelectionBackward=function(){if(null===e.state.selectedIndex);else if(e.state.searchResults&&e.state.searchResults.length>0&&(e.state.selectedIndex--,e.state.selectedIndex<0))return e.state.selectedIndex=null},e.doSearch=function(){if(""!==e.state.queryText){e.state.queryText,window.csrfToken;return e.state.currentlySearching=!0,a.$http.post("/project/".concat(e.project_id,"/references/search"),{query:e.state.queryText,_csrf:window.csrfToken}).then((function(t){return e.state.searchResults=t.data.hits,e.state.selectedIndex=null,e.state.currentlySearching=!1,e.state.error=!1}),(function(t){return console.error(">> error searching references",t),e.state.selectedIndex=null,e.state.currentlySearching=!1,e.state.error=!0})),r((function(){return e.state.currentlySearching=!1}),3e4)}},e.selectIndex=function(t){if(e.state.searchResults)return e.state.selectedIndex=t},e.acceptSelectedSearchResult=function(){if(e.state.searchResults&&null!==e.state.selectedIndex){l.sendMB("bib-search-result-inserted");var n=e.state.searchResults[e.state.selectedIndex];return t.close(n._source.EntryKey)}},e.cancel=function(){return t.dismiss("cancel")}}]);function Af(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fileTreeManager=t}var t,n,r;return t=e,(n=[{key:"fileExistsForPath",value:function(e){return!!this.fileTreeManager.findEntityByPath(e)}},{key:"getEntityForPath",value:function(e){for(var t,n=0,r=["",".png",".pdf",".jpg",".jpeg",".eps"];n<r.length;n++){var a=r[n];if(t=this.fileTreeManager.findEntityByPath("".concat(e).concat(a)))break}return t}},{key:"getPreviewUrlForEntity",value:function(e){return"/project/".concat(window.project_id,"/file/").concat(e.id)}},{key:"isPreviewableEntity",value:function(e){return!["eps","pdf"].includes(function(e){if(e&&e.name){var t=e.name.split(".").pop();return t?t.toLowerCase():null}return null}(e))}}])&&Af(t.prototype,n),r&&Af(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Tf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.replaceWord=this.replaceWord.bind(this),this.editor=t,this.highlightedWordManager=this.editor.highlightedWordManager}var t,n,r;return t=e,(n=[{key:"getLines",value:function(){return this.editor.getCodeMirror().getValue().split("\n")}},{key:"getLineCount",value:function(){return this.editor.getCodeMirror().doc.lineCount()}},{key:"getFirstVisibleRowNum",value:function(){return this.editor.getCodeMirror().getViewport().from}},{key:"getLastVisibleRowNum",value:function(){return this.editor.getCodeMirror().getViewport().to}},{key:"getLinesByRows",value:function(e){var t=this;return e.map((function(e){return t.editor.getCodeMirror().getLine(e)}))}},{key:"getSelectionContents",value:function(){return this.editor.getCodeMirror().getSelection()}},{key:"normalizeChangeEvent",value:function(e){return{start:{row:e.from.line},end:{row:e.to.line},action:null!=e.removed?"remove":"insert"}}},{key:"getCoordsFromContextMenuEvent",value:function(e){return e.stopPropagation(),{x:e.pageX,y:e.pageY}}},{key:"isContextMenuEventOnBottomHalf",value:function(e){var t=e.clientY,n=e.currentTarget.getBoundingClientRect();return(t-n.top)/n.height>.5}},{key:"preventContextMenuEventDefault",value:function(e){e.preventDefault()}},{key:"getHighlightFromCoords",value:function(e){var t=this.editor.getCodeMirror().coordsChar({left:e.x,top:e.y});return this.highlightedWordManager.findHighlightAtPosition(t)}},{key:"selectHighlightedWord",value:function(e){var t=e.marker.find();this.editor.getCodeMirror().setSelection(t.from,t.to)}},{key:"replaceWord",value:function(e,t){var n=this.editor.getCodeMirror();n.replaceSelection(t),n.focus()}}])&&Tf(t.prototype,n),r&&Tf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function If(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pf=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onChange=this.onChange.bind(this),this.$scope=t,this.metadata=n,this.bibtexReferences=r,this.debouncer={}}var t,n,r;return t=e,(n=[{key:"getCommandCompletions",value:function(e){return[].concat(vc,this.getCommandCompletionsFromMetadata()).map((function(t){return{text:t.caption,displayText:t.caption,hint:e}}))}},{key:"getCommandCompletionsFromMetadata",value:function(){return O.a.flattenDeep(this.metadata.getAllPackages())}},{key:"getBeginCommandArguments",value:function(){return Cc.all}},{key:"getBibtexArguments",value:function(){return this.bibtexReferences}},{key:"getReferenceArguments",value:function(){return this.metadata.getAllLabels()}},{key:"onChange",value:function(e){var t=e.getCursor().line,n=e.getLine(t);if(!(n.length>1e4))return/\\(usepackage|RequirePackage|label)(\[.*])?({.*})?/.test(n)?this.metadata.scheduleLoadDocMetaFromServer(this.$scope.docId):void 0}}])&&If(t.prototype,n),r&&If(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Df(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mf=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getCursor=this.getCursor.bind(this),this.editor=t}var t,n,r;return t=e,(n=[{key:"convertToAcePos",value:function(e){var t=e.line,n=e.ch;return{row:t?t+1:t,column:n?n+1:n}}},{key:"convertFromAcePos",value:function(e){var t=e.row,n=e.column;return{line:t?t-1:t,ch:n?n-1:0}}},{key:"getCursor",value:function(){return this.convertToAcePos(this.editor.getCodeMirror().getCursor())}},{key:"getEditorScrollPosition",value:function(){return this.editor.getCodeMirror().getViewport().from+10}},{key:"setCursor",value:function(e){return e=e.cursorPosition||{row:0,column:0},this.editor.getCodeMirror().setCursor(this.convertFromAcePos(e))}},{key:"setEditorScrollPosition",value:function(e){e=e.firstVisibleLine||0;var t=this.editor.getCodeMirror(),n=t.heightAtLine(e,"local");return t.scrollTo(null,n)}},{key:"clearSelection",value:function(){}},{key:"gotoLine",value:function(e,t){var n={cursorPosition:{row:e,column:t}};this.setCursor(n),this.centerOnCursor(e)}},{key:"centerOnCursor",value:function(){var e=this.editor.getCodeMirror(),t=e.getScrollInfo().clientHeight,n=e.cursorCoords(!0,"local"),r=(n.top+n.bottom-t)/2;e.scrollTo(null,r),e.focus()}},{key:"gotoOffset",value:function(){}}])&&Df(t.prototype,n),r&&Df(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Lf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ff=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.findTrackChangesMarker=this.findTrackChangesMarker.bind(this),this.getTrackChangesMarkers=this.getTrackChangesMarkers.bind(this),this.onInsertAdded=this.onInsertAdded.bind(this),this.shareJsOffsetToRowColumn=this.shareJsOffsetToRowColumn.bind(this),this.onDeleteAdded=this.onDeleteAdded.bind(this),this.onChangeMoved=this.onChangeMoved.bind(this),this.editor=t,this.cm=this.editor.getCodeMirror()}var t,n,r;return t=e,(n=[{key:"getTrackChangesMarkers",value:function(){return this.cm.doc.getAllMarks().filter((function(e){var t=e.className&&-1!==e.className.indexOf("track-changes-marker"),n="bookmark"===e.type&&e.replacedWith&&-1!==e.replacedWith.className.indexOf("track-changes-marker");return t||n}))}},{key:"findTrackChangesMarker",value:function(e){return this.getTrackChangesMarkers().find((function(t){return t.id===e}))}},{key:"clearAnnotations",value:function(){this.getTrackChangesMarkers().forEach((function(e){return e.clear()})),this.changeIdToMarkerIdMap={}}},{key:"tearDown",value:function(){this.changeIdToMarkerIdMap={}}},{key:"onInsertAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length),r=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-added-marker"});this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onDeleteAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=document.createElement("span");n.className="track-changes-marker track-changes-deleted-marker";var r=this.cm.setBookmark({line:t.row,ch:t.column},{widget:n,insertLeft:!0});this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onInsertRemoved",value:function(e){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}},{key:"onDeleteRemoved",value:function(e){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}},{key:"onChangeMoved",value:function(e){var t,n=this.shareJsOffsetToRowColumn(e.op.p);t=null!=e.op.i?this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length):n,this.updateMarker(e,n,t)}},{key:"onCommentAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length),r=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-comment-marker"});this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onCommentMoved",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length);this.updateMarker(e,t,n)}},{key:"onCommentRemoved",value:function(e){if(this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}}},{key:"updateMarker",value:function(e,t,n){var r=this.changeIdToMarkerIdMap[e.id];if(e.op.i||e.op.c){var a=this.findTrackChangesMarker(r);if(!a)return;a.clear();var l=e.op.i?"added":"comment",d=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-".concat(l,"-marker")});this.changeIdToMarkerIdMap[e.id]=d.id}}},{key:"shareJsOffsetToRowColumn",value:function(e){var t=this.cm.doc.getValue().split("\n");return fu.shareJsOffsetToRowColumn(e,t)}}])&&Lf(t.prototype,n),r&&Lf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.a.directive("cmEditor",["ide","metadata","localStorage","$cacheFactory","$http","$q",function(e,t,n,r,a,l){return{scope:{bundle:"=",formattingEvents:"=",initCodeMirror:"=",sharejsDoc:"=",readOnly:"=",spellCheck:"=",spellCheckLanguage:"=",trackChanges:"=",autoComplete:"=",autoCloseBrackets:"=",fontSize:"=",lineHeight:"=",docId:"=",onSave:"="},link:function(d,h,p){var f=h.find(".cm-editor-body"),y=null,w=null,x=null,j=null,C=new Pf(d,t,d.$root._references),S={triggerRecompile:d.onSave,triggerSyncToPdf:q};d.name="editor";function _(e,t){if(e!==t)return null!=t&&(d.$broadcast("beforeChangeDocument"),P(t)),null!=e&&I(e),null!=e&&null!=t?d.$broadcast("afterChangeDocument"):void 0}d.$watch("sharejsDoc",_),d.$watch("readOnly",(function(e){if(null!=e)return y.setReadOnly(e)}));var k=/[\0\uD800-\uDFFF]/g,E=function(e,t){if(t.update){var n=t.text.join("\n");if(k.lastIndex=0,k.test(n)){for(var r=[],a=0;a<t.text.length;a++){var l=t.text[a].replace(k,"�");r.push(l)}t.update(t.from,t.to,r)}}},A=O.a.once((function(){return d.$broadcast("editorInit")})),T=null,R=function(){var e=y.getCodeMirror(),t=e.getScrollInfo(),n=e.lineAtHeight(t.top,"local");if(n!==T){T=n;var r=e.lineAtHeight(t.top+t.clientHeight,"local");d.$emit("scroll:editor:update",Math.floor((n+r)/2))}},I=function(e){return d.$applyAsync((function(){return y.openDoc(e.getSnapshot()),e.attachToCM(y.getCodeMirror()),y.enable(),e.on("remoteop.richtext",(function(){return y.update()})),y.getCodeMirror().on("scroll",R),y.getCodeMirror().clearHistory(),y.getCodeMirror().on("beforeChange",E),A(),d.readOnly||function(){(w=new Jc(d,r,a,l,new Rf(y))).init();var e=y.getCodeMirror();e.on("change",D),$(e.getWrapperElement()).on("contextmenu",w.onContextMenu),e.on("scroll",w.onScroll)}(),L(),N()}))};function P(e){return M(),F(),B(),y.getCodeMirror().off("beforeChange",E),e.detachFromCM(),y.getCodeMirror().off("scroll",R),e.off("remoteop.richtext")}var D=function(e,t){return w.onChange(t)};function M(){var e=y.getCodeMirror();e.off("change",D),w&&($(e.getWrapperElement()).off("contextmenu",w.onContextMenu),e.off("scroll",w.onScroll))}var L=function(){var e=y.getCodeMirror();(x=new xu(d,null,h,new Ff(y))).rangesTracker=d.sharejsDoc.ranges,x.onChangeSession(),e.on("swapDoc",x.onChangeSession)},F=function(){var e=y.getCodeMirror();x.tearDown(),e.off("swapDoc",x.onChangeSession)};var q=function(){return j.onSyncToPdf()},N=function(){return y.getCodeMirror().on("change",C.onChange)},B=function(){return y.getCodeMirror().off("change",C.onChange)},U=function(e){return d[e]};if(d.$on("$destroy",(function(){return d.$broadcast("changeEditor"),M(),y.getCodeMirror().off("cursorActivity",j.onCursorChange),$(window).off("unload",j.onUnload),d.formattingEvents.off("section"),d.formattingEvents.off("subsection"),d.formattingEvents.off("bold"),d.formattingEvents.off("italic"),d.formattingEvents.off("inlineMath"),d.formattingEvents.off("displayMath"),d.formattingEvents.off("numberedList"),d.formattingEvents.off("bulletList"),B(),P(d.sharejsDoc),y.disable()})),y=new d.bundle.Editor(f[0],new $f(e.fileTreeManager),C,S,U),e.globalEditorWatchdogManager.attachToEditor("CM",y.getCodeMirror()),j=new pu(d,new Mf(y),n),y.getCodeMirror().on("cursorActivity",j.onCursorChange),$(window).on("unload",j.onUnload),_(d.sharejsDoc),d.formattingEvents.on("section",(function(){return y.wrapSection()})),d.formattingEvents.on("subsection",(function(){return y.wrapSubsection()})),d.formattingEvents.on("bold",(function(){return y.wrapBold()})),d.formattingEvents.on("italic",(function(){return y.wrapItalic()})),d.formattingEvents.on("inlineMath",(function(){return y.wrapInlineMath()})),d.formattingEvents.on("displayMath",(function(){return y.wrapDisplayMath()})),d.formattingEvents.on("numberedList",(function(){return y.wrapNumberedList()})),d.formattingEvents.on("bulletList",(function(){return y.wrapBulletList()})),e.$scope.$on("editor:replace-selection",(function(e,t){var n=y.getCodeMirror();n.focus(),n.replaceSelection(t),n.scrollIntoView(n.getCursor(),100)})),e.$scope.$on("symbol-palette-toggled",(function(e,t){t||y.getCodeMirror().focus()})),null!=p.resizeOn)for(var H=0,z=Array.from(p.resizeOn.split(","));H<z.length;H++){var V=z[H];d.$on(V,(function(){return qf(null!=y?y.getCodeMirror():void 0,(function(e){return e.refresh()}))}))}return d.$watch("fontSize",(function(e){return f.css({"font-size":"".concat(e,"px")}),qf(null!=y?y.getCodeMirror():void 0,(function(e){return e.refresh()}))})),d.$watch("lineHeight",(function(e){var t;if(e){switch(e){case"compact":t=1.33;break;case"normal":t=1.6;break;case"wide":t=2;break;default:t=1.6}return f.css({"line-height":t}),qf(null!=y?y.getCodeMirror():void 0,(function(e){return e.refresh()}))}}))},template:'<div class="cm-editor-wrapper rich-text">\n<div class="cm-editor-body"></div>\n<spell-menu\n  open="spellMenu.open"\n  top="spellMenu.top"\n  left="spellMenu.left"\n  layout-from-bottom="spellMenu.layoutFromBottom"\n  highlight="spellMenu.highlight"\n  replace-word="replaceWord(highlight, suggestion)"\n  learn-word="learnWord(highlight)"\n></spell-menu>\n</div>'}}]);function qf(e,t){return null!=e?t(e):void 0}y.a.directive("formattingButtons",(function(){return{scope:{buttons:"=",opening:"=",isFullscreenEditor:"="},link:function(e,t,n){e.showMore=!1,e.shownButtons=[],e.overflowedButtons=[];var r=e.$watch("opening",(function(t){if(!t)return a(),function(){if($(window).on("resize",d),null!=n.resizeOn)Array.from(n.resizeOn.split(",")).map((function(t){return e.$on(t,d)}))}(),r()}));function a(){var n=t.width(),r=Math.floor(n/33);return r<e.buttons.length?(e.showMore=!0,n-=70,r=Math.floor(n/33),l(r)):(e.showMore=!1,l(r))}var l=function(t){return e.$applyAsync((function(){return e.shownButtons=e.buttons.slice(0,t),e.overflowedButtons=e.buttons.slice(t)}))},d=O.a.debounce(a,300);return e.$watch("$destroy",(function(){return $(window).off("resize",d)})),e.$watch("isFullscreenEditor",(function(e,t){if(e!==t)return d()}))},templateUrl:"formattingButtonsTpl"}}));y.a.controller("EditorLoaderController",["$scope","localStorage",function(e,t){e.richText={bundle:null,formattingEvents:new Ml},e.$watch("editor.showRichText",(function(r){t("editor.mode.".concat(e.project_id),!0===r?"rich-text":"source"),r&&!e.richText.bundle&&Promise.all([n.e(83),n.e(75)]).then(n.bind(null,1140)).then((function(t){return e.$applyAsync((function(){return e.richText.bundle=t}))}))})),e.$watch("editor.newSourceEditor",(function(n){t("editor.source_editor.".concat(e.project_id),!0===n?"cm6":"ace")}))}]);var Nf={button:function(e,t){var n={iconText:"Ω",iconClass:"formatting-icon formatting-icon--serif",title:"Toggle Symbol Palette",active:!1,handleClick:function(){t.$scope.editor.toggleSymbolPalette()}};return e.$watch("editor.showSymbolPalette",(function(e){n.active=e})),n},source:!0,richText:!0};function Bf(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Uf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uf(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Uf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hf=[{import:p,path:"/overleaf/services/web/modules/symbol-palette/frontend/js/ide/toolbar"}].map((function(e){return e.import.default})),zf=(y.a.controller("EditorToolbarController",["$scope","ide",function(e,t){var n,r=[{iconText:"§",iconClass:"formatting-icon",title:"Insert Section Heading",handleClick:function(){e.richText.formattingEvents.trigger("section")}},{iconText:"§",iconClass:"formatting-icon formatting-icon--small",title:"Insert Subsection Heading",handleClick:function(){e.richText.formattingEvents.trigger("subsection")}},{iconClass:"formatting-icon fa fa-bold",title:"Format Bold",handleClick:function(){e.richText.formattingEvents.trigger("bold")}},{iconClass:"formatting-icon fa fa-italic",title:"Format Italic",handleClick:function(){e.richText.formattingEvents.trigger("italic")}},{iconClass:"formatting-icon fa fa-list-ol",title:"Insert Numbered List",handleClick:function(){e.richText.formattingEvents.trigger("numberedList")}},{iconClass:"formatting-icon fa fa-list-ul",title:"Insert Bullet Point List",handleClick:function(){e.richText.formattingEvents.trigger("bulletList")}},{iconText:"π",iconClass:"formatting-icon formatting-icon--serif",title:"Insert Inline Math",handleClick:function(){e.richText.formattingEvents.trigger("inlineMath")}},{iconText:"Σ",iconClass:"formatting-icon formatting-icon--serif",title:"Insert Math on its own line",handleClick:function(){e.richText.formattingEvents.trigger("displayMath")}}],a=[],l=Bf(Hf);try{for(l.s();!(n=l.n()).done;){var d=n.value,h=d.button(e,t);d.source&&a.push(h),d.richText&&r.push(h)}}catch(e){l.e(e)}finally{l.f()}e.richTextButtons=r,e.editorButtons=a}]),Object(C.lazy)((function(){return Promise.all([n.e(81),n.e(43)]).then(n.bind(null,1139))})));function Vf(){return Object(R.jsx)(C.Suspense,{fallback:Object(R.jsx)("div",{className:"pdf-loading-spinner-container",children:Object(R.jsx)(_h.a,{})}),children:Object(R.jsx)(zf,{})})}var Wf=Object(C.memo)(Vf);y.a.component("sourceEditor",Object(x.react2angular)(Ys.use(Wf),[]));n(947);function Kf(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}var Gf=Kf()?C.useLayoutEffect:C.useEffect;function Yf(e,t){return Object(C.createContext)(t)}function Xf(){}function Jf(){return(Jf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Qf=["element","index"];function Zf(e,t){void 0===t&&(t={});return Yf(0,Jf({descendants:[],registerDescendant:Xf,unregisterDescendant:Xf},t))}function eg(e,t,n){var r,a,l,d=(r=Object(C.useState)(Object.create(null))[1],Object(C.useCallback)((function(){r(Object.create(null))}),[])),h=Object(C.useContext)(t),p=h.registerDescendant,f=h.unregisterDescendant,y=h.descendants,w=null!=n?n:y.findIndex((function(t){return t.element===e.element})),x=(a=y,l=Object(C.useRef)(null),Object(C.useEffect)((function(){l.current=a}),[a]),l.current),j=y.some((function(e,t){var n;return e.element!==(null==x||null==(n=x[t])?void 0:n.element)}));return Gf((function(){return e.element||d(),p(Jf({},e,{index:w})),function(){return f(e.element)}}),[d,w,p,j,f].concat(Object.values(e))),w}function tg(){return Object(C.useState)([])}function ng(e){var t=e.context,n=e.children,r=e.items,a=e.set,l=Object(C.useCallback)((function(e){var t=e.element,n=e.index,r=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Qf);t&&a((function(e){var a;if(null!=n)a=[].concat(e,[Jf({},r,{element:t,index:n})]);else if(0===e.length)a=[].concat(e,[Jf({},r,{element:t,index:0})]);else if(e.find((function(e){return e.element===t})))a=e;else{var l=e.findIndex((function(e){return!(!e.element||!t)&&Boolean(e.element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING)})),d=Jf({},r,{element:t,index:l});a=-1===l?[].concat(e,[d]):[].concat(e.slice(0,l),[d],e.slice(l))}return a.map((function(e,t){return Jf({},e,{index:t})}))}))}),[]),d=Object(C.useCallback)((function(e){e&&a((function(t){return t.filter((function(t){return e!==t.element}))}))}),[]);return Object(C.createElement)(t.Provider,{value:Object(C.useMemo)((function(){return{descendants:r,registerDescendant:l,unregisterDescendant:d}}),[r,l,d])},n)}function rg(e){var t=function(e){return Kf()?e?e.ownerDocument:document:null}(e);return t?t.defaultView||window:null}function ig(e,t){var n;return(null==(n=function(e){var t=rg(e);return t?t.getComputedStyle(e,null):null}(e))?void 0:n.getPropertyValue(t))||null}function og(e){return!(!e||"[object Function]"!={}.toString.call(e))}function ag(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return null!=e})).join("--")}function sg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lg(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sg(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function cg(e,t){if(null!=e)if(og(e))e(t);else try{e.current=t}catch(n){throw new Error('Cannot assign value "'+t+'" to ref "'+e+'"')}}function ug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(C.useCallback)((function(e){for(var n,r=lg(t);!(n=r()).done;){cg(n.value,e)}}),t)}function dg(e,t){return function(n){if(e&&e(n),!n.defaultPrevented)return t(n)}}var hg=!1,pg=0,fg=function(){return++pg};function gg(){return(gg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function mg(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}var vg,bg,yg=["as","children","defaultIndex","orientation","index","keyboardActivation","onChange","readOnly"],wg=["children","as","onKeyDown"],xg=["isSelected","children","as","index","disabled","onBlur","onFocus"],jg=["children","as"],Og=["children","aria-label","as"],Cg=Zf(),Sg=Zf(),_g=Yf(0,{});!function(e){e.Auto="auto",e.Manual="manual"}(vg||(vg={})),function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(bg||(bg={}));var kg=Object(C.forwardRef)((function(e,t){var n,r,a,l,d,h,p,f,y=e.as,w=void 0===y?"div":y,x=e.children,j=e.defaultIndex,O=e.orientation,S=void 0===O?bg.Horizontal:O,_=e.index,k=void 0===_?void 0:_,E=e.keyboardActivation,A=void 0===E?vg.Auto:E,T=e.onChange,R=e.readOnly,I=void 0!==R&&R,P=mg(e,yg),D=Object(C.useRef)(null!=k),M=function(e){var t=e||(hg?fg():null),n=Object(C.useState)(t),r=n[0],a=n[1];return Gf((function(){null===r&&a(fg())}),[]),Object(C.useEffect)((function(){!1===hg&&(hg=!0)}),[]),null!=r?String(r):void 0}(P.id),L=null!=(n=P.id)?n:ag("tabs",M),F=Object(C.useRef)(!1),q=Object(C.useRef)(null),N=Object(C.useRef)(!1),B=(r=k,a=null!=j?j:0,l=Object(C.useRef)(null!=r),d=Object(C.useState)(a),h=d[0],p=d[1],f=Object(C.useCallback)((function(e){l.current||p(e)}),[]),[l.current?r:h,f]),U=B[0],H=B[1],z=Object(C.useState)(-1),V=z[0],W=z[1],K=tg(),G=K[0],Y=K[1],X=Object(C.useMemo)((function(){return{focusedIndex:V,id:L,isControlled:D.current,isRTL:N,keyboardActivation:A,onFocusPanel:function(){q.current&&og(q.current.focus)&&q.current.focus()},onSelectTab:I?Xf:function(e){F.current=!0,T&&T(e),H(e)},onSelectTabWithKeyboard:I?Xf:function(e){switch(F.current=!0,A){case vg.Manual:var t=G[e]&&G[e].element;return void(t&&og(t.focus)&&t.focus());case vg.Auto:default:return T&&T(e),void H(e)}},orientation:S,selectedIndex:U,selectedPanelRef:q,setFocusedIndex:W,setSelectedIndex:H,userInteractedRef:F}}),[V,L,A,T,S,I,U,H,G]);return Object(C.createElement)(ng,{context:Cg,items:G,set:Y},Object(C.createElement)(_g.Provider,{value:X},Object(C.createElement)(w,gg({},P,{ref:t,"data-reach-tabs":"","data-orientation":S,id:P.id}),og(x)?x({focusedIndex:V,id:L,selectedIndex:U}):x)))}));var Eg=Object(C.forwardRef)((function(e,t){var n,r=e.children,a=e.as,l=void 0===a?"div":a,d=e.onKeyDown,h=mg(e,wg),p=Object(C.useContext)(_g),f=p.focusedIndex,y=p.isControlled,w=p.isRTL,x=p.keyboardActivation,j=p.onSelectTabWithKeyboard,O=p.orientation,S=p.selectedIndex,_=p.setSelectedIndex,k=(n=Cg,Object(C.useContext)(n).descendants),E=Object(C.useRef)(null),A=ug(t,E);Object(C.useEffect)((function(){E.current&&(E.current.ownerDocument&&"rtl"===E.current.ownerDocument.dir||"rtl"===ig(E.current,"direction"))&&(w.current=!0)}),[w]);var T=dg(d,function(e,t){var n=Object(C.useContext)(e).descendants,r=t.callback,a=t.currentIndex,l=t.filter,d=t.key,h=void 0===d?"index":d,p=t.orientation,f=void 0===p?"vertical":p,y=t.rotate,w=void 0===y||y,x=t.rtl,j=void 0!==x&&x;return function(e){if(["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(e.key)){var t=null!=a?a:-1,d=l?n.filter(l):n;if(l&&(t=d.findIndex((function(e){return e.index===a}))),d.length)switch(e.key){case"ArrowDown":if("vertical"===f||"both"===f){e.preventDefault();var p=E();r("option"===h?p:p[h])}break;case"ArrowUp":if("vertical"===f||"both"===f){e.preventDefault();var y=A();r("option"===h?y:y[h])}break;case"ArrowLeft":if("horizontal"===f||"both"===f){e.preventDefault();var x=(j?E:A)();r("option"===h?x:x[h])}break;case"ArrowRight":if("horizontal"===f||"both"===f){e.preventDefault();var O=(j?A:E)();r("option"===h?O:O[h])}break;case"PageUp":e.preventDefault();var C=(e.ctrlKey?A:T)();r("option"===h?C:C[h]);break;case"Home":e.preventDefault();var S=T();r("option"===h?S:S[h]);break;case"PageDown":e.preventDefault();var _=(e.ctrlKey?E:R)();r("option"===h?_:_[h]);break;case"End":e.preventDefault();var k=R();r("option"===h?k:k[h])}}function E(){return t===d.length-1?w?T():d[t]:d[(t+1)%d.length]}function A(){return 0===t?w?R():d[t]:d[(t-1+d.length)%d.length]}function T(){return d[0]}function R(){return d[d.length-1]}}}(Cg,{currentIndex:x===vg.Manual?f:S,orientation:O,rotate:!0,callback:j,filter:function(e){return!e.disabled},rtl:w.current}));return Gf((function(){var e,t;if(!y&&("true"===(t=null==(e=k[S])?void 0:e.disabled)||function(e){return"boolean"==typeof e}(t)&&t)){var n=k.find((function(e){return!e.disabled}));n&&_(n.index)}}),[k,y,S,_]),Object(C.createElement)(l,gg({role:"tablist","aria-orientation":O},h,{"data-reach-tab-list":"",ref:A,onKeyDown:T}),C.Children.map(r,(function(e,t){return function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return Object(C.isValidElement)(e)?C.cloneElement.apply(void 0,[e,t].concat(r)):e}(e,{isSelected:t===S})})))}));var Ag=Object(C.memo)(Eg);var $g=Object(C.forwardRef)((function(e,t){e.isSelected;var n,r,a,l=e.children,d=e.as,h=void 0===d?"button":d,p=e.index,f=e.disabled,y=e.onBlur,w=e.onFocus,x=mg(e,xg),j=Object(C.useContext)(_g),O=j.id,S=j.onSelectTab,_=j.orientation,k=j.selectedIndex,E=j.userInteractedRef,A=j.setFocusedIndex,T=Object(C.useRef)(null),R=ug(t,T),I=eg({element:T.current,disabled:!!f},Cg,p),P="button"===h&&null==x.type?"button":x.type,D=I===k;return n=function(){D&&T.current&&E.current&&(E.current=!1,og(T.current.focus)&&T.current.focus())},r=[D,E],a=Object(C.useRef)(!1),Object(C.useEffect)((function(){a.current?n():a.current=!0}),r),Object(C.createElement)(h,gg({"aria-controls":ag(O,"panel",I),"aria-disabled":f,"aria-selected":D,role:"tab",tabIndex:D?0:-1},x,{ref:R,"data-reach-tab":"","data-orientation":_,"data-selected":D?"":void 0,disabled:f,id:ag(O,"tab",I),onClick:function(){S(I)},onFocus:dg(w,(function(){A(I)})),onBlur:dg(y,(function(){A(-1)})),type:P}),l)}));var Tg=Object(C.forwardRef)((function(e,t){var n=e.children,r=e.as,a=void 0===r?"div":r,l=mg(e,jg),d=ug(Object(C.useRef)(),t),h=tg(),p=h[0],f=h[1];return Object(C.createElement)(ng,{context:Sg,items:p,set:f},Object(C.createElement)(a,gg({},l,{ref:d,"data-reach-tab-panels":""}),n))}));var Rg=Object(C.memo)(Tg);var Ig=Object(C.forwardRef)((function(e,t){var n=e.children;e["aria-label"];var r=e.as,a=void 0===r?"div":r,l=mg(e,Og),d=Object(C.useContext)(_g),h=d.selectedPanelRef,p=d.selectedIndex,f=d.id,y=Object(C.useRef)(null),w=eg({element:y.current},Sg),x=ag(f,"panel",w),j=w===p,O=Object(C.useRef)(!1),S=!!O.current&&!j;Object(C.useEffect)((function(){O.current=!0}),[]);var _=ug(t,y,j?h:null);return Object(C.createElement)(a,gg({"aria-labelledby":ag(f,"tab",w),hidden:S,role:"tabpanel",tabIndex:j?0:-1},l,{ref:_,"data-reach-tab-panel":"",id:x}),n)}));var Pg=n(618),Dg=n.n(Pg),Mg={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0};Fg.rankings=Mg;var Lg=function(e,t){return String(e.rankedValue).localeCompare(String(t.rankedValue))};function Fg(e,t,n){void 0===n&&(n={});var r=n,a=r.keys,l=r.threshold,d=void 0===l?Mg.MATCHES:l,h=r.baseSort,p=void 0===h?Lg:h,f=r.sorter;return(void 0===f?function(e){return e.sort((function(e,t){return function(e,t,n){var r=e.rank,a=e.keyIndex,l=t.rank,d=t.keyIndex;return r===l?a===d?n(e,t):a<d?-1:1:r>l?-1:1}(e,t,p)}))}:f)(e.reduce((function(e,r,l){var h=function(e,t,n,r){if(!t){return{rankedValue:e,rank:qg(e,n,r),keyIndex:-1,keyThreshold:r.threshold}}return function(e,t){for(var n=[],r=0,a=t.length;r<a;r++)for(var l=t[r],d=Hg(l),h=Bg(e,l),p=0,f=h.length;p<f;p++)n.push({itemValue:h[p],attributes:d});return n}(e,t).reduce((function(e,t,a){var l=e.rank,d=e.rankedValue,h=e.keyIndex,p=e.keyThreshold,f=t.itemValue,y=t.attributes,w=qg(f,n,r),x=d,j=y.minRanking,O=y.maxRanking,C=y.threshold;return w<j&&w>=Mg.MATCHES?w=j:w>O&&(w=O),w>l&&(l=w,h=a,p=C,x=f),{rankedValue:x,rank:l,keyIndex:h,keyThreshold:p}}),{rankedValue:e,rank:Mg.NO_MATCH,keyIndex:-1,keyThreshold:r.threshold})}(r,a,t,n),p=h.rank,f=h.keyThreshold;p>=(void 0===f?d:f)&&e.push(Object(zi.a)({},h,{item:r,index:l}));return e}),[])).map((function(e){return e.item}))}function qg(e,t,n){return e=Ng(e,n),(t=Ng(t,n)).length>e.length?Mg.NO_MATCH:e===t?Mg.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(t=t.toLowerCase())?Mg.EQUAL:e.startsWith(t)?Mg.STARTS_WITH:e.includes(" "+t)?Mg.WORD_STARTS_WITH:e.includes(t)?Mg.CONTAINS:1===t.length?Mg.NO_MATCH:(r=e,a="",r.split(" ").forEach((function(e){e.split("-").forEach((function(e){a+=e.substr(0,1)}))})),a).includes(t)?Mg.ACRONYM:function(e,t){var n=0,r=0;function a(e,t,r){for(var a=r,l=t.length;a<l;a++){if(t[a]===e)return n+=1,a+1}return-1}var l=a(t[0],e,0);if(l<0)return Mg.NO_MATCH;r=l;for(var d=1,h=t.length;d<h;d++){var p=t[d];if(!((r=a(p,e,r))>-1))return Mg.NO_MATCH}return function(e){var r=1/e,a=n/t.length;return Mg.MATCHES+a*r}(r-l)}(e,t);var r,a}function Ng(e,t){return e=""+e,t.keepDiacritics||(e=Dg()(e)),e}function Bg(e,t){var n;if("object"==typeof t&&(t=t.key),"function"==typeof t)n=t(e);else if(null==e)n=null;else if(Object.hasOwnProperty.call(e,t))n=e[t];else{if(t.includes("."))return function(e,t){for(var n=e.split("."),r=[t],a=0,l=n.length;a<l;a++){for(var d=n[a],h=[],p=0,f=r.length;p<f;p++){var y=r[p];if(null!=y)if(Object.hasOwnProperty.call(y,d)){var w=y[d];null!=w&&h.push(w)}else"*"===d&&(h=h.concat(y))}r=h}if(Array.isArray(r[0])){var x=[];return x.concat.apply(x,r)}return r}(t,e);n=null}return null==n?[]:Array.isArray(n)?n:[String(n)]}var Ug={maxRanking:1/0,minRanking:-1/0};function Hg(e){return"string"==typeof e?Ug:Object(zi.a)({},Ug,e)}var zg=n(364);n(635);function Vg(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Wg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Wg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jg(e){var t=e.setInput,n=e.inputRef,r=Yg(Object(C.useState)(""),2),a=r[0],l=r[1],d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(C.useState)(e),r=Kg(n,2),a=r[0],l=r[1];return Object(C.useEffect)((function(){var n=window.setTimeout((function(){l(e)}),t);return function(){window.clearTimeout(n)}}),[e,t]),a}(a,250);Object(C.useEffect)((function(){t(d)}),[d,t]);var h=Object(Mt.a)().t,p=Object(C.useCallback)((function(e){n.current=e}),[n]);return Object(R.jsx)(Zo.a,{className:"symbol-palette-search",type:"search",inputRef:p,id:"symbol-palette-input","aria-label":"Search",value:a,placeholder:h("search")+"…",onChange:function(e){l(e.target.value)}})}function Qg(e){var t=e.focused,n=e.handleSelect,r=e.handleKeyDown,a=e.symbol,l=Object(C.useRef)(null);return Object(C.useEffect)((function(){var e;t&&l.current&&null!==(e=document.activeElement)&&void 0!==e&&e.closest(".symbol-palette-items")&&l.current.focus()}),[t]),Object(R.jsx)(hi.a,{placement:"top",trigger:["hover","focus"],overlay:Object(R.jsxs)(di.a,{id:"tooltip-symbol-".concat(a.codepoint),children:[Object(R.jsx)("div",{className:"symbol-palette-item-description",children:a.description}),Object(R.jsx)("div",{className:"symbol-palette-item-command",children:a.command}),a.notes&&Object(R.jsx)("div",{className:"symbol-palette-item-notes",children:a.notes})]}),children:Object(R.jsx)("button",{className:"symbol-palette-item",onClick:function(){return n(a)},onKeyDown:r,tabIndex:t?0:-1,ref:l,role:"option","aria-label":a.description,"aria-selected":t?"true":"false",children:a.character},a.codepoint)})}function Zg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return em(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return em(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function em(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tm(e){var t=e.items,n=e.focusInput,r=Object(te.b)().insertSymbol,a=Zg(Object(C.useState)(0),2),l=a[0],d=a[1];Object(C.useEffect)((function(){d(0)}),[t]);var h=Object(C.useCallback)((function(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey))switch(e.key){case"ArrowLeft":case"ArrowUp":d((function(e){return e>0?e-1:t.length-1}));break;case"ArrowRight":case"ArrowDown":d((function(e){return e<t.length-1?e+1:0}));break;case"Home":d(0);break;case"End":d(t.length-1);break;case"Enter":case" ":break;default:n()}}),[n,t.length]);return Object(R.jsx)("div",{className:"symbol-palette-items",role:"listbox","aria-label":"Symbols",children:t.map((function(e,t){return Object(R.jsx)(Qg,{symbol:e,handleSelect:function(e){r(e),d(t)},handleKeyDown:h,focused:t===l},e.codepoint)}))})}function nm(e){var t=e.categories,n=e.categorisedSymbols,r=e.filteredSymbols,a=e.focusInput,l=Object(Mt.a)().t;return r?Object(R.jsxs)(R.Fragment,{children:[r.length?Object(R.jsx)(tm,{items:r,focusInput:a}):Object(R.jsx)("div",{className:"symbol-palette-empty",children:l("no_symbols_found")}),Object(R.jsx)(Rg,{children:t.map((function(e){return Object(R.jsx)(Ig,{tabIndex:-1},e.id)}))})]}):Object(R.jsx)(Rg,{children:t.map((function(e){return Object(R.jsx)(Ig,{tabIndex:-1,children:Object(R.jsx)(tm,{items:n[e.id],focusInput:a})},e.id)}))})}function rm(e){var t=e.categories,n=e.disabled;return Object(R.jsx)(Ag,{"aria-label":"Symbol Categories",className:"symbol-palette-tab-list",children:t.map((function(e){return Object(R.jsx)($g,{disabled:n,className:"symbol-palette-tab",children:e.label},e.id)}))})}function im(){var e=Object(R.jsxs)("span",{children:["The ",Object(R.jsx)("b",{children:"Symbol Palette"})," is a new feature. Click here to give feedback"]});return Object(R.jsx)(hi.a,{placement:"top",trigger:["hover","focus"],overlay:Object(R.jsx)(di.a,{id:"tooltip-symbol-palette-info",children:e}),children:Object(R.jsx)(Ir.a,{bsStyle:"link",bsSize:"small",className:"symbol-palette-info-link",href:"https://docs.google.com/forms/d/e/1FAIpQLScaCYdiSc0QOmaP-o--8Jmbtnq3LCu4OM0W9SteF4D4926xUA/viewform",target:"_blank",rel:"noopener noreferrer",children:Object(R.jsx)("span",{className:"info-badge"})})})}Jg.propTypes={setInput:k.a.func.isRequired,inputRef:k.a.object.isRequired},Qg.propTypes={symbol:k.a.shape({codepoint:k.a.string.isRequired,description:k.a.string.isRequired,command:k.a.string.isRequired,character:k.a.string.isRequired,notes:k.a.string}),handleKeyDown:k.a.func.isRequired,handleSelect:k.a.func.isRequired,focused:k.a.bool},tm.propTypes={items:k.a.arrayOf(k.a.shape({codepoint:k.a.string.isRequired})).isRequired,focusInput:k.a.func.isRequired},nm.propTypes={categories:k.a.arrayOf(k.a.object).isRequired,categorisedSymbols:k.a.object,filteredSymbols:k.a.arrayOf(k.a.object),focusInput:k.a.func.isRequired},rm.propTypes={categories:k.a.arrayOf(k.a.shape({id:k.a.string.isRequired,label:k.a.string.isRequired})).isRequired,disabled:k.a.bool};n(948);function om(){var e=Object(te.b)().toggleSymbolPalette;return Object(R.jsxs)(Ir.a,{onClick:e,className:"symbol-palette-close-button",children:[Object(R.jsx)("span",{"aria-hidden":"true",children:"×"}),Object(R.jsx)("span",{className:"sr-only",children:"Close"})]})}var am=n(354);function sm(){var e=Object(Mt.a)().t;return Object(R.jsxs)("div",{className:"symbol-palette-overlay small",children:[Object(R.jsx)(om,{}),Object(R.jsx)("h4",{children:e("find_the_symbols_you_need_with_premium")}),Object(R.jsxs)("p",{children:[e("with_premium_subscription_you_also_get"),":"]}),Object(R.jsx)(am.a,{}),Object(R.jsx)("div",{children:Object(R.jsx)(ma.a,{source:"symbol-palette",buttonStyle:"success",children:e("try_premium_for_free")})})]})}var lm=Object(C.memo)(sm);function cm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return um(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return um(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function um(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dm(){var e=cm(Object(C.useState)(""),2),t=e[0],n=e[1],r=Object(Mt.a)().t,a=Boolean(window.showSymbolPalette),l=Object(C.useMemo)((function(){return function(e){return[{id:"Greek",label:e("category_greek")},{id:"Arrows",label:e("category_arrows")},{id:"Operators",label:e("category_operators")},{id:"Relations",label:e("category_relations")},{id:"Misc",label:e("category_misc")}]}(r)}),[r]),d=Object(C.useMemo)((function(){return function(e){var t,n={},r=Vg(e);try{for(r.s();!(t=r.n()).done;){n[t.value.id]=[]}}catch(e){r.e(e)}finally{r.f()}var a,l=Vg(zg);try{for(l.s();!(a=l.n()).done;){var d=a.value;d.category in n&&(d.character=String.fromCodePoint(parseInt(d.codepoint.replace(/^U\+0*/,""),16)),n[d.category].push(d))}}catch(e){l.e(e)}finally{l.f()}return n}(l)}),[l]),h=Object(C.useMemo)((function(){return""===t?null:t.trim().split(/\s+/).reduceRight((function(e,t){return Fg(e,t,{keys:["command","description","character","aliases"],threshold:Fg.rankings.CONTAINS})}),zg)}),[t]),p=Object(C.useRef)(null),f=Object(C.useCallback)((function(){p.current&&a&&p.current.focus()}),[a]);return Object(C.useEffect)((function(){f()}),[f]),Object(R.jsxs)(kg,{className:"symbol-palette-container",children:[!a&&Object(R.jsx)(lm,{}),Object(R.jsxs)("div",{className:"symbol-palette",children:[Object(R.jsxs)("div",{className:"symbol-palette-header-outer",children:[Object(R.jsxs)("div",{className:"symbol-palette-header",children:[Object(R.jsx)(rm,{categories:l,disabled:t.length>0}),Object(R.jsxs)("div",{className:"symbol-palette-header-group",children:[Object(R.jsx)(im,{}),Object(R.jsx)(Jg,{setInput:n,inputRef:p})]})]}),Object(R.jsx)("div",{className:"symbol-palette-header-group",children:Object(R.jsx)("div",{children:Object(R.jsx)(om,{})})})]}),Object(R.jsx)("div",{className:"symbol-palette-body",children:Object(R.jsx)(nm,{categories:l,categorisedSymbols:d,filteredSymbols:h,focusInput:f})})]})]})}y.a.component("symbolPalette",Object(x.react2angular)(Ys.use((function(){return Object(te.b)().showSymbolPalette?Object(R.jsx)(dm,{}):null})))),y.a.controller("TemplatesController",["$scope","$modal","$http","ide",function(e,t,n,r){e.templateDetails={exists:!1},e.refreshPublishedStatus=function(){return n.get("/project/".concat(r.project_id,"/template")).then((function(t){var n=t.data;e.templateDetails=n,e.templateDetails.publishedDate=od()(n.publishedDate).format("Do MMM YYYY, h:mm a"),e.templateDetails.description=n.description})).catch((function(){e.problemTalkingToTemplateApi=!0}))},e.openPublishTemplateModal=function(){var n=function(){return e.problemTalkingToTemplateApi=!1};return n(),e.refreshPublishedStatus().then((function(){return t.open({templateUrl:"publishProjectAsTemplateModalTemplate",controller:"PublishProjectAsTemplateModalController",scope:e}).result.then(n,n)}))}}]);y.a.controller("PublishProjectAsTemplateModalController",["$scope","$modalInstance","ide","$http",function(e,t,n,r){e.state={publishInflight:!1,unpublishInflight:!1};var a=function(){return e.problemTalkingToTemplateApi=!0};e.$watch(e.problemTalkingToTemplateApi,(function(t){if(null!=t)return e.refreshPublishedStatus()}));var l=function(){return r.post("/project/".concat(n.project_id,"/template/description"),{description:e.templateDetails.description,_csrf:window.csrfToken})};return t.result.finally((function(){return l()})),e.publishTemplate=function(){return e.state.publishInflight=!0,l().then((function(){return r.post("/project/".concat(n.project_id,"/template/publish"),{_csrf:window.csrfToken}).then((function(){return e.refreshPublishedStatus(),e.state.publishInflight=!1})).catch((function(){return a()}))})).catch((function(){return a()}))},e.unpublishTemplate=function(){return e.state.unpublishInflight=!0,r.post("/project/".concat(n.project_id,"/template/unpublish"),{_csrf:window.csrfToken}).then((function(){return e.refreshPublishedStatus(),e.state.unpublishInflight=!1})).catch((function(){return a()}))},e.cancel=function(){return t.dismiss()}}]);function hm(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pm(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function pm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fm(e,t){var n;return O.a.forEach(e,(function(e){n||(n=O.a.find(e.entries,(function(e){return e.id===t})))})),n}function gm(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(B.d)(e,{body:t})}("/project/".concat(t,"/export/").concat(e.id),n).then((function(e){return function(e,t){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;return new Promise((function(a,l){!function d(){Object(B.c)(e).then((function(e){n(e)?l(e):t(e)?a(e):setTimeout((function(){r<1e4&&(r+=1e3),d()}),r)})).catch(l)}()}))}("/project/".concat(t,"/export/").concat(e),(function(e){return"succeeded"===e.export_json.status_summary}),(function(e){return"failed"===e.export_json.status_summary}))}(e.export_v1_id,t).then((function(t){var n=[t.export_json.v2_user_first_name,t.export_json.v2_user_last_name].filter(Boolean).join(" ");return{exportId:e.export_v1_id,message:e.message,token:t.export_json.token,submissionId:t.export_json.partner_submission_id,authorEmail:t.export_json.v2_user_email,authorName:n,title:t.export_json.title}})).catch((function(e){throw e.export_json?new Error(e.export_json.status_detail):e}))}))}y.a.component("sharedContextReact",Object(x.react2angular)(Ys.component,[],["ide","settings"]));function mm(e){var t=e;if(window._ide.editorManager.getCurrentDocId()===t)return!1;var n=window._ide.editorManager.getCurrentDocValue();if(null==n)return!1;var r,a=hm(n.split("\n"));try{for(a.s();!(r=a.n()).done;){var l=r.value;if(/^[^%]*\\documentclass/.test(l))return!0}}catch(e){a.e(e)}finally{a.f()}return!1}function vm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vm(Object(n),!0).forEach((function(t){ym(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ym(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jm=Object(C.createContext)();function Om(e){var t,n,r,a=e.children,l=Object(Io.b)({first_name:k.a.string,last_name:k.a.string}),d=l.first_name,h=l.last_name,p=Object(A.c)({_id:k.a.string.isRequired,name:k.a.string.isRequired,rootDocId:k.a.string.isRequired}),f=p._id,y=p.name,w=p.rootDocId,x=Object(T.b)({hasFolders:k.a.bool}).hasFolders,j=Object(te.b)({cobranding:k.a.shape({brandVariationId:k.a.number.isRequired,brandId:k.a.number.isRequired,publishGuideHtml:k.a.string,partner:k.a.string,brandedMenu:k.a.bool})}).cobranding,O=wm(Object(oe.a)("pdf.downloadUrl"),1)[0],S=wm(Object(oe.a)("pdf.url"),1)[0],_=wm(Object(oe.a)("pdf.logEntries"),1)[0],E=Object(ks.b)({uncompiled:k.a.bool}).uncompiled;j&&(j.publishGuideHtml||j.partner)?j.brandedMenu?(n="/journals/".concat(j.brandId),t="branded"):j.partner?(n="/journals/".concat(j.brandId),t="export",r=j.brandVariationId):(n="/journals/".concat(j.brandId),t="guide",r=j.brandVariationId):(n="/journals",t="basic");var I=wm(Object(C.useState)(null),2),P=I[0],D=I[1],M=wm(Object(C.useState)(null),2),L=M[0],F=M[1],q=ef(),N={entries:P,initialShown:t,brandVariationId:r,fetchData:Object(C.useCallback)((function(){var e="/latest_template/".concat(f);return Promise.all([Object(B.c)(e),Object(B.c)(n)]).then((function(e){var t=wm(e,2),n=t[0],r=t[1];if(q.current){var a=n.title?{title:n.title}:{};a.description=n.description,a.author=n.author,a.license=n.license,F(n),D(r)}}))}),[q,n,f]),initParams:bm({projectId:f,pdfUrl:S?O:void 0,logs:_,uncompiled:E,hasFolders:x,rootDocOverridden:mm(w),firstName:d,lastName:h,title:y},L)};return Object(R.jsx)(jm.Provider,{value:N,children:a})}jm.Provider.propTypes={value:k.a.shape({entries:k.a.object,initialShown:k.a.oneOf(["basic","guide","branded","export"]).isRequired,brandVariationId:k.a.number,fetchData:k.a.func.isRequired,initParams:k.a.shape({title:k.a.string,description:k.a.string,author:k.a.string,license:k.a.string,projectId:k.a.string.isRequired,pdfUrl:k.a.string,logs:k.a.object,uncompiled:k.a.bool,hasFolders:k.a.bool,rootDocOverridden:k.a.bool,firstName:k.a.string,lastName:k.a.string}).isRequired}).isRequired},Om.propTypes={children:k.a.any};var Cm=n(593),Sm=n.n(Cm);function _m(e){return(_m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function km(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Am(e,t){return(Am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rm(e);if(t){var a=Rm(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Tm(this,n)}}function Tm(e,t){if(t&&("object"===_m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Rm(e){return(Rm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Am(e,t)}(l,e);var t,n,r,a=$m(l);function l(){return km(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.name,r=t.id,a=t.category,l=t.displayCategory,d=t.switchTo;return Object(R.jsxs)("div",{className:"col-sm-6 table-content",children:[l&&Object(R.jsx)("div",{className:"table-content-category",children:a.replace("_"," ")}),Object(R.jsx)("div",{className:"table-content-name",children:n}),Object(R.jsx)("div",{className:"table-content-icon",children:Object(R.jsx)("button",{"data-event":"publish_entry_select","data-category":"Publish","data-action":"choose","data-label":this.props.id,style:{border:0,padding:0,backgroundColor:"transparent"},onClick:function(){return e.props.onSwitch(d,r)},children:Object(R.jsx)("img",{src:this.props.publish_menu_icon,alt:n})})}),Object(R.jsx)("div",{className:"table-content-text",children:Object(R.jsx)("div",{className:"table-content-slogan",dangerouslySetInnerHTML:{__html:this.props.publish_menu_html}})}),Object(R.jsx)("div",{className:"table-content-link",children:Object(R.jsx)("button",{className:"".concat(this.props.linkClass," btn btn-primary btn-wrapping"),"data-event":"publish_entry_select","data-category":"Publish","data-action":"choose","data-label":this.props.id,onClick:function(){return e.props.onSwitch(d,r)},dangerouslySetInnerHTML:{__html:this.props.publish_menu_link_html}})})]})}}])&&Em(t.prototype,n),r&&Em(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Pm(e){return(Pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dm(Object(n),!0).forEach((function(t){Lm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nm(e,t){return(Nm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hm(e);if(t){var a=Hm(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Um(this,n)}}function Um(e,t){if(t&&("object"===Pm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hm(e){return(Hm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Im.propTypes={id:k.a.number,name:k.a.string,category:k.a.string,publish_menu_icon:k.a.string,publish_menu_html:k.a.string,publish_menu_link_html:k.a.string,linkClass:k.a.string,switchTo:k.a.string,onSwitch:k.a.func.isRequired,displayCategory:k.a.bool};var zm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nm(e,t)}(l,e);var t,n,r,a=Bm(l);function l(){return Fm(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this.props,t=e.right,n=e.left,r=e.onSwitch,a=e.displayCategory;return Object(R.jsxs)("div",{children:[this.props.left&&Object(R.jsx)(Im,Mm({},Vm(n,r,a))),this.props.right&&Object(R.jsx)(Im,Mm({},Vm(t,r,a)))]})}}])&&qm(t.prototype,n),r&&qm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Vm(e,t,n){var r;return r=e.partner?"exportGuide":"guide",O.a.assign({},e,{switchTo:r,linkClass:void 0,onSwitch:t,displayCategory:n})}function Wm(e){return(Wm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Km(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gm(e,t){return(Gm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ym(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Jm(e);if(t){var a=Jm(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Xm(this,n)}}function Xm(e,t){if(t&&("object"===Wm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Jm(e){return(Jm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}zm.propTypes={left:k.a.object,right:k.a.object,onSwitch:k.a.func.isRequired,displayCategory:k.a.bool};var Qm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gm(e,t)}(l,e);var t,n,r,a=Ym(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).props.entries.length>2?t.state={shownCount:4}:t.state={shownCount:2},t}return t=l,(n=[{key:"showMore",value:function(){this.setState({shownCount:this.state.shownCount+4})}},{key:"render",value:function(){for(var e=this,t=[],n=0;n<this.state.shownCount&&!(this.props.entries.length<n+1);n+=2)t.push(Object(R.jsx)(zm,{left:this.props.entries[n],right:this.props.entries[n+1],onSwitch:this.props.onSwitch,displayCategory:this.props.displayCategory}));return Object(R.jsxs)("div",{className:"overbox overbox-small",children:[t.map((function(e,t){return Object(R.jsxs)("div",{children:[t>0&&Object(R.jsx)("hr",{}),Object(R.jsx)("div",{className:"row",children:e})]},"outer-div"+t)})),this.state.shownCount<this.props.entries.length&&Object(R.jsxs)("span",{children:[Object(R.jsx)("br",{}),Object(R.jsx)("button",{className:"button-as-link",onClick:function(){return e.showMore()},children:"Show more"})]})]})}}])&&Km(t.prototype,n),r&&Km(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Zm(e){return(Zm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ev(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tv(e,t){return(tv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ov(e);if(t){var a=ov(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return rv(this,n)}}function rv(e,t){if(t&&("object"===Zm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return iv(e)}function iv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ov(e){return(ov=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qm.propTypes={entries:k.a.array,onSwitch:k.a.func.isRequired,displayCategory:k.a.bool};var av=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tv(e,t)}(l,e);var t,n,r,a=nv(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=a.call(this,e);var n=O.a.flattenDeep(O.a.map(e.entries,(function(e,t){return"featured"===t||"search"===t?[]:e.entries}))),r=O.a.map(e.entries,(function(e,t){if("featured"!==t&&"search"!==t)return e.title})).filter((function(e){return e}));return t.categoryListing=O.a.initial(r).join(", ")+" or "+O.a.last(r),t.state={results:[]},t.fuse=new Sm.a(n,{keys:["name","brand_name","publish_menu_html","publish_guide_html"],threshold:.4}),t.handleInput=t.handleInput.bind(iv(t)),t}return t=l,(n=[{key:"handleInput",value:function(e){var t,n=e.target.value.trim();t=""===n?[]:this.fuse.search(n),this.setState({results:t})}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"render",value:function(){return Object(R.jsxs)("div",{children:[Object(R.jsx)("div",{children:Object(R.jsx)("form",{className:"search",id:"search",onSubmit:this.handleSubmit,children:Object(R.jsxs)("div",{id:"search-input-container",children:[Object(R.jsx)("label",{className:"sr-only",htmlFor:"search",children:"Search"}),Object(R.jsx)("input",{type:"text",id:"search",name:"search-input",className:"form-control search-input",placeholder:this.categoryListing,onChange:this.handleInput})]})})}),Object(R.jsx)("div",{id:"search-results",children:Object(R.jsx)("div",{children:0===this.state.results.length?"":Object(R.jsx)(Qm,{entries:this.state.results,onSwitch:this.props.onSwitch,displayCategory:!0})})})]})}}])&&ev(t.prototype,n),r&&ev(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);av.propTypes={entries:k.a.object.isRequired,onSwitch:k.a.func.isRequired};var sv=function(e){var t=e.entries,n=e.onSwitch;return Object(R.jsx)("div",{children:O.a.map(t,(function(e,r){return Object(R.jsxs)("div",{children:[Object(R.jsx)("span",{className:"affix-target affix-content-title","data-affix-target":r,children:e.title}),Object(R.jsx)("div",{className:"affix-subcontent",children:lv(e,r,t,n)})]},"category-"+r)}))})};function lv(e,t,n,r){return"search"===t?Object(R.jsx)(av,{entries:n,onSwitch:r},"journal-search-"+t):Object(R.jsx)(Qm,{entries:e.entries,onSwitch:r},"publish-menu-"+t)}sv.propTypes={entries:k.a.object.isRequired,onSwitch:k.a.func.isRequired};var cv=sv;function uv(e){return(uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pv(e,t){return(pv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mv(e);if(t){var a=mv(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return gv(this,n)}}function gv(e,t){if(t&&("object"===uv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mv(e){return(mv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pv(e,t)}(l,e);var t,n,r,a=fv(l);function l(){return dv(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this.props.entries;return Object(R.jsx)("span",{children:Object(R.jsx)("div",{id:"publish-table",className:"modal-body-content row content-as-table",children:Object(R.jsx)("div",{className:"col-md-12",children:Object(R.jsx)(cv,{entries:e,onSwitch:this.props.onSwitch})})})})}}])&&hv(t.prototype,n),r&&hv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);vv.propTypes={entries:k.a.object.isRequired,onSwitch:k.a.func.isRequired};var bv=function(e){var t=e.returnText,n=e.onReturn;return n?Object(R.jsxs)("button",{className:"modal-return button-as-link",onClick:function(){return n(null,null)},style:{paddingBottom:"15px"},children:[Object(R.jsx)("i",{style:{paddingRight:"5px",color:"inherit",fontSize:"inherit"},className:"fa fa-fw fa-arrow-left"}),t]}):null};bv.propTypes={returnText:k.a.string,onReturn:k.a.func};var yv=bv;function wv(e){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jv(e,t){return(jv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ov(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_v(e);if(t){var a=_v(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Cv(this,n)}}function Cv(e,t){if(t&&("object"===wv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sv(e)}function Sv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _v(e){return(_v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jv(e,t)}(l,e);var t,n,r,a=Ov(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",errorDetails:null},t.initiateGuideExport=t.initiateGuideExport.bind(Sv(t)),t}return t=l,(n=[{key:"initiateGuideExport",value:function(e,t,n){var r=this;this.setState({exportState:"initiated"}),gm(e,t).then((function(e){var a=e.exportId;r.props.downloadFile("/project/".concat(t,"/export/").concat(a,"/").concat("zip"===n?"zip":"pdf")),r.setState({exportState:"uninitiated"})})).catch((function(e){r.setState({exportState:"error",errorDetails:e.message})}))}},{key:"render",value:function(){var e=this.props,t=e.entry,n=e.returnText,r=e.onReturn,a=e.projectId;return Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",id:"publish-guide-"+t.id,children:Object(R.jsxs)("div",{className:"col-sm-12",children:[r&&n&&Object(R.jsx)(yv,{onReturn:r,returnText:n}),Object(R.jsx)(Ev,{guideHtml:t.publish_guide_html,renderDownload:Object(R.jsx)(Av,{entry:t,projectId:a,exportState:this.state.exportState,initiateGuideExport:this.initiateGuideExport,errorDetails:this.state.errorDetails})}),t.publish_link_destination&&Object(R.jsxs)("div",{children:[Object(R.jsx)(Av,{entry:t,projectId:a,exportState:this.state.exportState,initiateGuideExport:this.initiateGuideExport,errorDetails:this.state.errorDetails}),Object(R.jsx)($v,{entry:t})]})]})},t.id)}}])&&xv(t.prototype,n),r&&xv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Ev(e){var t=e.guideHtml,n=e.renderDownload;if(-1!==t.indexOf("DOWNLOAD")){var r=t.split("DOWNLOAD");return Object(R.jsxs)("div",{children:[Object(R.jsx)("div",{dangerouslySetInnerHTML:{__html:r[0]}}),n,Object(R.jsx)("div",{style:{marginLeft:"140px",paddingLeft:"15px"},dangerouslySetInnerHTML:{__html:r[1]}})]})}return Object(R.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})}function Av(e){var t=e.entry,n=e.projectId,r=e.exportState,a=e.initiateGuideExport,l=e.errorDetails;return Object(R.jsxs)("div",{style:{marginLeft:"140px",paddingLeft:"15px"},children:[Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"Step 1: Download files"})}),"uninitiated"===r&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"btn btn-primary",onClick:function(){return a(t,n,"zip")},children:"Download project ZIP with submission files (e.g. .bbl)"})}),Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"btn btn-primary",onClick:function(){return a(t,n,"pdf")},children:"Download PDF file of your article"})})]}),"initiated"===r&&Object(R.jsxs)("p",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Compiling project, please wait..."})]}),"error"===r&&Object(R.jsxs)("p",{children:["Project failed to compile",Object(R.jsx)("br",{}),"Error message: ",l]})]})}function $v(e){var t=e.entry;return Object(R.jsxs)("div",{style:{marginLeft:"140px",paddingLeft:"15px"},children:[Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"Step 2: Submit your manuscript"})}),Object(R.jsx)("p",{children:Object(R.jsxs)("a",{href:t.publish_link_destination,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary","data-event":"link_submit","data-category":"Publish","data-action":"submit","data-label":t.id,children:["Submit to ",t.name]})})]})}function Tv(e){return(Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pv(e,t){return(Pv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lv(e);if(t){var a=Lv(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Mv(this,n)}}function Mv(e,t){if(t&&("object"===Tv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lv(e){return(Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}kv.defaultProps={downloadFile:function(e){window.location.pathname=e}},kv.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired,downloadFile:k.a.func.isRequired},Ev.propTypes={guideHtml:k.a.string.isRequired,renderDownload:k.a.node},Av.propTypes={entry:k.a.object.isRequired,projectId:k.a.string.isRequired,exportState:k.a.string.isRequired,initiateGuideExport:k.a.func.isRequired,errorDetails:k.a.string},$v.propTypes={entry:k.a.object.isRequired};var Fv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pv(e,t)}(l,e);var t,n,r,a=Dv(l);function l(){return Rv(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this.props.entries,t=O.a.omit(e,"brand_data");return Object(R.jsx)("span",{children:Object(R.jsx)("div",{id:"publish-table",className:"modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-md-12",children:[Object(R.jsx)(kv,{entry:e.brand_data,projectId:this.props.initParams.projectId}),Object(R.jsx)("br",{}),Object(R.jsx)(cv,{entries:t,onSwitch:this.props.onSwitch})]})})})}}])&&Iv(t.prototype,n),r&&Iv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function qv(e){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nv(Object(n),!0).forEach((function(t){Uv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Uv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vv(e,t){return(Vv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gv(e);if(t){var a=Gv(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Kv(this,n)}}function Kv(e,t){if(t&&("object"===qv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gv(e){return(Gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Fv.propTypes={entries:k.a.object.isRequired,onSwitch:k.a.func.isRequired,initParams:k.a.object.isRequired};var Yv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vv(e,t)}(l,e);var t,n,r,a=Wv(l);function l(){return Hv(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e=this.props,t=e.entry,n=e.onReturn,r=e.returnText,a=e.initParams,l=e.onSwitch,d=Object(R.jsx)("p",{dangerouslySetInnerHTML:{__html:t.publish_menu_html}}),h=Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{children:Object(R.jsx)("b",{children:"Overleaf Gallery"})}),Object(R.jsx)("p",{children:"Thank you for your interest in sharing your work as a template with the Overleaf community!"}),Object(R.jsxs)("p",{children:["Submitting a document as a template to the Overleaf Gallery means that a copy of your document will be made"," ",Object(R.jsx)("b",{children:"publicly available for everyone on Overleaf"})," to find and reuse for their own work."]}),Object(R.jsx)("p",{children:"Before you submit the document, make sure it doesn’t contain identifiable personal details. Please use only dummy data and text contents if you wish to provide a template for CVs, reports, theses, etc."})]});return Object(R.jsxs)("div",{className:"publish-guide modal-body-content row content-as-table",children:[Object(R.jsx)("div",{className:"col-sm-12",children:Object(R.jsx)(yv,{onReturn:n,returnText:r})}),Object(R.jsx)("div",{className:"col-sm-2",style:{verticalAlign:"top"},children:t.publish_menu_icon&&Object(R.jsx)("img",{src:t.publish_menu_icon,alt:t.name,style:{width:"106px",float:"right"}})}),Object(R.jsxs)("div",{className:"col-sm-10",style:{paddingLeft:"15px"},children:["gallery"===t.partner?h:d,Object(R.jsx)(Xv,Bv(Bv({},a),{},{entry:t,onSwitch:l}))]})]},t.id)}}])&&zv(t.prototype,n),r&&zv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Xv(e){var t=e.entry,n=e.onSwitch,r=(e.pdfUrl,e.logs);return Object(R.jsxs)("div",{children:["gallery"!==t.partner?Object(R.jsx)("p",{children:"To begin a direct export from Overleaf please click the button below"}):Object(R.jsx)(R.Fragment,{}),Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"btn btn-primary",style:{display:"inline-block"},onClick:function(){return n("export",t.id)},children:"gallery"===t.partner?"Begin submission":"Continue"})}),Object(R.jsx)("p",{children:"You will have a chance to confirm your submission on the next page before your files are sent."}),r.warnings.length>0&&Object(R.jsxs)("p",{children:[Object(R.jsx)("strong",{children:" Warning: "})," LaTeX warnings on this project may affect submissions. Please check the logs before continuing"]})]})}Yv.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired,onSwitch:k.a.func.isRequired,initParams:k.a.object.isRequired},Xv.propTypes={entry:k.a.object.isRequired,onSwitch:k.a.func.isRequired,logs:k.a.object,pdfUrl:k.a.string};var Jv=function(e){var t,n=e.entry,r=e.projectId,a=e.exportId;return t=n.publish_link_destination?Zv(n.publish_link_destination):"the journal's website",Object(R.jsxs)("span",{children:[Object(R.jsxs)("p",{children:["This project has already been submitted to this journal, and this journal does not allow resubmission from within Overleaf. Please download your project files below and log in at ",t," to resubmit from there."]}),Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"btn btn-primary",onClick:function(){return Qv(r,a,"zip")},children:"Download project ZIP with submission files (e.g. .bbl)"})}),Object(R.jsx)("p",{children:Object(R.jsx)("button",{className:"btn btn-primary",onClick:function(){return Qv(r,a,"pdf")},children:"Download PDF file of your article"})})]})};function Qv(e,t,n){window.location.pathname="/project/".concat(e,"/export/").concat(t,"/").concat("zip"===n?"zip":"pdf")}var Zv=function(e){return Object(R.jsx)("a",{href:e,children:"the journal's website"})};Jv.propTypes={entry:k.a.object.isRequired,projectId:k.a.string.isRequired,exportId:k.a.string.isRequired};var eb=Jv;function tb(e){return(tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rb(e,t){return(rb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ib(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sb(e);if(t){var a=sb(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ob(this,n)}}function ob(e,t){if(t&&("object"===tb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ab(e)}function ab(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sb(e){return(sb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rb(e,t)}(l,e);var t,n,r,a=ib(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",submissionValid:!0,errorDetails:null},t.handleSubmit=t.handleSubmit.bind(ab(t)),t}return t=l,(n=[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.props,r=n.entry,a=n.projectId;this.firstName.value&&this.lastName.value?(this.setState({submissionValid:!0,exportState:"initiated"}),gm(r,a,{firstName:this.firstName.value,lastName:this.lastName.value}).then((function(e){var n=e.exportId;"RESUBMISSION"===e.message?t.setState({exportState:"resubmission",exportId:n}):t.setState({exportState:"complete"})})).catch((function(e){t.setState({exportState:"error",errorDetails:e.message})}))):this.setState({submissionValid:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.entry,r=t.onReturn,a=t.returnText,l=t.firstName,d=t.lastName,h=t.projectId;return Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:a}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to: ",Object(R.jsx)("br",{}),Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),"uninitiated"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Thanks for using Overleaf to submit your article."}),Object(R.jsx)("p",{children:"When you submit using the button below, your manuscript and supporting files will be sent to the journal automatically, and you will receive a confirmation email from Overleaf. The journal's editorial team will then send you a follow-up email with instructions for how to complete your submission."}),Object(R.jsx)("p",{children:"To send your article, please confirm your first and last name:"}),Object(R.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(R.jsxs)("p",{children:[Object(R.jsx)("input",{type:"text",className:"form-control",defaultValue:l,style:{width:"30%",display:"inline-block"},maxLength:"255",placeholder:"First Name",ref:function(t){return e.firstName=t}}),Object(R.jsx)("input",{type:"text",className:"form-control",defaultValue:d,style:{width:"30%",display:"inline-block"},maxLength:"255",placeholder:"Last Name",ref:function(t){return e.lastName=t}})]}),Object(R.jsx)("br",{}),Object(R.jsxs)("button",{type:"submit",className:"btn btn-primary",children:["Submit to ",n.name]})]}),!this.state.submissionValid&&Object(R.jsx)("p",{style:{color:"red"},children:"Please add valid first and last names before continuing"})]}),"initiated"===this.state.exportState&&Object(R.jsx)("span",{children:Object(R.jsxs)("div",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Exporting files, please wait..."})]})}),"complete"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Successful!"}),Object(R.jsxs)("p",{children:["Thanks for submitting to ",n.name,". Your manuscript and supporting files have been sent directly to the journal's editorial team, and they will send a follow-up email with instructions for how to complete your submission."]}),Object(R.jsx)("p",{children:"Please check your email for confirmation of your submission."})]}),"error"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Failed"}),Object(R.jsxs)("p",{children:["Error message: ",this.state.errorDetails]})]}),"resubmission"===this.state.exportState&&Object(R.jsx)(eb,{entry:n,projectId:h,exportId:this.state.exportId})]})},n.id)}}])&&nb(t.prototype,n),r&&nb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function cb(e){return(cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ub(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function db(e,t){return(db=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gb(e);if(t){var a=gb(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return pb(this,n)}}function pb(e,t){if(t&&("object"===cb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fb(e)}function fb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gb(e){return(gb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}lb.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired,firstName:k.a.string,lastName:k.a.string};var mb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&db(e,t)}(l,e);var t,n,r,a=hb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",submissionValid:!0,exportId:null,errorDetails:null},t.handleSubmit=t.handleSubmit.bind(fb(t)),t}return t=l,(n=[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.props,r=n.entry,a=n.projectId;this.firstName.value&&this.lastName.value?(this.setState({submissionValid:!0,exportState:"initiated"}),gm(r,a,{firstName:this.firstName.value,lastName:this.lastName.value}).then((function(e){var n=e.exportId;"RESUBMISSION"===e.message?t.setState({exportState:"resubmission",exportId:n}):t.setState({exportState:"complete"})})).catch((function(e){t.setState({exportState:"error",errorDetails:e.message})}))):this.setState({submissionValid:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.entry,r=t.onReturn,a=t.returnText,l=t.hasFolders,d=t.projectId,h=t.firstName,p=t.lastName;return l?Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:a}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to: ",Object(R.jsx)("br",{}),Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:" Files must be at top folder level "})}),Object(R.jsxs)("p",{children:["This project has one or more files in subfolders, rather than at the top folder level. Although Overleaf allows you to create and nest folders within your project,",n.name," requires all files to be at the top level of your project."]}),Object(R.jsx)("p",{children:"Please move each of the above files to the top level of the project, check that your project renders properly, and then retry the submission. We apologize for the inconvenience."})]})},n.id):Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:a}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to: ",Object(R.jsx)("br",{}),Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),"uninitiated"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Thanks for using Overleaf to submit your article."}),Object(R.jsx)("p",{children:"When you submit using the button below, your manuscript and supporting files will be sent to the journal automatically, and you will receive a confirmation email from Overleaf. The journal's editorial team will then send you a follow-up email with instructions for how to complete your submission."}),Object(R.jsx)("p",{children:"To send your article, please confirm your first and last name:"}),Object(R.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(R.jsxs)("p",{children:[Object(R.jsx)("input",{type:"text",className:"form-control",defaultValue:h,style:{width:"30%",display:"inline-block"},maxLength:"255",placeholder:"First Name",ref:function(t){return e.firstName=t}}),Object(R.jsx)("input",{type:"text",className:"form-control",defaultValue:p,style:{width:"30%",display:"inline-block"},maxLength:"255",placeholder:"Last Name",ref:function(t){return e.lastName=t}})]}),Object(R.jsx)("br",{}),Object(R.jsxs)("button",{type:"submit",className:"btn btn-primary",children:["Submit to ",n.name]})]}),!this.state.submissionValid&&Object(R.jsx)("p",{style:{color:"red"},children:"Please add valid first and last names before continuing"})]}),"initiated"===this.state.exportState&&Object(R.jsx)("span",{children:Object(R.jsxs)("div",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Exporting files, please wait..."})]})}),"complete"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Successful!"}),Object(R.jsxs)("p",{children:["Thanks for submitting to ",n.name,". Your manuscript and supporting files have been sent directly to the journal's editorial team, and they will send a follow-up email with instructions for how to complete your submission."]}),Object(R.jsx)("p",{children:"Please check your email for confirmation of your submission."})]}),"error"===this.state.exportState&&Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Failed"}),Object(R.jsxs)("p",{children:["Error message: ",this.state.errorDetails]})]}),"resubmission"===this.state.exportState&&Object(R.jsx)(eb,{entry:n,projectId:d,exportId:this.state.exportId})]})},n.id)}}])&&ub(t.prototype,n),r&&ub(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function vb(e){return(vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yb(e,t){return(yb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ob(e);if(t){var a=Ob(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return xb(this,n)}}function xb(e,t){if(t&&("object"===vb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jb(e)}function jb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ob(e){return(Ob=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mb.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired,hasFolders:k.a.bool,firstName:k.a.string,lastName:k.a.string};var Cb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yb(e,t)}(l,e);var t,n,r,a=wb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",submissionValid:!0,errorDetails:null,allowTemplateChecked:!0},t.handleAllowTemplate=t.handleAllowTemplate.bind(jb(t)),t.handleSharingOptionsClick=t.handleSharingOptionsClick.bind(jb(t)),t}return t=l,(n=[{key:"handleAllowTemplate",value:function(){this.setState({allowTemplateChecked:!this.state.allowTemplateChecked})}},{key:"handleSharingOptionsClick",value:function(){Object(xe.b)("gallery-submission-sharing-options-click")}},{key:"runExport",value:function(e){var t=this;if(e.preventDefault(),this.title.value&&this.author.value&&this.description.value&&this.license.value){var n=this.props,r=n.entry,a=n.projectId;this.setState({submissionValid:!0,exportState:"initiated"}),gm(r,a,{title:this.title.value,author:this.author.value,description:this.description.value,license:this.license.value,showSource:this.state.allowTemplateChecked}).then((function(){t.setState({exportState:"complete"})})).catch((function(e){t.setState({exportState:"error",errorDetails:e.message})}))}else this.setState({submissionValid:!1})}},{key:"renderUninitiated",value:function(){var e=this,t=this.props,n=t.entry,r=t.author,a=t.title,l=t.description,d=t.license;return Object(R.jsxs)("form",{onSubmit:function(t){return e.runExport(t)},children:[Object(R.jsxs)("p",{children:["Almost done! Please provide some final information to complete your submission."," ",Object(R.jsx)("b",{children:"This is what people browsing the Overleaf Gallery will see when previewing your template."})]}),Object(R.jsx)("p",{children:"If you obtained the template from another source, please include a link to the webpage you obtained it from in the description box. If this template was not authored by you, please ensure that the template is licensed to be reposted."}),Object(R.jsxs)("div",{className:"form-control-box",children:[Object(R.jsx)("label",{htmlFor:"gallery-export-title",children:"Title"}),Object(R.jsx)("input",{id:"gallery-export-title",type:"text",className:"form-control",defaultValue:a,maxLength:"255",placeholder:"Title",ref:function(t){return e.title=t}})]}),Object(R.jsxs)("div",{className:"form-control-box",children:[Object(R.jsx)("label",{htmlFor:"gallery-export-author",children:"Author(s)"}),Object(R.jsx)("input",{id:"gallery-export-author",type:"text",className:"form-control",defaultValue:r,maxLength:"255",placeholder:"Author(s)",ref:function(t){return e.author=t}})]}),Object(R.jsxs)("div",{className:"form-control-box",children:[Object(R.jsx)("label",{htmlFor:"gallery-export-description",children:"Description"}),Object(R.jsx)("textarea",{id:"gallery-export-description",rows:"4",className:"form-control",defaultValue:l,maxLength:"2048",placeholder:"Description",ref:function(t){return e.description=t}})]}),Object(R.jsxs)("div",{className:"form-control-box",children:[Object(R.jsx)("label",{htmlFor:"gallery-export-license",children:"License"}),Object(R.jsxs)("select",{id:"gallery-export-license",ref:function(t){return e.license=t},defaultValue:d,children:[Object(R.jsx)("option",{value:"cc_by_4.0",children:"Creative Commons CC BY 4.0"}),Object(R.jsx)("option",{value:"lppl_1.3c",children:"LaTeX Project Public License 1.3c"}),Object(R.jsx)("option",{value:"other",children:"Other (as stated in the work)"})]}),Object(R.jsx)("a",{className:"help",href:"/learn/how-to/How_are_the_contents_of_the_Overleaf_gallery_licensed%3F",target:"_blank",rel:"noopener noreferrer",children:"(?)"})]}),Object(R.jsxs)("div",{className:"form-control-box no-label",children:[Object(R.jsx)("input",{type:"checkbox",id:"gallery-export-show-source",checked:this.state.allowTemplateChecked,onChange:this.handleAllowTemplate}),Object(R.jsx)("label",{htmlFor:"gallery-export-show-source",className:"checkbox-label",children:"I allow my project to be used as a template by others on Overleaf"}),!this.state.allowTemplateChecked&&Object(R.jsxs)("div",{className:"text-small",children:["Overleaf Gallery is intended for sharing"," ",Object(R.jsx)("b",{children:"public templates only"}),". If you want to:",Object(R.jsxs)("ul",{children:[Object(R.jsxs)("li",{children:["publish a final document, consider using another platform such as"," ",Object(R.jsx)("a",{href:"https://figshare.com/",target:"_blank",rel:"noopener noreferrer",children:"figshare"}),"."]}),Object(R.jsxs)("li",{children:["share your project with collaborators only, consider using the"," ",Object(R.jsx)("a",{onClick:this.handleSharingOptionsClick,href:"/learn/how-to/Sharing_a_project",target:"_blank",children:"project sharing options"}),"."]})]})]})]}),Object(R.jsxs)("div",{className:"form-control-box no-label",children:[Object(R.jsxs)("button",{type:"submit",className:"btn btn-primary",disabled:!this.state.allowTemplateChecked,children:["Submit to ",n.name]}),!this.state.submissionValid&&Object(R.jsx)("p",{style:{color:"red"},children:"Please provide all of title, author(s) and description before continuing"})]})]})}},{key:"renderInitiated",value:function(){return Object(R.jsx)("span",{children:Object(R.jsxs)("div",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Exporting files, please wait..."})]})})}},{key:"renderComplete",value:function(){return Object(R.jsx)("span",{children:Object(R.jsxs)("p",{children:["Thank you for your submission to the Overleaf Gallery! Your submission is pending, and ",Object(R.jsx)("b",{children:"requires action from you"})," — we’ve sent you an email with instructions."]})})}},{key:"renderError",value:function renderError(){return Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Failed"}),Object(R.jsxs)("p",{children:["Error message: ",this.state.errorDetails]})]})}},{key:"render",value:function(){var e,t=this.props,n=t.entry,r=t.onReturn,a=t.returnText;return e="uninitiated"===this.state.exportState?this.renderUninitiated():"initiated"===this.state.exportState?this.renderInitiated():"complete"===this.state.exportState?this.renderComplete():this.renderError(),Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:a}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to:",Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),e]})},n.id)}}])&&bb(t.prototype,n),r&&bb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Sb(e){return(Sb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kb(e,t){return(kb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Eb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$b(e);if(t){var a=$b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ab(this,n)}}function Ab(e,t){if(t&&("object"===Sb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $b(e){return($b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Cb.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired,author:k.a.string,title:k.a.string,description:k.a.string,license:k.a.string};var Tb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kb(e,t)}(l,e);var t,n,r,a=Eb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",errorDetails:null},t}return t=l,(n=[{key:"runExport",value:function(e,t){var n=this;this.setState({exportState:"initiated"}),gm(e,t).then((function(e){var t=e.exportId,r=e.token,a=e.submissionId;n.setState({exportState:"complete",exportId:"".concat(t).concat(r),submissionId:a})})).catch((function(e){n.setState({exportState:"error",errorDetails:e.message})}))}},{key:"componentDidUpdate",value:function(){"complete"===this.state.exportState&&this.submitButton.click()}},{key:"renderUninitiated",value:function(e,t){var n=this;return Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Thanks for using Overleaf to submit your article."}),Object(R.jsx)("p",{children:"Use the button below to send a PDF of your paper and a ZIP file of the LaTeX source files to the journal’s submission site."}),Object(R.jsx)("p",{children:"Log In or Create an Account on the next screen."}),Object(R.jsx)("p",{children:"Once you have logged in,"}),Object(R.jsxs)("ul",{children:[Object(R.jsx)("li",{children:"If you have just started, you will be on the first step of the submission process and your files will be automatically attached."}),Object(R.jsx)("li",{children:"If you have edited an existing project, you will be on the step where the Overleaf files are replaced by your latest version."})]}),Object(R.jsx)("br",{}),Object(R.jsxs)("button",{className:"btn btn-primary",onClick:function(){return n.runExport(e,t)},children:["Submit to ",e.name]})]})}},{key:"renderInitiated",value:function(){return Object(R.jsx)("span",{children:Object(R.jsxs)("div",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Exporting files, please wait..."})]})})}},{key:"renderComplete",value:function(){var e=this;return Object(R.jsxs)("form",{action:this.props.entry.export_url,method:"post",id:"export_form","data-testid":"export-complete",children:[Object(R.jsx)("input",{id:"export_id",name:"export_id",type:"hidden",value:this.state.exportId}),Object(R.jsx)("input",{id:"submission_id",name:"submission_id",type:"hidden",value:this.state.submissionId}),Object(R.jsx)("input",{id:"EXT_ACTION",name:"EXT_ACTION",type:"hidden",value:"OVERLEAF_SUBMISSION"}),Object(R.jsx)("button",{style:{display:"none"},ref:function(t){e.submitButton=t},children:"Submit"})]})}},{key:"renderError",value:function renderError(){return Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Failed"}),Object(R.jsxs)("p",{children:["Error message: ",this.state.errorDetails]})]})}},{key:"render",value:function(){var e,t=this.props,n=t.entry,r=t.onReturn,a=t.projectId,l=t.returnText;return e="uninitiated"===this.state.exportState?this.renderUninitiated(n,a):"initiated"===this.state.exportState?this.renderInitiated(n,a):"complete"===this.state.exportState?this.renderComplete(n):this.renderError(),Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:l}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to: ",Object(R.jsx)("br",{}),Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),e]})},n.id)}}])&&_b(t.prototype,n),r&&_b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Rb(e){return(Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ib(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pb(e,t){return(Pb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Db(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lb(e);if(t){var a=Lb(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Mb(this,n)}}function Mb(e,t){if(t&&("object"===Rb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lb(e){return(Lb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Tb.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired};var Fb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pb(e,t)}(l,e);var t,n,r,a=Db(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={exportState:"uninitiated",errorDetails:null},t}return t=l,(n=[{key:"runExport",value:function(e,t){var n=this;this.setState({exportState:"initiated"});var r=window.ExposedSettings.siteUrl;gm(e,t).then((function(e){var t=e.authorEmail,a=e.authorName,l=e.title,d=e.exportId,h=e.token;n.setState({exportState:"complete",authorEmail:t,authorName:a,title:l,articleZipURL:"".concat(r,"/exports/").concat(d).concat(h,".zip"),pdfURL:"".concat(r,"/exports/").concat(d).concat(h,".pdf"),revisionURL:"".concat(r,"/exports/").concat(d).concat(h,"/revise"),submissionURL:"",publicationURL:"",rejectionURL:"",newVersionURL:"",articleId:""})})).catch((function(e){n.setState({exportState:"error",errorDetails:e.message})}))}},{key:"componentDidUpdate",value:function(){"complete"===this.state.exportState&&this.submitButton.click()}},{key:"renderUninitiated",value:function(e,t){var n=this;return Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Thanks for using Overleaf to write your article."}),Object(R.jsxs)("p",{children:["When you are ready to submit, then click",Object(R.jsxs)("strong",{children:[" Submit to ",e.name]})," below. (Your files will be sent to ",e.name," by Overleaf)"]}),Object(R.jsxs)("button",{"data-testid":"submit-button",className:"btn btn-primary",onClick:function(){return n.runExport(e,t)},children:["Submit to ",e.name]})]})}},{key:"renderInitiated",value:function(){return Object(R.jsx)("span",{children:Object(R.jsxs)("div",{style:{fontSize:20,margin:"20px 0px 20px"},children:[Object(R.jsx)("i",{className:"fa fa-refresh fa-spin fa-fw"}),Object(R.jsx)("span",{children:"   Exporting files, please wait..."})]})})}},{key:"renderComplete",value:function(){var e=this;return Object(R.jsxs)("form",{action:this.props.entry.export_url,method:"GET","data-testid":"export-complete",children:[Object(R.jsx)("input",{id:"authorEmail",name:"authorEmail",type:"hidden",value:this.state.authorEmail}),Object(R.jsx)("input",{id:"authorName",name:"authorName",type:"hidden",value:this.state.authorName}),Object(R.jsx)("input",{id:"title",name:"title",type:"hidden",value:this.state.title}),Object(R.jsx)("input",{id:"articleZipURL",name:"articleZipURL",type:"hidden",value:this.state.articleZipURL}),Object(R.jsx)("input",{id:"pdfURL",name:"pdfURL",type:"hidden",value:this.state.pdfURL}),Object(R.jsx)("input",{id:"revisionURL",name:"revisionURL",type:"hidden",value:this.state.revisionURL}),Object(R.jsx)("input",{id:"submissionURL",name:"submissionURL",type:"hidden",value:""}),Object(R.jsx)("input",{id:"publicationURL",name:"publicationURL",type:"hidden",value:""}),Object(R.jsx)("input",{id:"rejectionURL",name:"rejectionURL",type:"hidden",value:""}),Object(R.jsx)("input",{id:"newVersionURL",name:"newVersionURL",type:"hidden",value:""}),Object(R.jsx)("input",{id:"articleId",name:"articleId",type:"hidden",value:""}),Object(R.jsx)("button",{style:{display:"none"},ref:function(t){e.submitButton=t},children:"Submit"})]})}},{key:"renderError",value:function renderError(){return Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{children:"Export Failed"}),Object(R.jsxs)("p",{children:["Error message: ",this.state.errorDetails]})]})}},{key:"render",value:function(){var e,t=this.props,n=t.entry,r=t.onReturn,a=t.projectId,l=t.returnText;return e="uninitiated"===this.state.exportState?this.renderUninitiated(n,a):"initiated"===this.state.exportState?this.renderInitiated(n,a):"complete"===this.state.exportState?this.renderComplete():this.renderError(),Object(R.jsx)("div",{className:"publish-guide modal-body-content row content-as-table",children:Object(R.jsxs)("div",{className:"col-sm-12",children:[Object(R.jsx)(yv,{onReturn:r,returnText:l}),Object(R.jsxs)("h3",{style:{marginTop:"5px"},children:["Submit to: ",Object(R.jsx)("br",{}),Object(R.jsxs)("strong",{children:[" ",n.name," "]})]}),e]})},n.id)}}])&&Ib(t.prototype,n),r&&Ib(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function qb(e){return(qb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ub(e,t){return(Ub=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vb(e);if(t){var a=Vb(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return zb(this,n)}}function zb(e,t){if(t&&("object"===qb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vb(e){return(Vb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Fb.propTypes={entry:k.a.object.isRequired,returnText:k.a.string,onReturn:k.a.func,projectId:k.a.string.isRequired};var Wb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ub(e,t)}(l,e);var t,n,r,a=Hb(l);function l(){return Nb(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"render",value:function(){var e,t,n,r=this.props,a=r.guideId,l=r.initialEntry,d=r.entries,h=r.onSwitch,p=r.shown,f=r.initParams;return l&&a===l.id?(e=l,d.journal&&d.journal.entries.length>1&&d.brand_data.active&&(n="More "+d.brand_data.name+" Journals",t=h)):(e=fm(d,a),n="Back to Journals and Services",t=h),"guide"===p?Object(R.jsx)(kv,{onReturn:t,entry:e,returnText:n,projectId:f.projectId}):"export"===p?"gallery"===e.partner?Object(R.jsx)(Cb,{onReturn:t,entry:e,returnText:n,projectId:f.projectId,firstName:f.firstName,lastName:f.lastName,title:f.title,author:f.author,description:f.description,license:f.license,showSource:f.showSource,hasFolders:f.hasFolders}):"scholar_one"===e.partner?Object(R.jsx)(Tb,{onReturn:t,entry:e,returnText:n,projectId:f.projectId}):"f1000"===e.partner||"wellcome_trust"===e.partner?Object(R.jsx)(Fb,{onReturn:t,entry:e,partnerName:e.name,partnerContactURL:e.home_url+"/contact",returnText:n,projectId:f.projectId}):"ejp"===e.partner?Object(R.jsx)(lb,{onReturn:t,entry:e,returnText:n,projectId:f.projectId,firstName:f.firstName,lastName:f.lastName}):Object(R.jsx)(mb,{onReturn:t,entry:e,returnText:n,projectId:f.projectId,firstName:f.firstName,lastName:f.lastName,hasFolders:f.hasFolders}):"exportGuide"===p?Object(R.jsx)(Yv,{onReturn:t,entry:e,returnText:n,projectId:f.projectId,onSwitch:h,initParams:f}):null}}])&&Bb(t.prototype,n),r&&Bb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function Kb(e){return(Kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yb(e,t){return(Yb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zb(e);if(t){var a=Zb(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Jb(this,n)}}function Jb(e,t){if(t&&("object"===Kb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qb(e)}function Qb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zb(e){return(Zb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Wb.propTypes={entries:k.a.object.isRequired,initialEntry:k.a.object,guideId:k.a.number.isRequired,shown:k.a.string.isRequired,onSwitch:k.a.func.isRequired,initParams:k.a.object.isRequired};var ey=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yb(e,t)}(l,e);var t,n,r,a=Xb(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={shown:e.initialShown,baseReturn:e.initialShown},t.handleSwitch=t.handleSwitch.bind(Qb(t)),"guide"!==e.initialShown&&"export"!==e.initialShown||(t.state.initialEntry=fm(e.entries,e.brandVariationId),t.state.guideId=t.state.initialEntry.id,t.state.baseReturn="branded"),t}return t=l,(n=[{key:"handleSwitch",value:function(e,t){e?this.setState({shown:e,guideId:t}):this.setState({shown:this.state.baseReturn,guideId:null})}},{key:"render",value:function(){var e=this.props,t=e.entries,n=e.initParams;return n.pdfUrl?n.logs.errors&&n.logs.errors.length>0?Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"This project has LaTeX errors, which can cause problems with your submission. Please check the logs, fix the errors and try submitting again."})}):n.rootDocOverridden?Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"The current document in the editor has a documentclass command but is not the project's main document. To ensure you are submitting the project as intended, please switch to the project's main document and recompile before continuing."})}):n.uncompiled?Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"This project has been changed since it was last compiled. Please recompile the project and submit again."})}):"basic"===this.state.shown?Object(R.jsx)(vv,{entries:this.props.entries,onSwitch:this.handleSwitch}):"guide"===this.state.shown||"exportGuide"===this.state.shown||"export"===this.state.shown?Object(R.jsx)(Wb,{onSwitch:this.handleSwitch,entries:t,guideId:this.state.guideId,initParams:n,shown:this.state.shown,initialEntry:this.state.initialEntry}):"branded"===this.state.shown?Object(R.jsx)(Fv,{onSwitch:this.handleSwitch,entries:t,initialEntry:this.state.initialEntry,initParams:n}):void 0:Object(R.jsx)("p",{children:Object(R.jsx)("strong",{children:"No current PDF. Please make sure your project compiles before submitting."})})}}])&&Gb(t.prototype,n),r&&Gb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(C.Component);function ty(e){return(ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ny(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ry(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iy(e,t){return(iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sy(e);if(t){var a=sy(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ay(this,n)}}function ay(e,t){if(t&&("object"===ty(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sy(e){return(sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ey.propTypes={entries:k.a.object.isRequired,initialShown:k.a.string.isRequired,initParams:k.a.object.isRequired,brandVariationId:k.a.number};var ly=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iy(e,t)}(DestinationsError,e);var t,n,r,a=oy(DestinationsError);function DestinationsError(){return ny(this,DestinationsError),a.apply(this,arguments)}return t=DestinationsError,(n=[{key:"render",value:function(){return Object(R.jsx)("span",{children:Object(R.jsxs)("p",{children:["Sorry, we had trouble retrieving our list of submission destinations. If you give us a minute, retry, and still find this error, please notify support at"," ",Object(R.jsx)("a",{href:"mailto:support@overleaf.com?subject=Unable to submit",children:"support@overleaf.com"})]})})}}])&&ry(t.prototype,n),r&&ry(t,r),Object.defineProperty(t,"prototype",{writable:!1}),DestinationsError}(C.Component);function cy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return uy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dy(e){var t,n,r,a=e.handleHide,l=Object(Mt.a)().t,d=(t={entries:k.a.object,initialShown:k.a.string.isRequired,initParams:k.a.object.isRequired,fetchData:k.a.func.isRequired,brandVariationId:k.a.number},n=Object(C.useContext)(jm),k.a.checkPropTypes(t,n,"data","PublishContext.Provider"),n),h=d.entries,p=d.initialShown,f=d.initParams,y=d.fetchData,w=d.brandVariationId,x=cy(Object(C.useState)(!0),2),j=x[0],O=x[1],S=cy(Object(C.useState)(!1),2),_=S[0],E=S[1],A=cy(Object(C.useState)(!1),2),T=A[0],I=A[1],P=ef();return Object(C.useEffect)((function(){_||(y().catch((function(){P.current&&I(!0)})),E(!0))}),[P,_,y]),r=h?Object(R.jsx)(ey,{entries:h,initialShown:p,initParams:f,brandVariationId:w}):T?Object(R.jsx)(ly,{}):Object(R.jsx)(hy,{}),Object(R.jsxs)(wi.a,{bsSize:"large",show:j,onHide:function(){a(),O(!1)},children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsxs)(yi.a.Title,{children:[" ",l("submit_title")," "]})}),Object(R.jsx)(yi.a.Body,{children:Object(R.jsxs)("div",{className:"modal-body-publish",children:[r," "]})})]})}function hy(){var e=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"refresh",fw:!0,spin:!0})," ",Object(R.jsxs)("span",{children:[e("loading"),"…"]})]})}function py(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gy(e){var t=e.cobranding,n=Object(Mt.a)().t,r=py(Object(C.useState)(!1),2),a=r[0],l=r[1];var d=re()("btn","btn-full-height");return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{id:"publishButton",className:d,onClick:function(){l(!0)},children:[Object(R.jsx)(Pr.a,{type:"globe",fw:!0}),null!=t&&t.submitBtnHtml?Object(R.jsx)("p",{className:"toolbar-label toolbar-label-multiline",dangerouslySetInnerHTML:{__html:t.submitBtnHtml}}):Object(R.jsx)("p",{className:"toolbar-label",children:n("submit_title")})]})}),a&&Object(R.jsx)(Om,{children:Object(R.jsx)(dy,{handleHide:function(){l(!1)}})})]})}dy.propTypes={handleHide:k.a.func.isRequired},gy.propTypes={cobranding:k.a.shape({submitBtnHtml:k.a.string})};var my=Object(E.a)(gy);function vy(e){var t=e.onClick,n=Object(Mt.a)().t;return Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{className:"btn btn-full-height",onClick:t,children:[Object(R.jsx)(Pr.a,{type:"bars",fw:!0,className:"editor-menu-icon"}),Object(R.jsx)("p",{className:"toolbar-label",children:n("menu")})]})})}vy.propTypes={onClick:k.a.func.isRequired};var by=vy;function yy(e){var t=e.brandVariationHomeUrl,n=e.brandVariationName,r=e.logoImgUrl;return Object(R.jsx)("a",{className:"btn btn-full-height header-cobranding-logo-container",href:t,target:"_blank",rel:"noreferrer noopener",children:Object(R.jsx)("img",{src:r,className:"header-cobranding-logo",alt:n})})}yy.propTypes={brandVariationHomeUrl:k.a.string.isRequired,brandVariationName:k.a.string.isRequired,logoImgUrl:k.a.string.isRequired};var wy=yy;var xy=function(){var e=Object(Mt.a)().t;return Object(R.jsx)("a",{className:"toolbar-header-back-projects",href:"/project",children:Object(R.jsx)(Pr.a,{type:"level-up",fw:!0,accessibilityLabel:e("back_to_your_projects")})})};function jy(e){var t=e.chatIsOpen,n=e.unreadMessageCount,r=e.onClick,a=Object(Mt.a)().t,l=re()("btn","btn-full-height","btn-full-height-no-border",{active:t}),d=n>0;return Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{className:l,onClick:r,children:[Object(R.jsx)(Pr.a,{type:"comment",fw:!0,className:d?"bounce":""}),d&&Object(R.jsx)("span",{className:"label label-info",children:n}),Object(R.jsx)("p",{className:"toolbar-label",children:a("chat")})]})})}jy.propTypes={chatIsOpen:k.a.bool,unreadMessageCount:k.a.number.isRequired,onClick:k.a.func.isRequired};var Oy=jy;var Cy=function(){var e=Object(Mt.a)().t;return Object(R.jsx)(Pr.a,{type:"check",fw:!0,accessibilityLabel:e("selected")})};function Sy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ky(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ey(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ky(Object(n),!0).forEach((function(t){Ay(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ky(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ay(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $y(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(C.useState)(e),n=Sy(t,2),r=n[0],a=n[1],l=Object(C.useRef)(null),d=Object(C.useCallback)((function(e){e&&(l.current=Object(Tr.findDOMNode)(e))}),[l]),h=Object(C.useCallback)((function(e){e.stopPropagation()}),[]),p=Object(C.useCallback)((function(e){a(e)}),[]),f=Object(C.useCallback)((function(e){l.current&&!l.current.contains(e.target)&&a(!1)}),[l]);return Object(C.useEffect)((function(){return r&&document.addEventListener("mousedown",f),function(){document.removeEventListener("mousedown",f)}}),[r,f]),{ref:d,onClick:h,onToggle:p,open:r}}(Boolean(e.defaultOpen));return Object(R.jsx)(Co,Ey(Ey(Ey({},e),t),{},{children:S.a.Children.map(e.children,(function(e){return S.a.isValidElement(e)?"open"in e.props?S.a.cloneElement(e,{open:t.open}):"show"in e.props?S.a.cloneElement(e,{show:t.open}):S.a.cloneElement(e):e}))}))}$y.propTypes={children:k.a.any,defaultOpen:k.a.bool};var Ty=function(){return Object(R.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(R.jsx)("rect",{x:"0.5",y:"1.5769",width:"15",height:"13.7692",rx:"1.5",stroke:"#505050"}),Object(R.jsx)("line",{x1:"1",y1:"2.49976",x2:"15",y2:"2.49976",stroke:"#505050"}),Object(R.jsx)("line",{x1:"14",y1:"2.99976",x2:"14",y2:"14.9998",stroke:"#505050",strokeWidth:"2"}),Object(R.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.74946 5.26853L10.7397 8.35194C11.0868 8.70989 11.0868 9.29025 10.7397 9.6482L7.74946 12.7316C7.40233 13.0896 6.83952 13.0896 6.49238 12.7316C6.14525 12.3736 6.51344 11.7904 6.86057 11.4324L8.33333 9.91374L3.88889 9.91667C3.39797 9.91667 3 9.50629 3 9.00007C3 8.49385 3.39797 8.08347 3.88889 8.08347L8.33333 8.08054L6.86057 6.56187C6.51344 6.20392 6.14525 5.62649 6.49238 5.26853C6.83952 4.91058 7.40233 4.91058 7.74946 5.26853Z",fill:"#505050"})]})};var Ry=function(){return Object(R.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(R.jsx)("rect",{x:"0.5",y:"1.5",width:"15",height:"14",rx:"1.5",stroke:"#505050"}),Object(R.jsx)("line",{x1:"1",y1:"2.5",x2:"15",y2:"2.5",stroke:"#505050"}),Object(R.jsx)("line",{x1:"2",y1:"3",x2:"2",y2:"15",stroke:"#505050",strokeWidth:"2"}),Object(R.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.25054 12.7315L5.26035 9.64806C4.91322 9.29011 4.91322 8.70975 5.26035 8.3518L8.25054 5.2684C8.59767 4.91044 9.16048 4.91044 9.50762 5.2684C9.85475 5.62635 9.48656 6.20964 9.13943 6.56759L7.66667 8.08626L12.1111 8.08333C12.602 8.08333 13 8.49371 13 8.99993C13 9.50615 12.602 9.91653 12.1111 9.91653L7.66667 9.91946L9.13943 11.4381C9.48656 11.7961 9.85475 12.3735 9.50762 12.7315C9.16048 13.0894 8.59767 13.0894 8.25054 12.7315Z",fill:"#505050"})]})};function Iy(){return Object(R.jsx)(Pr.a,{type:"",fw:!0})}function Py(){return Object(R.jsx)(Pr.a,{type:"refresh",fw:!0,spin:!0})}function Dy(){return Object(R.jsx)(Pr.a,{type:"columns",fw:!0})}function My(){return Object(R.jsx)(Pr.a,{type:"window-restore",fw:!0})}function Ly(e){var t=e.iconFor,n=e.pdfLayout,r=e.view;return"detacher"===e.detachRole||"history"===r?Object(R.jsx)(Iy,{}):"editorOnly"!==t||"flat"!==n||"editor"!==r&&"file"!==r?"pdfOnly"===t&&"flat"===n&&"pdf"===r||"sideBySide"===t&&"sideBySide"===n?Object(R.jsx)(Cy,{}):Object(R.jsx)(Iy,{}):Object(R.jsx)(Cy,{})}var Fy=function(){var e=Object(Mt.a)().t,t=Pe(qy),n=t.reattach,r=t.detach,a=t.detachIsLinked,l=t.detachRole,d=t.changeLayout,h=t.view,p=t.pdfLayout,f=Object(ks.b)().stopCompile,y=Object(C.useCallback)((function(){r(),f(),xe.b("project-layout-detach")}),[r,f]),w=Object(C.useCallback)((function(){"detacher"===l&&(n(),xe.b("project-layout-reattach"))}),[l,n]),x=Object(C.useCallback)((function(e,t){w(),d(e,t),xe.b("project-layout-change",{layout:e,view:t})}),[d,w]),j=!a&&"detacher"===l;return Object(R.jsxs)(R.Fragment,{children:[j&&Object(R.jsx)("div",{"aria-live":"assertive",className:"sr-only",children:e("layout_processing")}),Object(R.jsxs)($y,{id:"layout-dropdown",className:"toolbar-item layout-dropdown",pullRight:!0,children:[Object(R.jsxs)(Co.Toggle,{className:"btn-full-height",bsStyle:"link",children:[j?Object(R.jsx)(Py,{}):Object(R.jsx)(Dy,{}),Object(R.jsx)("span",{className:"toolbar-label",children:e("layout")}),Object(R.jsx)(hi.a,{placement:"bottom",overlay:Object(R.jsx)(di.a,{id:"pdf-detach-badge",children:"Beta feature"}),delayHide:100,children:Object(R.jsx)("span",{className:"beta-badge"})})]}),Object(R.jsxs)(Co.Menu,{id:"layout-dropdown-list",children:[Object(R.jsxs)(ko,{onSelect:function(){return x("sideBySide")},children:[Object(R.jsx)(Ly,{iconFor:"sideBySide",pdfLayout:p,view:h,detachRole:l}),Object(R.jsx)(Pr.a,{type:"columns"}),e("editor_and_pdf")]}),Object(R.jsxs)(ko,{onSelect:function(){return x("flat","editor")},className:"menu-item-with-svg",children:[Object(R.jsx)(Ly,{iconFor:"editorOnly",pdfLayout:p,view:h,detachRole:l}),Object(R.jsx)(Ty,{}),Object(R.jsx)("span",{children:Object(R.jsx)(_i.a,{i18nKey:"editor_only_hide_pdf",components:[Object(R.jsx)("span",{className:"subdued"},"editor_only_hide_pdf")]})})]}),Object(R.jsxs)(ko,{onSelect:function(){return x("flat","pdf")},className:"menu-item-with-svg",children:[Object(R.jsx)(Ly,{iconFor:"pdfOnly",pdfLayout:p,view:h,detachRole:l}),Object(R.jsx)(Ry,{}),Object(R.jsx)("span",{children:Object(R.jsx)(_i.a,{i18nKey:"pdf_only_hide_editor",components:[Object(R.jsx)("span",{className:"subdued"},"pdf_only_hide_editor")]})})]}),"detacher"===l?Object(R.jsxs)(ko,{children:[a?Object(R.jsx)(Cy,{}):Object(R.jsx)(Py,{}),Object(R.jsx)(My,{}),e("pdf_in_separate_tab")]}):Object(R.jsxs)(ko,{onSelect:y,children:[Object(R.jsx)(Iy,{}),Object(R.jsx)(My,{}),e("pdf_in_separate_tab")]}),Object(R.jsx)(ko,{divider:!0}),Object(R.jsxs)("div",{className:"pdf-detach-survey",children:[Object(R.jsx)("span",{children:Object(R.jsx)("span",{className:"beta-badge"})}),Object(R.jsxs)("span",{className:"pdf-detach-survey-text",children:["The Layout menu and opening the PDF in a new tab are beta features."," ",Object(R.jsxs)("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLScuxQA8Az9NQwvYgC6FALG7FEtCCj4e8of27e_L0SXGrJFRMw/viewform",target:"_blank",rel:"noopener noreferrer",children:[e("give_feedback"),"."]})]})]})]})]})]})};Ly.propTypes={iconFor:k.a.string.isRequired,pdfLayout:k.a.string.isRequired,view:k.a.string,detachRole:k.a.string};var qy={reattach:k.a.func.isRequired,detach:k.a.func.isRequired,changeLayout:k.a.func.isRequired,detachIsLinked:k.a.bool,detachRole:k.a.string,pdfLayout:k.a.string.isRequired,view:k.a.string};function Ny(e){var t=e.onlineUsers,n=e.goToUser,r=Object(Mt.a)().t;return t.length>=4?Object(R.jsxs)($y,{id:"online-users",className:"online-users",pullRight:!0,children:[Object(R.jsx)(Uy,{bsRole:"toggle",onlineUserCount:t.length}),Object(R.jsxs)(Co.Menu,{children:[Object(R.jsx)(ko,{header:!0,children:r("connected_users")}),t.map((function(e,t){return Object(R.jsx)(ko,{as:"button",eventKey:e,onSelect:n,children:Object(R.jsx)(By,{user:e,onClick:n,showName:!0})},"".concat(e.user_id,"_").concat(t))}))]})]}):Object(R.jsx)("div",{className:"online-users",children:t.map((function(e,t){return Object(R.jsx)(hi.a,{placement:"bottom",trigger:["hover","focus"],overlay:Object(R.jsx)(di.a,{id:"tooltip-online-user",children:e.name}),children:Object(R.jsx)("span",{children:Object(R.jsx)(By,{user:e,onClick:n})})},"".concat(e.user_id,"_").concat(t))}))})}function By(e){var t=e.user,n=e.showName,r=e.onClick,a="hsl(".concat(uh(t.user_id),", 70%, 50%)");return Object(R.jsxs)("span",{onClick:function(){r(t)},children:[Object(R.jsx)("span",{className:"online-user",style:{backgroundColor:a},children:t.name.slice(0,1)}),n&&t.name]})}Ny.propTypes={onlineUsers:k.a.arrayOf(k.a.shape({user_id:k.a.string.isRequired,name:k.a.string.isRequired})).isRequired,goToUser:k.a.func.isRequired},By.propTypes={user:k.a.shape({user_id:k.a.string.isRequired,name:k.a.string.isRequired}),showName:k.a.bool,onClick:k.a.func.isRequired};var Uy=S.a.forwardRef((function(e,t){var n=Object(Mt.a)().t;return Object(R.jsx)(hi.a,{placement:"left",overlay:Object(R.jsx)(di.a,{id:"tooltip-connected-users",children:n("connected_users")}),children:Object(R.jsxs)("button",{className:"btn online-user online-user-multi",onClick:e.onClick,children:[Object(R.jsx)("strong",{children:e.onlineUserCount}),Object(R.jsx)(Pr.a,{type:"users",fw:!0})]})})}));Uy.displayName="DropDownToggleButton",Uy.propTypes={onlineUserCount:k.a.number.isRequired,onClick:k.a.func};var Hy=Ny;function zy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wy(e){var t=e.projectName,n=e.hasRenamePermissions,r=e.onChange,a=e.className,l=Object(Mt.a)().t,d=zy(Object(C.useState)(!1),2),h=d[0],p=d[1],f=n&&!h,y=zy(Object(C.useState)(t),2),w=y[0],x=y[1],j=Object(C.useRef)(null);function O(){f&&(x(t),p(!0))}function S(){p(!1),r(w)}return Object(C.useEffect)((function(){h&&j.current.select()}),[h]),Object(R.jsxs)("div",{className:re()("project-name",a),children:[!h&&Object(R.jsx)("span",{className:"name",onDoubleClick:O,children:t}),h&&Object(R.jsx)("input",{ref:j,type:"text",className:"form-control",onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),S())},onChange:function(e){x(e.target.value)},onBlur:function(){h&&S()},value:w}),f&&Object(R.jsx)(hi.a,{placement:"bottom",trigger:["hover","focus"],overlay:Object(R.jsx)(di.a,{id:"tooltip-online-user",children:l("rename")}),children:Object(R.jsx)("a",{className:"rename",role:"button",onClick:O,children:Object(R.jsx)(Pr.a,{type:"pencil",fw:!0})})})]})}Wy.propTypes={projectName:k.a.string.isRequired,hasRenamePermissions:k.a.bool,onChange:k.a.func.isRequired,className:k.a.string};var Ky=Wy;function Gy(e){var t=e.trackChangesIsOpen,n=e.disabled,r=e.onClick,a=Object(Mt.a)().t,l=re()("btn","btn-full-height",{active:t&&!n,disabled:n});return Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{disabled:n,className:l,onClick:r,children:[Object(R.jsx)("i",{className:"review-icon"}),Object(R.jsx)("p",{className:"toolbar-label",children:a("review")})]})})}Gy.propTypes={trackChangesIsOpen:k.a.bool,disabled:k.a.bool,onClick:k.a.func.isRequired};var Yy=Gy;function Xy(e){var t=e.historyIsOpen,n=e.onClick,r=Object(Mt.a)().t,a=re()("btn","btn-full-height",{active:t});return Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{className:a,onClick:n,children:[Object(R.jsx)(Pr.a,{type:"history",fw:!0}),Object(R.jsx)("p",{className:"toolbar-label",children:r("history")})]})})}Xy.propTypes={historyIsOpen:k.a.bool,onClick:k.a.func.isRequired};var Jy=Xy;function Qy(e){var t=e.onClick,n=Object(Mt.a)().t;return Object(R.jsx)("div",{className:"toolbar-item",children:Object(R.jsxs)("button",{className:"btn btn-full-height",onClick:t,children:[Object(R.jsx)(Pr.a,{type:"group",fw:!0}),Object(R.jsx)("p",{className:"toolbar-label",children:n("share")})]})})}Qy.propTypes={onClick:k.a.func.isRequired};var Zy=Qy;function ew(e){var t=e.onClick,n=e.pdfViewIsOpen,r=re()("btn","btn-full-height","btn-full-height-no-border",{active:n});return Object(R.jsx)(hi.a,{placement:"bottom",trigger:["hover","focus"],overlay:Object(R.jsx)(di.a,{id:"tooltip-online-user",children:"PDF"}),children:Object(R.jsx)("a",{role:"button",className:r,onClick:t,children:Object(R.jsx)(Pr.a,{type:"file-pdf-o",fw:!0,accessibilityLabel:"PDF"})})})}ew.propTypes={onClick:k.a.func.isRequired,pdfViewIsOpen:k.a.bool};var tw=ew;function nw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nw(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function iw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ow={import:f,path:"/overleaf/services/web/modules/publish-modal/frontend/js/components/publish-toolbar-button"},aw=null==ow?void 0:ow.import.default,sw=S.a.memo((function(e){var t=e.cobranding,n=e.onShowLeftMenuClick,r=e.chatIsOpen,a=e.toggleChatOpen,l=e.reviewPanelOpen,d=e.toggleReviewPanelOpen,h=e.historyIsOpen,p=e.toggleHistoryOpen,f=e.unreadMessageCount,y=e.onlineUsers,w=e.goToUser,x=e.isRestrictedTokenMember,j=e.hasPublishPermissions,O=e.projectName,C=e.renameProject,S=e.hasRenamePermissions,_=e.openShareModal,k=e.pdfViewIsOpen,E=e.pdfButtonIsVisible,A=e.togglePdfView,T=e.trackChangesVisible,I=Object(Mt.a)().t,P=j&&aw,D=T&&!x;return Object(R.jsxs)("header",{className:"toolbar toolbar-header toolbar-with-labels",role:"navigation","aria-label":I("project_layout_sharing_submission"),children:[Object(R.jsxs)("div",{className:"toolbar-left",children:[Object(R.jsx)(by,{onClick:n}),t&&t.logoImgUrl&&Object(R.jsx)(wy,rw({},t)),Object(R.jsx)(xy,{})]}),!window.showPdfDetach&&E&&Object(R.jsx)(tw,{onClick:A,pdfViewIsOpen:k}),Object(R.jsx)(Ky,{className:"toolbar-center",projectName:O,hasRenamePermissions:S,onChange:C}),Object(R.jsxs)("div",{className:"toolbar-right",children:[Object(R.jsx)(Hy,{onlineUsers:y,goToUser:w}),D&&Object(R.jsx)(Yy,{onClick:d,disabled:h,trackChangesIsOpen:l}),Object(R.jsx)(Zy,{onClick:_}),P&&Object(R.jsx)(aw,{cobranding:t}),!x&&Object(R.jsx)(Jy,{historyIsOpen:h,onClick:p}),window.showPdfDetach&&Object(R.jsx)(Fy,{}),!x&&Object(R.jsx)(Oy,{chatIsOpen:r,onClick:a,unreadMessageCount:f})]})]})}));sw.propTypes={onShowLeftMenuClick:k.a.func.isRequired,cobranding:k.a.object,chatIsOpen:k.a.bool,toggleChatOpen:k.a.func.isRequired,reviewPanelOpen:k.a.bool,toggleReviewPanelOpen:k.a.func.isRequired,historyIsOpen:k.a.bool,toggleHistoryOpen:k.a.func.isRequired,unreadMessageCount:k.a.number.isRequired,onlineUsers:k.a.array.isRequired,goToUser:k.a.func.isRequired,isRestrictedTokenMember:k.a.bool,hasPublishPermissions:k.a.bool,projectName:k.a.string.isRequired,renameProject:k.a.func.isRequired,hasRenamePermissions:k.a.bool,openShareModal:k.a.func.isRequired,pdfViewIsOpen:k.a.bool,pdfButtonIsVisible:k.a.bool,togglePdfView:k.a.func.isRequired,trackChangesVisible:k.a.bool};var lw=sw,cw={name:k.a.string.isRequired,features:k.a.shape({trackChangesVisible:k.a.bool}).isRequired},uw={cobranding:k.a.object,loading:k.a.bool,isRestrictedTokenMember:k.a.bool,renameProject:k.a.func.isRequired,isProjectOwner:k.a.bool,permissionsLevel:k.a.string},dw={chatIsOpen:k.a.bool,setChatIsOpen:k.a.func.isRequired,reviewPanelOpen:k.a.bool,setReviewPanelOpen:k.a.func.isRequired,view:k.a.string,setView:k.a.func.isRequired,setLeftMenuShown:k.a.func.isRequired,pdfLayout:k.a.string.isRequired},hw={markMessagesAsRead:k.a.func.isRequired,unreadMessageCount:k.a.number.isRequired},pw=S.a.memo((function(e){var t=e.onlineUsersArray,n=e.openDoc,r=e.openShareProjectModal,a=Object(A.c)(cw),l=a.name,d=a.features.trackChangesVisible,h=Object(te.b)(uw),p=h.cobranding,f=h.loading,y=h.isRestrictedTokenMember,w=h.renameProject,x=h.isProjectOwner,j=h.permissionsLevel,O=Pe(dw),S=O.chatIsOpen,_=O.setChatIsOpen,k=O.reviewPanelOpen,E=O.setReviewPanelOpen,T=O.view,I=O.setView,P=O.setLeftMenuShown,D=O.pdfLayout,M=zs(hw),L=M.markMessagesAsRead,F=M.unreadMessageCount,q=Object(C.useCallback)((function(){S||L(),_((function(e){return!e}))}),[S,_,L]),N=Object(C.useCallback)((function(){return E((function(e){return!e}))}),[E]),B=Object(C.useCallback)((function(){I("history"===T?"editor":"history")}),[T,I]),U=Object(C.useCallback)((function(){I("pdf"===T?"editor":"pdf")}),[T,I]),H=Object(C.useCallback)((function(){r(x)}),[r,x]),z=Object(C.useCallback)((function(){return P((function(e){return!e}))}),[P]),V=Object(C.useCallback)((function(e){e.doc&&"number"==typeof e.row&&n(e.doc,{gotoLine:e.row+1})}),[n]);return Object(R.jsx)(lw,{style:f?{display:"none"}:{},cobranding:p,onShowLeftMenuClick:z,chatIsOpen:S,unreadMessageCount:F,toggleChatOpen:q,reviewPanelOpen:k,toggleReviewPanelOpen:N,historyIsOpen:"history"===T,toggleHistoryOpen:B,onlineUsers:t,goToUser:V,isRestrictedTokenMember:y,hasPublishPermissions:"owner"===j||"readAndWrite"===j,projectName:l,renameProject:w,hasRenamePermissions:"owner"===j,openShareModal:H,pdfViewIsOpen:"pdf"===T,pdfButtonIsVisible:"flat"===D,togglePdfView:U,trackChangesVisible:d})}));pw.propTypes={onlineUsersArray:k.a.array.isRequired,openDoc:k.a.func.isRequired,openShareProjectModal:k.a.func.isRequired};var fw=pw;y.a.controller("EditorNavigationToolbarController",["$scope","ide",function(e,t){e.openDoc=function(e,n){return t.editorManager.openDoc(e,n)}}]),y.a.component("editorNavigationToolbarRoot",Object(x.react2angular)(Ys.use(fw),["openDoc","onlineUsersArray","openShareProjectModal"]));n(314);var gw=function(e,t,n){var r=Object(C.useRef)(),a=Object(C.useCallback)((function(){r.current=new ResizeObserver((function(e){n(e[0])}))}),[n]);Object(C.useLayoutEffect)((function(){if("ResizeObserver"in window){var t=e&&e.current;return t&&a(e.current),r.current&&t&&r.current.observe(t),function(){t&&function(e){r.current.unobserve(e)}(t)}}}),[e,t,a])};function mw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bw(e){var t=e.sourceLocation,n=e.level,r=e.headerTitle,a=e.headerIcon,l=e.logType,d=e.showSourceLocationLink,h=void 0===d||d,p=e.showCloseButton,f=void 0!==p&&p,y=e.onSourceLocationClick,w=e.onClose,x=Object(Mt.a)().t,j=Object(C.useRef)(),O=mw(Object(C.useState)(!1),2),S=O[0],_=O[1];gw(j,S,(function(e){var t=e.target,n=t.scrollWidth>t.clientWidth;_(n)}));var k=t?t.file:null,E=t?t.line:null,A=re()("log-entry-header",{"log-entry-header-error":"error"===n,"log-entry-header-warning":"warning"===n,"log-entry-header-typesetting":"typesetting"===n,"log-entry-header-raw":"raw"===n,"log-entry-header-success":"success"===n}),T=re()("log-entry-header-link",{"log-entry-header-link-error":"error"===n,"log-entry-header-link-warning":"warning"===n,"log-entry-header-link-typesetting":"typesetting"===n,"log-entry-header-link-raw":"raw"===n,"log-entry-header-link-success":"success"===n}),I=x("navigate_log_source",{location:k+(E?", ".concat(E):"")});var P=h&&k?"".concat(k).concat(E?", ".concat(E):""):null,D=P?Object(R.jsxs)("button",{className:T,type:"button","aria-label":I,onClick:y,children:[Object(R.jsx)(Pr.a,{type:"chain"})," ",Object(R.jsx)("span",{ref:j,className:"log-entry-header-link-location",children:"‪".concat(P,"‬")})]}):null,M=S&&P?Object(R.jsx)(di.a,{id:P,className:"log-location-tooltip",children:P}):null,L=l?"".concat(l," ").concat(r):r;return Object(R.jsxs)("header",{className:A,children:[a?Object(R.jsx)("div",{className:"log-entry-header-icon-container",children:a}):null,Object(R.jsx)("h3",{className:"log-entry-header-title",children:L}),M?Object(R.jsx)(hi.a,{placement:"left",overlay:M,children:D}):D,f?Object(R.jsx)("button",{className:"btn-inline-link log-entry-header-link",type:"button","aria-label":x("dismiss_error_popup"),onClick:w,children:Object(R.jsx)("span",{"aria-hidden":"true",children:"×"})}):null]})}bw.propTypes={sourceLocation:k.a.shape({file:k.a.string,line:k.a.any,column:k.a.any}),level:k.a.string.isRequired,headerTitle:k.a.string,headerIcon:k.a.element,logType:k.a.string,showSourceLocationLink:k.a.bool,showCloseButton:k.a.bool,onSourceLocationClick:k.a.func,onClose:k.a.func};var yw=bw;function ww(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ow(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ow(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ow(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cw(e){var t,n,r,a=e.rawContent,l=e.collapsedSize,d=void 0===l?0:l,h=jw(Object(C.useState)(!1),2),p=h[0],f=h[1],y=jw(Object(C.useState)(!1),2),w=y[0],x=y[1],j=(t=function(e){x(e.scrollHeight>d)},n=Object(C.useRef)(null),r=Object(C.useCallback)((function(e){if(e&&"ResizeObserver"in window){n.current&&n.current.observer.unobserve(n.current.element);var r=new ResizeObserver((function(e){var n=ww(e,1)[0];t(n.target)}));n.current={element:e,observer:r},r.observe(e),t(e)}}),[t]),Object(C.useEffect)((function(){return function(){n.current&&n.current.observer.unobserve(n.current.element)}}),[]),r),O=Object(Mt.a)().t;return Object(R.jsxs)("div",{className:"log-entry-content-raw-container",children:[Object(R.jsx)("div",{className:"expand-collapse-container",style:{height:p||!w?"auto":d},children:Object(R.jsx)("pre",{className:"log-entry-content-raw",ref:j,children:a.trim()})}),w&&Object(R.jsx)("div",{className:re()("log-entry-content-button-container",{"log-entry-content-button-container-collapsed":!p}),children:Object(R.jsx)(Ir.a,{bsSize:"xs",bsStyle:"default",className:"log-entry-btn-expand-collapse",onClick:function(){return f((function(e){return!e}))},children:p?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"angle-up"})," ",O("collapse")]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"angle-down"})," ",O("expand")]})})})]})}function Sw(e){var t=e.rawContent,n=e.formattedContent,r=e.extraInfoURL,a=Object(Mt.a)().t;return Object(R.jsxs)("div",{className:"log-entry-content",children:[n&&Object(R.jsx)("div",{className:"log-entry-formatted-content",children:n}),r&&Object(R.jsx)("div",{className:"log-entry-content-link",children:Object(R.jsx)("a",{href:r,target:"_blank",rel:"noopener",children:a("log_hint_extra_info")})}),t&&Object(R.jsx)(Cw,{rawContent:t,collapsedSize:150})]})}function _w(e){var t=e.headerTitle,n=e.headerIcon,r=e.rawContent,a=e.logType,l=e.formattedContent,d=e.extraInfoURL,h=e.level,p=e.sourceLocation,f=e.showSourceLocationLink,y=void 0===f||f,w=e.showCloseButton,x=void 0!==w&&w,j=e.entryAriaLabel,O=void 0===j?null:j,S=e.customClass,_=e.onSourceLocationClick,k=e.onClose,E=Object(C.useCallback)((function(e){e.preventDefault(),_(p)}),[_,p]);return Object(R.jsxs)("div",{className:re()("log-entry",S),"aria-label":O,children:[Object(R.jsx)(yw,{level:h,sourceLocation:p,headerTitle:t,headerIcon:n,logType:a,showSourceLocationLink:y,onSourceLocationClick:E,showCloseButton:x,onClose:k}),(r||l)&&Object(R.jsx)(Sw,{rawContent:r,formattedContent:l,extraInfoURL:d})]})}Cw.propTypes={rawContent:k.a.string.isRequired,collapsedSize:k.a.number},Sw.propTypes={rawContent:k.a.string,formattedContent:k.a.node,extraInfoURL:k.a.string},_w.propTypes={sourceLocation:yw.propTypes.sourceLocation,headerTitle:k.a.string,headerIcon:k.a.element,rawContent:k.a.string,logType:k.a.string,formattedContent:k.a.node,extraInfoURL:k.a.string,level:k.a.oneOf(["error","warning","typesetting","raw","success"]).isRequired,customClass:k.a.string,showSourceLocationLink:k.a.bool,showCloseButton:k.a.bool,entryAriaLabel:k.a.string,onSourceLocationClick:k.a.func,onClose:k.a.func};var kw=Object(C.memo)(_w);function Ew(e){var t=e.issue,n=e.name,r=Object(Mt.a)().t;switch(n){case"sizeCheck":return Object(R.jsx)(kw,{headerTitle:r("project_too_large"),formattedContent:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{children:r("project_too_large_please_reduce")}),Object(R.jsx)("ul",{className:"list-no-margin-bottom",children:t.resources.map((function(e){return Object(R.jsxs)("li",{children:[e.path," — ",e.kbSize,"kb"]},e.path)}))})]}),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});case"conflictedPaths":return Object(R.jsx)(kw,{headerTitle:r("conflicting_paths_found"),formattedContent:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{children:r("following_paths_conflict")}),Object(R.jsx)("ul",{className:"list-no-margin-bottom",children:t.map((function(e){return Object(R.jsxs)("li",{children:["/",e.path]},e.path)}))})]}),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});case"mainFile":return Object(R.jsx)(kw,{headerTitle:r("main_file_not_found"),formattedContent:r("please_set_main_file"),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});default:return null}}Ew.propTypes={name:k.a.string.isRequired,issue:k.a.any};var Aw=Object(C.memo)(Ew);function $w(){var e=Object(Mt.a)().t,t=Object(te.b)(),n=t.hasPremiumCompile,r=t.isProjectOwner;return!window.ExposedSettings.enableSubscriptions||n?null:Object(R.jsx)(kw,{headerTitle:e(r?"upgrade_for_longer_compiles":"ask_proj_owner_to_upgrade_for_longer_compiles"),formattedContent:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("p",{children:e("free_accounts_have_timeout_upgrade_to_increase")}),Object(R.jsxs)("p",{children:[e("plus_upgraded_accounts_receive"),":"]}),Object(R.jsx)("div",{children:Object(R.jsx)(am.a,{})}),r&&Object(R.jsx)("p",{className:"text-center",children:Object(R.jsx)(ma.a,{source:"compile-timeout",buttonStyle:"success",classes:{button:"row-spaced-small"}})})]}),entryAriaLabel:e(r?"upgrade_for_longer_compiles":"ask_proj_owner_to_upgrade_for_longer_compiles"),level:"success"})}var Tw=Object(C.memo)($w);function PdfPreviewError(e){var t=e.error,n=Object(Mt.a)().t;switch(t){case"rendering-error":return Object(R.jsx)(Iw,{title:n("pdf_rendering_error"),children:n("something_went_wrong_rendering_pdf")});case"clsi-maintenance":return Object(R.jsx)(Iw,{title:n("server_error"),children:n("clsi_maintenance")});case"clsi-unavailable":return Object(R.jsx)(Iw,{title:n("server_error"),children:n("clsi_unavailable")});case"too-recently-compiled":return Object(R.jsx)(Iw,{title:n("server_error"),children:n("too_recently_compiled")});case"terminated":return Object(R.jsx)(Iw,{title:n("terminated"),children:n("compile_terminated_by_user")});case"rate-limited":return Object(R.jsx)(Iw,{title:n("pdf_compile_rate_limit_hit"),children:n("project_flagged_too_many_compiles")});case"compile-in-progress":return Object(R.jsx)(Iw,{title:n("pdf_compile_in_progress_error"),children:n("pdf_compile_try_again")});case"auto-compile-disabled":return Object(R.jsx)(Iw,{title:n("autocompile_disabled"),children:n("autocompile_disabled_reason")});case"project-too-large":return Object(R.jsx)(Iw,{title:n("project_too_large"),children:n("project_too_much_editable_text")});case"timedout":return Object(R.jsxs)(Iw,{title:n("timedout"),children:[n("proj_timed_out_reason"),Object(R.jsx)("div",{children:Object(R.jsx)("a",{href:"https://www.overleaf.com/learn/how-to/Why_do_I_keep_getting_the_compile_timeout_error_message%3F",target:"_blank",rel:"noopener",children:n("learn_how_to_make_documents_compile_quickly")})})]});case"failure":return Object(R.jsxs)(Iw,{title:n("no_pdf_error_title"),children:[n("no_pdf_error_explanation"),Object(R.jsxs)("ul",{className:"log-entry-formatted-content-list",children:[Object(R.jsx)("li",{children:n("no_pdf_error_reason_unrecoverable_error")}),Object(R.jsx)("li",{children:Object(R.jsx)(_i.a,{i18nKey:"no_pdf_error_reason_no_content",components:{code:Object(R.jsx)("code",{})}})}),Object(R.jsx)("li",{children:Object(R.jsx)(_i.a,{i18nKey:"no_pdf_error_reason_output_pdf_already_exists",components:{code:Object(R.jsx)("code",{})}})})]})]});case"clear-cache":return Object(R.jsx)(Iw,{title:n("server_error"),children:n("somthing_went_wrong_compiling")});case"validation-problems":return null;case"error":default:return Object(R.jsx)(Iw,{title:n("server_error"),children:n("somthing_went_wrong_compiling")})}}PdfPreviewError.propTypes={error:k.a.string.isRequired};var Rw=Object(C.memo)(PdfPreviewError);function Iw(e){var t=e.title,n=e.children,r=Object(Mt.a)().t;return Object(R.jsx)(kw,{headerTitle:t,formattedContent:n,entryAriaLabel:r("compile_error_entry_description"),level:"error"})}function Pw(){var e=Object(ks.b)(),t=e.compiling,n=e.clearCache,r=e.clearingCache,a=Object(Mt.a)().t;return Object(R.jsxs)(Ir.a,{bsSize:"small",bsStyle:"danger",className:"logs-pane-actions-clear-cache",onClick:n,disabled:r||t,children:[r?Object(R.jsx)(Pr.a,{type:"refresh",spin:!0}):Object(R.jsx)(Pr.a,{type:"trash-o"})," ",Object(R.jsx)("span",{children:a("clear_cached_files")})]})}Iw.propTypes={title:k.a.string.isRequired,children:k.a.any.isRequired};var Dw=Object(C.memo)(Pw);function Mw(e){var t=e.fileList,n=Object(Mt.a)().t;return t?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(ko,{header:!0,children:n("other_output_files")}),t.top.map((function(e){return Object(R.jsx)(ko,{download:!0,href:e.url,children:Object(R.jsx)("b",{children:e.path})},e.path)})),t.other.length>0&&t.top.length>0&&Object(R.jsx)(ko,{divider:!0}),t.other.map((function(e){return Object(R.jsx)(ko,{download:!0,href:e.url,children:Object(R.jsx)("b",{children:e.path})},e.path)}))]}):null}var Lw=k.a.arrayOf(k.a.shape({path:k.a.string.isRequired,url:k.a.string.isRequired}));Mw.propTypes={fileList:k.a.shape({top:Lw,other:Lw})};var Fw=Object(C.memo)(Mw);function qw(){var e=Object(ks.b)(),t=e.compiling,n=e.fileList,r=Object(Mt.a)().t;return Object(R.jsxs)($y,{id:"dropdown-files-logs-pane",dropup:!0,pullRight:!0,disabled:t||!n,children:[Object(R.jsx)(Co.Toggle,{className:"dropdown-toggle",title:r("other_logs_and_files"),bsSize:"small",bsStyle:"info"}),Object(R.jsx)(Co.Menu,{id:"dropdown-files-logs-pane-list",children:Object(R.jsx)(Fw,{fileList:n})})]})}var Nw=Object(C.memo)(qw);function Bw(e){var t=e.totalEntries,n=e.entriesShown,r=e.hasErrors,a=Object(Mt.a)().t,l=a("log_entry_maximum_entries_title",{total:t,displayed:n});return Object(R.jsxs)("div",{className:"log-entry","aria-label":a("log_entry_maximum_entries"),children:[Object(R.jsx)(yw,{level:"raw",headerTitle:l}),Object(R.jsxs)("div",{className:"log-entry-content",children:[Object(R.jsx)(Pr.a,{type:"lightbulb-o"})," ",r?Object(R.jsx)(_i.a,{i18nKey:"log_entry_maximum_entries_message",components:[Object(R.jsx)("b",{},"bold-1"),Object(R.jsx)("p",{})]}):Object(R.jsx)(_i.a,{i18nKey:"log_entry_maximum_entries_message_no_errors",components:[Object(R.jsx)("b",{},"bold-1")]})]})]})}Bw.propTypes={totalEntries:k.a.number,entriesShown:k.a.number,hasErrors:k.a.bool};var Uw=Bw;function Hw(e){var t=e.entries,n=e.hasErrors,r=Object(Mt.a)().t,a=Object(_e.b)(),l=Nu("sync-to-entry",Object(C.useCallback)((function(e){var t,n,r=a.fileTreeManager.findEntityByPath(e.file);r&&"doc"===r.type&&a.editorManager.openDoc(r,{gotoLine:null!==(t=e.line)&&void 0!==t?t:void 0,gotoColumn:null!==(n=e.column)&&void 0!==n?n:void 0})}),[a]),"detached","detacher"),d=t.slice(0,100);return Object(R.jsxs)(R.Fragment,{children:[t.length>100&&Object(R.jsx)(Uw,{totalEntries:t.length,entriesShown:100,hasErrors:n}),d.map((function(e){return Object(R.jsx)(kw,{headerTitle:e.message,rawContent:e.content,logType:e.type,formattedContent:e.humanReadableHintComponent,extraInfoURL:e.extraInfoURL,level:e.level,entryAriaLabel:r("log_entry_description",{level:e.level}),sourceLocation:{file:e.file,line:e.line,column:e.column},onSourceLocationClick:l},e.key)}))]})}Hw.propTypes={entries:k.a.arrayOf(k.a.object),hasErrors:k.a.bool};var zw=Object(C.memo)(Hw),Vw=n(356);function Ww(){var e=Object(Mt.a)().t;return Object(R.jsx)("div",{className:"log-entry",children:Object(R.jsxs)("div",{className:"log-entry-header log-entry-header-error",children:[Object(R.jsx)("div",{className:"log-entry-header-icon-container",children:Object(R.jsx)(Pr.a,{type:"exclamation-triangle",fw:!0})}),Object(R.jsx)("h3",{className:"log-entry-header-title",children:e("code_check_failed_explanation")})]})})}var Kw=Object(C.memo)(Ww);function Gw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xw(){var e=Object(Mt.a)().t,t=Gw(Object(De.a)("logs_pane.dismissed_info_notice",!1),2),n=t[0],r=t[1];return n?null:Object(R.jsx)("div",{className:"log-entry",children:Object(R.jsxs)("div",{className:"log-entry-header log-entry-header-raw",children:[Object(R.jsx)("div",{className:"log-entry-header-icon-container",children:Object(R.jsx)("span",{className:"info-badge"})}),Object(R.jsx)("h3",{className:"log-entry-header-title",children:e("logs_pane_info_message")}),Object(R.jsx)("a",{href:"https://forms.gle/zYByeRPcDtA6nDS19",target:"_blank",rel:"noopener noreferrer",className:"log-entry-header-link log-entry-header-link-raw",children:Object(R.jsx)("span",{className:"log-entry-header-link-location",children:e("give_feedback")})}),Object(R.jsx)("button",{className:"btn-inline-link log-entry-header-link",type:"button","aria-label":e("dismiss"),onClick:function(){return r(!0)},children:Object(R.jsx)("span",{"aria-hidden":"true",children:"×"})})]})})}var Jw=Object(C.memo)(Xw);function Qw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ex(){var e=Object(ks.b)(),t=e.codeCheckFailed,n=e.error,r=e.logEntries,a=e.rawLog,l=e.validationIssues,d=e.showLogs,h=Object(Mt.a)().t;return Object(R.jsx)("div",{className:re()("logs-pane",{hidden:!d}),children:Object(R.jsxs)("div",{className:"logs-pane-content",children:[Object(R.jsx)(Jw,{}),t&&Object(R.jsx)(Kw,{}),n&&Object(R.jsx)(Rw,{error:n}),"timedout"===n&&Object(R.jsx)(Tw,{}),l&&Object.entries(l).map((function(e){var t=Qw(e,2),n=t[0],r=t[1];return Object(R.jsx)(Aw,{name:n,issue:r},n)})),(null==r?void 0:r.all)&&Object(R.jsx)(zw,{entries:r.all,hasErrors:r.errors.length>0}),a&&Object(R.jsx)(kw,{headerTitle:h("raw_logs"),rawContent:a,entryAriaLabel:h("raw_logs_description"),level:"raw"}),Object(R.jsxs)("div",{className:"logs-pane-actions",children:[Object(R.jsx)(Dw,{}),Object(R.jsx)(Nw,{})]})]})})}var tx=Object(E.a)(Object(C.memo)(ex),(function(){return Object(R.jsx)(Vw.a,{type:"logs"})})),nx=Object(C.lazy)((function(){return Promise.all([n.e(82),n.e(72)]).then(n.bind(null,1141))}));function rx(){var e=Object(ks.b)(),t=e.pdfUrl,n=e.pdfViewer;if(!t)return null;switch(n){case"native":return Object(R.jsx)("iframe",{title:"PDF Preview",src:t});case"pdfjs":default:return Object(R.jsx)(nx,{url:t})}}var ix=Object(C.memo)(rx),ox=function(e){function t(){return e.apply(this,arguments)||this}return Object($i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=Object(Ai.a)(e,["className"]),r=Object(oo.f)(n),a=r[0],l=r[1],d=Object(oo.d)(a);return S.a.createElement("div",Object(Ei.a)({},l,{role:"toolbar",className:re()(t,d)}))},t}(S.a.Component),ax=Object(oo.a)("btn-toolbar",ox);function sx(){var e=Object(ks.b)(),t=e.autoCompile,n=e.compiling,r=e.draft,a=e.hasChanges,l=e.setAutoCompile,d=e.setDraft,h=e.setStopOnValidationError,p=e.stopOnValidationError,f=e.startCompile,y=e.stopCompile,w=e.recompileFromScratch,x=Object(Mt.a)().t;return Object(R.jsxs)($y,{className:re()({"toolbar-item":!0,"btn-recompile-group":!0,"btn-recompile-group-has-changes":a}),id:"pdf-recompile-dropdown",children:[Object(R.jsx)(Hu,{startCompile:f,compiling:n}),Object(R.jsx)(Co.Toggle,{"aria-label":x("toggle_compile_options_menu"),className:"btn-recompile",bsStyle:"success"}),Object(R.jsxs)(Co.Menu,{children:[Object(R.jsx)(ko,{header:!0,children:x("auto_compile")}),Object(R.jsxs)(ko,{onSelect:function(){return l(!0)},children:[Object(R.jsx)(Pr.a,{type:t?"check":"",fw:!0}),x("on")]}),Object(R.jsxs)(ko,{onSelect:function(){return l(!1)},children:[Object(R.jsx)(Pr.a,{type:t?"":"check",fw:!0}),x("off")]}),Object(R.jsx)(ko,{header:!0,children:x("compile_mode")}),Object(R.jsxs)(ko,{onSelect:function(){return d(!1)},children:[Object(R.jsx)(Pr.a,{type:r?"":"check",fw:!0}),x("normal")]}),Object(R.jsxs)(ko,{onSelect:function(){return d(!0)},children:[Object(R.jsx)(Pr.a,{type:r?"check":"",fw:!0}),x("fast")," ",Object(R.jsx)("span",{className:"subdued",children:"[draft]"})]}),Object(R.jsx)(ko,{header:!0,children:"Syntax Checks"}),Object(R.jsxs)(ko,{onSelect:function(){return h(!0)},children:[Object(R.jsx)(Pr.a,{type:p?"check":"",fw:!0}),x("stop_on_validation_error")]}),Object(R.jsxs)(ko,{onSelect:function(){return h(!1)},children:[Object(R.jsx)(Pr.a,{type:p?"":"check",fw:!0}),x("ignore_validation_errors")]}),Object(R.jsx)(ko,{divider:!0}),Object(R.jsx)(ko,{onSelect:y,disabled:!n,"aria-disabled":!n,children:x("stop_compile")}),Object(R.jsx)(ko,{onSelect:w,disabled:n,"aria-disabled":n,children:x("recompile_from_scratch")})]})]})}var lx=Object(C.memo)(sx);function cx(){var e=Pe(),t=e.pdfLayout,n=e.switchLayout,r=Object(Mt.a)().t,a=Object(C.useMemo)((function(){return r("sideBySide"===t?"full_screen":"split_screen")}),[t,r]);return Object(R.jsx)(hi.a,{placement:"left",overlay:Object(R.jsx)(di.a,{id:"expand-pdf-btn",children:a}),children:Object(R.jsx)(Ir.a,{onClick:n,className:"toolbar-pdf-expand-btn toolbar-item","aria-label":a,children:Object(R.jsx)(Pr.a,{type:"sideBySide"===t?"expand":"compress"})})})}var ux=Object(C.memo)(cx),dx=(n(468),n(253)),hx=n.n(dx),px=n(61),fx=function(e){function t(){return e.apply(this,arguments)||this}Object($i.a)(t,e);var n=t.prototype;return n.hasContent=function(e){var t=!1;return S.a.Children.forEach(e,(function(e){t||(e||0===e)&&(t=!0)})),t},n.render=function(){var e=this.props,t=e.className,n=e.children,r=Object(Ai.a)(e,["className","children"]),a=Object(oo.f)(r),l=a[0],d=a[1],h=Object(Ei.a)({},Object(oo.d)(l),{hidden:!this.hasContent(n)});return S.a.createElement("span",Object(Ei.a)({},d,{className:re()(t,h)}),n)},t}(S.a.Component),gx=Object(oo.a)("label",Object(oo.c)(hx()(px.d).concat([px.e.DEFAULT,px.e.PRIMARY]),px.e.DEFAULT,fx));function mx(){var e,t,n=Object(ks.b)(),r=n.error,a=n.logEntries,l=n.setShowLogs,d=n.showLogs,h=Object(Mt.a)().t,p=Object(C.useCallback)((function(){l((function(e){return e||Object(xe.c)("ide-open-logs-once"),!e}))}),[l]),f=Number(null==a||null===(e=a.errors)||void 0===e?void 0:e.length),y=f+Number(null==a||null===(t=a.warnings)||void 0===t?void 0:t.length);return Object(R.jsx)(hi.a,{placement:"bottom",overlay:Object(R.jsx)(di.a,{id:"tooltip-logs-toggle",children:h("logs_and_output_files")}),children:Object(R.jsxs)(Ir.a,{bsStyle:"link",disabled:Boolean(r),active:d,className:"toolbar-item log-btn",onClick:p,style:{position:"relative"},"aria-label":h(d?"view_pdf":"view_logs"),children:[Object(R.jsx)(Pr.a,{type:"file-text-o",fw:!0}),!d&&y>0&&Object(R.jsx)(gx,{bsStyle:0===f?"warning":"danger",children:y})]})})}var vx=Object(C.memo)(mx);function bx(){var e=Object(ks.b)().pdfDownloadUrl,t=Object(Mt.a)().t;return Object(R.jsx)(hi.a,{placement:"bottom",overlay:Object(R.jsx)(di.a,{id:"tooltip-logs-toggle",children:t(e?"download_pdf":"please_compile_pdf_before_download")}),children:Object(R.jsx)(Ir.a,{bsStyle:"link",disabled:!e,download:!0,href:e||"#",target:"_blank",style:{pointerEvents:"auto"},children:Object(R.jsx)(Pr.a,{type:"download",fw:!0})})})}var yx=Object(C.memo)(bx);function wx(){var e=Object(ks.b)(),t=e.codeCheckFailed,n=e.error,r=e.setShowLogs,a=Object(Mt.a)().t,l=Object(C.useCallback)((function(){r((function(e){return e||Object(xe.c)("ide-open-logs-once"),!e}))}),[r]);return t?Object(R.jsxs)(Ir.a,{bsSize:"xsmall",bsStyle:"danger",disabled:Boolean(n),className:"btn-toggle-logs toolbar-item",onClick:l,children:[Object(R.jsx)(Pr.a,{type:"exclamation-triangle"}),Object(R.jsx)("span",{className:"toolbar-text toolbar-hide-small",children:a("code_check_failed")})]}):null}var xx=Object(C.memo)(wx),jx=function(){window.location=ce(null).toString()};function Ox(){var e=Object(Mt.a)().t;return Object(R.jsx)(Ir.a,{onClick:jx,className:"btn-orphan",bsStyle:"primary",bsSize:"small",children:e("redirect_to_editor")})}var Cx=Object(C.memo)(Ox);n(330);function Sx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kx=Object(le.a)("ol-debugPdfDetach");function Ex(e,t,n,r){var a=Sx(Object(C.useState)(t),2),l=a[0],d=a[1],h=we(),p=h.role,f=h.broadcastEvent,y=h.addEventHandler,w=h.deleteEventHandler,x="state-".concat(e);Object(C.useEffect)((function(){p===n&&f(x,{value:l})}),[p,n,x,l,f]);var j=Object(C.useCallback)((function(e){e.event===x&&p===r&&(kx&&console.log("Set ".concat(e.data.value," for ").concat(x)),d(e.data.value))}),[p,r,x,d]);return Object(C.useEffect)((function(){return y(j),function(){return w(j)}}),[y,w,j]),[l,d]}function Ax(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Tx(e){var t=e.position,n=e.syncToCode,r=e.syncToCodeInFlight,a=e.isDetachLayout,l=Object(Mt.a)().t,d=a?"bottom":"right",h=re()("synctex-control",{"detach-synctex-control":!!a}),p=null;return r?p=Object(R.jsx)(Pr.a,{type:"refresh",spin:!0,className:"synctex-spin-icon"}):a||(p=Object(R.jsx)(Pr.a,{type:"arrow-left",className:"synctex-control-icon"})),Object(R.jsx)(hi.a,{placement:d,overlay:Object(R.jsx)(di.a,{id:"sync-to-code-tooltip",children:l("go_to_pdf_location_in_code")}),children:Object(R.jsxs)(Ir.a,{bsStyle:"default",bsSize:"xs",onClick:function(){return n(t,72)},disabled:r,className:h,"aria-label":l("go_to_pdf_location_in_code"),children:[p,a?Object(R.jsxs)("span",{children:[" ",l("show_in_code")]}):""]})})}function Rx(e){var t=e.cursorPosition,n=e.syncToPdf,r=e.syncToPdfInFlight,a=e.isDetachLayout,l=Object(Mt.a)().t,d=a?"bottom":"right",h=re()("synctex-control",{"detach-synctex-control":!!a}),p=null;return r?p=Object(R.jsx)(Pr.a,{type:"refresh",spin:!0,className:"synctex-spin-icon"}):a||(p=Object(R.jsx)(Pr.a,{type:"arrow-right",className:"synctex-control-icon"})),Object(R.jsx)(hi.a,{placement:d,overlay:Object(R.jsx)(di.a,{id:"sync-to-pdf-tooltip",children:l("go_to_code_location_in_pdf")}),children:Object(R.jsxs)(Ir.a,{bsStyle:"default",bsSize:"xs",onClick:function(){return n(t)},disabled:r||!t,className:h,"aria-label":l("go_to_code_location_in_pdf"),children:[p,a?Object(R.jsxs)("span",{children:[" ",l("show_in_pdf")]}):""]})})}function Ix(){var e=Object(_e.b)(),t=Object(A.c)()._id,n=Pe().detachRole,r=Object(ks.b)(),a=r.clsiServerId,l=r.pdfUrl,d=r.pdfViewer,h=r.position,p=r.setShowLogs,f=r.setHighlights,y=Ax(Object(C.useState)((function(){var t=ke.a.getItem("doc.position.".concat(e.editorManager.getCurrentDocId()));return t?t.cursorPosition:null})),2),w=y[0],x=y[1],j=ef(),O=Object(ea.a)().signal,S=Ax(Ex("pdf-exists",!!l,"detached","detacher"),2),_=S[0],k=S[1];Object(C.useEffect)((function(){k(!!l)}),[l,k]),Object(C.useEffect)((function(){var e=function(e){return x(e.detail)};return window.addEventListener("cursor:editor:update",e),function(){return window.removeEventListener("cursor:editor:update",e)}}),[e]);var E=Ax(Ex("sync-to-pdf-inflight",!1,"detached","detacher"),2),T=E[0],I=E[1],P=Ax(Object(C.useState)(!1),2),D=P[0],M=P[1],L=Ax(Object(oe.a)("sync_tex_error"),2)[1],F=Object(C.useCallback)((function(){var t=e.editorManager.getCurrentDocId(),n=e.fileTreeManager.findEntityById(t),r=e.fileTreeManager.getEntityPath(n),a=e.fileTreeManager.getRootDocDirname();return a&&(r=r.replace(RegExp("^".concat(a)),"".concat(a,"/."))),r}),[e]),q=Nu("go-to-code-line",Object(C.useCallback)((function(t,n){if(t){var r=e.fileTreeManager.findEntityByPath(t);e.editorManager.openDoc(r,{gotoLine:n})}else L(!0),window.setTimeout((function(){j.current&&L(!1)}),4e3)}),[e,j,L]),"detached","detacher"),N=Nu("go-to-pdf-location",Object(C.useCallback)((function(e){I(!0),a&&(e+="&clsiserverid=".concat(a)),Object(B.c)("/project/".concat(t,"/sync/code?").concat(e),{signal:O}).then((function(e){p(!1),f(e.pdf)})).catch((function(e){console.error(e)})).finally((function(){j.current&&I(!1)}))}),[a,j,t,p,f,I,O]),"detacher","detached"),U=Object(C.useCallback)((function(e){var t=new URLSearchParams({file:F(),line:e.row+1,column:e.column}).toString();N(t)}),[F,N]),H=Object(C.useCallback)((function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;M(!0);var l=e.offset.left,d=0;null!==(n=e.pageSize)&&void 0!==n&&n.height?d+=e.pageSize.height-e.offset.top:d+=e.offset.top,d+=r;var h=new URLSearchParams({page:e.page+1,h:l.toFixed(2),v:d.toFixed(2)});a&&h.set("clsiserverid",a),Object(B.c)("/project/".concat(t,"/sync/pdf?").concat(h),{signal:O}).then((function(e){var t=Ax(e.code,1)[0],n=t.file,r=t.line;q(n,r)})).catch((function(e){console.error(e)})).finally((function(){j.current&&M(!1)}))}),[a,t,O,j,M,q]);return Object(C.useEffect)((function(){var e=function(e){return H(e.detail)};return window.addEventListener("synctex:sync-to-position",e),function(){window.removeEventListener("synctex:sync-to-position",e)}}),[H]),h&&_&&"native"!==d?"detacher"===n?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Rx,{cursorPosition:w,syncToPdf:U,syncToPdfInFlight:T,isDetachLayout:!0})}):"detached"===n?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(Tx,{position:h,syncToCode:H,syncToCodeInFlight:D,isDetachLayout:!0})}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Rx,{cursorPosition:w,syncToPdf:U,syncToPdfInFlight:T}),Object(R.jsx)(Tx,{position:h,syncToCode:H,syncToCodeInFlight:D})]}):null}var Px=Object(C.memo)(Ix);function Dx(){var e=Pe(Mx),t=e.detachRole,n=e.detachIsLinked;return"detached"===t&&n?Object(R.jsx)(Px,{}):null}Tx.propTypes={isDetachLayout:k.a.bool,position:k.a.object.isRequired,syncToCode:k.a.func.isRequired,syncToCodeInFlight:k.a.bool.isRequired},Rx.propTypes={cursorPosition:k.a.object,isDetachLayout:k.a.bool,syncToPdf:k.a.func.isRequired,syncToPdfInFlight:k.a.bool.isRequired};var Mx={detachRole:k.a.string,detachIsLinked:k.a.bool};function Lx(){var e=Pe(),t=e.detachRole,n=!e.detachIsLinked&&"detached"===t;return Object(R.jsx)(ax,{className:"toolbar toolbar-pdf toolbar-pdf-hybrid",children:n?Object(R.jsx)(qx,{}):Object(R.jsx)(Fx,{})})}function Fx(){return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"toolbar-pdf-left",children:[Object(R.jsx)(lx,{}),Object(R.jsx)(vx,{}),Object(R.jsx)(yx,{})]}),Object(R.jsxs)("div",{className:"toolbar-pdf-right",children:[Object(R.jsx)(xx,{}),!window.showPdfDetach&&Object(R.jsx)(ux,{}),Object(R.jsx)(Dx,{})]})]})}function qx(){var e=Object(Mt.a)().t;return Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)("div",{className:"toolbar-pdf-orphan",children:[e("tab_no_longer_connected"),Object(R.jsx)(Cx,{})]})})}var Nx=Object(C.memo)(Lx);function Bx(){var e=Object(ks.b)(),t=e.compiling,n=e.pdfDownloadUrl,r=e.fileList,a=Object(Mt.a)().t,l=t||!n;return Object(R.jsxs)($y,{id:"pdf-download-dropdown",className:"toolbar-item",disabled:l,children:[Object(R.jsxs)(Ir.a,{bsSize:"xsmall",bsStyle:"info",disabled:t||!n,download:!0,href:n||"#",children:[Object(R.jsx)(Pr.a,{type:"download",fw:!0}),Object(R.jsx)("span",{className:"toolbar-text toolbar-hide-medium toolbar-hide-small",children:a("download_pdf")})]}),Object(R.jsx)(Co.Toggle,{bsSize:"xsmall",bsStyle:"info",className:"dropdown-toggle","aria-label":a("toggle_output_files_list"),disabled:!r}),Object(R.jsx)(Co.Menu,{id:"download-dropdown-list",children:Object(R.jsx)(Fw,{fileList:r})})]})}var Ux=Object(C.memo)(Bx);function Hx(e){var t,n,r,a=e.showLogs,l=e.logEntries,d=e.codeCheckFailed,h=Object(Mt.a)().t;if(a)return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"file-pdf-o"}),Object(R.jsx)("span",{className:"toolbar-text toolbar-hide-small",children:h("view_pdf")})]});if(d)return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"exclamation-triangle"}),Object(R.jsx)("span",{className:"toolbar-text toolbar-hide-small",children:h("code_check_failed")})]});var p=(null==l||null===(t=l.errors)||void 0===t?void 0:t.length)||(null==l||null===(n=l.warnings)||void 0===n?void 0:n.length);return p?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"file-text-o"}),Object(R.jsxs)("span",{className:"btn-toggle-logs-label toolbar-text toolbar-hide-small",children:[null!==(r=l.errors)&&void 0!==r&&r.length?h("your_project_has_an_error",{count:p}):h("view_warning",{count:p}),Object(R.jsx)("span",{className:"sr-hidden",children:p>1&&" (".concat(p>99?"99+":p,")")})]})]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Pr.a,{type:"file-text-o"}),Object(R.jsx)("span",{className:"toolbar-text toolbar-hide-small",children:h("view_logs")})]})}Hx.propTypes={codeCheckFailed:k.a.bool,showLogs:k.a.bool,logEntries:k.a.object};function zx(){var e=Object(ks.b)(),t=e.codeCheckFailed,n=e.error,r=e.logEntries,a=e.showLogs,l=e.setShowLogs,d=Object(C.useMemo)((function(){if(a)return"default";if(t)return"danger";if(r){var e,n;if(null!==(e=r.errors)&&void 0!==e&&e.length)return"danger";if(null!==(n=r.warnings)&&void 0!==n&&n.length)return"warning"}return"default"}),[t,r,a]),h=Object(C.useCallback)((function(){l((function(e){return e||Object(xe.c)("ide-open-logs-once"),!e}))}),[l]);return Object(R.jsx)(Ir.a,{bsSize:"xsmall",bsStyle:d,disabled:Boolean(n),className:"btn-toggle-logs toolbar-item",onClick:h,children:Object(R.jsx)(Hx,{showLogs:a,logEntries:r,codeCheckFailed:t})})}var Vx=Object(C.memo)(zx);function Wx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||Gx(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kx(e){return function(e){if(Array.isArray(e))return Yx(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gx(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gx(e,t){if(e){if("string"==typeof e)return Yx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yx(e,t):void 0}}function Yx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xx(e){var t=Wx(Object(C.useState)(2),2),n=t[0],r=t[1],a=Wx(Object(C.useState)(!0),2),l=a[0],d=a[1],h=Wx(Object(C.useState)((function(){if("ResizeObserver"in window)return new ResizeObserver((function(){r(2),d(!0)}))})),1)[0],p=Wx(Object(C.useState)((function(){return new MutationObserver((function(){r(2),d(!0)}))})),1)[0];return Object(C.useEffect)((function(){if(e&&p&&h)return h.observe(e),p.observe(e,{childList:!0,subtree:!0,characterData:!0}),function(){p.disconnect(),h.disconnect()}}),[e,p,h]),Object(C.useLayoutEffect)((function(){l&&e&&n&&(function(e){return Kx(e.querySelectorAll("button")).reduce((function(e,t){return e+t.scrollWidth}),0)}(e)+150>e.clientWidth?r((function(e){return e-1})):d(!1))}),[e,n,l]),Object(C.useMemo)((function(){return re()({toolbar:!0,"toolbar-pdf":!0,"toolbar-large":2===n,"toolbar-medium":1===n,"toolbar-small":0===n})}),[n])}function Jx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qx(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zx=new URLSearchParams(window.location.search).get("preview");function ej(){var e=Jx(Object(C.useState)(),2),t=e[0],n=e[1],r=Xx(t);return Object(R.jsx)("div",{ref:function(e){return n(e)},children:Object(R.jsxs)(ax,{className:r,children:[Object(R.jsxs)("div",{className:"toolbar-pdf-left",children:[Object(R.jsx)(lx,{}),Object(R.jsx)(Ux,{})]}),Object(R.jsxs)("div",{className:"toolbar-pdf-right",children:[Object(R.jsx)(Vx,{}),!Zx&&Object(R.jsx)(ux,{})]})]})})}var tj=Object(C.memo)(ej),nj=new URLSearchParams(window.location.search).has("new_preview_toolbar");function rj(){return Object(R.jsxs)("div",{className:"pdf full-size",children:[nj?Object(R.jsx)(tj,{}):Object(R.jsx)(Nx,{}),Object(R.jsx)(C.Suspense,{fallback:Object(R.jsx)(ij,{}),children:Object(R.jsx)("div",{className:"pdf-viewer",children:Object(R.jsx)(ix,{})})}),Object(R.jsx)(tx,{})]})}function ij(){return Object(R.jsx)("div",{className:"pdf-loading-spinner-container",children:Object(R.jsx)(_h.a,{})})}var oj=Object(C.memo)(rj),aj=n(365),sj=Object(le.a)("ol-showPdfDetach"),lj=Object(le.a)("ol-debugPdfDetach");function cj(){return function(){var e=Object(ks.b)(),t=e.startCompile,n=e.setChangedAt,r=e.cleanupCompileResult,a=e.setError,l=we().role,d=Nu("start-compile",t,"detacher","detached"),h=Object(C.useCallback)((function(e){sj?d(e.detail):t(e.detail)}),[d,t]);Object(aj.a)("pdf:recompile",h);var p=Nu("set-changed-at",n,"detacher","detached"),f=Object(C.useCallback)((function(){sj?p(Date.now()):n(Date.now())}),[p,n]);Object(aj.a)("doc:changed",f),Object(aj.a)("doc:saved",f);var y=je(l);Object(C.useEffect)((function(){y&&!l&&(lj&&console.log("Recompile on reattach",{previousDetachRole:y,detachRole:l}),r(),a(),t())}),[r,a,t,y,l])}(),Object(R.jsx)(oj,{})}var uj,dj,hj=Object(E.a)(Object(C.memo)(cj),(function(){return Object(R.jsx)(Vw.a,{type:"preview"})}));function pj(e,t,n){var r;return function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(t,n){if(e||!window.grecaptcha)return t();try{uj||(uj=window.grecaptcha.render("recaptcha",{callback:function(e){dj&&(dj(e),dj=void 0),window.grecaptcha.reset()}})),dj=t}catch(e){n(e)}}))}(null===(r=window.ExposedSettings.recaptchaDisabled)||void 0===r?void 0:r.invite).then((function(r){return Object(B.d)("/project/".concat(e,"/invite"),{body:{email:t,privileges:n,"g-recaptcha-response":r}})}))}function fj(e,t){return Object(B.d)("/project/".concat(e,"/invite/").concat(t._id,"/resend"))}function gj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vj(e){var t=e.member,n=e.cancel,r=gj(Object(C.useState)(!1),2),a=r[0],l=r[1],d=gj(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Object(A.c)(),y=f._id,w=f.name;return Object(R.jsxs)(wi.a,{show:!0,onHide:n,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:Object(R.jsx)(_i.a,{i18nKey:"change_project_owner"})})}),Object(R.jsxs)(yi.a.Body,{children:[Object(R.jsx)("p",{children:Object(R.jsx)(_i.a,{i18nKey:"project_ownership_transfer_confirmation_1",values:{user:t.email,project:w},components:[Object(R.jsx)("strong",{},"strong-1"),Object(R.jsx)("strong",{},"strong-2")]})}),Object(R.jsx)("p",{children:Object(R.jsx)(_i.a,{i18nKey:"project_ownership_transfer_confirmation_2"})})]}),Object(R.jsxs)(yi.a.Footer,{children:[Object(R.jsxs)("div",{className:"modal-footer-left",children:[a&&Object(R.jsx)(Pr.a,{type:"refresh",spin:!0}),h&&Object(R.jsx)("span",{className:"text-danger",children:Object(R.jsx)(_i.a,{i18nKey:"generic_something_went_wrong"})})]}),Object(R.jsxs)("div",{className:"modal-footer-right",children:[Object(R.jsx)(Ir.a,{type:"button",bsStyle:"default",onClick:n,disabled:a,children:Object(R.jsx)(_i.a,{i18nKey:"cancel"})}),Object(R.jsx)(Ir.a,{type:"button",bsStyle:"success",onClick:function(){p(!1),l(!0),function(e,t){return Object(B.d)("/project/".concat(e,"/transfer-ownership"),{body:{user_id:t._id}})}(y,t).then((function(){window.location.reload()})).catch((function(){p(!0),l(!1)}))},disabled:a,children:Object(R.jsx)(_i.a,{i18nKey:"change_owner"})})]})]})]})}function bj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bj(Object(n),!0).forEach((function(t){wj(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oj(e){var t=e.member,n=xj(Object(C.useState)(t.privileges),2),r=n[0],a=n[1],l=xj(Object(C.useState)(!1),2),d=l[0],h=l[1];Object(C.useEffect)((function(){a(t.privileges)}),[t.privileges]);var p=EO(),f=p.updateProject,y=p.monitorRequest,w=Object(A.c)(),x=w._id,j=w.members;return d?Object(R.jsx)(vj,{member:t,cancel:function(){return h(!1)}}):Object(R.jsx)(Zp.a,{horizontal:!0,id:"share-project-form",onSubmit:function(e){e.preventDefault(),"owner"===r?h(!0):y((function(){return function(e,t,n){return Object(B.e)("/project/".concat(e,"/users/").concat(t._id),{body:n})}(x,t,{privilegeLevel:r})})).then((function(){f({members:j.map((function(e){return e._id===t._id?yj(yj({},e),{},{privileges:r}):e}))})}))},children:Object(R.jsxs)(Jo.a,{className:"project-member",children:[Object(R.jsx)(dp.a,{xs:7,children:Object(R.jsx)(Zo.a.Static,{children:t.email})}),Object(R.jsx)(dp.a,{xs:3,children:Object(R.jsx)(Cj,{value:r,handleChange:function(e){return a(e.target.value)}})}),Object(R.jsx)(dp.a,{xs:2,children:r===t.privileges?Object(R.jsx)(Sj,{member:t}):Object(R.jsx)(_j,{handleReset:function(){return a(t.privileges)}})})]})})}function Cj(e){var t=e.value,n=e.handleChange,r=Object(Mt.a)().t;return Object(R.jsxs)(Zo.a,{componentClass:"select",className:"privileges",bsSize:"sm",value:t,onChange:n,children:[Object(R.jsx)("option",{value:"owner",children:r("owner")}),Object(R.jsx)("option",{value:"readAndWrite",children:r("can_edit")}),Object(R.jsx)("option",{value:"readOnly",children:r("read_only")})]})}function Sj(e){var t=e.member,n=Object(Mt.a)().t,r=EO(),a=r.updateProject,l=r.monitorRequest,d=Object(A.c)(),h=d._id,p=d.members;return Object(R.jsx)(Zo.a.Static,{className:"text-center",children:Object(R.jsx)(hi.a,{placement:"bottom",overlay:Object(R.jsx)(di.a,{id:"tooltip-remove-collaborator",children:Object(R.jsx)(_i.a,{i18nKey:"remove_collaborator"})}),children:Object(R.jsx)(Ir.a,{type:"button",bsStyle:"link",onClick:function(e){e.preventDefault(),l((function(){return function(e,t){return Object(B.b)("/project/".concat(e,"/users/").concat(t._id))}(h,t)})).then((function(){a({members:p.filter((function(e){return e!==t}))})}))},className:"remove-button","aria-label":n("remove_collaborator"),children:Object(R.jsx)(Pr.a,{type:"times"})})})})}function _j(e){var t=e.handleReset;return Object(R.jsxs)("div",{className:"text-center",children:[Object(R.jsx)(Ir.a,{type:"submit",bsSize:"sm",bsStyle:"success",children:Object(R.jsx)(_i.a,{i18nKey:"change_or_cancel-change"})}),Object(R.jsxs)("div",{className:"text-sm",children:[Object(R.jsx)(_i.a,{i18nKey:"change_or_cancel-or"})," ",Object(R.jsx)(Ir.a,{type:"button",className:"btn-inline-link",onClick:t,children:Object(R.jsx)(_i.a,{i18nKey:"change_or_cancel-cancel"})})]})]})}function kj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ej(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ej(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ej(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Aj(){var e=kj(Object(C.useState)(!1),2),t=e[0],n=e[1],r=EO().monitorRequest,a=Object(A.c)(),l=a._id,d=a.publicAccessLevel,h=Object(C.useCallback)((function(e){n(!0),r((function(){return function(e,t){return Object(B.d)("/project/".concat(e,"/settings/admin"),{body:{publicAccessLevel:t}})}(l,e)})).then((function(){})).finally((function(){n(!1)}))}),[r,l]);switch(d){case"private":return Object(R.jsx)($j,{setAccessLevel:h,inflight:t});case"tokenBased":return Object(R.jsx)(Tj,{setAccessLevel:h,inflight:t});case"readAndWrite":case"readOnly":return Object(R.jsx)(Rj,{setAccessLevel:h,accessLevel:d,inflight:t});default:return null}}function $j(e){var t=e.setAccessLevel,n=e.inflight;return Object(R.jsx)(up.a,{className:"public-access-level",children:Object(R.jsxs)(dp.a,{xs:12,className:"text-center",children:[Object(R.jsx)(_i.a,{i18nKey:"link_sharing_is_off"}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Ir.a,{type:"button",bsStyle:"link",className:"btn-inline-link",onClick:function(){t("tokenBased"),xe.b("link-sharing-click")},disabled:n,children:Object(R.jsx)(_i.a,{i18nKey:"turn_on_link_sharing"})}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Dj,{})]})})}function Tj(e){var t=e.setAccessLevel,n=e.inflight,r=Object(A.c)().tokens;return Object(R.jsxs)(up.a,{className:"public-access-level",children:[Object(R.jsxs)(dp.a,{xs:12,className:"text-center",children:[Object(R.jsx)("strong",{children:Object(R.jsx)(_i.a,{i18nKey:"link_sharing_is_on"})}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Ir.a,{bsStyle:"link",className:"btn-inline-link",onClick:function(){return t("private")},disabled:n,children:Object(R.jsx)(_i.a,{i18nKey:"turn_off_link_sharing"})}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Dj,{})]}),Object(R.jsxs)(dp.a,{xs:12,className:"access-token-display-area",children:[Object(R.jsxs)("div",{className:"access-token-wrapper",children:[Object(R.jsx)("strong",{children:Object(R.jsx)(_i.a,{i18nKey:"anyone_with_link_can_edit"})}),Object(R.jsx)(Pj,{token:null==r?void 0:r.readAndWrite,path:"/",tooltipId:"tooltip-copy-link-rw"})]}),Object(R.jsxs)("div",{className:"access-token-wrapper",children:[Object(R.jsx)("strong",{children:Object(R.jsx)(_i.a,{i18nKey:"anyone_with_link_can_view"})}),Object(R.jsx)(Pj,{token:null==r?void 0:r.readOnly,path:"/read/",tooltipId:"tooltip-copy-link-ro"})]})]})]})}function Rj(e){var t=e.accessLevel,n=e.setAccessLevel,r=e.inflight;return Object(R.jsx)(up.a,{className:"public-access-level",children:Object(R.jsxs)(dp.a,{xs:12,className:"text-center",children:[Object(R.jsxs)("strong",{children:["readAndWrite"===t&&Object(R.jsx)(_i.a,{i18nKey:"this_project_is_public"}),"readOnly"===t&&Object(R.jsx)(_i.a,{i18nKey:"this_project_is_public_read_only"})]}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Ir.a,{type:"button",bsStyle:"link",className:"btn-inline-link",onClick:function(){return n("private")},disabled:r,children:Object(R.jsx)(_i.a,{i18nKey:"make_private"})}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Dj,{})]})})}function Ij(){var e=Object(A.c)().tokens;return Object(R.jsx)(up.a,{className:"public-access-level",children:Object(R.jsx)(dp.a,{xs:12,className:"access-token-display-area",children:Object(R.jsxs)("div",{className:"access-token-wrapper",children:[Object(R.jsx)("strong",{children:Object(R.jsx)(_i.a,{i18nKey:"anyone_with_link_can_view"})}),Object(R.jsx)(Pj,{token:null==e?void 0:e.readOnly,path:"/read/",tooltipId:"tooltip-copy-link-ro"})]})})})}function Pj(e){var t=e.token,n=e.path,r=e.tooltipId;if(!t)return Object(R.jsx)("pre",{className:"access-token",children:Object(R.jsxs)("span",{children:[Object(R.jsx)(_i.a,{i18nKey:"loading"}),"…"]})});var a="".concat(window.location.origin).concat(n).concat(t);return Object(R.jsxs)("pre",{className:"access-token",children:[Object(R.jsx)("span",{children:a}),Object(R.jsx)(Fp,{link:a,tooltipId:r})]})}function Dj(){return Object(R.jsx)(hi.a,{placement:"top",overlay:Object(R.jsx)(di.a,{id:"tooltip-link-sharing-info",children:Object(R.jsx)(_i.a,{i18nKey:"learn_more_about_link_sharing"})}),children:Object(R.jsx)("a",{href:"/learn/how-to/What_is_Link_Sharing%3F",target:"_blank",rel:"noopener",children:Object(R.jsx)(Pr.a,{type:"question-circle"})})})}function Mj(e){switch(e.privileges){case"readAndWrite":return Object(R.jsx)(_i.a,{i18nKey:"can_edit"});case"readOnly":return Object(R.jsx)(_i.a,{i18nKey:"read_only"});default:return null}}function Lj(e){var t=e.invite,n=e.isAdmin;return Object(R.jsxs)(up.a,{className:"project-invite",children:[Object(R.jsxs)(dp.a,{xs:7,children:[Object(R.jsx)("div",{children:t.email}),Object(R.jsxs)("div",{className:"small",children:[Object(R.jsx)(_i.a,{i18nKey:"invite_not_accepted"}),". ",n&&Object(R.jsx)(Fj,{invite:t})]})]}),Object(R.jsx)(dp.a,{xs:3,className:"text-left",children:Object(R.jsx)(Mj,{privileges:t.privileges})}),n&&Object(R.jsx)(dp.a,{xs:2,className:"text-center",children:Object(R.jsx)(qj,{invite:t})})]})}function Fj(e){var t=e.invite,n=EO().monitorRequest,r=Object(A.c)()._id,a=Object(C.useCallback)((function(){return n((function(){return fj(r,t)})).finally((function(){document.activeElement.blur()}))}),[t,n,r]);return Object(R.jsx)(Ir.a,{bsStyle:"link",className:"btn-inline-link",onClick:a,children:Object(R.jsx)(_i.a,{i18nKey:"resend"})})}function qj(e){var t=e.invite,n=Object(Mt.a)().t,r=EO(),a=r.updateProject,l=r.monitorRequest,d=Object(A.c)(),h=d._id,p=d.invites;return Object(R.jsx)(hi.a,{placement:"bottom",overlay:Object(R.jsx)(di.a,{id:"tooltip-revoke-invite",children:Object(R.jsx)(_i.a,{i18nKey:"revoke_invite"})}),children:Object(R.jsx)(Ir.a,{type:"button",bsStyle:"link",onClick:function(e){e.preventDefault(),l((function(){return function(e,t){return Object(B.b)("/project/".concat(e,"/invite/").concat(t._id))}(h,t)})).then((function(){a({invites:p.filter((function(e){return e!==t}))})}))},"aria-label":n("revoke"),className:"btn-inline-link",children:Object(R.jsx)(Pr.a,{type:"times"})})})}y.a.component("pdfPreview",Object(x.react2angular)(Ys.use(hj),[])),y.a.component("pdfSynctexControls",Object(x.react2angular)(Ys.use(Px),[])),y.a.component("detacherSynctexControl",Object(x.react2angular)(Ys.use((function(){var e=Pe(Mx),t=e.detachRole,n=e.detachIsLinked;return"detacher"===t&&n?Object(R.jsx)(Px,{}):null})),[])),vj.propTypes={member:k.a.object.isRequired,cancel:k.a.func.isRequired},Oj.propTypes={member:k.a.shape({_id:k.a.string.isRequired,email:k.a.string.isRequired,privileges:k.a.string.isRequired})},Cj.propTypes={value:k.a.string.isRequired,handleChange:k.a.func.isRequired},Sj.propTypes={member:k.a.shape({_id:k.a.string.isRequired,email:k.a.string.isRequired,privileges:k.a.string.isRequired})},_j.propTypes={handleReset:k.a.func.isRequired},$j.propTypes={setAccessLevel:k.a.func.isRequired,inflight:k.a.bool},Tj.propTypes={setAccessLevel:k.a.func.isRequired,inflight:k.a.bool},Rj.propTypes={accessLevel:k.a.string.isRequired,setAccessLevel:k.a.func.isRequired,inflight:k.a.bool},Pj.propTypes={token:k.a.string,tooltipId:k.a.string.isRequired,path:k.a.string.isRequired},Mj.propTypes={privileges:k.a.string.isRequired},Lj.propTypes={invite:k.a.object.isRequired,isAdmin:k.a.bool.isRequired},Fj.propTypes={invite:k.a.object.isRequired},qj.propTypes={invite:k.a.object.isRequired};var Nj=n(225);function Bj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bj(Object(n),!0).forEach((function(t){Hj(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zj(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Wj(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function Vj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||Wj(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wj(e,t){if(e){if("string"==typeof e)return Kj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kj(e,t):void 0}}function Kj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gj=/[\u061C\u2000-\u200F\u202A-\u202E\u2060\u2066-\u2069\u2028\u2029\u202F]/g;function Yj(e){var t=e.loading,n=e.options,r=e.placeholder,a=e.multipleSelectionProps,l=a.getSelectedItemProps,d=a.getDropdownProps,h=a.addSelectedItem,p=a.removeSelectedItem,f=a.selectedItems,y=Vj(Object(C.useState)(""),2),w=y[0],x=y[1],j=Object(C.useMemo)((function(){return f.map((function(e){return e.email}))}),[f]),O=Object(C.useMemo)((function(){return n.filter((function(e){return!j.includes(e.email)}))}),[n,j]),S=Object(C.useMemo)((function(){return""===w?O:Fg(O,w,{keys:["name","email"],threshold:Fg.rankings.CONTAINS,baseSort:function(e,t){return e.index-t.index>0?1:-1}})}),[O,w]),_=Object(C.useRef)(null),k=Object(C.useCallback)((function(){_.current&&window.setTimeout((function(){_.current.focus()}),10)}),[_]),E=Object(C.useMemo)((function(){if(w.includes("@")){var e,t=zj(f);try{for(t.s();!(e=t.n()).done;){if(e.value.email===w)return!1}}catch(e){t.e(e)}finally{t.f()}}return!0}),[w,f]),A=Object(Nj.a)({inputValue:w,defaultHighlightedIndex:0,items:S,itemToString:function(e){return e&&e.name},onStateChange:function(e){e.inputValue;var t=e.type,n=e.selectedItem;switch(t){case Nj.a.stateChangeTypes.InputKeyDownEnter:case Nj.a.stateChangeTypes.ItemClick:case Nj.a.stateChangeTypes.InputBlur:n&&(x(""),h(n))}}}),T=A.isOpen,I=A.getLabelProps,P=A.getMenuProps,D=A.getInputProps,M=A.getComboboxProps,L=A.highlightedIndex,F=A.getItemProps,q=A.reset,N=Object(C.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.replace(Gj,"");if(E&&n.includes("@")&&!j.includes(n))return h({email:n,display:n,type:"user"}),x(""),q(),t&&k(),!0}),[h,j,E,k,q]);return Object(C.useEffect)((function(){T&&0===S.length&&q()}),[q,T,S.length]),Object(R.jsxs)("div",{className:"tags-input",children:[Object(R.jsxs)("label",Uj(Uj({className:"small"},I()),{},{children:[Object(R.jsx)(_i.a,{i18nKey:"share_with_your_collabs"})," ",t&&Object(R.jsx)(Pr.a,{type:"refresh",spin:!0})]})),Object(R.jsxs)("div",{className:"host",children:[Object(R.jsxs)("div",Uj(Uj({},M()),{},{className:"tags",onClick:k,children:[f.map((function(e,t){return Object(R.jsx)(Jj,{removeSelectedItem:p,selectedItem:e,focusInput:k,index:t,getSelectedItemProps:l},"selected-item-".concat(t))})),Object(R.jsx)("input",Uj({},D(d({className:re()({input:!0,"invalid-tag":!E}),type:"email",placeholder:r,size:w.length?w.length+5:r.length,ref:_,onBlur:function(){T||N(w,!1)},onChange:function(e){x(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation();break;case"Tab":!T&&N(w)&&(e.preventDefault(),e.stopPropagation());break;case",":e.preventDefault(),N(w)}},onPaste:function(e){var t,n,r,a=null!==(t=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain"))&&void 0!==t?t:null===(r=window.clipboardData)||void 0===r?void 0:r.getData("text");if(a){var l=a.split(/\s*,\s*/).filter((function(e){return e.includes("@")}));if(l.length){e.preventDefault();var d,h=zj(l);try{for(h.s();!(d=h.n()).done;){var p=d.value;N(p)}}catch(e){h.e(e)}finally{h.f()}}}}}))))]})),Object(R.jsx)("div",{className:re()({autocomplete:T}),children:Object(R.jsx)("ul",Uj(Uj({},P()),{},{className:"suggestion-list",children:T&&S.map((function(e,t){return Object(R.jsx)(Xj,{index:t,item:e,selected:t===L,getItemProps:F},e.email)}))}))})]})]})}function Xj(e){var t=e.selected,n=e.item,r=e.getItemProps,a=e.index;return Object(R.jsxs)("li",Uj(Uj({className:re()("suggestion-item",{selected:t})},r({item:n,index:a})),{},{children:[Object(R.jsx)(Pr.a,{type:"user",fw:!0})," ",n.display]}))}function Jj(e){var t=e.removeSelectedItem,n=e.selectedItem,r=e.focusInput,a=e.getSelectedItemProps,l=e.index,d=Object(Mt.a)().t,h=Object(C.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),t(n),r()}),[r,t,n]);return Object(R.jsxs)("span",Uj(Uj({className:"tag-item"},a({selectedItem:n,index:l})),{},{children:[Object(R.jsx)(Pr.a,{type:"user",fw:!0}),Object(R.jsx)("span",{children:n.display}),Object(R.jsx)("button",{type:"button",className:"remove-button btn-inline-link","aria-label":d("remove"),onClick:h,children:Object(R.jsx)(Pr.a,{type:"close",fw:!0})})]}))}function Qj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qj(Object(n),!0).forEach((function(t){eO(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rO(e){var t=tO(e.email.split("@"),1)[0],n=e.last_name||e.first_name!==t?[e.first_name,e.last_name].filter(Boolean).join(" "):"";return Zj(Zj({},e),{},{name:n,display:n?"".concat(n," <").concat(e.email,">"):e.email})}function iO(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lO(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,d=!0,h=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return d=e.done,e},e:function(e){h=!0,l=e},f:function(){try{d||null==n.return||n.return()}finally{if(h)throw l}}}}function oO(e,t,n,r,a,l,d){try{var h=e[l](d),p=h.value}catch(e){return void n(e)}h.done?t(p):Promise.resolve(p).then(r,a)}function aO(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function d(e){oO(l,r,a,d,h,"next",e)}function h(e){oO(l,r,a,d,h,"throw",e)}d(void 0)}))}}function sO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||lO(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lO(e,t){if(e){if("string"==typeof e)return cO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cO(e,t):void 0}}function cO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uO(){var e=sO(Object(C.useState)("readAndWrite"),2),t=e[0],n=e[1],r=ef(),a=function(){var e=tO(Object(C.useState)(!0),2),t=e[0],n=e[1],r=tO(Object(C.useState)(null),2),a=r[0],l=r[1],d=tO(Object(C.useState)(!1),2),h=d[0],p=d[1],f=Object(ea.a)().signal;return Object(C.useEffect)((function(){Object(B.c)("/user/contacts",{signal:f}).then((function(e){l(e.contacts.map(rO))})).catch((function(e){return p(e)})).finally((function(){return n(!1)}))}),[f]),{loading:t,data:a,error:h}}().data,l=Object(Mt.a)().t,d=EO(),h=d.updateProject,p=d.setInFlight,f=d.setError,y=Object(A.c)(),w=y._id,x=y.members,j=y.invites,O=Object(C.useMemo)((function(){return(x||[]).map((function(e){return e.email})).sort()}),[x]),S=Object(C.useMemo)((function(){return a?a.filter((function(e){return!O.includes(e.email)})):null}),[a,O]),_=Object(Nj.b)({initialActiveIndex:0,initialSelectedItems:[]}),k=_.reset,E=_.selectedItems;function T(){return(T=aO(regeneratorRuntime.mark((function e(n){var a,l,d,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),E.length){e.next=3;break}return e.abrupt("return");case 3:k(),f(void 0),p(!0),a=iO(E),e.prev=7,d=regeneratorRuntime.mark((function e(){var n,a,d,y,C,S,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.value,r.current){e.next=3;break}return e.abrupt("return","break");case 3:if(a="user"===n.type?n.email:n.display,d=a.toLowerCase(),!O.includes(d)){e.next=7;break}return e.abrupt("return","continue");case 7:if(y=void 0,e.prev=8,!(C=(j||[]).find((function(e){return e.email===d})))){e.next=16;break}return e.next=13,fj(w,C);case 13:y=e.sent,e.next=19;break;case 16:return e.next=18,pj(w,a,t);case 18:y=e.sent;case 19:e.next=26;break;case 21:return e.prev=21,e.t0=e.catch(8),p(!1),f((null===(S=e.t0.data)||void 0===S?void 0:S.errorReason)||(429===(null===(_=e.t0.response)||void 0===_?void 0:_.status)?"too_many_requests":"generic_something_went_wrong")),e.abrupt("return","break");case 26:return y.error?(f(y.error),p(!1)):y.invite?h({invites:j.concat(y.invite)}):y.users?h({members:x.concat(y.users)}):y.user&&h({members:x.concat(y.user)}),e.next=29,new Promise((function(e){return setTimeout(e,100)}));case 29:case"end":return e.stop()}}),e,null,[[8,21]])})),a.s();case 10:if((l=a.n()).done){e.next=19;break}return e.delegateYield(d(),"t0",12);case 12:if("break"!==(y=e.t0)){e.next=15;break}return e.abrupt("break",19);case 15:if("continue"!==y){e.next=17;break}return e.abrupt("continue",17);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(7),a.e(e.t1);case 24:return e.prev=24,a.f(),e.finish(24);case 27:p(!1);case 28:case"end":return e.stop()}}),e,null,[[7,21,24,27]])})))).apply(this,arguments)}return Object(R.jsxs)(Zp.a,{onSubmit:function(e){return T.apply(this,arguments)},children:[Object(R.jsx)(Jo.a,{children:Object(R.jsx)(Yj,{loading:!S,options:S||[],placeholder:"joe@example.com, sue@example.com, …",multipleSelectionProps:_})}),Object(R.jsx)(Jo.a,{children:Object(R.jsxs)("div",{className:"pull-right",children:[Object(R.jsxs)(Zo.a,{componentClass:"select",className:"privileges",bsSize:"sm",value:t,onChange:function(e){return n(e.target.value)},children:[Object(R.jsx)("option",{value:"readAndWrite",children:l("can_edit")}),Object(R.jsx)("option",{value:"readOnly",children:l("read_only")})]}),Object(R.jsx)("span",{children:"  "}),Object(R.jsx)(Ir.a,{type:"submit",bsStyle:"info",children:Object(R.jsx)(_i.a,{i18nKey:"share"})})]})})]})}function dO(){var e=Object(Mt.a)().t;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("p",{className:"text-center",children:[Object(R.jsx)(_i.a,{i18nKey:"need_to_upgrade_for_more_collabs"}),". ",e("also"),":"]}),Object(R.jsxs)("ul",{className:"list-unstyled",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"unlimited_projects"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"collabs_per_proj",values:{collabcount:"Multiple"}})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"full_doc_history"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"sync_to_dropbox"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"sync_to_github"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"compile_larger_projects"})]})]})]})}function hO(){return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"row",children:Object(R.jsx)("div",{className:"col-xs-10 col-xs-offset-1",children:Object(R.jsx)("p",{className:"text-center",children:Object(R.jsx)(_i.a,{i18nKey:"need_to_upgrade_for_more_collabs_variant"})})})}),Object(R.jsxs)("div",{className:"row",children:[Object(R.jsxs)("ul",{className:"list-unstyled col-xs-7",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"unlimited_projects"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"collabs_per_proj",values:{collabcount:"Multiple"}})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"full_doc_history"})]})]}),Object(R.jsxs)("ul",{className:"list-unstyled col-xs-5",children:[Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"sync_to_dropbox"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"sync_to_github"})]}),Object(R.jsxs)("li",{children:[Object(R.jsx)(Pr.a,{type:"check"})," ",Object(R.jsx)(_i.a,{i18nKey:"compile_larger_projects"})]})]})]}),Object(R.jsx)("br",{})]})}function pO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gO(){var e=Object(Io.b)({allowedFreeTrial:k.a.bool}),t=pO(Object(C.useState)(!1),2),n=t[0],r=t[1],a=Ks({splitTestVariants:k.a.object}).splitTestVariants["project-share-modal-paywall"];return Object(R.jsxs)("div",{className:"default"===a?"add-collaborators-upgrade":"",children:[a&&"default"!==a?Object(R.jsx)(hO,{}):Object(R.jsx)(dO,{}),Object(R.jsx)("p",{className:"text-center row-spaced-thin",children:e.allowedFreeTrial?Object(R.jsx)(ma.a,{buttonStyle:"success",setStartedFreeTrial:r,source:"project-sharing"}):Object(R.jsx)(Ir.a,{bsStyle:"success",onClick:function(){Object(xd.c)("project-sharing"),r(!0)},children:Object(R.jsx)(_i.a,{i18nKey:"upgrade"})})}),n&&Object(R.jsx)("p",{className:"small",children:Object(R.jsx)(_i.a,{i18nKey:"refresh_page_after_starting_free_trial"})})]})}function mO(){var e=Object(A.c)(),t=e.members,n=e.invites,r=e.features,a=Object(C.useMemo)((function(){return!!r&&(-1===r.collaborators||t.length+n.length<r.collaborators)}),[t,n,r]);return Object(R.jsx)(up.a,{className:"invite-controls",children:a?Object(R.jsx)(uO,{}):Object(R.jsx)(gO,{})})}function vO(e){var t=e.member;return Object(R.jsxs)(up.a,{className:"project-member",children:[Object(R.jsx)(dp.a,{xs:7,children:t.email}),Object(R.jsx)(dp.a,{xs:3,children:Object(R.jsx)(Mj,{privileges:t.privileges})})]})}function bO(){var e=Object(A.c)().owner;return Object(R.jsxs)(up.a,{className:"project-member",children:[Object(R.jsx)(dp.a,{xs:7,children:null==e?void 0:e.email}),Object(R.jsx)(dp.a,{xs:3,className:"text-left",children:Object(R.jsx)(_i.a,{i18nKey:"owner"})})]})}function yO(){var e=Object(A.c)().publicAccessLevel;return Object(R.jsx)(up.a,{className:"public-access-level public-access-level--notice",children:Object(R.jsx)(dp.a,{xs:12,className:"text-center",children:Object(R.jsx)(wO,{level:e})})})}function wO(e){switch(e.level){case"private":return Object(R.jsx)(_i.a,{i18nKey:"to_add_more_collaborators"});case"tokenBased":return Object(R.jsx)(_i.a,{i18nKey:"to_change_access_permissions"});default:return null}}function xO(){return Object(R.jsx)("div",{className:"recaptcha-branding",children:Object(R.jsx)(_i.a,{i18nKey:"recaptcha_conditions",components:{1:Object(R.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://policies.google.com/privacy",children:"Privacy Policy"}),2:Object(R.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://policies.google.com/terms",children:"Terms of Service"})}})})}function jO(){var e,t,n,r=EO().isAdmin,a=Ks({splitTestVariants:k.a.object}).splitTestVariants,l=Object(A.c)(),d=l.invites,h=l.members;switch(a["project-share-modal-paywall"]){case"new-copy-top":return Object(R.jsxs)(R.Fragment,{children:[r?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(mO,{}),Object(R.jsx)(up.a,{className:"public-access-level"})]}):Object(R.jsx)(yO,{}),Object(R.jsx)(bO,{}),h.map((function(e){return r?Object(R.jsx)(Oj,{member:e},e._id):Object(R.jsx)(vO,{member:e},e._id)})),d.map((function(e){return Object(R.jsx)(Lj,{invite:e,isAdmin:r},e._id)})),r&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("br",{}),Object(R.jsx)(Aj,{})]}),!(null!==(e=window.ExposedSettings.recaptchaDisabled)&&void 0!==e&&e.invite)&&Object(R.jsx)(xO,{})]});case"new-copy-middle":return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(bO,{}),h.map((function(e){return r?Object(R.jsx)(Oj,{member:e},e._id):Object(R.jsx)(vO,{member:e},e._id)})),d.map((function(e){return Object(R.jsx)(Lj,{invite:e,isAdmin:r},e._id)})),r?Object(R.jsx)(mO,{}):Object(R.jsx)(yO,{}),r&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("br",{}),Object(R.jsx)(Aj,{})]}),!(null!==(t=window.ExposedSettings.recaptchaDisabled)&&void 0!==t&&t.invite)&&Object(R.jsx)(xO,{})]});case"new-copy-bottom":case"default":default:return Object(R.jsxs)(R.Fragment,{children:[r&&Object(R.jsx)(Aj,{}),Object(R.jsx)(bO,{}),h.map((function(e){return r?Object(R.jsx)(Oj,{member:e},e._id):Object(R.jsx)(vO,{member:e},e._id)})),d.map((function(e){return Object(R.jsx)(Lj,{invite:e,isAdmin:r},e._id)})),r?Object(R.jsx)(mO,{}):Object(R.jsx)(yO,{}),!(null!==(n=window.ExposedSettings.recaptchaDisabled)&&void 0!==n&&n.invite)&&Object(R.jsx)(xO,{})]})}}function OO(e){var t=e.show,n=e.cancel,r=e.animation,a=e.inFlight,l=e.error,d=Object(te.b)({isRestrictedTokenMember:k.a.bool}).isRestrictedTokenMember;return Object(R.jsxs)(wi.a,{show:t,onHide:n,animation:r,children:[Object(R.jsx)(yi.a.Header,{closeButton:!0,children:Object(R.jsx)(yi.a.Title,{children:Object(R.jsx)(_i.a,{i18nKey:"share_project"})})}),Object(R.jsx)(yi.a.Body,{className:"modal-body-share",children:Object(R.jsx)(fp.a,{fluid:!0,children:d?Object(R.jsx)(Ij,{}):Object(R.jsx)(jO,{})})}),Object(R.jsxs)(yi.a.Footer,{className:"modal-footer-share",children:[Object(R.jsxs)("div",{className:"modal-footer-left",children:[a&&Object(R.jsx)(Pr.a,{type:"refresh",spin:!0}),l&&Object(R.jsx)("span",{className:"text-danger error",children:Object(R.jsx)(CO,{error:l})})]}),Object(R.jsx)("div",{className:"modal-footer-right",children:Object(R.jsx)(Ir.a,{type:"button",onClick:n,bsStyle:"default",disabled:a,children:Object(R.jsx)(_i.a,{i18nKey:"close"})})})]})]})}function CO(e){switch(e.error){case"cannot_invite_non_user":return Object(R.jsx)(_i.a,{i18nKey:"cannot_invite_non_user"});case"cannot_verify_user_not_robot":return Object(R.jsx)(_i.a,{i18nKey:"cannot_verify_user_not_robot"});case"cannot_invite_self":return Object(R.jsx)(_i.a,{i18nKey:"cannot_invite_self"});case"invalid_email":return Object(R.jsx)(_i.a,{i18nKey:"invalid_email"});case"too_many_requests":return Object(R.jsx)(_i.a,{i18nKey:"too_many_requests"});default:return Object(R.jsx)(_i.a,{i18nKey:"generic_something_went_wrong"})}}function SO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Yj.propTypes={loading:k.a.bool.isRequired,options:k.a.array.isRequired,placeholder:k.a.string,multipleSelectionProps:k.a.shape({getSelectedItemProps:k.a.func.isRequired,getDropdownProps:k.a.func.isRequired,addSelectedItem:k.a.func.isRequired,removeSelectedItem:k.a.func.isRequired,selectedItems:k.a.array.isRequired}).isRequired},Xj.propTypes={selected:k.a.bool.isRequired,item:k.a.shape({display:k.a.string.isRequired}),index:k.a.number.isRequired,getItemProps:k.a.func.isRequired},Jj.propTypes={focusInput:k.a.func.isRequired,removeSelectedItem:k.a.func.isRequired,selectedItem:k.a.shape({display:k.a.string.isRequired}),getSelectedItemProps:k.a.func.isRequired,index:k.a.number.isRequired},vO.propTypes={member:k.a.shape({_id:k.a.string.isRequired,email:k.a.string.isRequired,privileges:k.a.string.isRequired}).isRequired},wO.propTypes={level:k.a.string},OO.propTypes={cancel:k.a.func.isRequired,show:k.a.bool,animation:k.a.bool,inFlight:k.a.bool,error:k.a.string},CO.propTypes={error:k.a.oneOfType([k.a.bool,k.a.string]).isRequired};var kO=Object(C.createContext)();function EO(){var e=Object(C.useContext)(kO);if(!e)throw new Error("useShareProjectContext is only available inside ShareProjectProvider");return e}kO.Provider.propTypes={value:k.a.shape({isAdmin:k.a.bool.isRequired,updateProject:k.a.func.isRequired,monitorRequest:k.a.func.isRequired,inFlight:k.a.bool,setInFlight:k.a.func,error:k.a.oneOfType([k.a.bool,k.a.string]),setError:k.a.func})};var AO=S.a.memo((function(e){var t=e.handleHide,n=e.show,r=e.animation,a=void 0===r||r,l=e.isAdmin,d=SO(Object(C.useState)(!1),2),h=d[0],p=d[1],f=SO(Object(C.useState)(),2),y=f[0],w=f[1],x=Object(A.c)(A.b),j=Ks({splitTestVariants:k.a.object}).splitTestVariants;Object(C.useEffect)((function(){n&&Object(xe.b)("share-modal-opened",{splitTestVariant:j["null-test-share-modal"]})}),[j,n]),Object(C.useEffect)((function(){n&&w(void 0)}),[n]);var O=Object(C.useCallback)((function(){h||t()}),[t,h]),S=Object(C.useCallback)((function(e){w(void 0),p(!0);var t=e();return t.catch((function(e){var t,n;w((null===(t=e.data)||void 0===t?void 0:t.errorReason)||(null===(n=e.data)||void 0===n?void 0:n.error)||"generic_something_went_wrong")})),t.finally((function(){p(!1)})),t}),[]),_=Object(C.useCallback)((function(e){return Object.assign(x,e)}),[x]);return x?Object(R.jsx)(kO.Provider,{value:{isAdmin:l,updateProject:_,monitorRequest:S,inFlight:h,setInFlight:p,error:y,setError:w},children:Object(R.jsx)(OO,{animation:a,cancel:O,error:y,inFlight:h,show:n})}):null}));AO.propTypes={animation:k.a.bool,handleHide:k.a.func.isRequired,isAdmin:k.a.bool.isRequired,show:k.a.bool.isRequired};var $O=AO;y.a.component("shareProjectModal",Object(x.react2angular)(Ys.use($O),Object.keys($O.propTypes)));y.a.controller("ReactShareProjectModalController",["$scope","eventTracking","ide",function(e,t,n){e.isAdmin=!1,e.show=!1,e.handleHide=function(){e.$applyAsync((function(){e.show=!1}))},e.openShareProjectModal=function(n){t.sendMBOnce("ide-open-share-modal-once"),e.$applyAsync((function(){e.isAdmin=n,e.show=!0}))},n.socket.on("project:tokens:changed",(function(t){null!=t.tokens&&e.$applyAsync((function(){e.project.tokens=t.tokens}))})),n.socket.on("project:membership:changed",(function(t){var n;t.members&&(n=e.project._id,Object(B.c)("/project/".concat(n,"/members"))).then((function(t){var n=t.members;n&&e.$applyAsync((function(){e.project.members=n}))})).catch((function(){console.error("Error fetching members for project")})),t.invites&&function(e){return Object(B.c)("/project/".concat(e,"/invites"))}(e.project._id).then((function(t){var n=t.invites;n&&e.$applyAsync((function(){e.project.invites=n}))})).catch((function(){console.error("Error fetching invites for project")}))}))}]);function TO(e){var t=e.tooltip,n=e.url,r=void 0===n?"/beta/participate":n;return Object(R.jsx)(hi.a,{placement:t.placement||"bottom",overlay:Object(R.jsx)(di.a,{id:t.id,className:t.className,children:t.text}),delayHide:100,children:Object(R.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"badge beta-badge",children:Object(R.jsx)("span",{className:"sr-only",children:t.text})})})}function RO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],d=!0,h=!1;try{for(n=n.call(e);!(d=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);d=!0);}catch(e){h=!0,a=e}finally{try{d||null==n.return||n.return()}finally{if(h)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return IO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PO(){var e=RO(Object(oe.a)("editor.newSourceEditor"),2),t=e[0],n=e[1],r=RO(Object(oe.a)("editor.showRichText"),2),a=r[0],l=r[1],d=Object(C.useCallback)((function(e){switch(e.target.value){case"ace":l(!1),n(!1);break;case"cm6":l(!1),n(!0);break;case"rich-text":l(!0)}}),[l,n]),h=Object(C.useMemo)((function(){return{id:"editor-switch-tooltip",placement:"bottom",className:"tooltip-wide",text:Object(R.jsxs)(R.Fragment,{children:['We are upgrading the source editor. Please test it by selecting "Source (Beta)".',Object(R.jsx)("br",{}),Object(R.jsx)("br",{}),"Click to learn more and give feedback"]})}}),[]);return Object(R.jsxs)("div",{className:"editor-toggle-switch",children:[Object(R.jsx)(TO,{tooltip:h,url:"https://forms.gle/GmSs6odZRKRp3VX98"}),Object(R.jsxs)("fieldset",{className:"toggle-switch",children:[Object(R.jsx)("legend",{className:"sr-only",children:"Editor mode."}),Object(R.jsx)("input",{type:"radio",name:"editor",value:"cm6",id:"editor-switch-cm6",className:"toggle-switch-input",checked:!a&&!!t,onChange:d}),Object(R.jsx)("label",{htmlFor:"editor-switch-cm6",className:"toggle-switch-label",children:Object(R.jsx)("span",{children:"Source (Beta)"})}),Object(R.jsx)("input",{type:"radio",name:"editor",value:"ace",id:"editor-switch-ace",className:"toggle-switch-input",checked:!a&&!t,onChange:d}),Object(R.jsx)("label",{htmlFor:"editor-switch-ace",className:"toggle-switch-label",children:Object(R.jsx)("span",{children:"Source"})}),Object(R.jsx)("input",{type:"radio",name:"editor",value:"rich-text",id:"editor-switch-rich-text",className:"toggle-switch-input",checked:!!a,onChange:d}),Object(R.jsx)("label",{htmlFor:"editor-switch-rich-text",className:"toggle-switch-label",children:Object(R.jsx)("span",{children:"Rich Text"})})]})]})}TO.propTypes={tooltip:k.a.exact({id:k.a.string.isRequired,text:k.a.oneOfType([k.a.string,k.a.object]).isRequired,placement:k.a.string,className:k.a.string}),url:k.a.string};var DO=Object(C.memo)(PO);y.a.component("editorSwitch",Object(x.react2angular)(Ys.use(DO))),y.a.controller("IdeController",["$scope","$timeout","ide","localStorage","eventTracking","metadata","$q","CobrandingDataService","$window",function(e,t,n,r,a,l,d,h,p){var f,y,w;e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)},e.state={loading:!0,load_progress:40,error:null},e.ui={leftMenuShown:!1,view:"editor",chatOpen:!1,pdfLayout:"sideBySide",pdfHidden:!1,pdfWidth:0,reviewPanelOpen:r("ui.reviewPanelOpen.".concat(window.project_id)),miniReviewPanelVisible:!1,chatResizerSizeOpen:7,chatResizerSizeClosed:0},e.user=window.user,e.settings=window.userSettings,e.anonymous=window.anonymous,e.isTokenMember=window.isTokenMember,e.isRestrictedTokenMember=window.isRestrictedTokenMember,e.cobranding={isProjectCobranded:h.isProjectCobranded(),logoImgUrl:h.getLogoImgUrl(),submitBtnHtml:h.getSubmitBtnHtml(),brandVariationName:h.getBrandVariationName(),brandVariationHomeUrl:h.getBrandVariationHomeUrl()},e.chat={},n.toggleReviewPanel=e.toggleReviewPanel=function(){e.project.features.trackChangesVisible&&(e.ui.reviewPanelOpen=!e.ui.reviewPanelOpen,a.sendMB("rp-toggle-panel",{value:e.ui.reviewPanelOpen}))},e.$watch("ui.reviewPanelOpen",(function(e){if(null!=e)return r("ui.reviewPanelOpen.".concat(window.project_id),e)})),e.$on("layout:pdf:resize",(function(t,n){return e.ui.pdfHidden=n.east.initClosed,e.ui.pdfWidth=n.east.size})),e.$watch("ui.view",(function(t,n){t!==n&&e.$broadcast("layout:flat-screen:toggle"),null!=t&&"editor"!==t&&"pdf"!==t&&a.sendMBOnce("ide-open-view-".concat(t,"-once"))})),e.$watch("ui.chatOpen",(function(e){e&&a.sendMBOnce("ide-open-chat-once")})),e.$watch("ui.leftMenuShown",(function(e){e&&a.sendMBOnce("ide-open-left-menu-once")})),e.trackHover=function(e){a.sendMBOnce("ide-hover-".concat(e,"-once"))},window._ide=n,n.validFileRegex="^[^*/]*$";var x=window.location&&window.location.search&&window.location.search.match(/ws=fallback/);n.wsUrl=x?null:window.sharelatex.wsUrl||null,n.project_id=e.project_id=window.project_id,n.$scope=e,n.referencesSearchManager=new Pd(n,e),n.loadingManager=new rl(e),n.connectionManager=new $l(n,e),n.fileTreeManager=new el(n,e),n.editorManager=new Zu(n,e,r,a),n.onlineUsersManager=new rd(n,e),window.data.useV2History?n.historyManager=new Sd(n,e,r):n.historyManager=new cd(n,e),n.permissionsManager=new Ed(n,e),n.binaryFilesManager=new $d(n,e),n.metadataManager=new Md(n,e,l),n.outlineManager=new th(n,e);var j=!1;e.$on("project:joined",(function(){if(!j)return j=!0,MO(null!=e?e.project:void 0,(function(e){return e.deletedByExternalDataSource}))&&n.showGenericMessageModal("Project Renamed or Deleted","This project has either been renamed or deleted by an external data source such as Dropbox.\nWe don't want to delete your data on Overleaf, so this project still contains your history and collaborators.\nIf the project has been renamed please look in your project list for a new project under the new name."),t((function(){if(e.permissions.write)return n.metadataManager.loadProjectMetaFromServer(),!0}),200)}));var O=!1;e.$on("doc:opened",(function(){if(!O)return e.$broadcast("ide:loaded"),O=!0})),n.editingSessionHeartbeat=function(){var e={editorType:n.editorManager.getEditorType()};a.editingSessionHeartbeat(e)},e.$on("cursor:editor:update",(function(){n.editingSessionHeartbeat()})),e.$on("scroll:editor:update",(function(){n.editingSessionHeartbeat()})),angular.element(p).on("click",n.editingSessionHeartbeat),e.$on("$destroy",(function(){return angular.element(p).off("click",n.editingSessionHeartbeat)}));var C=["ambiance","chaos","clouds_midnight","cobalt","idle_fingers","merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","terminal","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink"];e.darkTheme=!1,e.$watch("settings.editorTheme",(function(t){return Array.from(C).includes(t)?e.darkTheme=!0:e.darkTheme=!1})),n.localStorage=r,n.browserIsSafari=!1,e.switchToFlatLayout=function(t){return e.ui.pdfLayout="flat",e.ui.view=t,n.localStorage("pdf.layout","flat")},e.switchToSideBySideLayout=function(t){return e.ui.pdfLayout="sideBySide",e.ui.view=t,r("pdf.layout","split")},(y=r("pdf.layout"))?("split"===y&&e.switchToSideBySideLayout(),"flat"===y&&e.switchToFlatLayout()):e.switchToSideBySideLayout(),e.recompileViaKey=function(){e.recompile?e.recompile({keyShortcut:!0}):window.dispatchEvent(new CustomEvent("pdf:recompile",{detail:{keyShortcut:!0}}))},e.handleKeyDown=function(t){t.shiftKey||t.altKey||"s"===t.key&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),e.recompileViaKey())};try{w=navigator.userAgent,n.browserIsSafari=w&&/.*Safari\/.*/.test(w)&&!/.*Chrome\/.*/.test(w)&&!/.*Chromium\/.*/.test(w)}catch(e){f=e,console.error(f)}n.browserIsSafari&&(n.safariScrollPatcher=new ih(e));try{null!=(parseFloat(navigator.userAgent.split(" Chrome/")[1])||null)&&document.styleSheets[0].insertRule(".ace_editor.ace_autocomplete .ace_completion-highlight { text-shadow: none !important; font-weight: bold; }",1)}catch(e){f=e,console.error(f)}return n.featureToggle=MO(MO("undefined"!=typeof location&&null!==location?location.search:void 0,(function(e){return e.match(/^\?ft=(\w+)$/)})),(function(e){return e[1]})),n.$scope.$on("service-worker:unregister",lh),window.addEventListener("editor:lint",(function(t){e.hasLintingError=t.detail.hasLintingError})),n.socket.on("project:publicAccessLevel:changed",(function(t){if(null!=t.newAccessLevel)return n.$scope.project.publicAccesLevel=t.newAccessLevel,e.$digest()}))}]),Object(le.a)("ol-resetServiceWorker")?lh():Object(le.a)("ol-enablePdfCaching")&&function(e){if(sh()){var t=navigator.serviceWorker.register("/serviceWorker.js",{scope:"/project/"}).then((function(){navigator.serviceWorker.addEventListener("message",(function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}if(t&&t.error&&t.extra){var n=ah.tag(t.error,"Error in serviceWorker"),r=new Error;r.name=n.name,r.message=n.message,r.stack=ah.getFullStack(n),Object(oh.a)(r,{extra:t.extra})}}))})).catch((function(e){return Object(oh.a)(ah.tag(e,"Cannot register serviceWorker"))}));if(e&&e.timeout>0){var n=new Promise((function(t){setTimeout(t,e.timeout)}));Promise.race([t,n])}else t}}(),angular.module("SharelatexApp").config(["$provide",function(e){e.decorator("$browser",["$delegate",function(e){return e.onUrlChange=function(){},e.url=function(){return""},e}])}]);t.default=angular.bootstrap(document.body,["SharelatexApp"]);function MO(e,t){return null!=e?t(e):void 0}},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));n(16),n(4),n(10),n(13),n(8),n(7),n(17),n(11),n(12),n(14),n(6),n(9),n(43);var r=n(2),a=n(308);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(r=(d=h.next()).done)&&(n.push(d.value),!t||n.length!==t);r=!0);}catch(e){a=!0,l=e}finally{try{r||null==h.return||h.return()}finally{if(a)throw l}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=0,f=Object(r.memo)((function(e){var t=e.children,n=l(function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,l=t;l[y]||(l[y]=Object(a.b)(e,t,n,r));return l[y]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(h(e,["children"])),2),d=n[0],f=n[1];return r.useEffect((function(){return f&&p++,function(){f&&(0===--p&&(w()[y]=null))}}),[]),r.createElement(a.a.Provider,{value:d},t)}));f.displayName="DndProvider";var y=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");function w(){return void 0!==e?e:window}}).call(this,n(84))},function(e,t,n){"use strict";var r=n(253),a=n.n(r),l=n(27),d=n(35),h=n(34),p=n(19),f=n.n(p),y=n(2),w=n.n(y),x=n(1),j=n.n(x),O=n(23),C=n(61),S=n(361),_={onDismiss:j.a.func,closeLabel:j.a.string},k=function(e){function t(){return e.apply(this,arguments)||this}return Object(h.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.onDismiss,r=t.closeLabel,a=t.className,h=t.children,p=Object(d.a)(t,["onDismiss","closeLabel","className","children"]),y=Object(O.f)(p),x=y[0],j=y[1],C=!!n,_=Object(l.a)({},Object(O.d)(x),((e={})[Object(O.e)(x,"dismissable")]=C,e));return w.a.createElement("div",Object(l.a)({},j,{role:"alert",className:f()(a,_)}),C&&w.a.createElement(S.a,{onClick:n,label:r}),h)},t}(w.a.Component);k.propTypes=_,k.defaultProps={closeLabel:"Close alert"},t.a=Object(O.c)(a()(C.d),C.d.INFO,Object(O.a)("alert",k))},function(e,t,n){"use strict";var r=n(27),a=n(35),l=n(34),d=n(19),h=n.n(d),p=n(2),f=n.n(p),y=n(1),w=n.n(y),x=n(68),j=n.n(x),O=n(23),C={fluid:w.a.bool,componentClass:j.a},S=function(e){function t(){return e.apply(this,arguments)||this}return Object(l.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.fluid,n=e.componentClass,l=e.className,d=Object(a.a)(e,["fluid","componentClass","className"]),p=Object(O.f)(d),y=p[0],w=p[1],x=Object(O.e)(y,t&&"fluid");return f.a.createElement(n,Object(r.a)({},w,{className:h()(l,x)}))},t}(f.a.Component);S.propTypes=C,S.defaultProps={componentClass:"div",fluid:!1},t.a=Object(O.a)("container",S)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n(493),a=n.n(r),l=n(257),d=n.n(l),h=n(155),p=n.n(h),f=n(2),y=n.n(f),w=n(610),x=n.n(w),j=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function O(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(x.a[n[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var r=e.indexOf("--\x3e");return{type:"comment",comment:-1!==r?e.slice(4,r):""}}for(var a=new RegExp(j),l=null;null!==(l=a.exec(e));)if(l[0].trim())if(l[1]){var d=l[1].trim(),h=[d,""];d.indexOf("=")>-1&&(h=d.split("=")),t.attrs[h[0]]=h[1],a.lastIndex--}else l[2]&&(t.attrs[l[2]]=l[3].trim().substring(1,l[3].length-1));return t}var C=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,S=/^\s*$/,_=Object.create(null);function k(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+'="'+e[n]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(k,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var E={parse:function(e,t){t||(t={}),t.components||(t.components=_);var n,r=[],a=[],l=-1,d=!1;if(0!==e.indexOf("<")){var h=e.indexOf("<");r.push({type:"text",content:-1===h?e:e.substring(0,h)})}return e.replace(C,(function(h,p){if(d){if(h!=="</"+n.name+">")return;d=!1}var f,y="/"!==h.charAt(1),w=h.startsWith("\x3c!--"),x=p+h.length,j=e.charAt(x);if(w){var C=O(h);return l<0?(r.push(C),r):((f=a[l]).children.push(C),r)}if(y&&(l++,"tag"===(n=O(h)).type&&t.components[n.name]&&(n.type="component",d=!0),n.voidElement||d||!j||"<"===j||n.children.push({type:"text",content:e.slice(x,e.indexOf("<",x))}),0===l&&r.push(n),(f=a[l-1])&&f.children.push(n),a[l]=n),(!y||n.voidElement)&&(l>-1&&(n.voidElement||n.name===h.slice(2,-1))&&(l--,n=-1===l?r:a[l]),!d&&"<"!==j&&j)){f=-1===l?r:a[l].children;var _=e.indexOf("<",x),k=e.slice(x,-1===_?void 0:_);S.test(k)&&(k=" "),(_>-1&&l+f.length>=0||" "!==k)&&f.push({type:"text",content:k})}})),r},stringify:function(e){return e.reduce((function(e,t){return e+k("",t)}),"")}},A="".replace,T=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g,R={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"'};function I(e){return R[e]}var P=n(129),D=n(116),M=["format"],L=["children","count","parent","i18nKey","tOptions","values","defaults","components","ns","i18n","t","shouldUnescape"];function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){if(!e)return!1;var n=e.props?e.props.children:e.children;return t?n.length>0:!!n}function B(e){return e?e&&e.children?e.children:e.props&&e.props.children:[]}function U(e){return Array.isArray(e)?e:[e]}function H(e,t,n,r,a,l){if(""===t)return[];var h=r.transKeepBasicHtmlNodesFor||[],p=t&&new RegExp(h.join("|")).test(t);if(!e&&!p)return[t];var f={};!function e(t){U(t).forEach((function(t){"string"!=typeof t&&(N(t)?e(B(t)):"object"!==d()(t)||y.a.isValidElement(t)||Object.assign(f,t))}))}(e);var w=E.parse("<0>".concat(t,"</0>")),x=q(q({},f),a);function j(e,t,n){var r=B(e),a=C(r,t.children,n);return function(e){return"[object Array]"===Object.prototype.toString.call(e)&&e.every((function(e){return y.a.isValidElement(e)}))}(r)&&0===a.length?r:a}function O(e,t,n,r,a){e.dummy&&(e.children=t),n.push(y.a.cloneElement(e,q(q({},e.props),{},{key:r}),a?void 0:t))}function C(t,a,f){var w=U(t);return U(a).reduce((function(t,a,S){var _,k,E,R,P=a.children&&a.children[0]&&a.children[0].content&&n.services.interpolator.interpolate(a.children[0].content,x,n.language);if("tag"===a.type){var D=w[parseInt(a.name,10)];!D&&1===f.length&&f[0][a.name]&&(D=f[0][a.name]),D||(D={});var M=0!==Object.keys(a.attrs).length?(k={props:a.attrs},(R=q({},E=D)).props=Object.assign(k.props,E.props),R):D,L=y.a.isValidElement(M),F=L&&N(a,!0)&&!a.voidElement,B=p&&"object"===d()(M)&&M.dummy&&!L,U="object"===d()(e)&&null!==e&&Object.hasOwnProperty.call(e,a.name);if("string"==typeof M){var H=n.services.interpolator.interpolate(M,x,n.language);t.push(H)}else if(N(M)||F){O(M,j(M,a,f),t,S)}else if(B){var z=C(w,a.children,f);t.push(y.a.cloneElement(M,q(q({},M.props),{},{key:S}),z))}else if(Number.isNaN(parseFloat(a.name))){if(U)O(M,j(M,a,f),t,S,a.voidElement);else if(r.transSupportBasicHtmlNodes&&h.indexOf(a.name)>-1)if(a.voidElement)t.push(y.a.createElement(a.name,{key:"".concat(a.name,"-").concat(S)}));else{var V=C(w,a.children,f);t.push(y.a.createElement(a.name,{key:"".concat(a.name,"-").concat(S)},V))}else if(a.voidElement)t.push("<".concat(a.name," />"));else{var W=C(w,a.children,f);t.push("<".concat(a.name,">").concat(W,"</").concat(a.name,">"))}}else if("object"!==d()(M)||L)1===a.children.length&&P?t.push(y.a.cloneElement(M,q(q({},M.props),{},{key:S}),P)):t.push(y.a.cloneElement(M,q(q({},M.props),{},{key:S})));else{var K=a.children[0]?P:null;K&&t.push(K)}}else if("text"===a.type){var G=r.transWrapTextNodes,Y=l?(_=n.services.interpolator.interpolate(a.content,x,n.language),A.call(_,T,I)):n.services.interpolator.interpolate(a.content,x,n.language);G?t.push(y.a.createElement(G,{key:"".concat(a.name,"-").concat(S)},Y)):t.push(Y)}return t}),[])}return B(C([{dummy:!0,children:e||[]}],w,U(e||[]))[0])}function z(e){var t=e.children,n=e.count,r=e.parent,l=e.i18nKey,h=e.tOptions,p=void 0===h?{}:h,w=e.values,x=e.defaults,j=e.components,O=e.ns,C=e.i18n,S=e.t,_=e.shouldUnescape,k=a()(e,L),E=Object(f.useContext)(P.a)||{},A=E.i18n,T=E.defaultNS,R=C||A||Object(P.d)();if(!R)return Object(D.d)("You will need to pass in an i18next instance by using i18nextReactModule"),t;var I=S||R.t.bind(R)||function(e){return e},F=q(q({},Object(P.c)()),R.options&&R.options.react),N=O||I.ns||T||R.options&&R.options.defaultNS;N="string"==typeof N?[N]:N||["translation"];var B=x||function e(t,n){if(!t)return"";var r="",l=U(t),h=n.transKeepBasicHtmlNodesFor||[];return l.forEach((function(t,l){if("string"==typeof t)r+="".concat(t);else if(y.a.isValidElement(t)){var p=Object.keys(t.props).length,f=h.indexOf(t.type)>-1,w=t.props.children;if(!w&&f&&0===p)r+="<".concat(t.type,"/>");else if(w||f&&0===p)if(t.props.i18nIsDynamicList)r+="<".concat(l,"></").concat(l,">");else if(f&&1===p&&"string"==typeof w)r+="<".concat(t.type,">").concat(w,"</").concat(t.type,">");else{var x=e(w,n);r+="<".concat(l,">").concat(x,"</").concat(l,">")}else r+="<".concat(l,"></").concat(l,">")}else if(null===t)Object(D.c)("Trans: the passed in value is invalid - seems you passed in a null child.");else if("object"===d()(t)){var j=t.format,O=a()(t,M),C=Object.keys(O);if(1===C.length){var S=j?"".concat(C[0],", ").concat(j):C[0];r+="{{".concat(S,"}}")}else Object(D.c)("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",t)}else Object(D.c)("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",t)})),r}(t,F)||F.transEmptyNodeValue||l,z=F.hashTransKey,V=l||(z?z(B):B),W=w?p.interpolation:{interpolation:q(q({},p.interpolation),{},{prefix:"#$?",suffix:"?$#"})},K=q(q(q(q({},p),{},{count:n},w),W),{},{defaultValue:B,ns:N}),G=H(j||t,V?I(V,K):B,R,F,K,_),Y=void 0!==r?r:F.defaultTransParent;return Y?y.a.createElement(Y,k,G):G}}])}));